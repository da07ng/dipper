// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/FeaturedItems",["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/dijit/Gallery,arcgisonline/sharing/dijit/views,arcgisonline/sharing/util"],function(e,a,f){a.provide("arcgisonline.sharing.dijit.FeaturedItems");a.require("arcgisonline.sharing.dijit.Gallery");a.require("arcgisonline.sharing.dijit.views");a.require("arcgisonline.sharing.util");a.declare("arcgisonline.sharing.dijit.FeaturedItems",[e._Widget,e._Templated],{_gallery:null,_galleryPane:null,_detailsPane:null,
_detailsTextPane:null,_detailsIconPane:null,_detailsTimer:null,featuredItemsId:null,galleryNodes:4,galleryFilter:null,_views:arcgisonline.sharing.dijit.views,_util:arcgisonline.sharing.util,showThumbnail:!0,templateString:'\x3cdiv class\x3d"featuredItems" dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3c!-- \r\n  \x3cdiv class\x3d"details" dojoAttachPoint\x3d"_detailsPane"\x3e \x3c/div\x3e\r\n  \x3cdiv class\x3d"gallery"\x3e\r\n\t  \x3cspan style\x3d"vertical-align: middle;"\x3e\r\n\t\t  \x3ca dojoAttachEvent\x3d"onclick:prevPage"\x3e\r\n\t      \x3cspan class\x3d"pageButton pageButtonRight" style\x3d"display:inline-block;"\x3e\x26lt;\x3c/span\x3e\r\n\t    \x3c/a\x3e\r\n\t\t  \x3cdiv style\x3d"display: inline-block;"\x3e\r\n\t\t   \x3cdiv dojoAttachPoint\x3d"_galleryPane" style\x3d"display:block;"\x3e\x3c/div\x3e\r\n\t\t  \x3c/div\x3e\r\n\t\t  \x3ca dojoAttachEvent\x3d"onclick:nextPage"\x3e\r\n\t\t    \x3cspan class\x3d"pageButton pageButtonRight" style\x3d"display:inline-block;"\x3e\x26gt;\x3c/span\x3e\r\n\t\t  \x3c/a\x3e\r\n\t  \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  --\x3e\r\n  \x3cdiv class\x3d"thumb esriAlignLeading" dojoAttachPoint\x3d"_detailsIconPane"\x3e \x3c/div\x3e\r\n  \x3cdiv class\x3d"gallery esriAlignLeading"\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_galleryPane" \x3e\x3c/div\x3e\r\n  \x3c/div\x3e  \r\n  \x3cdiv class\x3d"details esriAlignLeading" dojoAttachPoint\x3d"_detailsTextPane" style\x3d"clear:both;"\x3e \x3c/div\x3e\r\n  \r\n  \x3cdiv style\x3d"clear:both; height:0px;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
_getFeaturedItems:function(){arcgisonline.sharing.geow.Content.getFeaturedItems(this.featuredItemsId,a.hitch(this,this._handleFeaturedIdChange),a.hitch(this,this._handleFeaturedIdChange))},refresh:function(){this._getFeaturedItems()},postCreate:function(){this._gallery=new arcgisonline.sharing.dijit.Gallery({nodesPerPage:this.galleryNodes,showNodeLabels:!1,showToolTip:!1,includeNode:this.galleryFilter},this._galleryPane);this._gallery.startup();a.connect(this._gallery,"onContentChange",this,this._placeDetails);
a.connect(this._gallery,"onNodeMouseEnter",this,this._handleNodeMouseEnter);a.connect(this._gallery,"onNodeMouseLeave",this,this._handleNodeMouseLeave)},_handleNodeMouseEnter:function(c,b){null!=this._detailsTimer&&window.clearTimeout(this._detailsTimer);this._detailsTimer=window.setTimeout(a.hitch(this,this._placeDetails,b),500)},_handleNodeMouseLeave:function(a,b){null!=this._detailsTimer&&window.clearTimeout(this._detailsTimer)},_placeDetails:function(c){if(c){"number"==typeof c&&(c=this._gallery.items[0]);
var b=[];b.push(a.fadeOut({node:this._detailsIconPane,duration:200}));b.push(a.fadeOut({node:this._detailsTextPane,duration:200}));b=a.fx.combine(b);a.connect(b,"onEnd",a.hitch(this,function(){var b=this._views.item.medium(c,!1,"left");this.showThumbnail&&a.create("img",{src:this._views.item._getThumbnailUrl(c)},this._detailsIconPane,"only");var d=a.create("span");a.style(d,"position","absolute");a.style(d,"padding","0 0 0 420px");a.place(this._util.getGalleryItemLinks(c),d,"only");a.place(b,this._detailsTextPane,
"only");a.place(d,b,"before");a.fx.combine([a.fadeIn({node:this._detailsIconPane,duration:200}),a.fadeIn({node:this._detailsTextPane,duration:200})]).play()}));b.play()}},_setFeaturedItemsIdAttr:function(a){null==a||0==a.length||(this.pageCount=0,this.featuredItemsId=a,this._getFeaturedItems())},_handleFeaturedIdChange:function(c,b){a.attr(this._gallery,"items",c.results||c.relatedItems)},nextPage:function(){this._gallery.nextPage()},prevPage:function(){this._gallery.prevPage()}})});