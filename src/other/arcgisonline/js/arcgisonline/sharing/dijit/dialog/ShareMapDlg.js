// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/dialog/ShareMapDlg",["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/util,arcgisonline/sharing/utilShare,dijit/Dialog,arcgisonline/sharing/dijit/TemplatesGrid,arcgisonline/sharing/geow/Content,arcgisonline/sharing/geow/Community,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/HelpManager,dijit/form/Textarea,dijit/_Widget,dijit/_Templated,dijit/Tooltip,dijit/layout/StackContainer,dojo/store/Memory,dojo/data/ObjectStore,arcgisonline/sharing/dijit/ShareOptions,arcgisonline/sharing/dijit/ComboBox,esri/basemaps,esri/dijit/Search,esri/dijit/Tags,arcgisonline/sharing/dijit/dialog/BrowseItemsDlg,arcgisonline/sharing/dijit/dialog/PluginConfigurableAppsViewer,arcgisonline/sharing/dijit/dialog/ConfirmDialog,arcgisonline/sharing/dijit/dialog/ItemPropertiesDlg,arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin"],
function(c,a,n){a.provide("arcgisonline.sharing.dijit.dialog.ShareMapDlg");a.require("arcgisonline.sharing.util");a.require("arcgisonline.sharing.utilShare");a.require("dijit.Dialog");a.require("arcgisonline.sharing.dijit.TemplatesGrid");a.require("arcgisonline.sharing.geow.Content");a.require("arcgisonline.sharing.geow.Community");a.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");a.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");a.require("arcgisonline.sharing.dijit.HelpManager");
a.require("dijit.form.Textarea");a.require("dijit._Widget");a.require("dijit._Templated");a.require("dijit.Tooltip");a.require("dijit.layout.StackContainer");a.require("dojo.store.Memory");a.require("dojo.data.ObjectStore");a.require("arcgisonline.sharing.dijit.ShareOptions");a.require("arcgisonline.sharing.dijit.ComboBox");a.require("esri.basemaps");a.require("esri.dijit.Search");a.require("esri.dijit.Tags");a.require("arcgisonline.sharing.dijit.dialog.BrowseItemsDlg");a.require("arcgisonline.sharing.dijit.dialog.PluginConfigurableAppsViewer");
a.require("arcgisonline.sharing.dijit.dialog.ConfirmDialog");a.require("arcgisonline.sharing.dijit.dialog.ItemPropertiesDlg");a.require("arcgisonline.sharing.dijit.dialog._CreateItemUtilMixin");a.declare("arcgisonline.sharing.dijit.dialog.ShareMapDlg",[c._Widget,c._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.Dialog" class\x3d"${baseClass}" id\x3d"share-map-dialog" title\x3d"${i18n.share}" execute\x3d"" style\x3d"width:900px;"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.StackContainer" id\x3d"share-map-stack" data-dojo-attach-point\x3d"_stackContainer" data-dojo-props\x3d"doLayout:false"\x3e\r\n      \x3cdiv id\x3d"galleryTabs" style\x3d"display:none;" class\x3d"galleryTabs"\x3e\r\n        \x3ca id\x3d"configurableTab" class\x3d"selected" href\x3d"JavaScript:void(0);"\x3e${i18n.configurableApps}\x3c/a\x3e\r\n        \x3ca id\x3d"appBuilderTab" href\x3d"JavaScript:void(0);"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- all options --\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackAllOptions" class\x3d"share-map-stack-stack"\x3e\r\n        \x3cdiv id\x3d"share-map-is-public" style\x3d"display:none;"\x3e\r\n          \x3cdiv class\x3d"paddingBottom10"\x3e\r\n            \x3clabel\x3e\r\n              ${i18n.selectToShare}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"share-map-make-public" style\x3d"display:none;"\x3e\r\n          \x3cdiv class\x3d"paddingBottom10"\x3e\r\n            \x3clabel style\x3d"font-weight:bold;"\x3e\r\n              ${i18n.chooseWhoCanView}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv\x3e\r\n            \x3clabel id\x3d"share-map-text-public-note"\x3e\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-premium" style\x3d"display:none;"\x3e\x3cspan class\x3d"esriItemLinks"\x3e${i18n.premiumLayerMsg}\x26nbsp;\x3cA id\x3d"share-map-premium-link" href\x3d"JavaScript:void(0)" target\x3d"_blank"\x3e${i18n.premiumLayerMsgLearnMore}\x3c/A\x3e\x3c/span\x3e\x3c/div\x3e\r\n          \x3c!--\r\n          \x3cdiv style\x3d"padding-top:15px;padding-bottom:15px;"\x3e\r\n          \x3cinput id\x3d"share-map-share-everyone" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" value\x3d"off" type\x3d"checkbox"/\x3e\r\n          \x3clabel id\x3d"share-map-label" for\x3d"share-map-share-everyone"\x3e\r\n          Share with everyone (public).\r\n          \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          --\x3e\r\n          \x3cdiv style\x3d"" data-dojo-type\x3d"arcgisonline.sharing.dijit.ShareOptions" data-dojo-attach-point\x3d"shareOptions"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"share-map-not-public" style\x3d"display:none;padding-bottom:15px;"\x3e\r\n          \x3cdiv\x3e\r\n            \x3clabel id\x3d"share-map-text-not-public-note"\x3e\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"height:20px;"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d""\x3e\r\n          \x3clabel style\x3d"font-weight:bold;"\x3e\r\n            ${i18n.linkToMap}\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"linkTypeDiv" class\x3d"paddingLeading15 paddingTop10 paddingBottom10" style\x3d"display:none;"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"linkType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"linkType:map" /\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:50px;"\x3e\r\n            \x3clabel for\x3d"linkType:map"\x3e\r\n              ${i18n.mapLabel}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"linkType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"linkType:presentation" checked\x3d"checked"/\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:100px;"\x3e\r\n            \x3clabel for\x3d"linkType:presentation" id\x3d"linkType:presentation-label"\x3e\r\n              ${i18n.presentationLabel}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"paddingLeading15" style\x3d"clear:both;"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" class\x3d"paddingTop10" style\x3d"width:320px;"\x3e\r\n            \x3cdiv id\x3d"share-map-url" data-dojo-type\x3d"dijit.form.Textarea" style\x3d"width:270px;color:#000;" dir\x3d"ltr"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"socialNetworkLinks" style\x3d"display:none;" class\x3d"esriFloatLeading"\x3e\r\n            \x3cdiv class\x3d"esriItemLinks"\x3e\r\n              \x3c!-- use table because of RTL + IE --\x3e\r\n              \x3ctable\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd width\x3d"30"\x3e\r\n                      \x3cA id\x3d"facebookLink" href\x3d"JavaScript:void(0);" title\x3d"${i18n.shareFacebook}" alt\x3d"${i18n.shareFacebook}" target\x3d"_blank"\x3e\x3cspan class\x3d"badge facebookBadge dijitInline"\x3e\x3c/span\x3e\x3c/A\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cA id\x3d"facebookLink2" class\x3d"label" style\x3d"vertical-align:top;" title\x3d"${i18n.shareFacebook}" alt\x3d"${i18n.shareFacebook}" target\x3d"_blank"\x3e${i18n.facebook}\x3c/A\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd width\x3d"25"\x3e\x26nbsp;\r\n\r\n                    \x3c/td\x3e\r\n                    \x3ctd width\x3d"30"\x3e\r\n                      \x3cA id\x3d"twitterLink" href\x3d"JavaScript:void(0);" title\x3d"${i18n.shareTwitter}" alt\x3d"${i18n.shareTwitter}" target\x3d"_blank"\x3e\x3cspan class\x3d"badge twitterBadge dijitInline"\x3e\x3c/span\x3e\x3c/A\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cA id\x3d"twitterLink2" class\x3d"label" style\x3d"vertical-align:top;" title\x3d"${i18n.shareTwitter}" alt\x3d"${i18n.shareTwitter}" target\x3d"_blank"\x3e${i18n.twitter}\x3c/A\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-url-extent-div" class\x3d"paddingTop5" style\x3d"clear:both;"\x3e\r\n            \x3cinput id\x3d"share-map-url-extent" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true" type\x3d"checkbox" /\x3e\r\n            \x3clabel for\x3d"share-map-url-extent"\x3e\r\n              ${i18n.shareCurrentExtent}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"share-map-advanced-box" class\x3d"paddingTop10" style\x3d"clear:both;"\x3e\r\n          \x3cdiv id\x3d"share-map-advanced-label" style\x3d""\x3e\r\n            \x3clabel style\x3d"font-weight:bold;"\x3e\r\n              ${i18n.embedMap}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"paddingLeading15"\x3e\r\n            \x3cdiv id\x3d"share-map-embed-option" class\x3d"esriFloatLeading" class\x3d"paddingTop10"\x3e\r\n              \x3ccenter\x3e\r\n                \x3cbutton id\x3d"button-share-map-embed" class\x3d"jevent medium" data-dojo-type\x3d"dijit.form.Button" type\x3d"button"\x3e\r\n                  ${i18n.embedInWebsite}\r\n                \x3c/button\x3e\r\n              \x3c/center\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv id\x3d"share-map-makeApp-option" class\x3d"esriFloatLeading" class\x3d"paddingTop10"\x3e\r\n              \x3ccenter\x3e\r\n                \x3cbutton id\x3d"button-share-map-application" class\x3d"jevent medium" data-dojo-type\x3d"dijit.form.Button" type\x3d"button"\x3e\r\n                  ${i18n.makeWebApp}\r\n                \x3c/button\x3e\r\n              \x3c/center\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"share-map-embed" class\x3d"paddingTop10" style\x3d"display:none;clear:both;width:75%;"\x3e\r\n          \x3cdiv\x3e\r\n            \x3clabel id\x3d"share-map-embed-label"\x3e\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cbutton id\x3d"share-map-dialog-close" class\x3d"calcite primary" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.done}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- embed option --\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackEmbed" class\x3d"share-map-stack-stack"\x3e\r\n        \x3cdiv class\x3d"section"\x3e\r\n          \x3cdiv for\x3d"share-map-embed-type" class\x3d"sectionLabel"\x3e${i18n.updates.whatEmbed}\x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-embed-type" class\x3d"lineHeight18"\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"embedType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedType:map" checked\x3d"checked"\r\n                  data-dojo-attach-event\x3d"onClick:onChooseEmbedMap"/\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n              \x3clabel for\x3d"embedType:map"\x3e${i18n.updates.embedMap}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"embedType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedType:presentation"\r\n                  data-dojo-attach-event\x3d"onClick:onChooseEmbedPresentation"/\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n              \x3clabel for\x3d"embedType:presentation" id\x3d"embedType:presentation:label"\x3e${i18n.updates.embedPresentation}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3c!--\x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e--\x3e\r\n              \x3c!--\x3cinput type\x3d"radio" name\x3d"embedType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedType:scene"--\x3e\r\n                  \x3c!--data-dojo-attach-event\x3d"onClick:onChooseEmbedScene"/\x3e--\x3e\r\n            \x3c!--\x3c/div\x3e--\x3e\r\n            \x3c!--\x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e--\x3e\r\n              \x3c!--\x3clabel for\x3d"embedType:scene"\x3e${i18n.updates.embedScene}\x3c/label\x3e--\x3e\r\n            \x3c!--\x3c/div\x3e--\x3e\r\n          \x3c/div\x3e\r\n          \x3cbr style\x3d"clear:both;"/\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"section"\x3e\r\n          \x3cdiv class\x3d"sectionLabel adjustedHeight"\x3e\r\n            \x3cdiv id\x3d"embed-type-label" class\x3d"inline valignTop"\x3e${i18n.updates.chooseEmbed}\x3c/div\x3e\r\n            \x3cdiv id\x3d"mapSize-help" class\x3d"inline"\x3e\x3c/div\x3e\x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-mapsize" class\x3d"lineHeight18"\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n              \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n                \x3clabel for\x3d"mapSize:custom:width"\x3e${i18n.updates.width}\x26nbsp;\x3c/label\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                \x3cdiv id\x3d"mapSize:custom:width" class\x3d"paddedInput" data-dojo-type\x3d"dijit.form.TextBox" style\x3d"width:35px;" value\x3d"500"\x3e\x3c/div\x3e\r\n              \x3c/td\x3e\r\n                \x3ctd\x3e\x3cspan\x3e\x26nbsp;${i18n.updates.by}\x26nbsp;\x3c/span\x3e\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3clabel for\x3d"mapSize:custom:height"\x3e${i18n.updates.height}\x26nbsp;\x3c/label\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  \x3cdiv id\x3d"mapSize:custom:height" class\x3d"paddedInput" data-dojo-type\x3d"dijit.form.TextBox" style\x3d"width:35px;" value\x3d"400"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1 padTopHalfEm"\x3e\r\n              \x3cinput type\x3d"checkbox" id\x3d"mapSize:responsive" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true"\x3e\r\n              \x3clabel for\x3d"mapSize:responsive"\x3e${i18n.updates.allowResponsive}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cbr style\x3d"clear:both;"/\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"section"\x3e\r\n          \x3cdiv for\x3d"share-map-embed-text" class\x3d"esriFloatLeading sectionLabel"\x3e${i18n.copyPaste}\x3c/div\x3e\r\n          \x3cbr style\x3d"clear:both;"/\x3e\r\n          \x3cdiv id\x3d"share-map-embed-text" dir\x3d"ltr" data-dojo-type\x3d"dijit.form.Textarea" style\x3d"width:98%;height:18px;max-height:18px;"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"mapOptionsContainer"\x3e\r\n          \x3cdiv id\x3d"embedTabs" class\x3d"embedTabs"\x3e\r\n            \x3ca id\x3d"advOptionsTab" class\x3d"selected" href\x3d"JavaScript:void(0);"\x3e${i18n.updates.advancedOpt}\x3c/a\x3e\r\n            \x3ca id\x3d"addMarkerTab" href\x3d"JavaScript:void(0);"\x3e${i18n.updates.addMarkerSym}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv id\x3d"advancedOptionsTab" class\x3d"fixedHeightContainer"\x3e\r\n            \x3cdiv class\x3d"sectionLabel paddingTop5"\x3e${i18n.updates.chooseOptions}\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading sectionCol"\x3e\r\n              \x3cdiv id\x3d"share-map-zoom"\x3e\r\n                \x3cinput id\x3d"share-map-embed-zoom" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-zoom" id\x3d"share-map-embed-zoom-label"\x3e\r\n                  ${i18n.updates.zoomControl}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-home" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-home" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-home" id\x3d"share-map-embed-home-label"\x3e\r\n                  ${i18n.updates.homeButton}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-basemap" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-basemap" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox"\r\n                    data-dojo-attach-event\x3d"onClick:onBasemapSelectorClicked"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-basemap" id\x3d"share-map-embed-basemap-label"\x3e\r\n                  ${i18n.updates.basemapSelector}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-basemap-options" class\x3d"paddingLeading15" style\x3d"display:none;"\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading paddingTop10" style\x3d"width:20px;"\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"basemapType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"basemapType:gallery" checked\x3d"checked"\r\n                      data-dojo-attach-event\x3d"onChange:onBasemapTypeChanged"/\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading paddingTop10" style\x3d"width:105px;"\x3e\r\n                  \x3clabel for\x3d"basemapType:gallery"\x3e${i18n.updates.basemapGallery}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr style\x3d"clear:both;"/\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading paddingTop10" style\x3d"width:20px;"\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"basemapType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"basemapType:toggle"\r\n                         data-dojo-attach-event\x3d"onChange:onBasemapTypeChanged"/\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading paddingTop10" style\x3d"width:105px;"\x3e\r\n                  \x3clabel for\x3d"basemapType:toggle"\x3e${i18n.updates.basemapToggle}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr style\x3d"clear:both"/\x3e\r\n                \x3cdiv id\x3d"share-map-second-basemap" class\x3d"paddingTop10" style\x3d"display:none;"\x3e\r\n                  \x3cspan\x3e${i18n.updates.chooseAltBasemap}\x3c/span\x3e\x3cbr/\x3e\r\n                  \x3cselect name\x3d"secondBasemap" id\x3d"basemap:secondBasemap" style\x3d"width:120px;"\r\n                          data-dojo-type\x3d"arcgisonline.sharing.dijit.ComboBox"\r\n                          data-dojo-attach-event\x3d"onChange:onSecondBasemapChange"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-largemap" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-largemap" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-largemap" id\x3d"share-map-embed-largemap-label"\x3e\r\n                  ${i18n.viewLargerMap}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-disablezoom" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-disablezoom" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-disablezoom" id\x3d"share-map-embed-disablezoom-label"\x3e\r\n                  ${i18n.updates.disableZoom}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading paddingLeading40 sectionCol"\x3e\r\n              \x3cdiv id\x3d"share-map-scale"\x3e\r\n                \x3cinput id\x3d"share-map-embed-scale" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-scale" id\x3d"share-map-embed-scale-label"\x3e\r\n                  ${i18n.updates.scaleBar}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-location" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-location" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-location" id\x3d"share-map-embed-location-label"\x3e\r\n                  ${i18n.updates.geocoder}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-location-restrict" class\x3d"paddingTop10 paddingLeading15" style\x3d"display:none;"\x3e\r\n                \x3cinput id\x3d"share-map-embed-location-restrict" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-location-restrict" id\x3d"share-map-embed-location-restrict-label"\x3e\r\n                  ${i18n.updates.currentExtent}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-description" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-description" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox"\r\n                       data-dojo-attach-event\x3d"onClick:onShareMapActivePanelCheck"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-description" id\x3d"share-map-embed-description-label"\x3e\r\n                  ${i18n.updates.mapDetails}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-legend" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-legend" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox"\r\n                       data-dojo-attach-event\x3d"onClick:onShareMapActivePanelCheck"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-legend" id\x3d"share-map-embed-legend-label"\x3e\r\n                  ${i18n.updates.legend}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-active-panel" class\x3d"paddingTop10" style\x3d"display:none;"\x3e\r\n                \x3cspan\x3e${i18n.updates.choosePanel}\x3c/span\x3e\x3cbr/\x3e\r\n                \x3cselect name\x3d"activePanel" id\x3d"activePanel" style\x3d"width:120px;"\r\n                        data-dojo-type\x3d"arcgisonline.sharing.dijit.ComboBox"\r\n                        data-dojo-attach-event\x3d"onChange:onShareMapActivePanelChange"\x3e\r\n                  \x3coption value\x3d"details"\x3e${i18n.updates.mapDetails}\x3c/option\x3e\r\n                  \x3coption value\x3d"legend"\x3e${i18n.updates.legend}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n              \x3c/div\x3e\r\n              \x3c!--\x3cdiv id\x3d"share-map-presentation" class\x3d"paddingTop5"\x3e--\x3e\r\n                \x3c!--\x3cinput id\x3d"share-map-embed-presentation" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true" value\x3d"off" type\x3d"checkbox" /\x3e--\x3e\r\n                \x3c!--\x3clabel for\x3d"share-map-embed-presentation"\x3e--\x3e\r\n                  \x3c!--${i18n.embedPresentation}--\x3e\r\n                \x3c!--\x3c/label\x3e--\x3e\r\n              \x3c!--\x3c/div\x3e--\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatTrailing paddingTrailing40"\x3e\r\n              \x3c!--for map preview--\x3e\r\n              \x3clabel for\x3d"mapPreview"\x3e${i18n.updates.mapPreview}\x3c/label\x3e\x3cbr/\x3e\r\n              \x3cdiv id\x3d"mapPreview" class\x3d"imageStack"\x3e\r\n                \x3cdiv id\x3d"mapPreview:basemap" class\x3d"imageLayer previewBasemap" style\x3d"z-index:50"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:panel" class\x3d"imageLayer previewPanel" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:details" class\x3d"imageLayer previewDetails" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:legend" class\x3d"imageLayer previewLegend" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:gallery" class\x3d"imageLayer previewGallery" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:toggle" class\x3d"imageLayer previewToggle" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:zoom" class\x3d"imageLayer previewZoom" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:zoomhome" class\x3d"imageLayer previewZoomHome" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:search" class\x3d"imageLayer previewSearch" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:scale" class\x3d"imageLayer previewScale" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e${i18n.updates.selectTheme}\x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-theme" class\x3d"lineHeight18"\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"embedTheme" checked\x3d"checked" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedTheme:light"\r\n                         data-dojo-attach-event\x3d"onChange:onThemeChange"/\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n                  \x3cdiv class\x3d"themeSwatch light"\x3e\x26nbsp;\x3c/div\x3e\r\n                  \x3clabel for\x3d"embedTheme:light"\x3e${i18n.updates.lightTheme}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"embedTheme" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedTheme:dark"\r\n                         data-dojo-attach-event\x3d"onChange:onThemeChange"/\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n                  \x3cdiv class\x3d"themeSwatch darkTheme"\x3e\x26nbsp;\x3c/div\x3e\r\n                  \x3clabel for\x3d"embedTheme:dark"\x3e${i18n.updates.darkTheme}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cbr style\x3d"clear:both;"/\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv id\x3d"addMarkerSymbolTab" class\x3d"fixedHeightContainer" style\x3d"display:none;"\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e${i18n.updates.selectLocation}\x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n                \x3cinput type\x3d"radio" name\x3d"markerLocation" id\x3d"marker:search" checked\x3d"checked"\r\n                       data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-event\x3d"onChange:onMarkerLocationTypeChange"/\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n                \x3clabel for\x3d"marker:search"\x3e${i18n.updates.locationSearch}\x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n                \x3cinput type\x3d"radio" name\x3d"markerLocation" id\x3d"marker:latlong" data-dojo-type\x3d"dijit.form.RadioButton"\r\n                       data-dojo-attach-event\x3d"onChange:onMarkerLocationTypeChange"/\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:115px;"\x3e\r\n                \x3clabel for\x3d"marker:latlong"\x3e${i18n.updates.locationLatLng}\x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cbr style\x3d"clear:both;"/\x3e\r\n              \x3cdiv id\x3d"marker:search:input" class\x3d"sectionNoBorder"\x3e\r\n                \x3cdiv id\x3d"marker:geocoder" style\x3d"position:relative;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"marker:latlong:input" class\x3d"sectionNoBorder" style\x3d"display:none;"\x3e\r\n                \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                  \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd\x3e\x3clabel for\x3d"latitude:y"\x3e${i18n.updates.latitudeY}\x3c/label\x3e\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                    \x3ctd\x3e\x3clabel\x3e${i18n.updates.longitudeX}\x3c/label\x3e\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd\x3e\x3cinput id\x3d"latitude:y" class\x3d"paddedInput" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                    \x3ctd\x3e\x3cinput id\x3d"longitude:x" class\x3d"paddedInput" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cbutton id\x3d"setLocation" type\x3d"button" class\x3d"calcite light small" data-dojo-type\x3d"dijit.form.Button"\r\n                              data-dojo-attach-event\x3d"onClick:onSetLocationClick"\x3e\r\n                        ${i18n.updates.setLocation}\r\n                      \x3c/button\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e\x3clabel for\x3d"marker-symbol-title"\x3e${i18n.updates.markerTitle}\x3c/label\x3e\x3c/div\x3e\r\n              \x3cinput type\x3d"text" id\x3d"marker-symbol-title" class\x3d"paddedInput" style\x3d"width:550px;" data-dojo-type\x3d"dijit.form.TextBox"\r\n                     data-dojo-props\x3d"trim:true" data-dojo-attach-event\x3d"onChange:onMarkerSymbolTitleChange,onKeyDown:onMarkerSymbolTitleKeyDown"/\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e${i18n.updates.markerDescription}\x3c/div\x3e\r\n              \x3cdiv id\x3d"marker-symbol-desc" data-dojo-type\x3d"dijit.form.Textarea"\r\n                   class\x3d"paddedInput"\r\n                   style\x3d"width:561px;height:40px;min-height:40px;max-height:40px;"\r\n                   data-dojo-attach-event\x3d"onChange:onMarkerSymbolDescChange"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e\x3clabel for\x3d"marker-symbol-url"\x3e${i18n.updates.markerUrl}\x3c/label\x3e\x3c/div\x3e\r\n              \x3cinput type\x3d"text" id\x3d"marker-symbol-url" class\x3d"paddedInput" style\x3d"width:550px;" data-dojo-type\x3d"dijit.form.TextBox"\r\n                     data-dojo-props\x3d"trim:true" data-dojo-attach-event\x3d"onChange:onMarkerSymbolUrlChange,onKeyDown:onMarkerSymbolUrlKeyDown"/\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!--\x3cdiv class\x3d"esriPositionRight0" style\x3d"position:absolute;bottom:5px;"\x3e--\x3e\r\n        \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n          \x3cbutton id\x3d"share-map-embed-back" class\x3d"calcite default" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\r\n              data-dojo-attach-event\x3d"onClick:onShareMapEmbedBack"\x3e\r\n            ${i18n.back}\r\n          \x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite primary" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onEmbedClose"\x3e\r\n            ${i18n.done}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- application option gallery  --\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackApplicationGallery" class\x3d"share-map-stack-stack"\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3clabel style\x3d"font-weight:bold; text-decoration:underline; "\x3e--\x3e\r\n            \x3c!--${i18n.makeWebApp}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n\r\n        \x3c!--\x3cdiv style\x3d"padding-bottom:15px;padding-top:0;"\x3e--\x3e\r\n          \x3c!--\x3clabel\x3e--\x3e\r\n            \x3c!--${i18n.selectTemplate}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3c!--\x3cdiv id\x3d"share-map-application-gallery-box" style\x3d"border:#333 1px solid; width:auto; min-height:325px; padding:0; overflow:hidden;"\x3e--\x3e\r\n          \x3c!--\x3cdiv style\x3d"position:relative; width:565px;" id\x3d"templatesGallery" jsId\x3d"gallery" data-dojo-type\x3d"arcgisonline.sharing.dijit.TemplatesGrid" sortField\x3d"\'title\'" groupQuery\x3d"esriGeowConfig.templatesGroupQuery" galleryNodes\x3d"8"\x3e--\x3e\r\n          \x3c!--\x3c/div\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cdiv id\x3d"gallery-grid"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cbutton id\x3d"share-map-application-back" class\x3d"calcite default" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\r\n              data-dojo-attach-event\x3d"onClick:onShareMapApplicationBack"\x3e\r\n            ${i18n.back}\r\n          \x3c/button\x3e\r\n            \x3c!--\x3cbutton id\x3d"share-map-application-next" class\x3d"calcite primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"--\x3e\r\n                    \x3c!--data-dojo-attach-event\x3d"onClick:onShareMapApplicationNext"\x3e--\x3e\r\n                \x3c!--${i18n.next}--\x3e\r\n            \x3c!--\x3c/button\x3e--\x3e\r\n          \x3cbutton class\x3d"calcite cancel" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.cancel}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- application option publish  --\x3e\r\n      \x3cdiv id\x3d"share-map-application-publish" data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackApplicationPublish" class\x3d"share-map-stack-stack"\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3clabel style\x3d"font-weight:bold; text-decoration:underline; "\x3e--\x3e\r\n            \x3c!--${i18n.makeWebApp}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cp class\x3d"configureApp"\x3e${i18n.savePublish}\x3c/p\x3e\r\n        \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${i18n.appBuilderMsg}\x3c/p\x3e\r\n        \x3cdiv\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_itemProperties"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"share-map-same-level" style\x3d"margin-left:22.5%;"\x3e\r\n            \x3cdiv id\x3d"publish-webmap-sharing" data-dojo-type\x3d"dijit.form.CheckBox" data-dojo-attach-point\x3d"_shareSameLevel"\x3e\x3c/div\x3e\r\n            \x3clabel id\x3d"publish-webmap-sharing-label" for\x3d"publish-webmap-sharing"\x3e${i18n.shareSameLevel}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cspan id\x3d"publish-webmap-waiting" style\x3d"display:none;"\x3e${i18n.savingAndPublishing}\x26nbsp;\x26nbsp;\x26nbsp;\x3c/span\x3e\r\n          \x3cbutton id\x3d"share-map-application-publish-config-back" class\x3d"calcite default" type\x3d"button"\r\n                  data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onShareMapApplicationPublishConfigBack"\x3e\r\n            ${i18n.back}\r\n          \x3c/button\x3e\r\n          \x3cbutton id\x3d"publish-webmap-button" class\x3d"calcite primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.savePublishBtn}\r\n          \x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite cancel" type\x3d"button" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.cancel}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- configure application help --\x3e\r\n      \x3cdiv id\x3d"share-map-application-publish-help" data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackApplicationPublishHelp" class\x3d"share-map-stack-stack"\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3clabel style\x3d"font-weight:bold; text-decoration:underline; "\x3e--\x3e\r\n            \x3c!--${i18n.makeWebApp}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cp\x3e\r\n          ${i18n.publishSuccess}\r\n        \x3c/p\x3e\r\n        \x3cp\x3e\r\n          \x3cb\x3e${i18n.shareApp}\x3c/b\x3e - ${i18n.shareInstructions}\r\n        \x3c/p\x3e\r\n        \x3cp\x3e\r\n          \x3cb\x3e${i18n.configureApp}\x3c/b\x3e - ${i18n.configureInstructions}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"esriItemLinks"\x3e\r\n          ${i18n.youCan} \x3ca id\x3d"_shareApplicationPublishAppUrl" href\x3d"JavaScript:void(0);"\x3e${i18n.goToItem}\x3c/a\x3e\r\n          ${i18n.toShare}\r\n        \x3c/p\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cbutton id\x3d"publish-webmap-view-item-button" class\x3d"jevent calcite primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.viewItemButton}\r\n          \x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite primary" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.done}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- application option help  --\x3e\r\n      \x3cdiv id\x3d"share-map-application-help" data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackApplicationHelp" class\x3d"share-map-stack-stack"\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3clabel style\x3d"font-weight:bold; text-decoration:underline; "\x3e--\x3e\r\n            \x3c!--${i18n.makeWebApp}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cdiv style\x3d"padding-top:15px;"\x3e\r\n          \x3clabel\x3e\r\n            ${i18n.followSteps}\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"padding-top:0;"\x3e\r\n          \x3cul\x3e\r\n            \x3cli\x3e\r\n              \x3cspan style\x3d"font-weight:bold;"\x3e${i18n.unzipFile}\x3c/span\x3e\r\n              \x3cdiv\x3e\r\n                ${i18n.unzipFileInstructions}\r\n              \x3c/div\x3e\r\n            \x3c/li\x3e\r\n            \x3cli style\x3d"margin-top:10px;"\x3e\r\n              \x3cspan style\x3d"font-weight:bold;"\x3e${i18n.deployTheApp}\x3c/span\x3e\r\n              \x3cdiv\x3e\r\n                ${i18n.copyAppToWeb}\r\n              \x3c/div\x3e\r\n            \x3c/li\x3e\r\n            \x3cli style\x3d"margin-top:10px;"\x3e\r\n              \x3cspan style\x3d"font-weight:bold;"\x3e${i18n.configureTheApp}\x3c/span\x3e\r\n              \x3cdiv\x3e\r\n                ${i18n.makeAppChanges}\r\n              \x3c/div\x3e\r\n            \x3c/li\x3e\r\n          \x3c/ul\x3e\r\n          \x3cdiv class\x3d"paddingTop10"\x3e\r\n            \x3cspan\x3e${i18n.yourMapId} \x3c/span\x3e\r\n            \x3cspan id\x3d"share-map-webmapId"\x3e${i18n.yourMapId} \x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-text-findId" class\x3d"paddingTop10"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cbutton id\x3d"share-map-application-help-back" class\x3d"calcite default" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\r\n              data-dojo-attach-event\x3d"onClick:onShareMapApplicationHelpBack"\x3e\r\n            ${i18n.back}\r\n          \x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.done}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
baseClass:"esriShareMapDlg",content:arcgisonline.sharing.geow.Content,community:arcgisonline.sharing.geow.Community,createItemUtil:arcgisonline.sharing.dijit.dialog._CreateItemUtilMixin,init:!1,webMapId:"",viewerUrl:null,embedMapUrl:null,basicViewerUrl:null,presentationUrl:null,hasBing:null,folderId:null,sharingInfo:null,size:"medium",webmapTitle:"",webMapOwner:"",gcsExtStr:"",shortenedUrl:null,_isPublishing:!1,defaultTextTitle:null,defaultTextTags:null,defaultTextSummary:null,waitHandler:null,publishWebmapViewItemButtonHandler:null,
homeViewerPath:"/home/webmap/viewer.html",embedAppPath:"/apps/Embed/index.html",statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.ShareMapDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=a.mixin({},a.i18n.getLocalization("arcgisonline","arcgisonline").common);a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline","arcgisonline").saveWebMapDlg);a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline",
"arcgisonline").shareMapDlg);this.i18n.shareOptions=a.i18n.getLocalization("arcgisonline","arcgisonline").shareOptions;this.i18n.shareErrors=a.i18n.getLocalization("arcgisonline","arcgisonline").addItemFrm.errors;this.i18n.browseItemsDlg=a.i18n.getLocalization("arcgisonline","arcgisonline").browseItemsDlg;this.defaultTextTitle=this.i18n.enterMapTitle;this.defaultTextTags=this.i18n.separateTags;this.defaultTextSummary=this.i18n.enterSummary},postCreate:function(){this.init||(a.byId("share-map-text-not-public-note").innerHTML=
esri.substitute({portalName:this._getPortalName()},this.i18n.shareMapNotPublic),a.byId("share-map-text-findId").innerHTML=esri.substitute({portalName:this._getPortalName()},this.i18n.findId),this.loadConnections(),this.init=!0,this._stackContainer.selectChild(this._stackEmbed),a.byId("share-groups-check-label").innerHTML=this.i18n.shareGroupsLabel,a.byId("appBuilderTab").innerHTML="Web AppBuilder",this._showGalleryTabs(!0),this._setupBasemapSelector(),this._setupMapPreview(),this._setupEmbedHelp(),
this._setupItemPropertiesDlg())},_setupBasemapSelector:function(){this._topoTitle="";this._basemaps=[];for(var b in esri.basemaps)esri.basemaps.hasOwnProperty(b)&&("topo"===b&&(this._topoTitle=esri.basemaps[b].title),this._basemaps.push({id:b,name:esri.basemaps[b].title}));c.byId("basemap:secondBasemap").set("store",new a.store.Memory({data:this._basemaps}));c.byId("basemap:secondBasemap").set("value",this._topoTitle)},_setupEmbedHelp:function(){a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/css/images/info.png")},
a.byId("mapSize-help"));this._embedHelpTooltip=new c.Tooltip({label:'\x3cdiv style\x3d"max-width:300px;"\x3e'+("\x3cp\x3e"+this.i18n.updates.setDimensions+"\x3c/p\x3e\x3cp\x3e"+this.i18n.updates.commonSizes+"\x3c/p\x3e\x3cp\x3e"+this.i18n.updates.smallSize+"\x3cbr\x3e"+this.i18n.updates.mediumSize+"\x3cbr\x3e"+this.i18n.updates.largeSize+"\x3c/p\x3e")+"\x3c/div\x3e",connectId:["mapSize-help"],id:"tooltip_mapSize-help",showDelay:200})},_setupMapPreview:function(){a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_background.png")},
a.byId("mapPreview:basemap"));a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_left-panel.png")},a.byId("mapPreview:panel"));a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_map-details-active.png")},a.byId("mapPreview:details"));a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_legend-active.png")},
a.byId("mapPreview:legend"));a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_basemap-gallery.png")},a.byId("mapPreview:gallery"));a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_basemap-toggle.png")},a.byId("mapPreview:toggle"));a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_zoom.png")},
a.byId("mapPreview:zoom"));a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_zoom-and-home.png")},a.byId("mapPreview:zoomhome"));a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_scale.png")},a.byId("mapPreview:scale"));a.create("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_search-field.png")},
a.byId("mapPreview:search"))},_setupGeocoder:function(){if(!this._geocoder){var b=arcgisonline.map.geocode.createSearchOptions();b.map=null;b.showInfoWindowOnSelect=!1;this._geocoder=new esri.dijit.Search(b,a.create("div",{id:"embedSearch"},a.byId("marker:geocoder")));this._geocoder.startup();this._geocoder.on("select-result",a.hitch(this,this.onSearchResult))}},_setupItemPropertiesDlg:function(){this._itemPropDlg||this.getUserItemTitles(a.hitch(this,function(){this._itemPropDlg=new arcgisonline.sharing.dijit.dialog.ItemPropertiesDlg({typeInfo:"configapp",
existingItems:this.allItemNames,showFolders:!0,showFile:!1,item:a.mixin({},this._webAppItemCard)},a.create("div",{},this._itemProperties));this._itemPropDlg.startup();this._webAppItemCard&&(this._itemPropDlg.set("summary",this._webAppItemCard.snippet),this._itemPropDlg.set("title",this._webAppItemCard.title),this._itemPropDlg.set("tags",this._webAppItemCard.tags||[]))}))},destroy:function(){this.inherited(arguments);this._lastPane=this._configureSettings=this._appBuilderSettings=this._folders=null;
this._embedHelpTooltip&&this._embedHelpTooltip.destroy();this._itemPropDlg&&(this._itemPropDlg.destroy(),this._itemPropDlg=null)},getUserFolders:function(b){var c=this._user||(this._user=arcgisonline.sharing.util.getUser());(null===c||this._folders)&&b();arcgisonline.sharing.geow.Folder.getFolders(a.hitch(this,function(d){var l=c.email;if(a.cookie("ESRI_Content")){var g=arcgisonline.sharing.util.getCookie("ESRI_Content");g.folderId&&(l=g.folderId||c.email)}d=this._folders=d.folders;g=[{label:c.email,
value:c.email}];g=g.concat(a.map(d,a.hitch(this,function(a){return{label:a.title,value:a.id}})));this._selectedFolderId=l;this.getUserItemTitles(b)}),a.hitch(this,function(a){this.showError({title:this.i18n.errorTitle,message:esri.substitute({message:a.message},this.i18n.searchFoldersFailed)});b()}))},getUserItemTitles:function(b){var c=arcgisonline.sharing.util.getUser();null!=c&&arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+'search?num\x3d100\x26q\x3d%2Btype:"Web Mapping Application"%20%2Bitemtype:text%20%2Bowner:'+
c.email,a.hitch(this,function(c){this.allItemNames=a.map(c.results,a.hitch(this,function(a){return a}));b()}),a.hitch(this,function(a){this.showError({title:this.i18n.errorTitle,message:esri.substitute({message:a.message},this.i18n.searchMapsFailed)});b()}))},loadConnections:function(){a.query(".jevent").connect("onclick",function(a){a.preventDefault()});a.query("#button-share-map-embed").connect("onclick",a.hitch(this,function(){c.byId("button-share-map-embed").get("disabled")||(c.byId("share-map-dialog").set("title",
this.i18n.embedInWebsite),this._stackContainer.selectChild(this._stackEmbed),this._copiedData=!1)}));a.query("#button-share-map-application").connect("onclick",a.hitch(this,function(){if(!c.byId("button-share-map-application").get("disabled")){c.byId("share-map-dialog").set("title",this.i18n.makeNewWebApp);this._showGalleryTabs(!0);this._changeTab();var a=c.byId("templatesGallery");a&&a._groupDoesntExist&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.notice,
message:this.i18n.groupDoesntExist})}}));a.connect(this._stackApplicationGallery,"onShow",a.hitch(this,function(){this._browseItemsDlg||(this._browseItemsDlg=new arcgisonline.sharing.dijit.dialog.BrowseItemsDlg({plugin:"arcgisonline/sharing/dijit/dialog/PluginConfigurableAppsViewer",messageLeft:this.i18n.browseItemsDlg.instructionsLeft,messageRight:this.i18n.browseItemsDlg.instructionsRight,"class":"esriBrowseItemsDlg"},a.create("div",{},a.byId("gallery-grid"))),this._browseItemsDlg.startup(),this._browseItemstopicHandle=
a.topic.subscribe("/esri/browseitems/close",a.hitch(this,function(a,c){if("create-app"===a)this.onShareMapApplicationNext();else if("preview-app"===a)this.onPreviewApp(c);else"download-app"===a&&arcgisonline.sharing.util.downloadWebMappingApp(c)})))}));a.connect(this._stackAllOptions,"onShow",a.hitch(this,function(){this._showGalleryTabs(!1)}));a.connect(this._stackApplicationPublish,"onShow",a.hitch(this,function(){if(!this._user){arcgisonline.map.storage.saveMapInCookie(null,!0);var a=arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.baseUrl);
window.location=a+"signin.html?returnUrl\x3d"+encodeURIComponent(window.location)+"%26showPublish\x26error\x3d403"}}));a.connect(c.byId("publish-webmap-button"),"onClick",this,"publishWebMap");a.connect(a.byId("configurableTab"),"onclick",a.hitch(this,"_changeTab"));a.connect(a.byId("appBuilderTab"),"onclick",a.hitch(this,"_changeTab"));a.connect(a.byId("advOptionsTab"),"onclick",a.hitch(this,"_changeEmbedTab"));a.connect(a.byId("addMarkerTab"),"onclick",a.hitch(this,"_changeEmbedTab"));a.mixin(c.byId("share-map-dialog"),
{onCancel:a.hitch(this,function(){this.hide()})});a.connect(a.byId("share-map-url"),"onkeypress",this,"doNothing");a.connect(a.byId("share-map-embed-text"),"onkeydown",this,"listenForCopy");a.connect(a.byId("share-map-embed-text"),"onclick",this,"toggleSelect");a.connect(a.byId("linkType:presentation"),"onclick",a.hitch(this,"updateLinkType","presentation"));a.connect(a.byId("linkType:map"),"onclick",a.hitch(this,"updateLinkType","map"));a.connect(a.byId("share-map-url-extent"),"onclick",a.hitch(this,
"updateMapUrlExtent"));a.connect(a.byId("share-map-embed-zoom"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("share-map-embed-home"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("share-map-embed-scale"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("share-map-embed-legend"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("share-map-embed-description"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("share-map-embed-location"),"onclick",
a.hitch(this,"updateLocation"));a.connect(a.byId("share-map-embed-location-restrict"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("share-map-embed-basemap"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("share-map-embed-largemap"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("share-map-embed-disablezoom"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("mapSize:responsive"),"onclick",a.hitch(this,"updateEmbedHTML"));a.connect(a.byId("mapSize:custom:width"),
"onkeyup",a.hitch(this,"updateMapSize","custom"));a.connect(a.byId("mapSize:custom:height"),"onkeyup",a.hitch(this,"updateMapSize","custom"));a.connect(a.byId("mapSize:responsive"),"click",a.hitch(this,"updateMapSize","custom"));a.subscribe("onShareUpdate",a.hitch(this,function(){this.disable(!1);this.shortenedUrl=null;this.checkUpdatedSharingStatus()}));arcgisonline.map.role.isAllowed("share_makeWebApp")||a.style(a.byId("share-map-makeApp-option"),"display","none");a.subscribe("onClickEveryone",
a.hitch(this,function(a){if(c.byId("share-everyone-check").get("checked")&&this._isPrivateOrg){var e={title:this.i18n.share,message:'\x3cp class\x3d"esriItemLinks"\x3e'+esri.substitute({url:'\x3ca href\x3d"'+(this.helpBase+this.helpMap["120000455"])+'" target\x3d"_blank" \x3e'+this.i18n.shareHelpLinkText+"\x3c/a\x3e"},this.i18n.shareWithEveryoneMessage)+"\x3c/p\x3e"};this.showError(e)}this.shareWait(a)}));a.subscribe("onClickAccount",a.hitch(this,function(a){this.shareWait(a)}));a.subscribe("onClickGroup",
a.hitch(this,function(a){this.shareWait(a)}))},onPreviewApp:function(a){var c=void 0!==esriGeowConfig.isMultiTenant&&null!==esriGeowConfig.isMultiTenant&&!1===esriGeowConfig.isMultiTenant,d=a.url,d=0===d.indexOf("http")||0===d.indexOf("//")?d:window.location.protocol+"//"+window.location.host+d;this.currentUser&&!this.currentUser.accountId?d=c?this._getPortalPreviewUrl(a,d):d.replace("/hosted/","/apps/"):c&&(d=this._getPortalPreviewUrl(a,d));arcgisonline.map.mapUtil.previewTemplate(d,a.id)},downloadWebMappingApp:function(b){var e=
"Mobile Application"!==b.type?"WMA2Code":"MobileApp2Code",d=esriGeowConfig.restBaseUrl+"content/items/"+b.id+"/relatedItems",e=b.relatedItems||arcgisonline.sharing.util.request({url:d,content:{relationshipType:e}}).then(a.hitch(this,function(a){b.relatedItems=a&&a.relatedItems||[];return b.relatedItems}));return a.when(e,a.hitch(this,function(b){var e=b||[],d=a.filter(e,function(a){return a&&null!==a.url});b=d&&d.length?d[0]:e&&0<e.length?e[0]:b;if(b.id)var p=b.url||arcgisonline.sharing.util.getItemDataPath(b);
b.url?window.open(p):window.location=p;c.byId("share-map-stack")&&c.byId("share-map-stack").selectChild(c.byId("share-map-application-help"))}),a.hitch(this,function(a){console.log(a)}))},onBasemapSelectorClicked:function(b){c.byId("share-map-embed-basemap").get("checked")?esri.show(a.byId("share-map-basemap-options")):esri.hide(a.byId("share-map-basemap-options"));this.updateMapSize(this.size)},onBasemapTypeChanged:function(b){c.byId("basemapType:gallery").get("checked")?esri.hide(a.byId("share-map-second-basemap")):
esri.show(a.byId("share-map-second-basemap"));this.updateMapSize(this.size)},onSecondBasemapChange:function(a){this.updateMapSize(this.size)},onThemeChange:function(a){this.updateMapSize(this.size)},onShareMapActivePanelCheck:function(b){c.byId("share-map-embed-legend").get("checked")&&c.byId("share-map-embed-description").get("checked")?esri.show(a.byId("share-map-active-panel")):esri.hide(a.byId("share-map-active-panel"));this.updateMapSize(this.size)},onShareMapActivePanelChange:function(a){this.updateMapSize(this.size)},
onMarkerSymbolTitleChange:function(a){this.updateMapSize(this.size)},onMarkerSymbolTitleKeyDown:function(b){b.keyCode==a.keys.ENTER&&(a.stopEvent(b),this.updateMapSize(this.size))},onMarkerSymbolUrlChange:function(a){this.updateMapSize(this.size)},onMarkerSymbolUrlKeyDown:function(b){b.keyCode==a.keys.ENTER&&(a.stopEvent(b),this.updateMapSize(this.size))},onMarkerSymbolDescChange:function(a){this.updateMapSize(this.size)},onMarkerLocationTypeChange:function(b){c.byId("marker:search").get("checked")?
(esri.hide(a.byId("marker:latlong:input")),esri.show(a.byId("marker:search:input"))):(esri.hide(a.byId("marker:search:input")),esri.show(a.byId("marker:latlong:input")));this.updateMapSize(this.size)},onSearchResult:function(b){b.result&&(b=b.result.feature.geometry,b="polygon"===b.type?b.getCentroid():"polyline"===b.type?b.getPoint(0,0):"multipoint"===b.type?b.getPoint(0):b,c.byId("latitude:y").set("value",a.number.format(Math.round(1E3*b.y)/1E3,this.numberPattern)),c.byId("longitude:x").set("value",
a.number.format(Math.round(1E3*b.x)/1E3,this.numberPattern)),c.byId("marker:latlong").set("checked",!0),this.updateMapSize(this.size),this._geocoder.clear())},onSetLocationClick:function(a){this.updateMapSize(this.size)},onShareMapEmbedBack:function(a){a.preventDefault();c.byId("share-map-dialog").set("title",this.i18n.share);this._stackContainer.selectChild(this._stackAllOptions)},onShareMapApplicationBack:function(a){a.preventDefault();c.byId("share-map-dialog").set("title",this.i18n.share);this._stackContainer.selectChild(this._stackAllOptions)},
onShareMapApplicationNext:function(b){b&&b.preventDefault();this._selectedTemplate=this._browseItemsDlg.get("selection");this.content.getItemData(this._selectedTemplate.id,a.hitch(this,function(a){this._showGalleryTabs(!1);this._selectedTemplate.data=a;this._stackContainer.selectChild(this._stackApplicationPublish)}))},onShareMapApplicationPublishConfigBack:function(a){a.preventDefault();this._isPublishing||("configurableTab"===this._selectedTab?(this._stackContainer.back(),this._showGalleryTabs(!0)):
this._stackContainer.selectChild(this._stackAllOptions))},onShareMapApplicationHelpBack:function(a){a.preventDefault();this._stackContainer.selectChild(this._stackApplicationGallery)},disable:function(b){this.currentUser&&!this.currentUser.accountId&&(a.forEach(c.registry.findWidgets(this._stackAllOptions.domNode),function(a){a.set("disabled",b)}),a.query("input").forEach(function(c){a.attr(c,"disabled",b)}))},shareWait:function(b){this.disable(!0);this.waitHandler&&clearTimeout(this.waitHandler);
this.waitHandler=setTimeout(a.hitch(this,function(){this.waitHandler=null;this.shareOptions.share(b)}),2E3)},checkUpdatedSharingStatus:function(){if(!this.currentUser||this.webMapOwner==this.currentUser.email||this.isAdmin)this.shareOptions.isEveryoneChecked()?this.sharingInfo={access:"public"}:this.shareOptions.isAccountChecked()?this.sharingInfo={access:"org"}:this.shareOptions.isGroupChecked()?this.sharingInfo={access:"shared"}:this.sharingInfo={access:"private"},this._webAppItemCard.access=this.sharingInfo.access,
"private"==this.sharingInfo.access?a.byId("share-map-text-public-note").innerHTML=this.i18n.mapPrivate:a.byId("share-map-text-public-note").innerHTML=this.i18n.mapShared+"\x3cbr/\x3e\x26nbsp;",this.updateDlgComponents(!0),(this.currentUser&&!this.currentUser.accountId&&this.shareOptions.isEveryoneChecked()||this.currentUser&&this.currentUser.accountId)&&arcgisonline.sharing.utilShare.checkWebMapContent({webMapId:this.webMapId,webMapItemCard:this._webAppItemCard,webMapConfig:arcgisonline.map.storage.buildWebMapText()})},
redirectToAppBuilder:function(b){b.folderId&&"/"!==b.folderId&&(b.folder=b.folderId);var c=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/webappbuilder/index.html?",c=c+a.objectToQuery({title:b.title,tags:b.tags,summary:b.snippet,folder:b.folder,sharewithwebmap:b.shareWithWebMap,webmap:this.webMapId});window.location="https:"===window.location.protocol?arcgisonline.sharing.util.getSecureUrl(c):arcgisonline.sharing.util.getHttpUrl(c)},publishWebMap:function(b){b.preventDefault();
var e=this._selectedTemplate;b=this._selectedTab;var d=this._itemPropDlg,l=arcgisonline.sharing.util.getHomeAppContext(),g=a.mixin(this._itemPropDlg.get("item"),{webMapId:this.webMapId,shareWithWebMap:!0===c.byId("publish-webmap-sharing").get("checked")}),h=a.hitch(this,function(b){this._itemPropDlg.set("readOnly",b);a.query(".share-map-application-publish-config-back").style("color",b?"#999":"#21759B");c.byId("publish-webmap-button").set("disabled",b);c.byId("publish-webmap-button").set("label",
b?this.i18n.savingAndPublishing:this.i18n.savePublishBtn)});a.hitch(this,function(b){var c=new a.Deferred;if(g.shareWithWebMap){var e=esriGeowConfig.restBaseUrl+"content/items/"+b.id+"/share",d=this.shareOptions.isEveryoneChecked(),l=this.shareOptions.isAccountChecked(),h=this.shareOptions.getSharedGroups(),h=a.map(h,"return item.id;"),d={f:"json",everyone:d,org:l,groups:h.join(","),items:[b.id]};arcgisonline.sharing.util.request({url:e,content:d},{usePost:!0}).then(a.hitch(this,function(){c.resolve(b)}))}else c.resolve(b);
return c});h(!0);"appBuilderTab"===b?d._validate().then(a.hitch(this,function(a){this.redirectToAppBuilder(g)}),a.hitch(this,function(a){h(!1);this.showError(a)})):d._validate().then(a.hitch(this,function(b){arcgisonline.sharing.util.isPortal()&&(e.url&&0===e.url.indexOf("/")&&e.url&&-1===e.url.indexOf(l))&&(e.url=l+e.url);this.createItemUtil.createTemplatedApplication(g,this._selectedTemplate,d._portal,this.shareOptions).then(a.hitch(this,function(a){arcgisonline.map.storage.saveMapInCookie();window.location=
a.configureUrl}),a.hitch(this,function(a){h(!1);this.showError(a)}))}),a.hitch(this,function(a){h(!1);this.showError(a)}))},_changeEmbedTab:function(b){b=b&&b.currentTarget&&b.currentTarget.id||this._selectedEmbedTab||"advOptionsTab";a.query(".selected",a.byId("embedTabs")).removeClass("selected");a.query("#"+b,a.byId("embedTabs")).addClass("selected");"advOptionsTab"===b?(esri.hide(a.byId("addMarkerSymbolTab")),esri.show(a.byId("advancedOptionsTab"))):(esri.hide(a.byId("advancedOptionsTab")),esri.show(a.byId("addMarkerSymbolTab")))},
_changeTab:function(b){b=b&&b.currentTarget&&b.currentTarget.id||this._selectedTab||"configurableTab";a.query(".selected",a.byId("galleryTabs")).removeClass("selected");a.query("#"+b,a.byId("galleryTabs")).addClass("selected");"appBuilderTab"===b?(this._configureSettings=this._getItemProperties(),this._setItemProperties(this._appBuilderSettings||this._configureSettings),this._lastPane=this._stackContainer.selectedChildWidget!==this._stackAllOptions?this._stackContainer.selectedChildWidget:null,this._stackContainer.selectChild(this._stackApplicationPublish),
this._selectedTab=b,c.byId("publish-webmap-button").set("label",this.i18n.getStartedBtn),a.query(".configureApp").forEach(esri.hide),a.query(".appBuilder").forEach(esri.show)):(this._appBuilderSettings=this._getItemProperties(),this._setItemProperties(this._configureSettings||this._appBuilderSettings),this._stackContainer.selectChild(this._lastPane||this._stackApplicationGallery),this._selectedTab=b,c.byId("publish-webmap-button").set("label",this.i18n.savePublishBtn),a.query(".configureApp").forEach(esri.show),
a.query(".appBuilder").forEach(esri.hide))},_showGalleryTabs:function(b){b?(b=this._user||(this._user=arcgisonline.sharing.util.getUser()),esriGeowConfig.webAppBuilderEnabled&&(b&&b.accountId)&&esri.show(a.byId("galleryTabs"))):esri.hide(a.byId("galleryTabs"))},_getItemProperties:function(){return this._itemPropDlg?a.mixin(this._itemPropDlg.get("item"),{sharing:c.byId("publish-webmap-sharing").get("checked")}):{}},_getGroupNames:function(){var b=[],c=this.userGroups,d=this.shareOptions.getSharedGroups()||
[];this.shareOptions.isEveryoneChecked()&&b.push(this.i18n.shareOptions.everyonePortal);this.shareOptions.isAccountChecked()&&b.push(esriGeowConfig.self&&esriGeowConfig.self.name);a.forEach(d,function(d){a.some(c,function(a){if(a.id===d.id)return b.push(a.title),!0})});return b},_setItemProperties:function(b){this._itemPropDlg&&(this._itemPropDlg.set("title",b.title),this._itemPropDlg.set("summary",b.snippet),this._itemPropDlg.set("tags",b.tags||[]),this._itemPropDlg.set("title",b.title),this._shareSameLevel.set("checked",
b.sharing));(b=this._getGroupNames())&&b.length?(a.attr("publish-webmap-sharing-label","innerHTML",this.i18n.shareSameLevel+" ("+this._getGroupNames().join(", ")+")"),a.style("publish-webmap-sharing-label","display",""),c.byId("publish-webmap-sharing").set("checked",!0),a.style(c.byId("publish-webmap-sharing").domNode,"display","")):(a.style("publish-webmap-sharing-label","display","none"),c.byId("publish-webmap-sharing").set("checked",!1),a.style(c.byId("publish-webmap-sharing").domNode,"display",
"none"))},checkValue:function(b,c){var d=null;if("title"===b)if(0===c.length||c===this.defaultTextTitle)d={title:this.i18n.errorTitle,message:this.i18n.error.provideTitle};else if(-1!==a.indexOf(this.allItemNames,c))d={title:this.i18n.errorTitle,message:esri.substitute({type:this._webApp&&this._webApp.type||"Web Mapping Application",title:c},this.i18n.shareErrors.itemExists.message)};else{if(-1<c.indexOf("\x3c")||-1<c.indexOf("\x3e"))d={title:this.i18n.errorTitle,message:this.i18n.error.specialCharaters}}else if("tags"===
b){if(0===c.length||c===this.defaultTextTags)d={title:this.i18n.errorTitle,message:this.i18n.error.provideTitle}}else if("summary"===b&&(0===c.length||c===this.defaultTextSummary))return" ";if(!d)return c;this.showError(d);return null},showError:function(a){(this._dlg||(this._dlg=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance())).show({title:a.title,message:a.message})},onFocus:function(b,c){b.get("value")===c&&(b.set("value",""),a.style(b.domNode,"color","#000000"))},
onBlur:function(b,c){""===b.get("value")&&(b.set("value",c),a.style(b.domNode,"color","#999999"))},onChooseEmbedMap:function(b){a.attr(a.byId("embed-type-label"),"innerHTML",esri.substitute({embedType:this.i18n.updates.embedTypeMap},this.i18n.updates.chooseEmbed));a.style(a.byId("mapOptionsContainer"),"visibility","visible");c.byId("embedType:map").set("checked",!0);this.updateMapSize(this.size)},onChooseEmbedPresentation:function(b){a.attr(a.byId("embed-type-label"),"innerHTML",esri.substitute({embedType:this.i18n.updates.embedTypePresentation},
this.i18n.updates.chooseEmbed));a.style(a.byId("mapOptionsContainer"),"visibility","hidden");c.byId("embedType:presentation").set("checked",!0);this.updateMapSize(this.size)},updateMapSize:function(a){this.size=a;a=c.byId("mapSize:custom:width").get("value");var e=c.byId("mapSize:custom:height").get("value");isNaN(a)||isNaN(e)?arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.invalidWidthHeight}):c.byId("share-map-embed-text").set("value",
this.buildEmbedMapHTML(a,e))},updateLinkType:function(b){var e=!1;if("http:"==location.protocol&&esriGeowConfig.bitlyUrl&&0<esriGeowConfig.bitlyUrl.length||"https:"==location.protocol&&esriGeowConfig.bitlyUrlSSL&&0<esriGeowConfig.bitlyUrlSSL.length)e=!0;this.linkType=b;switch(b){case "presentation":a.style(a.byId("share-map-url-extent-div"),"display","none");esriGeowConfig.showSocialMediaLinks&&e?(this.shortenedUrl=null,this.useShortenedUrl(this.presentationUrl)):c.byId("share-map-url").set("value",
n.html.entities.decode(this.presentationUrl));break;case "map":a.style(a.byId("share-map-url-extent-div"),"display",""),esriGeowConfig.showSocialMediaLinks&&e?(this.shortenedUrl=null,this.useShortenedUrl(this.viewerUrl)):c.byId("share-map-url").set("value",n.html.entities.decode(this.viewerUrl))}},updateLocation:function(){this.updateMapSize(this.size);c.byId("share-map-embed-location").get("checked")?a.style(a.byId("share-map-location-restrict"),"display",""):a.style(a.byId("share-map-location-restrict"),
"display","none")},updateEmbedHTML:function(){this.updateMapSize(this.size)},updatePresentation:function(){c.byId("embedType:presentation").get("checked")?(a.style(a.byId("share-map-embed-zoom-label"),"color","#999999"),a.style(a.byId("share-map-embed-home-label"),"color","#999999"),a.style(a.byId("share-map-embed-scale-label"),"color","#999999"),a.style(a.byId("share-map-embed-legend-label"),"color","#999999"),a.style(a.byId("share-map-embed-description-label"),"color","#999999"),a.style(a.byId("share-map-embed-location-label"),
"color","#999999"),a.style(a.byId("share-map-embed-basemap-label"),"color","#999999")):(a.style(a.byId("share-map-embed-zoom-label"),"color","#000000"),a.style(a.byId("share-map-embed-home-label"),"color","#000000"),a.style(a.byId("share-map-embed-scale-label"),"color","#000000"),a.style(a.byId("share-map-embed-legend-label"),"color","#000000"),a.style(a.byId("share-map-embed-description-label"),"color","#000000"),a.style(a.byId("share-map-embed-location-label"),"color","#000000"),a.style(a.byId("share-map-embed-basemap-label"),
"color","#000000"));this.updateMapSize(this.size)},hide:function(){c.byId("share-map-dialog").hide();this._browseItemsDlg&&(this._browseItemsDlg.destroy(),this._browseItemsDlg=null,this._browseItemstopicHandle.remove());9>a.isIE&&this._stackContainer.selectChild(this._stackAllOptions)},clear:function(){c.byId("share-map-dialog").set("title",this.i18n.share);a.style(a.byId("share-map-make-public"),"display","none");a.style(a.byId("share-map-not-public"),"display","none");a.style(a.byId("share-map-is-public"),
"display","block");a.style(a.byId("share-map-premium"),"display","none");this._setupGeocoder();c.byId("embedType:map").set("checked",!0);a.attr(a.byId("embed-type-label"),"innerHTML",esri.substitute({embedType:this.i18n.updates.embedTypeMap},this.i18n.updates.chooseEmbed));a.style(a.byId("mapOptionsContainer"),"visibility","visible");c.byId("share-map-embed-zoom").set("checked",!0);c.byId("share-map-embed-home").set("checked",!1);c.byId("share-map-embed-basemap").set("checked",!1);c.byId("basemapType:gallery").set("checked",
!0);c.byId("share-map-embed-scale").set("checked",!0);c.byId("share-map-embed-location").set("checked",!1);c.byId("share-map-embed-location-restrict").set("checked",!0);c.byId("share-map-embed-description").set("checked",!1);c.byId("share-map-embed-legend").set("checked",!1);c.byId("share-map-embed-disablezoom").set("checked",!0);a.attr(a.byId("share-map-embed-location-restrict-label"),"title",this.i18n.showLocationRestrict);c.byId("basemap:secondBasemap").set("value",this._topoTitle);this.onBasemapSelectorClicked();
this.onShareMapActivePanelCheck();c.byId("embedTheme:light").set("checked",!0);c.byId("marker-symbol-title").set("value","");c.byId("marker-symbol-desc").set("value","");c.byId("marker-symbol-url").set("value","");c.byId("marker-symbol-url").set("placeHolder",this.i18n.updates.exampleMarkerUrl);c.byId("marker:search").set("checked",!0);c.byId("latitude:y").set("value","");c.byId("longitude:x").set("value","");a.byId("advOptionsTab")&&a.byId("addMarkerTab")&&(a.addClass(a.byId("advOptionsTab"),"selected"),
a.removeClass(a.byId("addMarkerTab"),"selected"),esri.hide(a.byId("addMarkerSymbolTab")),esri.show(a.byId("advancedOptionsTab")));a.style(a.byId("mapPreview:panel"),"display","none");a.style(a.byId("mapPreview:details"),"display","none");a.style(a.byId("mapPreview:legend"),"display","none");a.style(a.byId("mapPreview:gallery"),"display","none");a.style(a.byId("mapPreview:toggle"),"display","none");a.style(a.byId("mapPreview:zoom"),"display","");a.style(a.byId("mapPreview:zoomhome"),"display","none");
a.style(a.byId("mapPreview:search"),"display","none");a.style(a.byId("mapPreview:scale"),"display","");a.query(".share-map-application-publish-config-back").forEach(a.hitch(this,function(b){a.style(b,"color","#21759B")}));c.byId("publish-webmap-button").set("disabled",!1);c.byId("publish-webmap-button").set("label",this.i18n.savePublishBtn);a.style(a.byId("publish-webmap-waiting"),"display","none");this.shortenedUrl=null;this._copiedData=!1},toggleSelect:function(b){b.preventDefault();a.byId("share-map-embed-text").select();
this._copiedData=!0},doNothing:function(a){(!a.metaKey&&!a.ctrlKey||!("c"===a.keyChar||"a"===a.keyChar))&&a.preventDefault()},listenForCopy:function(a){(a.metaKey||a.ctrlKey)&&("c"===a.keyChar||67===a.keyCode)?this._copiedData=!0:a.preventDefault()},show:function(b,c,d,l,g,h,p,A){this.hasPresentation=h;this.hasBing=g;this.showPublish=p;this.webMapId=b;this.folderId=d;this.webmapTitle=l;this.webMapOwner=c;this._isPublishing=!1;this.hasRequiresSubscriptionOrCredits=A;a.byId("share-map-webmapId").innerHTML=
this.webMapId;var k=function(a,b){var c=arcgisonline.map.main.extentToString(a[0]);this.show2(c)},s=function(a,b){this.show2("")},m=arcgisonline.map.main.map.extent;m.spatialReference._isWrappable()?esri.geometry.normalizeCentralMeridian([m],null,a.hitch(this,function(b){if(b[0].rings){var c=(new esri.geometry.Polygon(m.spatialReference)).addRing(b[0].rings[0]).getExtent();b=(new esri.geometry.Polygon(m.spatialReference)).addRing(b[0].rings[1]).getExtent();m=c.getWidth()>b.getWidth()?c:b}else m=b[0];
arcgisonline.map.main.projectExtent(m,new esri.SpatialReference({wkid:4326}),a.hitch(this,k),a.hitch(this,s))})):arcgisonline.map.main.projectExtent(m,new esri.SpatialReference({wkid:4326}),a.hitch(this,k),a.hitch(this,s))},show2:function(b){this._user=arcgisonline.sharing.util.getUser();this._webAppItemCard=a.mixin({},arcgisonline.map.save_open.webMapItemCard);this.gcsExtStr=b;this._webAppItemCard.owner||(this._webAppItemCard.owner=arcgisonline.map.save_open.webMapInfo.owner,this._webAppItemCard.id=
arcgisonline.map.save_open.webMapInfo.id,this._webAppItemCard.title=arcgisonline.map.save_open.webMapInfo.title,this._webAppItemCard.thumbnail=arcgisonline.map.save_open.webMapInfo.thumbnail,this._webAppItemCard.tags=arcgisonline.map.save_open.webMapInfo.tags,this._webAppItemCard.snippet=arcgisonline.map.save_open.webMapInfo.snippet);c.byId("share-map-url-extent").get("checked")?this.viewerUrl=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+this.webMapId+"\x26amp;extent\x3d"+this.gcsExtStr:
this.viewerUrl=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+this.webMapId;this.presentationUrl=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/presentation/index.html?webmap\x3d"+this.webMapId;this.embedMapUrl=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/Embed/index.html?webmap\x3d"+this.webMapId+"\x26amp;extent\x3d"+b;c.byId("mapSize:custom:width").set("value","500");c.byId("mapSize:custom:height").set("value",
"400");this.hasPresentation?(a.style(a.byId("linkTypeDiv"),"display","block"),a.byId("share-map-embed-label").innerHTML=this.i18n.sharePresentation,a.style(c.byId("embedType:presentation").domNode.parentNode,"display",""),a.style(a.byId("embedType:presentation:label").parentNode,"display","")):(a.style(a.byId("linkTypeDiv"),"display","none"),a.byId("share-map-embed-label").innerHTML=this.i18n.shareMap,a.style(c.byId("embedType:presentation").domNode.parentNode,"display","none"),a.style(a.byId("embedType:presentation:label").parentNode,
"display","none"));this.clear();this._itemPropDlg&&(this._itemPropDlg.set("summary",this._webAppItemCard.snippet),this._itemPropDlg.set("title",this._webAppItemCard.title),this._itemPropDlg.set("tags",this._webAppItemCard.tags||[]));this._stackContainer.selectChild(this.showPublish?this._stackApplicationGallery:this._stackAllOptions);c.byId("share-map-dialog").show();if(null==this.sharingInfo){var e=function(){this.community.getUserGroups(a.hitch(this,function(b,c){this.userGroups=b.groups;a.hitch(this,
d)()}))},d=function(){var b;if(!this.currentUser||this.webMapOwner!=this.currentUser.email&&!this.isAdmin)b=function(b,c){this.sharingInfo={access:b.access};this.currentUser&&0<this.userGroups.length&&(this.shareOptions.showGroups([this.item],this.userGroups),a.byId("share-map-text-public-note").innerHTML=this.i18n.mapShared+"\x3cbr/\x3e\x26nbsp;");this.updateDlgComponents()},arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+this.webMapId,a.hitch(this,b));else{b=function(b,
c){this.sharingInfo=b.sharing;"private"==this.sharingInfo.access?a.byId("share-map-text-public-note").innerHTML=this.i18n.mapPrivate:a.byId("share-map-text-public-note").innerHTML=this.i18n.mapShared+"\x3cbr/\x3e\x26nbsp;";this.updateDlgComponents();var d=esriGeowConfig.userRole,e=d&&esriGeowConfig.userRole.canUpdateOrgItems(),l=d&&(esriGeowConfig.userRole.canShareItemToGroup()||esriGeowConfig.userRole.canShareItemToOrg()||esriGeowConfig.userRole.canShareItemToPublic()),g=function(){(this.isAdmin||
e&&l)&&this.item.owner!==this.currentUser.email?this.shareOptions.showAdmin([this.item],this.userGroups,this.itemUser,this.adminGroups):this.currentUser&&this.item.owner===this.currentUser.email?this.shareOptions.show([this.item],this.userGroups,null):this.currentUser&&("public"===this.item.access||"shared"===this.item.access||"org"===this.item.access&&this.currentUser.accountId)?(this.shareOptions.showGroups([this.item],this.userGroups),a.byId("share-map-text-public-note").innerHTML=this.i18n.mapShared+
"\x3cbr/\x3e\x26nbsp;"):this.shareOptions.show([this.item],this.userGroups,null);this.hasRequiresSubscriptionOrCredits&&this.displayRequiresSubscriptionOrCredits()};this.userGroups?a.hitch(this,g)():this.isAdmin?this.item.owner!==this.currentUser.email?this.community.getUserGroupsByUser(this.itemUser.username,a.hitch(this,function(b,c){this.adminGroups=b.groups;a.hitch(this,g)()})):(this.adminGroups=this.userGroups,a.hitch(this,g)()):a.hitch(this,g)()};var c=esriGeowConfig.restBaseUrl+"content/users/"+
this._webAppItemCard.owner;this._webAppItemCard.ownerFolder&&this._webAppItemCard.ownerFolder.length&&"/"!=this._webAppItemCard.ownerFolder?c+="/"+this._webAppItemCard.ownerFolder:this.folderId&&(this.folderId.length&&"/"!=this.folderId)&&(c+="/"+this.folderId);c+="/items/"+this.webMapId;arcgisonline.sharing.util.getJson(c,a.hitch(this,b))}};this.currentUser=arcgisonline.sharing.util.getUser();if((this.item=this._webAppItemCard)&&this.item.ownerFolder&&this.item.ownerFolder.length&&"/"!=this.item.ownerFolder)this.item.folderId=
this.item.ownerFolder;esri.isDefined(this.folderId)&&(this.folderId.length&&"/"!=this.folderId)&&(this.item.folderId=this.folderId);this.isAdmin=!1;esriGeowConfig.userRole&&(esriGeowConfig.userRole.isAdmin()||esriGeowConfig.userRole.isCustom()&&esriGeowConfig.userRole.canUpdateOrgItems())?(this.isAdmin=!0,this.item.owner!==this.currentUser.email?this.community.getProfile(this.item.owner,a.hitch(this,a.hitch(this,function(b,c){this.itemUser=b;this.itemUser.orgId!==this.currentUser.accountId&&(this.isAdmin=
!1);a.hitch(this,e)()}))):(this.itemUser=this.currentUser,a.hitch(this,e)())):this.currentUser?(this.itemUser=this.currentUser,a.hitch(this,e)()):a.hitch(this,d)()}else this.updateDlgComponents(),this.hasRequiresSubscriptionOrCredits&&this.displayRequiresSubscriptionOrCredits()},onEmbedClose:function(b){if(this._copiedData)this.onClose();else b={title:this.i18n.updates.discardTitle,message:esri.substitute({yesLabel:this.i18n.yesLabel,noLabel:this.i18n.cancel},this.i18n.updates.haventCopied+"\x3cp\x3e"+
this.i18n.updates.returnToCopy+"\x3c/p\x3e"),choiceOneTitle:this.i18n.yesLabel,choiceTwoTitle:this.i18n.cancel,choiceOneHandler:a.hitch(this,function(){this.onClose()})},arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show(b)},onClose:function(a){this._configureSettings=this._appBuilderSettings=null;this.hide()},updateDlgComponents:function(b){esriGeowConfig.showSocialMediaLinks&&esriGeowConfig.bitlyUrl&&0<esriGeowConfig.bitlyUrl.length?(b=c.byId("linkType:presentation").get("checked"),
a.style(a.byId("share-map-url"),"width","270px"),this.hasPresentation&&"public"==this.sharingInfo.access?(b||(this.shortenedUrl=null),c.byId("linkType:presentation").set("disabled",!1),a.style(a.byId("linkType:presentation-label"),"color","#000000"),c.byId("linkType:presentation").set("checked",!0),a.style(a.byId("share-map-url-extent-div"),"display","none"),this.useShortenedUrl(this.presentationUrl)):(this.hasPresentation&&"public"!=this.sharingInfo.access&&(b&&(this.shortenedUrl=null),c.byId("linkType:presentation").set("disabled",
!1),a.style(a.byId("linkType:presentation-label"),"color","#000000"),c.byId("linkType:map").set("checked",!0),a.style(a.byId("share-map-url-extent-div"),"display","")),this.useShortenedUrl(this.viewerUrl))):(a.style(a.byId("share-map-url"),"width","450px"),this.hasPresentation&&"public"==this.sharingInfo.access?(c.byId("linkType:presentation").set("disabled",!1),a.style(a.byId("linkType:presentation-label"),"color","#000000"),c.byId("linkType:presentation").set("checked",!0),a.style(a.byId("share-map-url-extent-div"),
"display","none"),c.byId("share-map-url").set("value",n.html.entities.decode(this.presentationUrl))):(this.hasPresentation&&"public"!=this.sharingInfo.access&&(c.byId("linkType:presentation").set("disabled",!0),a.style(a.byId("linkType:presentation-label"),"color","#999999"),c.byId("linkType:map").set("checked",!0),a.style(a.byId("share-map-url-extent-div"),"display","")),c.byId("share-map-url").set("value",n.html.entities.decode(this.viewerUrl))),c.byId("share-map-url").focus(),a.style(a.byId("socialNetworkLinks"),
"display","none"));b=!0;if(esriGeowConfig.userRole&&esriGeowConfig.userRole.isCustom()&&!esriGeowConfig.userRole.canShareItemToOrg()&&!esriGeowConfig.userRole.canShareItemToGroup()&&(!esriGeowConfig.userRole.canShareItemToPublic()||!esriGeowConfig.self.canSharePublic))b=!1;c.byId("button-share-map-application").set("disabled",!1);var e=arcgisonline.sharing.util.getUser();"public"==this.sharingInfo.access?(this.updateMapSize(this.size),a.style(a.byId("share-map-not-public"),"display","none"),(this.currentUser=
arcgisonline.sharing.util.getUser())&&b&&(this.userGroups&&0<this.userGroups.length||this.webMapOwner==this.currentUser.email||this.isAdmin)?(a.style(a.byId("share-map-make-public"),"display","block"),a.style(a.byId("share-map-is-public"),"display","none")):(a.style(a.byId("share-map-make-public"),"display","none"),a.style(a.byId("share-map-is-public"),"display","block")),c.byId("button-share-map-embed").set("disabled",!1),esriGeowConfig.showSocialMediaLinks&&(arcgisonline.sharing.util.canSharePublic()&&
arcgisonline.map.role.isAllowed("share_socialMediaLinks"))&&a.style(a.byId("socialNetworkLinks"),"display","block"),a.style(a.byId("share-map-embed"),"display","none")):"shared"==this.sharingInfo.access||"org"==this.sharingInfo.access?(c.byId("button-share-map-embed").set("disabled",!0),!e||this.webMapOwner!=e.email&&!this.isAdmin||!b?(a.style(a.byId("share-map-not-public"),"display","block"),a.style(a.byId("share-map-make-public"),"display","none"),a.style(a.byId("share-map-is-public"),"display",
"none")):(a.style(a.byId("share-map-not-public"),"display","none"),a.style(a.byId("share-map-make-public"),"display","block"),a.style(a.byId("share-map-is-public"),"display","none"),a.style(a.byId("share-map-embed"),"display","block")),esriGeowConfig.showSocialMediaLinks&&(arcgisonline.sharing.util.canSharePublic()&&arcgisonline.map.role.isAllowed("share_socialMediaLinks"))&&a.style(a.byId("socialNetworkLinks"),"display","block")):(c.byId("button-share-map-embed").set("disabled",!0),!e||this.webMapOwner!=
e.email&&!this.isAdmin||!b?(a.style(a.byId("share-map-not-public"),"display","block"),a.style(a.byId("share-map-make-public"),"display","none"),a.style(a.byId("share-map-is-public"),"display","block")):(a.style(a.byId("share-map-not-public"),"display","none"),a.style(a.byId("share-map-make-public"),"display","block"),a.style(a.byId("share-map-is-public"),"display","none")),a.style(a.byId("socialNetworkLinks"),"display","none"),a.style(a.byId("share-map-embed"),"display","none"));esriGeowConfig.self&&
"private"===esriGeowConfig.self.access&&(this._isPrivateOrg=!0);!this.isAdmin&&!arcgisonline.sharing.util.canSharePublic()&&(a.style(a.byId("share-map-advanced-label"),"display","none"),a.style(a.byId("share-map-embed-option"),"display","none"),a.style(a.byId("share-map-embed"),"display","none"));this.helpBase=esriGeowConfig&&esriGeowConfig.self.helpBase;this.helpMap=esriGeowConfig&&esriGeowConfig.self.helpMap&&esriGeowConfig.self.helpMap.m},useShortenedUrl:function(b){if(this.shortenedUrl)c.byId("share-map-url").set("value",
this.shortenedUrl);else{if(("public"==this.sharingInfo.access||"shared"==this.sharingInfo.access)&&!arcgisonline.sharing.util.isPortal()){var e=b.indexOf("://"),d=b.indexOf("/",e+3);b=b.substring(0,e+3)+arcgisonline.map.main.selfCallResult.portalHostname+b.substring(d)}arcgisonline.sharing.util.shortenUrl(b,a.hitch(this,function(b){this.shortenedUrl=b;var d=arcgisonline.sharing.util.socialNetworkTitle(this.webmapTitle);c.byId("share-map-url").set("value",b);c.byId("share-map-url").focus();arcgisonline.sharing.util.canSharePublic()?
(a.byId("facebookLink").href="http://www.facebook.com/sharer.php?u\x3d"+b+"\x26t\x3d"+d,a.byId("facebookLink2").href="http://www.facebook.com/sharer.php?u\x3d"+b+"\x26t\x3d"+d,a.byId("twitterLink").href="http://twitter.com/intent/tweet?url\x3d"+b+"\x26text\x3d"+this.webmapTitle,a.byId("twitterLink2").href="http://twitter.com/intent/tweet?url\x3d"+b+"\x26text\x3d"+this.webmapTitle):a.style(a.byId("socialNetworkLinks"),"display","none")}),a.hitch(this,function(d,e){a.style(a.byId("share-map-url"),"width",
"450px");c.byId("share-map-url").set("value",b);c.byId("share-map-url").focus();a.style(a.byId("socialNetworkLinks"),"display","none")}))}},updateMapUrlExtent:function(){c.byId("share-map-url-extent").get("checked")?this.viewerUrl=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+this.webMapId+"\x26amp;extent\x3d"+this.gcsExtStr:this.viewerUrl=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+this.webMapId;esriGeowConfig.showSocialMediaLinks&&esriGeowConfig.bitlyUrl&&0<esriGeowConfig.bitlyUrl.length?
(this.shortenedUrl=null,this.useShortenedUrl(this.viewerUrl)):c.byId("share-map-url").set("value",n.html.entities.decode(this.viewerUrl))},buildEmbedMapHTML:function(b,e){this._copiedData=!1;var d='\x3ciframe width\x3d"'+b+'" height\x3d"'+e+'" frameborder\x3d"0" scrolling\x3d"no" marginheight\x3d"0" marginwidth\x3d"0" title\x3d"'+this.webmapTitle+'" src\x3d"',l=c.byId("share-map-embed-zoom").get("checked"),g=c.byId("share-map-embed-home").get("checked"),h=c.byId("share-map-embed-basemap").get("checked"),
p=h?a.attr(c.byId("basemapType:gallery"),"checked"):!1,n=h?a.attr(c.byId("basemapType:toggle"),"checked"):!1,k=n?c.byId("basemap:secondBasemap").get("value"):null,s=c.byId("share-map-embed-scale").get("checked"),m=c.byId("share-map-embed-location").get("checked"),B=c.byId("share-map-embed-location-restrict").get("checked"),q=c.byId("share-map-embed-description").get("checked"),r=c.byId("share-map-embed-legend").get("checked"),u=q&&r?c.byId("activePanel").get("value"):null,C=a.attr(c.byId("embedTheme:light"),
"checked")?"light":"dark",x=c.byId("longitude:x").get("value"),y=c.byId("latitude:y").get("value"),t=c.byId("marker-symbol-title").get("value"),v=c.byId("marker-symbol-desc").get("value"),w=c.byId("marker-symbol-url").get("value"),z=a.attr(c.byId("embedType:presentation"),"checked"),D=c.byId("share-map-embed-largemap").get("checked"),E=c.byId("share-map-embed-disablezoom").get("checked"),F=c.byId("mapSize:responsive").get("checked"),f;if(this.hasPresentation&&z)d+=this.presentationUrl+'"\x3e\x3c/iframe\x3e';
else{f=this.embedMapUrl;this.hasBing&&(f+="\x26amp;bing\x3dtrue");g&&(f+="\x26amp;home\x3dtrue",c.byId("share-map-embed-zoom").set("checked",!0),l=!0);l&&(f+="\x26amp;zoom\x3dtrue");f=s?f+"\x26amp;scale\x3dtrue":f+"\x26amp;scale\x3dfalse";m&&(f=f+"\x26amp;search\x3dtrue"+("\x26amp;searchextent\x3d"+(B?"true":"false")));q&&(f+="\x26amp;details\x3dtrue");r&&(f+="\x26amp;legend\x3dtrue");q&&r&&(u=u===this.i18n.updates.mapDetails?"details":"legend",f+="\x26amp;active_panel\x3d"+u);if(h)if(p)f+="\x26amp;basemap_gallery\x3dtrue";
else if(n){for(h=0;h<this._basemaps.length;h++)if(k===this._basemaps[h].name){k=this._basemaps[h].id;break}f+="\x26amp;basemap_toggle\x3dtrue\x26amp;alt_basemap\x3d"+k}f=E?f+"\x26amp;disable_scroll\x3dtrue":f+"\x26amp;disable_scroll\x3dfalse";f+="\x26amp;theme\x3d"+C;x&&y&&(k="\x26amp;marker\x3d"+a.number.parse(x)+";"+a.number.parse(y)+";;",v&&0<v.length&&(k+=encodeURIComponent(v)),k+=";",w&&0<w.length&&(k+=encodeURIComponent(w)),k+=";",t&&0<t.length&&(k+=encodeURIComponent(t)),f+=k);d+=f+'"\x3e\x3c/iframe\x3e';
D&&(d+='\x3cbr /\x3e\x3csmall\x3e\x3ca href\x3d"',d=this.hasPresentation&&z?d+this.presentationUrl:d+f,d+='" style\x3d"color:#0000FF;text-align:left" target\x3d"_blank"\x3e'+this.i18n.viewLargerMap+"\x3c/a\x3e\x3c/small\x3e");F&&(t=0<e?""+Math.round(100*(e/b))+"%":"80%",d=esri.substitute({ratioPct:t,embeddedFrame:d},'\x3cstyle\x3e.embed-container {position: relative; padding-bottom: ${ratioPct}; height: 0; max-width: 100%;} .embed-container iframe, .embed-container object, .embed-container iframe{position: absolute; top: 0; left: 0; width: 100%; height: 100%;} small{position: absolute; z-index: 40; bottom: 0; margin-bottom: -15px;}\x3c/style\x3e\x3cdiv class\x3d"embed-container"\x3e${embeddedFrame}\x3c/div\x3e'));
q||r?esriGeowConfig.isRightToLeft?a.addClass(a.byId("mapPreview:search"),"withPanel"):(a.addClass(a.byId("mapPreview:zoom"),"withPanel"),a.addClass(a.byId("mapPreview:zoomhome"),"withPanel"),a.addClass(a.byId("mapPreview:scale"),"withPanel"),a.addClass(a.byId("mapPreview:gallery"),"withPanel"),a.addClass(a.byId("mapPreview:toggle"),"withPanel")):esriGeowConfig.isRightToLeft?a.removeClass(a.byId("mapPreview:search"),"withPanel"):(a.removeClass(a.byId("mapPreview:zoom"),"withPanel"),a.removeClass(a.byId("mapPreview:zoomhome"),
"withPanel"),a.removeClass(a.byId("mapPreview:scale"),"withPanel"),a.removeClass(a.byId("mapPreview:gallery"),"withPanel"),a.removeClass(a.byId("mapPreview:toggle"),"withPanel"));a.removeClass(a.byId("mapPreview:gallery"),"withZoom");a.removeClass(a.byId("mapPreview:gallery"),"withZoomHome");g?a.addClass(a.byId("mapPreview:gallery"),"withZoomHome"):l&&a.addClass(a.byId("mapPreview:gallery"),"withZoom");a.style(a.byId("mapPreview:panel"),"display","none");a.style(a.byId("mapPreview:details"),"display",
"none");a.style(a.byId("mapPreview:legend"),"display","none");q&&r?"details"===u?a.style(a.byId("mapPreview:details"),"display",""):a.style(a.byId("mapPreview:legend"),"display",""):(q||r)&&a.style(a.byId("mapPreview:panel"),"display","");s?a.style(a.byId("mapPreview:scale"),"display",""):a.style(a.byId("mapPreview:scale"),"display","none");m?a.style(a.byId("mapPreview:search"),"display",""):a.style(a.byId("mapPreview:search"),"display","none");a.style(a.byId("mapPreview:zoomhome"),"display","none");
a.style(a.byId("mapPreview:zoom"),"display","none");g?a.style(a.byId("mapPreview:zoomhome"),"display",""):l&&a.style(a.byId("mapPreview:zoom"),"display","");a.style(a.byId("mapPreview:toggle"),"display","none");a.style(a.byId("mapPreview:gallery"),"display","none");p?a.style(a.byId("mapPreview:gallery"),"display",""):n&&a.style(a.byId("mapPreview:toggle"),"display","")}return d},displayRequiresSubscriptionOrCredits:function(){var b=arcgisonline.sharing.dijit.HelpManager.prototype.statics.getInstance();
b.isLoaded?a.byId("share-map-premium-link").href=b.getHelpUrl("120000923"):a.connect(b,"onLoad",a.hitch(this,function(){a.byId("share-map-premium-link").href=b.getHelpUrl("120000923")}));a.style(a.byId("share-map-premium"),"display","block")},_getPortalName:function(){return esriGeowConfig.portalName||this.i18n.arcgisCom},_getPortalPreviewUrl:function(a,c){var d=arcgisonline.sharing.util.parseUrl(c);"/"===a.url.substring(0,1)&&-1<esriGeowConfig.baseUrl.indexOf(d.host)&&(c=window.location.protocol+
"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+a.url);return c="https:"===window.location.protocol?arcgisonline.sharing.util.getSecureUrl(c):arcgisonline.sharing.util.getHttpUrl(c)}})});