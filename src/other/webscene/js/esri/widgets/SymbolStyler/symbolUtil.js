// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
define("../../symbols/support/jsonUtils ../../symbols/SimpleLineSymbol dojo/Deferred dojo/dom-construct dojo/on dojox/gfx".split(" "),function(h,f,m,k,l,n){var g={_pureOutlineStyles:"x,cross",isPoint:function(a){return g.isType(a,"marker")},isType:function(a,c){return a&&-1<a.type.indexOf(c+"symbol")},isLine:function(a){return g.isType(a,"line")},isPolygon:function(a){return g.isType(a,"fill")},hasPureOutlineStyle:function(a){return a&&-1<g._pureOutlineStyles.indexOf(a.style)},getOutline:function(a){return"simplelinesymbol"===
a.type||"cartographiclinesymbol"===a.type?a:a.outline},cloneSymbol:function(a){return h.fromJSON(a.toJSON())},setOutlineWidth:function(a,c){!isNaN(c)&&a&&g.getOutline(a).setWidth(c)},setOutlineStyle:function(a,c){if(c&&a){var d=g.getOutline(a);c=d.color?c:f.STYLE_NULL;d.setStyle(c)}},setSize:function(a,c){if(a&&!isNaN(c)){var d=a.width,b=c,e;if(d!=b)if("picturemarkersymbol"===a.type){if(e=a.url,a.setHeight(a.height/a.width*b),a.setWidth(b),e&&!("http://"===e||-1===e.indexOf("http://")&&-1===e.indexOf("data:")))if(a.xoffset||
a.yoffset)b=a.width,d=b/d,a.setOffset(Math.round(a.xoffset*d),Math.round(a.yoffset*d))}else a.setSize(b)}},getMarkerLength:function(a){return isNaN(a.width)?a.size:Math.max(a.width,a.height)},hasColor:function(a){return a&&a.color},setFillColor:function(a,c){a.setColor(c)},setOutlineColor:function(a,c){g.getOutline(a).setColor(c)},renderOnSurface:function(a,c){if(a){var d=80,b=30,e=g.isLine(a),f=a.outline?1.5*a.outline.width:1;if(e)d=190,b=20;else if("simplemarkersymbol"===a.type)b=d=a.size;else if("picturemarkersymbol"===
a.type){if(!a.url||"http://"===a.url||-1===a.url.indexOf("http://")&&-1===a.url.indexOf("https://")&&-1===a.url.indexOf("data:"))return;b=d=Math.max(a.width,a.height)}d=n.createSurface(c,d+f,b+f);b=h.getShapeDescriptors(a);e&&(b.defaultShape.path="M -90,0 L 90,0 E");e=d.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke);b=d.getDimensions();e.applyTransform({dx:0.5*b.width,dy:0.5*b.height});return d}},toFullLineStyle:function(a){switch(a){case "dot":a=f.STYLE_DOT;break;case "dash":a=f.STYLE_DASH;
break;case "dashdot":a=f.STYLE_DASHDOT;break;case "dashdotdot":a=f.STYLE_DASHDOTDOT;break;default:a=f.STYLE_SOLID}return a},testImageUrl:function(a){var c=new m,d=c.promise,b=k.create("img"),e,f;e=l(b,"load",function(){0===b.width&&0===b.height?c.reject():c.resolve()});f=l(b,"error",function(){c.reject()});b.src=a;d.always(function(){e.remove();f.remove();k.destroy(b)});return d}};return g});