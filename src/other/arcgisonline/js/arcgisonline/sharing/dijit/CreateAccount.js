// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/CreateAccount",["dijit","dojo","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dijit/form/Form,dijit/form/TextBox,dojo/io/iframe,dojo/store/Memory,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/dijit/ComboBox,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/TermsOfUseDlg"],
function(h,b,k){b.provide("arcgisonline.sharing.dijit.CreateAccount");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("dijit.form.Form");b.require("dijit.form.TextBox");b.require("dojo.io.iframe");b.require("dojo.store.Memory");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.dijit.ComboBox");b.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");
b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg");b.requireLocalization("arcgisonline","arcgisonline");b.declare("arcgisonline.sharing.dijit.CreateAccount",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"${baseClass}" dojoType\x3d"dijit.layout.ContentPane" dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"_socialLinkSection" class\x3d"esriItemLinks socialLinkSection esriFloatLeading newStyles grid-50 hide" style\x3d"margin-top:20px;"\x3e\r\n      \x3cp class\x3d"sectionHeader hide" id\x3d"socialTitle"\x3e${i18n.useSocialNetworkAccount}\x3c/p\x3e\r\n      \x3cdiv class\x3d"socialLinks"\x3e\r\n          \x3cul\x3e\r\n              \x3cli class\x3d"facebook"\x3e\x3ca target\x3d"_blank" dojoAttachPoint\x3d"_facebookSocialLink" href\x3d""\x3e\x3cspan\x3e\x3c/span\x3e${i18n.continueFacebook}\x3c/a\x3e\x3c/li\x3e\r\n              \x3cli class\x3d"google"\x3e\x3ca target\x3d"_blank" dojoAttachPoint\x3d"_googleSocialLink" href\x3d""\x3e\x3cspan\x3e\x3c/span\x3e${i18n.continueGoogle}\x3c/a\x3e\x3c/li\x3e\r\n          \x3c/ul\x3e\r\n          \x3cp class\x3d"accountMessage"\x3e${!i18n.publicAccountMsg}\x3c/p\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv dojoType\x3d"dijit.form.Form" autocomplete\x3d"off" id\x3d"_agoAccountSection" class\x3d"esriItemLinks esriFloatLeading newStyles grid-50" style\x3d"margin-top:20px;"\x3e\r\n    \x3cp class\x3d"sectionHeader hide" id\x3d"agoAccountTitle"\x3eOr enter your information\x3c/p\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock" data-dojo-attach-point\x3d"_messageRow"\x3e\r\n      \x3clabel for\x3d"messageRow" id\x3d"messageRowLabel"\x3e\x26nbsp;\x3c/label\x3e\r\n      \x3cdiv id\x3d"messageRow" dojoAttachPoint\x3d"_message" style\x3d"color:red;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"username" class\x3d"requiredLabel" id\x3d"usernameLabel"\x3e${i18n.usernameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"username" autocomplete\x3d"off" autocorrect\x3d"off" autocapitalize\x3d"off" spellcheck\x3d"false" class\x3d"esriFloatLeading" dojoAttachPoint\x3d"_username" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n        \x3cdiv id\x3d"username_coachmark" class\x3d"coachMarkMsg hide"\x3e${i18n.arcgisAccountMsg}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"password" class\x3d"requiredLabel" id\x3d"passwordLabel"\x3e${i18n.passwordLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"password" class\x3d"esriFloatLeading" dojoAttachPoint\x3d"_password" dojoType\x3d"dijit.form.TextBox" type\x3d"password" trim\x3d"true"\x3e\x3c/div\x3e\r\n        \x3cdiv id\x3d"password_coachmark" class\x3d"coachMarkMsg hide"\x3e${i18n.passwordHintText}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"confirm_password" class\x3d"requiredLabel" id\x3d"confirmPasswordLabel"\x3e${i18n.confirmPasswordLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"confirm_password" dojoAttachPoint\x3d"_confirmPassword" dojoType\x3d"dijit.form.TextBox" type\x3d"password" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"first_name" class\x3d"requiredLabel" id\x3d"firstNameLabel"\x3e${i18n.firstNameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"first_name" dojoAttachPoint\x3d"_firstName" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"last_name" class\x3d"requiredLabel" id\x3d"lastNameLabel"\x3e${i18n.lastNameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"last_name" dojoAttachPoint\x3d"_lastName" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv dojoAttachPoint\x3d"_organizationRow" class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"organization" class\x3d"requiredLabel" id\x3d"organizationLabel"\x3e${i18n.organizationLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"organization" dojoAttachPoint\x3d"_organizationName" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"email" class\x3d"requiredLabel" id\x3d"emailLabel"\x3e${i18n.emailLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"email" dojoAttachPoint\x3d"_email" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"confirm_email" class\x3d"requiredLabel" id\x3d"confirmEmailLabel"\x3e${i18n.confirmEmailLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"confirm_email" dojoAttachPoint\x3d"_confirmEmail" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv dojoAttachPoint\x3d"_phoneNumberRow" class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"phoneNumber" class\x3d"requiredLabel" id\x3d"phoneNumberLabel"\x3e${i18n.phoneNumberLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"phoneNumber" dojoAttachPoint\x3d"_phoneNumber" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"hintBox esriAlignLeading" id\x3d"identityQuestionMessage" dojoAttachPoint\x3d"_identityQuestionMessage"\x3e${i18n.identityQuestionMsg}\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"identity_question" class\x3d"requiredLabel" id\x3d"identityQuestionLabel"\x3e${i18n.identityQuestionLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"identity_question" dojoAttachPoint\x3d"_identityQuestion" dojoType\x3d"arcgisonline.sharing.dijit.ComboBox" dojoAttachEvent\x3d"onChange:onIdentityQuestionChange" style\x3d"width:350px;" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"identity_answer" class\x3d"requiredLabel" id\x3d"identityAnswerLabel"\x3e${i18n.answerLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"identity_answer" dojoAttachPoint\x3d"_identityAnswer" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock" id\x3d"terms_of_use_container"\x3e\r\n        \x3cdiv class\x3d"termsOfUse" dojoAttachPoint\x3d"_termsOfUseLink"\x3e${!i18n.termsOfUseMessage}\x3c/div\x3e\r\n        \x3cdiv class\x3d"termsOfUseInternational" dojoAttachPoint\x3d"_termsOfUseInternationalLink"\x3e\x3ca target\x3d"_blank" href\x3d"http://links.esri.com/termsofuse-international-arcgis"\x3e${i18n.touOtherLanguages}\x3c/a\x3e\x3c/div\x3e\r\n        \x3clabel class\x3d"tosCheck" for\x3d"tosCheck"\x3e\x3cinput dojoAttachPoint\x3d"_acceptTermsOfUseChk" name\x3d"tosCheck" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"agreed" /\x3e${i18n.touAcceptMsg}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"bottom-buttons esriFloatLeading"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_createAccount" class\x3d"calcite blue" dojoType\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:onCreateAccountClick" type\x3d"button"\x3e${i18n.createAccountLabel}\x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_cancel" class\x3d"calcite transparent" dojoType\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:onCancelClick" type\x3d"button"\x3e${i18n.cancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"esriFloatLeading newStyles" dojoAttachPoint\x3d"_columnThree"\x3e\r\n    \x3cdiv class\x3d"hintBox esriAlignLeading esriLeadingMargin3 grid-30" id\x3d"accountMessage" dojoAttachPoint\x3d"_accountMessage"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cform id\x3d"form_new_account" dojoAttachPoint\x3d"_form_new_account" method\x3d"post"\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_username" dojoAttachPoint\x3d"_form_username" name\x3d"username"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_password" dojoAttachPoint\x3d"_form_password" name\x3d"password"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_confirmationPassword" dojoAttachPoint\x3d"_form_confirmationPassword" name\x3d"confirmationPassword"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_firstName" dojoAttachPoint\x3d"_form_firstName" name\x3d"firstName"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_lastName" dojoAttachPoint\x3d"_form_lastName" name\x3d"lastName"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_organization" dojoAttachPoint\x3d"_form_organization" name\x3d"organization"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_email" dojoAttachPoint\x3d"_form_email" name\x3d"email"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_phoneNumber" dojoAttachPoint\x3d"_form_phoneNumber" name\x3d"phoneNumber"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_identifyQuestion" dojoAttachPoint\x3d"_form_identifyQuestion" name\x3d"identifyQuestion"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_identifyQuestionID" dojoAttachPoint\x3d"_form_identifyQuestionID" name\x3d"identifyQuestionID"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_identifyAnswer" dojoAttachPoint\x3d"_form_identifyAnswer" name\x3d"identifyAnswer"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_ipAddress" dojoAttachPoint\x3d"_form_ipAddress" name\x3d"ipAddress"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_apiKey" dojoAttachPoint\x3d"_form_apiKey" name\x3d"apiKey"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_appID" dojoAttachPoint\x3d"_form_appID" name\x3d"appID"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_languageCode" dojoAttachPoint\x3d"_form_languageCode" name\x3d"languageCode"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_format" dojoAttachPoint\x3d"_form_format" name\x3d"format"/\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e',
baseClass:"esriAGOCreateAccount",geow:arcgisonline.sharing.geow.Geow,util:arcgisonline.sharing.util,ipLookupUrl:"serverapi.arcgisonline.com/veadaptor/production/services/identity/clientIp",newUserUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"user.html?newUser\x3dtrue",redirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"content.html",accountMode:null,activationId:null,invitationId:null,orgName:null,termsAccepted:!1,newAccount:null,identityQuestions:null,_accountMessage:null,_pageTitle:null,
_formTitle:null,_columnThree:null,_identityQuestionMessage:null,_messageRow:null,_phoneNumberRow:null,_organizationRow:null,_usernameLabel:null,_passwordLabel:null,_confirmPasswordLabel:null,_firstNameLabel:null,_lastNameLabel:null,_organizationLabel:null,_emailLabel:null,_confirmEmailLabel:null,_phoneNumberLabel:null,_identityQuestionLabel:null,_identityAnswerLabel:null,_termsOfUseLabel:null,_message:null,_username:null,_password:null,_confirmPassword:null,_firstName:null,_lastName:null,_organizationName:null,
_email:null,_confirmEmail:null,_phoneNumber:null,_identityQuestionID:-1,_identityQuestion:null,_identityAnswer:null,_ipAddress:null,_terms:null,_createAccount:null,_cancel:null,_settingUsername:!1,_form_new_account:null,_form_username:null,_form_password:null,_form_confirmationPassword:null,_form_firstName:null,_form_lastName:null,_form_organization:null,_form_email:null,_form_phoneNumber:null,_form_identifyQuestion:null,_form_identifyQuestionID:null,_form_identifyAnswer:null,_form_ipAddress:null,
_form_apiKey:null,_form_appID:null,_form_languageCode:null,_form_format:null,i18n:null,ecasAccountMode:"ecas",arcgisAccountMode:"arcgis",bothUserType:"both",arcgisUserType:"arcgisonly",postMixInProperties:function(){this.inherited(arguments);this.i18n=b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline").common);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").createAccount);this.i18n.signUpWidget=b.i18n.getLocalization("arcgisonline","arcgisonline").signUpWidget;
this.i18n.securityQuestions=b.i18n.getLocalization("arcgisonline","arcgisonline").securityQuestions},startup:function(){this.inherited(arguments);b.style(this._messageRow,"display","none");this._createAccount.set("disabled",!0);this.setupQuestions();this.accountMode=this.arcgisAccountMode;this.userType=this.bothUserType;var a=b.queryToObject(window.location.search.slice(1)).activationcode,e=b.queryToObject(window.location.search.slice(1)).invitation;a?(this.activationId=a,this.accountMode=this.arcgisAccountMode,
this.userType=this.arcgisUserType):e&&(this.accountMode=this.arcgisAccountMode,this.invitationId=e,this.util.getJson(esriGeowConfig.restBaseUrl+"community/invitations/"+this.invitationId,b.hitch(this,function(a){a.account&&a.account.name&&(this.orgName=a.account.name)})),b.style(b.byId("terms_of_use_container"),"display","none"),this.termsAccepted=!0,this._createAccount.set("disabled",!1),this.userType=this.arcgisUserType);this.showArcGISAccountUI();this.accountMode===this.ecasAccountMode&&this.lookupIPAddress();
a=this.i18n.createAccountTitle;!this.activationId&&!this.invitationId&&(a=this.i18n.createPublicAccountTitle);b.attr(b.byId("pageTitle"),"innerHTML",a);a="";!this.activationId&&!this.invitationId&&(a+=this.i18n.publicAccountMsg+"\x3cbr/\x3e\x3cbr/\x3e");a+=(this.accountMode===this.arcgisAccountMode?this.i18n.arcgisAccountMsg:this.i18n.accountMsg)+" "+this.i18n.passwordHintText;b.attr(this._accountMessage,"innerHTML",a);b.subscribe("registerUser",this,"onTermsAccepted");b.subscribe("declineTermsOfUse",
this,"onTermsDeclined");b.connect(this._acceptTermsOfUseChk,"onChange",b.hitch(this,function(a){b.publish(a?"registerUser":"declineTermsOfUse",["true"])}));this.adjustNameRows()},setupOauthLinks:function(){var a={url:arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.restBaseUrl+"oauth2/social/authorize"),clientId:"arcgisonline",redirectUri:esriGeowConfig.baseUrl+"postsignin.html",response_type:"token",autoAccountCreateForSocial:!0,locale:b.locale},a=esri.substitute(a,"${url}?client_id\x3d${clientId}\x26response_type\x3d${response_type}\x26autoAccountCreateForSocial\x3d${autoAccountCreateForSocial}\x26redirect_uri\x3d${redirectUri}\x26locale\x3d${locale}");
b.attr(this._facebookSocialLink,"href",a+"\x26socialLoginProviderName\x3dfacebook");b.attr(this._googleSocialLink,"href",a+"\x26socialLoginProviderName\x3dgoogle");b.addClass(this.domNode,"showSocial");b.addClass(this._columnThree,"hide");b.removeClass(b.byId("_agoAccountSection"),"esriFloatLeading");b.addClass(b.byId("_agoAccountSection"),"esriFloatTrailing");b.removeClass(this._socialLinkSection,"hide");b.query(".sectionHeader",this.domNode).removeClass("hide");b.connect(this._username,"onFocus",
b.hitch(this,function(){b.removeClass(b.byId("username_coachmark"),"hide")}));b.connect(this._username,"onBlur",b.hitch(this,function(){b.addClass(b.byId("username_coachmark"),"hide")}));b.connect(this._password,"onFocus",b.hitch(this,function(){b.removeClass(b.byId("password_coachmark"),"hide")}));b.connect(this._password,"onBlur",b.hitch(this,function(){b.addClass(b.byId("password_coachmark"),"hide")}));b.connect(this._confirmPassword,"onFocus",b.hitch(this,function(){b.removeClass(b.byId("password_coachmark"),
"hide")}));b.connect(this._confirmPassword,"onBlur",b.hitch(this,function(){b.addClass(b.byId("password_coachmark"),"hide")}))},adjustNameRows:function(){"ja"===b.locale&&b.place(b.byId("firstNameRow"),b.byId("lastNameRow"),"after")},showArcGISAccountUI:function(){b.style(this._identityQuestionMessage,"display","none");b.style(this._organizationRow,"display","none");b.style(this._phoneNumberRow,"display","none");b.removeClass(this._accountMessage,"hintBox");b.connect(this._username,"onChange",b.hitch(this,
this.onUsernameChanged))},lookupIPAddress:function(){esri.request({url:esriGeowConfig.geoIPService}).then(b.hitch(this,function(a){a&&a.clientip&&(this._ipAddress=a.clientip)}),b.hitch(this,function(a,b){console.log("Unable to lookup IP address")}))},setupQuestions:function(){this.identityQuestions=[{id:1,name:this.i18n.securityQuestions[1]},{id:2,name:this.i18n.securityQuestions[2]},{id:3,name:this.i18n.securityQuestions[3]},{id:4,name:this.i18n.securityQuestions[4]},{id:5,name:this.i18n.securityQuestions[5]},
{id:6,name:this.i18n.securityQuestions[6]},{id:7,name:this.i18n.securityQuestions[7]},{id:8,name:this.i18n.securityQuestions[8]},{id:9,name:this.i18n.securityQuestions[9]},{id:10,name:this.i18n.securityQuestions[10]},{id:11,name:this.i18n.securityQuestions[11]},{id:12,name:this.i18n.securityQuestions[12]},{id:13,name:this.i18n.securityQuestions[13]},{id:14,name:this.i18n.securityQuestions[14]}];var a=new b.store.Memory({idProperty:"name",data:this.identityQuestions});this._identityQuestion.set("store",
a);this.accountMode===this.ecasAccountMode?this._identityQuestion.set("value",this.i18n.chooseQuestionLabel):this._identityQuestion.set("value",this.i18n.securityQuestionLabel)},compileAccountInfo:function(){var a=b.locale?b.locale:"en",a=-1<a.indexOf("-")?a.substring(0,a.indexOf("-")):a;this.newAccount={};this.newAccount.username=this._username.get("value");this.newAccount.password=this._password.get("value");this.newAccount.confirmPassword=this._confirmPassword.get("value");this.newAccount.firstName=
this._firstName.get("value");this.newAccount.lastName=this._lastName.get("value");this.newAccount.organization=this._organizationName.get("value");this.newAccount.email=this._email.get("value");this.newAccount.confirmEmail=this._confirmEmail.get("value");this.newAccount.phoneNumber=this._phoneNumber.get("value");this.newAccount.identifyQuestion=this._identityQuestion.get("value");this.newAccount.identifyQuestionID=this._identityQuestionID;this.newAccount.identifyAnswer=this._identityAnswer.get("value");
this.newAccount.ipAddress=this._ipAddress;this.newAccount.apiKey=esriGeowConfig.accountApiKey;this.newAccount.appID=esriGeowConfig.accountAppKey;this.newAccount.languageCode=a},validates:function(){this.compileAccountInfo();var a=null,b="\x3cp\x3e"+this.i18n.validationErrorHeader+"\x3c/p\x3e\x3cp\x3e",c=!1;if(this.notSet(this.newAccount.username))c=!0,b+=this.i18n.invalid.usernameIsBlank+"\x3cbr/\x3e",a||(a=this._username);else{6>this.newAccount.username.length&&(c=!0,b+=this.i18n.invalid.usernameTooShort+
"\x3cbr/\x3e",a||(a=this._username));128<this.newAccount.username.length&&(c=!0,b+=this.i18n.invalid.usernameTooLong+"\x3cbr/\x3e",a||(a=this._username));var d=this.findRestrictedChars(this.newAccount.username,arcgisonline.sharing.dijit.CreateAccount.validation.restrictedCharlist+" ");d&&0<d.length&&(c=!0,b+=esri.substitute({characters:d},this.i18n.invalid.usernameBadChars)+"\x3cbr/\x3e",a||(a=this._username));this.usernameContainsAlphaNumeric(this.newAccount.username)||(c=!0,b+=this.i18n.invalid.usernameInvalidChars+
"\x3cbr/\x3e",a||(a=this._username))}if(this.notSet(this.newAccount.password)||!this.util.meetsPasswordStrength(this.newAccount.password))c=!0,b+=this.i18n.passwordHintText+"\x3cbr/\x3e",a||(a=this._password);this.notSet(this.newAccount.confirmPassword)&&(c=!0,b+=this.i18n.invalid.passwordConfirmIsBlank+"\x3cbr/\x3e",a||(a=this._confirmPassword));this.isSet(this.newAccount.password)&&(this.isSet(this.newAccount.confirmPassword)&&this.newAccount.password!==this.newAccount.confirmPassword)&&(c=!0,b+=
this.i18n.invalid.passwordConfirmNoMatch+"\x3cbr/\x3e",a||(a=this._password));this.notSet(this.newAccount.firstName)?(c=!0,b+=this.i18n.invalid.firstNameIsBlank+"\x3cbr/\x3e",a||(a=this._firstName)):40<this.newAccount.firstName.length?(c=!0,b+=this.i18n.invalid.firstNameTooLong+"\x3cbr/\x3e",a||(a=this._firstName)):this.accountMode===this.ecasAccountMode&&!this.containsAlphaNumericWithSpaces(this.newAccount.firstName)&&(c=!0,b+=this.i18n.invalid.firstNameInvalidChars+"\x3cbr/\x3e",a||(a=this._firstName));
this.notSet(this.newAccount.lastName)?(c=!0,b+=this.i18n.invalid.lastNameIsBlank+"\x3cbr/\x3e",a||(a=this._lastName)):40<this.newAccount.lastName.length?(c=!0,b+=this.i18n.invalid.lastNameTooLong+"\x3cbr/\x3e",a||(a=this._lastName)):this.accountMode===this.ecasAccountMode&&!this.containsAlphaNumericWithSpaces(this.newAccount.lastName)&&(c=!0,b+=this.i18n.invalid.lastNameInvalidChars+"\x3cbr/\x3e",a||(a=this._lastName));this.accountMode===this.ecasAccountMode&&(this.notSet(this.newAccount.organization)?
(c=!0,b+=this.i18n.invalid.organizationIsBlank+"\x3cbr/\x3e",a||(a=this._organizationName)):255<this.newAccount.organization.length?(c=!0,b+=this.i18n.invalid.organizationTooLong+"\x3cbr/\x3e",a||(a=this._organizationName)):this.containsAlphaNumericWithSpaces(this.newAccount.organization)||(c=!0,b+=this.i18n.invalid.organizationInvalidChars+"\x3cbr/\x3e",a||(a=this._organizationName)));this.notSet(this.newAccount.email)?(c=!0,b+=this.i18n.invalid.emailIsBlank+"\x3cbr/\x3e",a||(a=this._email)):this.util.isValidEmailAddress(this.newAccount.email)||
(c=!0,b+=esri.substitute({email:this.newAccount.email},this.i18n.invalid.emailAddress+"\x3cbr/\x3e"),a||(a=this._email));this.notSet(this.newAccount.confirmEmail)?(c=!0,b+=this.i18n.invalid.emailConfirmIsBlank+"\x3cbr/\x3e",a||(a=this._confirmEmail)):this.util.isValidEmailAddress(this.newAccount.confirmEmail)||(c=!0,b+=esri.substitute({email:this.newAccount.confirmEmail},this.i18n.invalid.emailConfirmAddress)+"\x3cbr/\x3e",a||(a=this._confirmEmail));this.isSet(this.newAccount.email)&&(this.isSet(this.newAccount.confirmEmail)&&
this.newAccount.email!==this.newAccount.confirmEmail)&&(c=!0,b+=this.i18n.invalid.emailConfirmNoMatch+"\x3cbr/\x3e",a||(a=this._email));this.accountMode===this.ecasAccountMode&&(this.notSet(this.newAccount.phoneNumber)?(c=!0,b+=this.i18n.invalid.phoneIsBlank+"\x3cbr/\x3e",a||(a=this._phoneNumber)):(d=this.findRestrictedPhoneChars(this.newAccount.phoneNumber,arcgisonline.sharing.dijit.CreateAccount.validation.phoneValidChars),0!==d.length&&(c=!0,b+=esri.substitute({characters:d},this.i18n.invalid.phoneBadChars)+
"\x3cbr/\x3e",a||(a=this._phoneNumber))));1>this.newAccount.identifyQuestionID&&(c=!0,b+=this.i18n.invalid.questionSelection+"\x3cbr/\x3e",a||(a=this._identityQuestion));this.notSet(this.newAccount.identifyQuestion)&&(c=!0,b+=this.i18n.invalid.questionIsBlank+"\x3cbr/\x3e",a||(a=this._identityQuestion));this.notSet(this.newAccount.identifyAnswer)?(c=!0,b+=this.i18n.invalid.answerIsBlank+"\x3cbr/\x3e",a||(a=this._identityAnswer)):60<this.newAccount.identifyAnswer.length&&(c=!0,b+=this.i18n.invalid.answerTooLong+
"\x3cbr/\x3e",a||(a=this._identityAnswer));b+="\x3c/p\x3e";c&&(a&&a.focus(),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.noticeLabel,message:b}));return!c},onTermsAccepted:function(){this.termsAccepted=!0;this._createAccount.set("disabled",!1)},onTermsDeclined:function(){this.invitationId||(this.termsAccepted=!1,this._createAccount.set("disabled",!0))},onTermsClick:function(){arcgisonline.sharing.dijit.dialog.TermsOfUseDlg.prototype.statics.getInstance().show()},
onUsernameChanged:function(){b.style(this._messageRow,"display","none");b.attr(this._message,"innerHTML","");if(this._settingUsername)this._settingUsername=!1;else{var a=this._username.get("value");if(a&&0<a.length)arcgisonline.sharing.geow.Account.checkUsernames([a],b.hitch(this,this.handleCheckUsername),b.hitch(this,this.handleCheckUsername));else this.onTermsDeclined()}},handleCheckUsername:function(a){if(a&&!a.code&&!a.message){if(a.usernames&&0<a.usernames.length&&this._username.get("value")!==
a.usernames[0].suggested){var e=esriGeowConfig.baseUrl.replace("http:","https:");a=esri.substitute({username:a.usernames[0].requested,linkStart:"\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'"+e+esriGeowConfig.signin+window.location.search+"'\x3e",linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.invalid.usernameIsTaken);b.style(this._messageRow,"display","table-row");b.attr(this._message,"innerHTML",a);this.onTermsDeclined()}}else a.messageCode&&"DB_0006"===a.messageCode?(b.style(this._messageRow,
"display","table-row"),b.attr(this._message,"innerHTML",this.i18n.errors.restrictedCharacters)):(b.style(this._messageRow,"display","table-row"),b.attr(this._message,"innerHTML",this.i18n.errors.checkingUsername)),this.onTermsDeclined()},onIdentityQuestionChange:function(a){this._identityQuestion.get("store").query({name:a}).forEach(b.hitch(this,function(a){this._identityQuestionID=a.id}))},onCreateAccountClick:function(){this.termsAccepted?this.validates()&&this.createAccount(this.newAccount,esriGeowConfig.accountApi):
arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.noticeLabel,message:this.i18n.termsOfUseReminder})},onCancelClick:function(){var a=esriGeowConfig.baseUrl.replace("http://","https://")+esriGeowConfig.signin;this.activationId?a+="?activationcode\x3d"+this.activationId:this.invitationId&&(a+="?invitation\x3d"+this.invitationId);window.location=a},handleArcGISAccount:function(a,e){if(a&&a.success&&!0===a.success)this.onSignUp(a,e);else{var c=this.i18n.errors.creatingAccount,
d=this.i18n.errorLabel,f=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.code&&400===a.code&&a.message&&"Unable to signup user."===a.message&&a.details&&a.details[0]&&"Invitation email does not match."===a.details[0]?(d=this.i18n.noticeLabel,c="\x3cp\x3e"+this.i18n.invite.emailInvitation+"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.correctEmail+"\x3c/p\x3e",f.onOkClick=b.hitch(this,function(a,b){a.hide();this._email.set("value","");this._confirmEmail.set("value","");this._email.focus();
this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)},f),f.show({title:d,message:c})):a.code&&500===a.code&&a.message&&-1<a.message.indexOf("Username")&&-1<a.message.indexOf("not available.")?(d=this.i18n.noticeLabel,c=this.i18n.errors.restrictedCharacters,f.onOkClick=b.hitch(this,function(a,b){a.hide();this._username.focus();this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)})):(f.show({title:d,message:c}),
this._createAccount.set("disabled",!1),this._createAccount.set("label",this.i18n.createAccountLabel))}},handleCreateAccount:function(a){if(a&&a.status)if("success"===a.status)this.register();else{if("error"===a.status){console.log(a);var b="";(a=a.errorcode)?"Missing_FirstName"===a?(b=this.i18n.invalid.ecasFirstNameIsMissing,this._firstName.focus()):"Missing_LastName"===a?(b=this.i18n.invalid.ecasLastNameIsMissing,this._lastName.focus()):"Missing_Organization"===a?(b=this.i18n.invalid.ecasOrganizationIsMissing,
this._organizationName.focus()):"Missing_Email"===a||"Email_Bad_Format"===a?("Missing_Email"===a?b=this.i18n.invalid.ecasEmailIsMissing:"Email_Bad_Format"===a&&(b=this.i18n.invalid.ecasEmailBadFormat),this._email.focus()):"Missing_PhoneNumber"===a||"PhoneNumber_Bad_Format"===a?(""===a?b=this.i18n.invalid.ecasPhoneIsMissing:""===a&&(b=this.i18n.invalid.ecasPhoneBadFormat),this._phoneNumber.focus()):"Missing_Password"===a||"Password_Length"===a||"Password_Missmatch"===a?("Missing_Password"===a?b=this.i18n.invalid.ecasPasswordIsMissing:
"Password_Length"===a?b=this.i18n.invalid.ecasPasswordLength:"Password_Missmatch"===a&&(b=this.i18n.invalid.ecasPasswordMissmatch),this._password.focus()):"Missing_PasswordConfirmation"===a?(b=this.i18n.invalid.ecasPasswordConfirmIsMissing,this._confirmPassword.focus()):"Missing_IdentifyQuestion"===a?(b=this.i18n.invalid.ecasQuestionIsMissing,this._identityQuestion.focus()):"Missing_Answer"===a?(b=this.i18n.invalid.ecasAnswerIsMissing,this._identityAnswer.focus()):"Missing_Username"===a||"Username_Taken"===
a||"Username_Length"===a?("Username_Taken"===a?b=esri.substitute({username:this.newAccount.username},this.i18n.invalid.ecasUsernameIsTaken):"Missing_Username"===a?b=this.i18n.invalid.ecasUsernameIsMissing:"Username_Length"===a&&(b=this.i18n.invalid.ecasUsernameLength),this._username.focus()):"Delayed_Creation"===a?b=esri.substitute({p:"\x3cp\x3e",pEnd:"\x3c/p\x3e"},this.i18n.errors.delayedCreation):"Restricted_Characters"===a?this.usernameContainsAlphaNumeric(this.newAccount.username)?this.containsLatinCharset(this.newAccount.password)?
this.containsAlphaNumeric(this.newAccount.firstName)?this.containsAlphaNumeric(this.newAccount.lastName)?this.containsAlphaNumericWithSpaces(this.newAccount.organization)?(b=this.i18n.errors.restrictedIdentifyAnswerCharacters,this._identityAnswer.focus()):b=this.i18n.errors.restrictedOrganizationCharacters:b=this.i18n.errors.restrictedLastNameCharacters:b=this.i18n.errors.restrictedFirstNameCharacters:(b=this.i18n.invalid.ecasPasswordRestrictedCharacters,this._password.focus()):(b=this.i18n.errors.restrictedCharacters,
this._username.focus()):b=this.i18n.errors.creatingAccount:b=this.i18n.errors.creatingAccount;a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.show({title:this.i18n.errorLabel,message:b});this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)}}else console.log(a),a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),a.show({title:this.i18n.errorLabel,message:this.i18n.errors.creatingAccount}),this._createAccount.set("disabled",
!1),this._createAccount.set("label",this.i18n.createAccountLabel)},register:function(){var a={username:this.newAccount.username,password:this.newAccount.password};this.signout();this.geow.signup(a,b.hitch(this,this.onSignUp),b.hitch(this,this.signUpError))},signUpError:function(a,e){var c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.onOkClick=b.hitch(this,function(a,b){a.hide();var c=esriGeowConfig.baseUrl+esriGeowConfig.signin;this.invitationId?c+="?invitation\x3d"+
this.invitationId+"\x26org\x3d"+this.orgName:this.activationId&&(c+="?activationcode\x3d"+this.activationId);window.location=c},c);c.show({title:this.i18n.noticeLabel,message:this.i18n.errors.loggingIn});this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)},onSignUp:function(a,e){null!=a.error&&""!=a.error?this.errorHandler(a,e):arcgisonline.sharing.geow.Geow.signInHandler(this.newAccount.username,b.hitch(this,this.signIn),b.hitch(this,this.signInError),
a,e)},signIn:function(a,e){this.invitationId?arcgisonline.sharing.geow.Account.getInvitation(this.invitationId,b.hitch(this,this.onInvitationInfo),b.hitch(this,this.onInvitationInfo)):this.activationId?arcgisonline.sharing.geow.Account.activateAccount(this.activationId,b.hitch(this,this.onActivation),b.hitch(this,this.onActivation)):this.routeUser()},signInError:function(a){console.log(a);a=this.i18n.errors.registering+"\x3cbr/\x3e"+this.i18n.errors.caseSensitive;arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.noticeLabel,
message:a});this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)},onActivation:function(a){a&&!a.code&&!a.message?this.geow.signin({username:this.newAccount.username,password:this.newAccount.password,expiration:esriGeowConfig.tokenExpiration},b.hitch(this,this.routeUser),b.hitch(this,this.signInError)):(console.log(a),this.routeUser())},onInvitationInfo:function(a,e){var c;if(a&&a.code&&a.message&&403===a.code){var d="\x3cp\x3e"+this.i18n.invite.cantJoin+
"\x3c/p\x3e",d=d+("\x3cp\x3e"+esri.substitute({a:"\x3ca href\x3d'"+esriGeowConfig.account_edit+"' target\x3d'_blank' style\x3d'text-decoration:underline;'\x3e",aEnd:"\x3c/a\x3e"},this.i18n.invite.editEmail)+"\x3c/p\x3e"),d=d+("\x3cp\x3e"+this.i18n.invite.signInNoJoin+"\x3c/p\x3e");c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c);c.show({title:this.i18n.noticeLabel,message:d})}else if(a&&a.code&&a.message&&
400===a.code)d="\x3cp\x3e"+this.i18n.invite.alreadyAccepted+"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.signInNoJoin+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c),c.show({title:this.i18n.noticeLabel,message:d});else if(a&&a.id&&a.id===this.invitationId){var f="\x3cp\x3e"+esri.substitute({organization:"\x3cstrong\x3e"+a.account.name+"\x3c/strong\x3e"},this.i18n.invite.pendingApproval)+"\x3c/p\x3e",
d="\x3cp\x3e\x3cstrong\x3e"+esri.substitute({organization:a.account.name},this.i18n.invite.joiningOrg)+"\x3c/strong\x3e\x3c/p\x3e\x3cp\x3e\x3cul\x3e",d=d+("\x3cli\x3e"+this.i18n.invite.createdContent+" \x3cstrong\x3e"+this.i18n.invite.adminRights+"\x3c/strong\x3e\x3c/li\x3e"),d=d+("\x3cli\x3e"+this.i18n.signUpWidget.accountManagedMsg+"\x3c/li\x3e"),d=d+("\x3cli\x3e"+this.i18n.signUpWidget.leaveOrganization+"\x3c/li\x3e\x3c/ul\x3e\x3c/p\x3e");c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
c.onOkClick=b.hitch(this,function(c){c.hide();a.mustApprove&&!0===a.mustApprove?(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a){a.hide();arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))},c),c.show({title:this.i18n.noticeLabel,message:f})):arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,b.hitch(this,this.onInvitationAccepted),
b.hitch(this,this.onInvitationAccepted))},c);c.show({title:this.i18n.noticeLabel,message:d})}else this.routeUser()},onInvitationAccepted:function(a,e){var c;if(a&&a.success&&!0===a.success)this.geow.signin({username:this.newAccount.username,password:this.newAccount.password,expiration:esriGeowConfig.tokenExpiration},b.hitch(this,this.routeUser),b.hitch(this,this.signInError));else if(a&&a.code&&a.message&&500===a.code&&"Invitation has already been accepted."===b.trim(a.message)){var d="\x3cp\x3e"+
this.i18n.invite.awaitingApproval+"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.clickToSignIn+"\x3c/p\x3e";c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c);c.show({title:this.i18n.noticeLabel,message:d})}else console.log(a),c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=esriGeowConfig.baseUrl.replace("http:","https:")+
esriGeowConfig.signin},c),a.code&&a.message?c.show({title:this.i18n.unableToJoinLabel,message:a.message}):c.show({title:this.i18n.unableToJoinLabel,message:this.i18n.errors.joiningOrg})},routeUser:function(){var a=this.util.getUser(),e=b.queryToObject(window.location.search.slice(1)).returnUrl;!esriGeowConfig.isDebug&&a&&a.accountId?(esriGeowConfig.self=null,arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,this.routeOrg))):window.location=null!=e?e:this.newUserUrl},routeOrg:function(a,e){var c=
this.util.getUser(),d=b.queryToObject(window.location.search.slice(1)).returnUrl;if(a&&!a.code&&!a.message){var f=a.allSSL;if(d){if(a.urlKey&&a.customBaseUrl){var g=this.util.parseUrl(d).host;-1===g.indexOf(a.urlKey+"."+a.customBaseUrl)&&(c=this.util.getCookie("esri_auth"),d=d.replace(g,a.urlKey+"."+a.customBaseUrl),d=this.util.getBridgeUrl(d,c))}window.location=f?d.replace("http:","https:"):d}else a.urlKey&&a.customBaseUrl?(c=null,-1===window.location.host.indexOf(a.urlKey+"."+a.customBaseUrl)&&
(c=this.util.getCookie("esri_auth")),d=(f?"https:":"http:")+"//"+a.urlKey+"."+a.customBaseUrl,g=esriGeowConfig.baseUrl.indexOf(location.host),d=-1<g?d+(esriGeowConfig.baseUrl.substring(g+location.host.length)+"content.html"):f?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:"),c&&(d=esriGeowConfig.bridgeUrl+"?url\x3d"+d+"\x26exp\x3d"+Math.ceil((new Date(c.expires)-new Date)/1E3)),window.location=d):window.location="account_admin"===c.role&&!a.urlKey?(f?esriGeowConfig.baseUrl.replace("http:",
"https:"):esriGeowConfig.baseUrl.replace("https:","http:"))+"setup.html":f?this.redirectUrl.replace("http:","https:"):this.redirectUrl}else window.location=d?d:this.newUserUrl},isSet:function(a){return a&&null!==a&&0<a.length},notSet:function(a){return!a||null===a||""===a},findRestrictedChars:function(a,b){var c="",d;if(a&&b)for(d=0;d<b.length;d++){var f=b.charAt(d);-1!==a.indexOf(f)&&(" "==f&&(f="spaces"),c=0==c.length?f:c+(" "+f))}return c},findRestrictedPhoneChars:function(a,b){var c="",d;if(a&&
b)for(d=0;d<a.length;d++){var f=a.charAt(d);-1===b.indexOf(f)&&(c+=f+" ")}return c},containsLatinCharset:function(a){return/^[\u0000-\u00FF]+$/g.test(a)},usernameContainsAlphaNumeric:function(a){var b=/^[a-zA-Z0-9@_\.]+$/g;return a&&!!b.test(a)},containsAlphaNumeric:function(a){var b=/^[a-zA-Z0-9@_\.\-]+$/g;return a&&!!b.test(a)},containsAlphaNumericWithSpaces:function(a){var b=/^[a-zA-Z0-9@_\.\-\s]+$/g;return a&&!!b.test(a)},createAccount:function(a,e){this._createAccount.set("disabled",!0);this._createAccount.set("label",
this.i18n.creatingAccountLabel);if(this.accountMode===this.ecasAccountMode){if(esriGeowConfig.proxyServer){var c=esriGeowConfig.proxyServer;-1!==location.protocol.indexOf("https")&&(c=c.replace("http:","https:"));e=c+"?"+e}b.attr(this._form_new_account,"action",e);b.attr(this._form_username,"value",a.username);b.attr(this._form_password,"value",a.password);b.attr(this._form_confirmationPassword,"value",a.confirmPassword);b.attr(this._form_firstName,"value",a.firstName);b.attr(this._form_lastName,
"value",a.lastName);b.attr(this._form_organization,"value",a.organization);b.attr(this._form_email,"value",a.email);b.attr(this._form_phoneNumber,"value",a.phoneNumber);b.attr(this._form_identifyQuestion,"value",a.identifyQuestion);b.attr(this._form_identifyQuestionID,"value",a.identifyQuestionID);b.attr(this._form_identifyAnswer,"value",a.identifyAnswer);b.attr(this._form_ipAddress,"value",this._ipAddress);b.attr(this._form_apiKey,"value",a.apiKey);b.attr(this._form_appID,"value",a.appID);b.attr(this._form_languageCode,
"value",a.languageCode);b.attr(this._form_format,"value","json");b.xhrPost({url:e,form:this._form_new_account,handleAs:"json",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},load:b.hitch(this,this.handleCreateAccount),error:b.hitch(this,this.handleCreateAccount)})}else if(this.accountMode===this.arcgisAccountMode){var c="ja"===b.locale?a.lastName+" "+a.firstName:a.firstName+" "+a.lastName,d={username:a.username,password:a.password,email:a.email,firstName:a.firstName,
lastName:a.lastName,securityQuestionIdx:a.identifyQuestionID,securityAnswer:a.identifyAnswer,provider:this.arcgisAccountMode,usertype:this.userType};"ja"===b.locale&&(d.fullName=c);this.invitationId&&(d.invitationId=this.invitationId);this.activationId&&(d.activationCode=this.activationId);this.signout();this.geow.signup(d,b.hitch(this,this.onSignUp),b.hitch(this,this.handleArcGISAccount))}},signout:function(){esriGeowConfig.userInfo=null;esriGeowConfig.userPreferences=null;b.cookie("esri_auth",null,
{expires:-1,path:"/",domain:document.domain});b.cookie("ESRI_Webmap",null,{expires:-1,path:"/",domain:document.domain});b.publish("onSignOut",[])}});arcgisonline.sharing.dijit.CreateAccount.validation={restrictedCharlist:"'\"\x3c\x3e{}[]#$%^\x26;:/\\",phoneValidChars:"0123456789().-+ "}});