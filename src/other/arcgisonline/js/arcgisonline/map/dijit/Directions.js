// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/map/dijit/Directions",["dijit","dojo","dojox","dojo/require!dojo/has,dijit/_Widget,dijit/_Templated"],function(f,b,l){b.provide("arcgisonline.map.dijit.Directions");b.require("dojo.has");b.require("dijit._Widget");b.require("dijit._Templated");b.declare("arcgisonline.map.dijit.Directions",[f._Widget,f._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv dojoType\x3d"dijit.layout.BorderContainer" region\x3d"top"\x3e \r\n\r\n    \x3cdiv id\x3d"directionsContentHeader" class\x3d"panel panel_left" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" style\x3d"padding: 7px 7px 3px 7px;"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"padding:0;"\x3e\x3ca href\x3d"JavaScript:void(0);" dojoAttachPoint\x3d"_closeBtn" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3cimg src\x3d"images/close.gif" border\x3d"0"/\x3e\x3c/a\x3e\x3c/div\x3e\r\n      \x3cdiv id\x3d"directionsContentTitle" class\x3d"esriFloatLeading panel_title"\x3e${i18n.directionsPanelTitle}\x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\x3c!-- border-bottom: #333 thin solid; --\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"directionsContentPane" dojoType\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-x:hidden;overflow-y:auto;position:relative;padding:0 7px;" class\x3d"scrollPane"\x3e\r\n        \x3cdiv id\x3d"directions-main"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e \r\n   \r\n    \x3cdiv id\x3d"directionsContentFooter" dojoType\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px;"\x3e \r\n      \x3cdiv class\x3d"footer" id\x3d"directionsSiteFooter" dojotype\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
i18n:null,directions:null,container:null,numCurrentLegendRequests:0,intervalTimer:null,needsRefresh:!1,directionsSaveAsButton:null,_eventConnections:[],symbolSetJson:null,constructor:function(a,b){null!==a&&a.containerNode&&(this.container=a.containerNode)},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").directionsPanel)},postCreate:function(){this.container.addChild(f.byId("directionsPanel"));
this.loadConnections()},clear:function(){this.directions&&this.directions.reset()},loadConnections:function(){b.connect(f.byId("leftContentPanel"),"resize",this,"adjustHeight");b.connect(this._closeBtn,"onclick",this,"onClose");if(esri.isTouchEnabled){var a=b.query(".scrollPane",this.domNode)[0],a=esri.setScrollable(a);this._eventConnections.push(a[0],a[1])}},onClose:function(a){a.preventDefault();arcgisonline.map.leftPanel.hideLeftContentPanel()},destroy:function(){this.inherited(arguments);b.forEach(this._eventConnections,
b.disconnect)},loadContent:function(){this.loadDirections();setTimeout(function(){f.byId("directionsPanel").adjustHeight()},100)},loadDirections:function(a){if(this.directions){if(a&&a.geocodeResult)this.directions.updateStop(a.geocodeResult,this.calculateStopIndex());else if(a&&a.feature){var d=this.calculateStopIndex();if(a.feature.attributes.displayName){var c=new esri.geometry.Extent(a.feature.geometry.x-1E-4,a.feature.geometry.y-1E-4,a.feature.geometry.x+1E-4,a.feature.geometry.y+1E-4,a.feature.geometry.spatialReference);
this.directions.updateStop({extent:c,name:a.feature.attributes.displayName,feature:a.feature},d)}else this.directions.updateStop(a.feature,d)}else a&&a.features&&(this.directions.set("optimalRoute",a&&a.features&&!a.hasSequence?!0:!1),this.processFeatures(a));this.disableSaveButton()}else{d=arcgisonline.map.geocode.createSearchOptions("directions");d.autoNavigate=!1;c={};c.directionsLanguage=b.locale;c.directionsLengthUnits="metric"===arcgisonline.map.main.scaleBarUnits?esri.Units.KILOMETERS:esri.Units.MILES;
b.byId("directions-main")||b.create(e,{id:"directions-main"},"directionsContentPane");e=esriGeowConfig.self.helperServices.traffic&&esriGeowConfig.self.helperServices.traffic.url?new esri.layers.ArcGISDynamicMapServiceLayer(esriGeowConfig.self.helperServices.traffic.url,{opacity:0.4}):null;this.directions=new esri.dijit.Directions({map:arcgisonline.map.main.map,routeTaskUrl:esriGeowConfig.self.helperServices.route.url,trafficLayer:e,mapClickActive:!0,showTrafficOption:e?!0:!1,searchOptions:d,routeParams:c,
optimalRoute:a&&a.features&&!a.hasSequence?!0:!1,showClearButton:!0,hideTruckingMode:!1,showMilesKilometersOption:!1,showTravelModesOption:!0,hideFastestShortestOption:!0,alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",maxStops:9>b.has("ie")?20:50},"directions-main");b.addClass(b.query(".esriStopsGetDirections",f.byId("directionsPanel").domNode)[0],"btn calcite small blue");b.addClass(b.query(".esriStopsClearDirections",f.byId("directionsPanel").domNode)[0],"btn calcite small transparent");var e=b.query(".esriStopsGetDirectionsContainer",
f.byId("directionsPanel").domNode)[0];arcgisonline.map.role.isAllowed("directions_addAsLayer")&&(this.directionsSaveAsButton=b.create("div",{role:"button","class":"esriStopsGetDirections btn calcite small light",innerHTML:this.i18n.saveButton},e,2),this.disableSaveButton(),b.connect(this.directionsSaveAsButton,"onclick",b.hitch(this,"onSaveInMap")),b.connect(this.directions,"onDirectionsFinish",b.hitch(this,function(){"directionsStack"!==arcgisonline.map.leftPanel.getLeftContentPanelStack()?this.directions.reset():
this.directions.directions&&this.enableSaveButton()})),b.connect(this.directions,"onDirectionsStart",b.hitch(this,function(){this.disableSaveButton()})),b.connect(this.directions,"onDirectionsClear",b.hitch(this,function(){this.disableSaveButton()})));this.directions.startup();var g=b.connect(this.directions,"onLoad",b.hitch(this,function(){b.disconnect(g);if(a&&a.geocodeResult)this.directions.updateStop(a.geocodeResult,this.calculateStopIndex());else if(a&&a.feature){var c=this.calculateStopIndex();
if(a.feature.attributes.displayName){var d=new esri.geometry.Extent(a.feature.geometry.x-1E-4,a.feature.geometry.y-1E-4,a.feature.geometry.x+1E-4,a.feature.geometry.y+1E-4,a.feature.geometry.spatialReference);this.directions.updateStop({extent:d,name:a.feature.attributes.displayName,feature:a.feature},c)}else this.directions.updateStop(a.feature,c)}else a&&a.features&&this.processFeatures(a)}))}},calculateStopIndex:function(){if(this.directions&&this.directions.stops){for(var a=0;a<this.directions.stops.length;a++)if(!this.directions.stops[a].name.toString().length)return a;
a=this.directions.stops.length;this.directions.addStop("",a);return a}return 0},processFeatures:function(a){var d=null;b.forEach(a.features,function(a,b){if(d){var g=new esri.geometry.Extent(a.geometry.x-1E-4,a.geometry.y-1E-4,a.geometry.x+1E-4,a.geometry.y+1E-4,a.geometry.spatialReference);d=d.union(g)}else d=new esri.geometry.Extent(a.geometry.x-1E-4,a.geometry.y-1E-4,a.geometry.x+1E-4,a.geometry.y+1E-4,a.geometry.spatialReference)});b.forEach(a.features,function(a,b){1<b&&this.directions.addStop("",
b);a.attributes.displayName?this.directions.updateStop({extent:d,name:a.attributes.displayName,feature:a},b):this.directions.updateStop(a,b)},this)},adjustHeight:function(a){if(!("undefined"==typeof leftPanel||"directionsStack"!=leftPanel.visibleStack)){a=b.coords(b.byId("leftPanelDiv")).h;var d=b.coords(b.byId("directionsContentHeader")).h,c=b.coords(b.byId("directionsSiteFooter_links")).h+10;b.style(b.byId("directionsContentFooter"),"height",c+"px");b.style(b.byId("directionsContentPane"),"height",
a-(d+c)+"px")}},onSaveInMap:function(){this.symbolSetJson?this.createMapLayer():this.getSymbolListGroup().then(b.hitch(this,function(a){this.symbolSetJson=a;this.createMapLayer()}),b.hitch(this,function(){this.createMapLayer()}))},createMapLayer:function(){if(!this.saveButtonDisabled){var a={id:"route_"+Math.floor(10001*Math.random()),type:"user",title:this.directions.directions.routeName,defaultVisibility:!0,defaultOpacity:1,snippet:"",showLegend:!0,visibility:!0,identify:!1,layers:[],visibleLayers:"0,2",
__createDefaultPopup:!0};this.addDirectionsToMap(a);this.addRouteToMap(a);this.addStopsToMap(a);var d=arcgisonline.map.layer.getLayerPosition(a);arcgisonline.map.main.mapLayers.splice(d.list,0,a);arcgisonline.map.main.map.addLayers(a.layers);a=arcgisonline.map.featColl.getFullExtent(a);a=arcgisonline.map.main.getNewMapExtent(a);a.zoomMap&&arcgisonline.map.main.map.setExtent(a.extent.expand(1.25),!0);"contentStack"!==arcgisonline.map.leftPanel.getLeftContentPanelStack()?arcgisonline.map.leftPanel.openLeftTOCPanel():
b.publish("onLayerUpdate",[""]);arcgisonline.map.main.markMapAsChanged("saveRoute")}},disableSaveButton:function(){b.addClass(this.directionsSaveAsButton,"disabled");this.saveButtonDisabled=!0},enableSaveButton:function(){b.removeClass(this.directionsSaveAsButton,"disabled");this.saveButtonDisabled=!1},getRedPinUrl:function(){return arcgisonline.sharing.util.getStaticImagesUrl()+"/Symbols/Basic/RedStickpin.png"},addStopsToMap:function(a){var d=0,c=this.generateFeatureCollectionTemplateStops();c.layerDefinition.fields.push(this.createField("Name",
this.i18n.stops.name,"string",!0));c.layerDefinition.fields.push(this.createField("StopId","StopId","string",!0));c.layerDefinition.fields.push(this.createField("SolveId","SolveId","integer",!1));c.layerDefinition.fields.push(this.createField("Sequence",this.i18n.stops.Sequence,"integer",!1));c.layerDefinition.fields.push(this.createField("Addr_Type",this.i18n.stops.Addr_Type,"string",!1));c.layerDefinition.fields.push(this.createField("Score",this.i18n.stops.Score,"integer",!1));c.layerDefinition.fields.push(this.createField("TimeWindowStart",
this.i18n.stops.TimeWindowStart,"date",!1));c.layerDefinition.fields.push(this.createField("TimeWindowEnd",this.i18n.stops.TimeWindowEnd,"date",!1));c.layerDefinition.fields.push(this.createField("ArriveTime",this.i18n.stops.ArriveTime,"date",!1));c.layerDefinition.fields.push(this.createField("DepartTime",this.i18n.stops.DepartTime,"date",!1));c.layerDefinition.fields.push(this.createField("Status",this.i18n.stops.Status,"integer",!1,{type:"codedValue",name:"dStatus",codedValues:[{name:this.i18n.stops.statusDomains.esriNAObjectStatusOK,
code:0},{name:this.i18n.stops.statusDomains.esriNAObjectStatusNotLocated,code:1},{name:this.i18n.stops.statusDomains.esriNAObjectStatusElementNotLocated,code:2},{name:this.i18n.stops.statusDomains.esriNAObjectStatusElementNotTraversable,code:3},{name:this.i18n.stops.statusDomains.esriNAObjectStatusInvalidFieldValues,code:4},{name:this.i18n.stops.statusDomains.esriNAObjectStatusNotReached,code:5},{name:this.i18n.stops.statusDomains.esriNAObjectStatusTimeWindowViolation,code:6}]}));var e=arcgisonline.map.featColl.generateDefaultPopupInfo(c),
g=!1;b.forEach(this.directions.stops,function(a,b){var e={};e.__OBJECTID=d++;e.Name=a.name;var h=Math.floor(b/26),f=b%26,h=(0<h?String.fromCharCode(65+(h-1)):"")+String.fromCharCode(65+f);e.StopId=h;e.SolveId=1;e.Sequence=b+1;e.Addr_Type=a.feature.attributes.Addr_Type;e.Score=a.feature.attributes.Score;e.TimeWindowStart=null;e.TimeWindowEnd=null;e.ArriveTime=null;e.DepartTime=null;e.Status=0;var h=a.feature.attributes.displayName,f=a.feature.attributes.objectIdInLayer,k=a.feature.attributes.layerName;
if(h||esri.isDefined(f)||k)g||(c.layerDefinition.fields.push(this.createField("displayName",this.i18n.stops.displayName,"string",!0)),c.layerDefinition.fields.push(this.createField("layerName",this.i18n.stops.layerName,"string",!1)),c.layerDefinition.fields.push(this.createField("objectIdInLayer",this.i18n.stops.objectIdInLayer,"integer",!1)),g=!0),e.displayName=h?h:"",e.objectIdInLayer=f?f:"",e.layerName=k?k:"";e={geometry:a.feature.geometry.toJson(),attributes:e};c.featureSet.features.push(e)},
this);c.layerDefinition.name=this.i18n.stopsLayerName;c.layerDefinition.extent=this.directions.directions.extent.toJson();if(this.symbolSetJson){var k=new esri.renderer.UniqueValueRenderer(new esri.symbol.SimpleMarkerSymbol,"StopId");b.forEach(this.directions.stops,function(a,b){for(var d=Math.floor(b/26),c=b%26,d=(0<d?String.fromCharCode(65+(d-1)):"")+String.fromCharCode(65+c),c=null,e=0;e<this.symbolSetJson.length;e++){var g=this.symbolSetJson[e];if(0==b){if(g.name=="green"+d){c=esri.symbol.fromJson(this.symbolSetJson[e]);
break}}else if(b==this.directions.stops.length-1){if(g.name=="red"+d){c=esri.symbol.fromJson(this.symbolSetJson[e]);break}}else if(g.name=="blue"+d){c=esri.symbol.fromJson(this.symbolSetJson[e]);break}}c&&k.addValue({value:d,symbol:c,label:a.name||d})},this);c.layerDefinition.drawingInfo.renderer=k.toJson()}var f=new esri.layers.FeatureLayer(c,{infoTemplate:new esri.dijit.PopupTemplate(e),id:a.id+"_2",outFields:["*"],visible:!0,opacity:1,displayOnPan:9>b.isIE?!1:!0});a.onError=b.connect(f,"onError",
b.hitch(arcgisonline.map.layer,"layerOnErrorHandler",a));f.__popupInfo=e;a.layers[2]=f},addRouteToMap:function(a){var d=this.generateFeatureCollectionTemplateRoute();d.layerDefinition.fields.push(this.createField("Name",this.i18n.route.name,"string",!0));d.layerDefinition.fields.push(this.createField("totalDriveTime",this.i18n.route.totalDriveTimeInMin,"double",!0));d.layerDefinition.fields.push(this.createField("totalLength","metric"===arcgisonline.map.main.scaleBarUnits?this.i18n.route.totalLengthInKM:
this.i18n.route.totalLengthInMiles,"double",!0));d.layerDefinition.fields.push(this.createField("totalTime",this.i18n.route.totalTime,"double",!0));var c=arcgisonline.map.featColl.generateDefaultPopupInfo(d),e={__OBJECTID:0};e.Name=this.directions.directions.routeName;e.totalDriveTime=this.directions.directions.totalDriveTime;e.totalLength=this.directions.directions.totalLength;e.totalTime=this.directions.directions.totalTime;e={geometry:this.directions.mergedRouteGraphic.geometry.toJson(),attributes:e};
d.featureSet.features.push(e);d.layerDefinition.name=this.i18n.routeLayerName;d.layerDefinition.extent=this.directions.directions.extent.toJson();d=new esri.layers.FeatureLayer(d,{infoTemplate:new esri.dijit.PopupTemplate(c),id:a.id+"_1",outFields:["*"],visible:!1,opacity:1,displayOnPan:9>b.isIE?!1:!0});a.onError=b.connect(d,"onError",b.hitch(arcgisonline.map.layer,"layerOnErrorHandler",a));d.__popupInfo=c;a.layers[1]=d},addDirectionsToMap:function(a){var d=this.generateFeatureCollectionTemplateDirections();
d.layerDefinition.fields.push(this.createField("SolveId","SolveId","integer",!1));d.layerDefinition.fields.push(this.createField("Name",this.i18n.route.name,"string",!0));d.layerDefinition.fields.push(this.createField("time",this.i18n.directions.time,"double",!0));d.layerDefinition.fields.push(this.createField("length","metric"===arcgisonline.map.main.scaleBarUnits?this.i18n.directions.lengthInKM:this.i18n.directions.lengthInMiles,"double",!0));d.layerDefinition.fields.push(this.createField("ETA",
this.i18n.directions.ETA,"date",!1));d.layerDefinition.fields.push(this.createField("maneuverType",this.i18n.directions.maneuverType,"string",!1));d.layerDefinition.fields.push(this.createField("text",this.i18n.directions.text,"string",!0));d.layerDefinition.fields.push(this.createField("formattedText",this.i18n.directions.formattedText,"string",!1));d.layerDefinition.fields.push(this.createField("step",this.i18n.directions.step,"integer",!1));var c=arcgisonline.map.featColl.generateDefaultPopupInfo(d),
e=0;b.forEach(this.directions.directions.features,function(a,b){var c={};c.__OBJECTID=e++;c.SolveId=1;c.Name=this.directions.directions.routeName;for(var g in a.attributes)c[g]=a.attributes[g];c.step=b+1;a={geometry:a.geometry.toJson(),attributes:c};d.featureSet.features.push(a)},this);c=arcgisonline.map.featColl.generateDefaultPopupInfo(d);d.layerDefinition.name=this.i18n.directionsLayerName;d.layerDefinition.extent=this.directions.directions.extent.toJson();var g=new esri.layers.FeatureLayer(d,
{infoTemplate:new esri.dijit.PopupTemplate(c),id:a.id+"_0",outFields:["*"],visible:!0,opacity:1,displayOnPan:9>b.isIE?!1:!0});a.onError=b.connect(g,"onError",b.hitch(arcgisonline.map.layer,"layerOnErrorHandler",a));g.__popupInfo=c;a.layers[0]=g},generateFeatureCollectionTemplateStops:function(){var a={layerDefinition:null,featureSet:{features:[],geometryType:"esriGeometryPoint"}};a.layerDefinition={geometryType:"esriGeometryPoint",objectIdField:"__OBJECTID",type:"Feature Layer",typeIdField:"",drawingInfo:{renderer:{type:"simple",
symbol:{type:"esriPMS",url:this.getRedPinUrl(),imageData:"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",
contentType:"image/png",width:20,height:20,xoffset:0,yoffset:10}},fixedSymbols:!0},fields:[{name:"__OBJECTID",alias:"OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1,domain:null}],types:[],capabilities:"Query"};return a},generateFeatureCollectionTemplateRoute:function(){return{layerDefinition:null,featureSet:{features:[],geometryType:"esriGeometryPolyline"},layerDefinition:{geometryType:"esriGeometryPolyline",objectIdField:"__OBJECTID",type:"Feature Layer",typeIdField:"",drawingInfo:{renderer:{type:"simple",
symbol:{type:"esriSLS",style:"esriSLSSolid",color:[0,138,234,255],width:3},label:"",description:""},transparency:0,labelingInfo:null,fixedSymbols:!0},fields:[{name:"__OBJECTID",alias:"OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1,domain:null}],types:[],capabilities:"Query"}}},generateFeatureCollectionTemplateDirections:function(){return{layerDefinition:null,featureSet:{features:[],geometryType:"esriGeometryPolyline"},layerDefinition:{geometryType:"esriGeometryPolyline",objectIdField:"__OBJECTID",
type:"Feature Layer",typeIdField:"",drawingInfo:{renderer:{type:"simple",symbol:{type:"esriSLS",style:"esriSLSSolid",color:[0,69,117,255],width:3},label:"",description:""},transparency:0,labelingInfo:null,fixedSymbols:!0},fields:[{name:"__OBJECTID",alias:"OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1,domain:null}],types:[],capabilities:"Query"}}},createField:function(a,b,c,e,g){return"integer"===c?{name:a,alias:b,type:"esriFieldTypeInteger",editable:!0,nullable:!0,visible:e?!0:!1,domain:g}:
"double"===c?{name:a,alias:b,type:"esriFieldTypeDouble",editable:!0,nullable:!0,visible:e?!0:!1,domain:g}:"date"===c?{name:a,alias:b,type:"esriFieldTypeDate",length:36,editable:!0,nullable:!0,visible:e?!0:!1,domain:g}:{name:a,alias:b,type:"esriFieldTypeString",length:255,editable:!0,nullable:!0,visible:e?!0:!1,domain:g}},getSymbolListGroup:function(){var a=new b.Deferred,d=function(){console.log("Error retrieving symbol set group.");a.errback()};arcgisonline.sharing.geow.Community.searchGroups(esriGeowConfig.symbolSetsGroupQuery,
b.hitch(this,function(b,e){b&&b.results&&0<b.results.length?this.getSymbolListItems(b.results[0].id,a):d()}),b.hitch(this,d));return a},getSymbolListItems:function(a,d){var c=esriGeowConfig.restBaseUrl+"search?num\x3d20\x26q\x3dgroup:"+a+' AND type:"Symbol Set"',c="vml"===l.gfx.renderer?c+' AND -typekeywords:"by value"':c+' AND ((typekeywords:"by value" AND typekeywords:"marker") OR typekeywords:"fill" OR typekeywords:"line")',e=function(a){console.log(a?a:"Error retrieving Symbol Set items.");d.errback()};
arcgisonline.sharing.util.getJson(c,b.hitch(this,function(a,b){if(a.results&&0<a.results.length){for(var c=!1,f=0;f<a.results.length;f++)if("AtoZ"==a.results[f].name){c=!0;this.getSymbolListData(a.results[f],d);break}c||e("Symbol Set not found.")}else e("No Symbol Set found.")}),b.hitch(this,e))},getSymbolListData:function(a,d){var c=function(){console.log("Error retrieving Symbol Set data.");d.errback()};arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"/content/items/"+a.id+"/data",
b.hitch(this,function(a,b){a&&a.length?d.callback(a):c()}),b.hitch(this,c))}})});