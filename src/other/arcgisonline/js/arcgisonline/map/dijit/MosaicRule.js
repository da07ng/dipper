// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/map/dijit/MosaicRule",["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,esri/dijit/MosaicRule"],function(c,a,f){a.provide("arcgisonline.map.dijit.MosaicRule");a.require("dijit._Widget");a.require("dijit._Templated");a.require("esri.dijit.MosaicRule");a.declare("arcgisonline.map.dijit.MosaicRule",[c._Widget,c._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv dojoType\x3d"dijit.layout.BorderContainer" region\x3d"top"\x3e \r\n    \x3cdiv id\x3d"mosaicRuleContentHeader" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" class\x3d"panel panel_left"\x3e\r\n        \x3cdiv class\x3d"esriFloatTrailing" style\x3d"padding:0;"\x3e\r\n            \x3ca href\x3d"#" dojoAttachPoint\x3d"_closeBtn" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\r\n            \x3cimg src\x3d"images/close.gif" border\x3d"0"/\x3e\x3c/A\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"mosaicRuleContentTitle" class\x3d"esriFloatLeading" style\x3d"font-weight:bold;"\x3e\r\n            ${i18n.mosaicRuleDefaultTitle}\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both; border-bottom: #333 thin solid; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"mosaicRuleContentPane" dojoType\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-x:hidden;overflow-y:auto;position:relative;" class\x3d"scrollPane"\x3e\r\n        \x3cp id\x3d"mosaicRulePanelTitle" style\x3d"margin:4px 0px 10px 0px;"\x3e\r\n            ${i18n.mosaicRulePanelTitle}\r\n        \x3c/p\x3e\r\n        \x3cp style\x3d"margin:4px 0px 10px 0px;"\x3e\r\n            ${i18n.mosaicRuleTitleMessage}\r\n        \x3c/p\x3e             \r\n        \x3cdiv id\x3d"mosaicRule-main"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \r\n    \x3cdiv id\x3d"mosaicRuleContentButtons" style\x3d"padding:5px;"\x3e\r\n        \x3ccenter\x3e\r\n        \x3cbutton dojoType\x3d"dijit.form.Button" dojoAttachPoint\x3d"_applyMosaicRule" class\x3d"calcite blue"\x3e\r\n            ${i18n.applyLabel}\r\n        \x3c/button\x3e\r\n        \x3cbutton dojoType\x3d"dijit.form.Button" dojoAttachPoint\x3d"_resetMosaicRule" class\x3d"calcite light"\x3e\r\n            ${i18n.resetLabel}\r\n        \x3c/button\x3e        \r\n        \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"submit" dojoAttachPoint\x3d"_closeMosaicRule" class\x3d"calcite transparent"\x3e\r\n            ${i18n.closeLabel}\r\n        \x3c/button\x3e\r\n        \x3c/center\x3e\r\n    \x3c/div\x3e\r\n   \r\n    \x3cdiv id\x3d"mosaicRuleContentFooter" dojoType\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px; display:none;"\x3e \r\n      \x3cdiv class\x3d"footer" id\x3d"mosaicRuleSiteFooter" dojotype\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
i18n:null,mapLayer:null,mosaicRule:null,container:null,numCurrentLegendRequests:0,intervalTimer:null,needsRefresh:!1,_eventConnections:[],constructor:function(a,d){a&&(a.containerNode&&(this.container=a.containerNode),this.subLayerId=a.subLayerId,this.mapLayer=a.mapLayer)},postMixInProperties:function(){this.inherited(arguments);this.i18n=a.i18n.getLocalization("arcgisonline","arcgisonline").common;a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline","arcgisonline").mosaicRulePanel)},postCreate:function(){this.container.addChild(c.byId("mosaicRulePanel"));
isEmbedded||a.style(a.byId("mosaicRuleContentFooter"),"display","");this.loadConnections()},loadConnections:function(){a.connect(c.byId("leftContentPanel"),"resize",this,"adjustHeight");a.connect(this._applyMosaicRule,"onClick",a.hitch(this,"_onApply"));a.connect(this._resetMosaicRule,"onClick",a.hitch(this,"_onReset"));a.connect(this._closeBtn,"onclick",a.hitch(this,"_onClose",!1));a.connect(this._closeMosaicRule,"onClick",a.hitch(this,"_onClose",!1));if(esri.isTouchEnabled){var b=a.query(".scrollPane",
this.domNode)[0],b=esri.setScrollable(b);this._eventConnections.push(b[0],b[1])}},destroy:function(){this.inherited(arguments);a.forEach(this._eventConnections,a.disconnect)},loadContent:function(){this.loadMosaicRule();setTimeout(function(){c.byId("mosaicRulePanel").adjustHeight()},100)},loadMosaicRule:function(){this.mosaicRule=new esri.dijit.MosaicRule({layer:this.mapLayer.layer,map:arcgisonline.map.main.map,hideApplyButton:!0,hideLockRasterSelectionIdButton:!0},"mosaicRule-main");this._changeDialogTitle(this.mapLayer);
this.mosaicRule.startup();a.subscribe("onLayerUpdate",null,a.hitch(this,"_updateMosaicRule"))},_setMapLayerAttr:function(a){this.inherited(arguments);this.mapLayer=a;this._changeDialogTitle(this.mapLayer);this.mosaicRule&&this.mosaicRule.set("layer",this.mapLayer.layer)},_onApply:function(){this.mapLayer.mosaicRuleChanged=!0;a.publish("onMosaicRuleApply")},_onReset:function(){this.mapLayer.mosaicRuleChanged=!0;a.publish("onMosaicRuleReset")},_updateMosaicRule:function(a){leftPanel&&("undefined"==
typeof leftPanel||"mosaicrulestack"!==leftPanel.visiblestack)?this.needsrefresh=!0:(this.mosaicRule&&this.mosaicRule.set("layer",a),this.needsRefresh=!1)},_onClose:function(b,d){d.preventDefault();a.byId("mosaicRuleContentPane").scrollTop=0;b&&this.save();arcgisonline.map.leftPanel.openLeftTOCPanel()},_changeDialogTitle:function(b){var d=a.byId("mosaicRulePanelTitle");d&&(b&&b.title)&&(d.innerHTML=this.i18n.mosaicRulePanelTitle+" "+b.title)},adjustHeight:function(b){if(!("undefined"==typeof leftPanel||
"mosaicRuleStack"!=leftPanel.visibleStack)){b=a.coords(a.byId("leftPanelDiv")).h;var d=a.coords(a.byId("mosaicRuleContentHeader")).h,c=a.coords(a.byId("mosaicRuleSiteFooter_links")).h+25,e=c+a.coords(a.byId("mosaicRuleContentButtons")).h;a.style(a.byId("mosaicRuleContentFooter"),"height",c+"px");a.style(a.byId("mosaicRuleContentPane"),"height",b-(d+e)+"px")}}})});