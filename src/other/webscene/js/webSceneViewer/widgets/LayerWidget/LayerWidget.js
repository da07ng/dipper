// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
define(["esri/core/declare","dojo/dom-class","dojo/on","dijit/_WidgetBase","./LayerItem"],function(c,e,d,f,g){return c([f],{view:void 0,_layerItems:void 0,_onHandles:void 0,map:void 0,constructor:function(a,b){this._layerItems=[];this._onHandles=[]},destroy:function(){this._onHandles.forEach(function(a){a.remove()});this._onHandles.length=0;this._destroyAllLayerItems()},postMixInProperties:function(){this.map=this.view.map},postCreate:function(){this._init();this.startup()},_init:function(){e.add(this.domNode,
"LayerWidget");this._setupAllLayerItems();var a=d(this.map,"layer-add",function(a){this.reload()}.bind(this)),b=d(this.map,"layer-remove",function(a){this.reload()}.bind(this)),c=d(this.map,"layer-reorder",function(a){this.reload()}.bind(this));this._onHandles.push(a);this._onHandles.push(b);this._onHandles.push(c)},reload:function(){this._destroyAllLayerItems();this._setupAllLayerItems()},_destroyAllLayerItems:function(){for(var a=0;a<this._layerItems.length;a++)this._layerItems[a].destroy();this._layerItems.length=
0},_setupAllLayerItems:function(){for(var a=this.map.layers.get("length")-1;0<=a;a--){var b=this.map.layers.getItemAt(a);"SilentContentLayer"===b.id||"__basemapErrorFallbackLayer__"===b.id||this._addLayerItem(b)}},_addLayerItem:function(a){var b=this._createLayerItem(a);b.placeAt(this.domNode,this.map.layers.get("length")-this.map.layers.indexOf(a)-1);this._layerItems.push(b)},_removeLayerItem:function(a){for(var b=0;b<this._layerItems.length;b++)this._layerItems[b].layer===a&&(this._layerItems[b].destroy(),
this._layerItems.splice(b,1))},_createLayerItem:function(a){return new g({view:this.view,layer:a,layerWidget:this})}})});