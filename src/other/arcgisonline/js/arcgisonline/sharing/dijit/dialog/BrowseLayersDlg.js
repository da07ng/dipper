// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/dialog/BrowseLayersDlg",["dijit","dojo","dojox","dojo/require!dijit/Dialog,arcgisonline/sharing/util,arcgisonline/sharing/dijit/LayersGrid,dijit/_Widget,dijit/_Templated"],function(c,b,d){b.provide("arcgisonline.sharing.dijit.dialog.BrowseLayersDlg");b.require("dijit.Dialog");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.LayersGrid");b.require("dijit._Widget");b.require("dijit._Templated");b.declare("arcgisonline.sharing.dijit.dialog.BrowseLayersDlg",
[c._Widget,c._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"browse-layers-dialog" title\x3d"${i18n.title}" execute\x3d""\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"formNode" class\x3d"esriItemLinks dijitDialogPaneContentArea"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"margin: 0 5px 5px 5px; clear:both;"\x3e\r\n        \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput id\x3d"browse-layers-esri" dojoAttachPoint\x3d"_onlyEsriCheck" data-dojo-attach-event\x3d"onChange:onEsriCheckChanged" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox" /\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                \x26nbsp;\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                \x3clabel for\x3d"browse-layers-esri"\x3e${i18n.showEsriLayersOnly}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput id\x3d"browse-layers-extent" dojoAttachPoint\x3d"_mapExtentCheck" data-dojo-attach-event\x3d"onChange:onExtentCheckChanged" dojotype\x3d"dijit.form.CheckBox" checked\x3d"true" type\x3d"checkbox" /\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                \x26nbsp;\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                \x3clabel for\x3d"addContent-within-map"\x3e${i18n.withinMapArea}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"browse-layers-extent" style\x3d"border:#333 1px solid; width:565px; min-height:330px; padding:0; overflow:hidden; clear:both;"\x3e\r\n        \r\n        \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1" style\x3d"width:250px; margin-top:10px;"\x3e\r\n          \x3cselect id\x3d"browse-layers-category-select" dojoAttachPoint\x3d"_categorySelect" dojoType\x3d"dijit.form.Select" sortByLabel\x3d"false" maxHeight\x3d\'350\' style\x3d"width:240px;"\x3e\r\n          \x3c/select\x3e\r\n        \x3c/div\x3e\r\n        \r\n        \x3cdiv class\x3d"search esriFloatTrailing esriTrailingMargin1" style\x3d"width:250px;"\x3e\r\n          \x3cdiv id\x3d"search-form" style\x3d"position:relative;"\x3e\r\n            \x3cinput class\x3d"esriSearchBox" type\x3d"text" dojoType\x3d"dijit.form.TextBox" trim\x3d"true" id\x3d"browse-layers-search-box" dojoAttachPoint\x3d"searchText" dojoAttachEvent\x3d"onKeyPress:_onSearchKeyPress,onFocus:_onSearchBoxFocus,onBlur:_onSearchBoxBlur" alt\x3d"${i18n.searchFor}" title\x3d"${i18n.searchFor}" /\x3e\r\n            \x3cbutton class\x3d"esriLeadingMargin13 esriSearchButton" id\x3d"search-box_submit" alt\x3d"${i18n.searchTitle}" title\x3d"${i18n.searchTitle}" dojoAttachPoint\x3d"searchButton" dojoAttachEvent\x3d"onclick:_onSearchClick" \x3e\x26nbsp;\x26nbsp;\x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n  \r\n        \x3cdiv style\x3d"position:relative; width:565px;clear:both;" dojoAttachPoint\x3d"esriMapLayersGallery" id\x3d"esriMapLayersGallery" dojoType\x3d"arcgisonline.sharing.dijit.LayersGrid" galleryNodes\x3d"8"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"submitButtons dijitDialogPaneActionBar esriPositionRight0"\x3e\r\n      \x3cinput id\x3d"browse-layers-close" dojoType\x3d"dijit.form.Button" name\x3d"cancel" class\x3d"cancel esriFloatTrailing" type\x3d"button" dojoAttachEvent\x3d"onClick:onClose" label\x3d"${i18n.close}"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.BrowseLayersDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline").common);this.i18n=b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").search);this.i18n=b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").BrowseLayersDlg);this.searchBoxTip=
this.i18n.searchBoxTip},postCreate:function(){var a=[];a.push({label:this.i18n.categoryAll,category:this.i18n.categoryAll,subCategory:null,tagsQuery:""});a.push({label:this.i18n.categoryImagery,category:this.i18n.categoryImagery,subCategory:null,tagsQuery:"tags:imagery"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryBasemapImagery,category:this.i18n.categoryImagery,subCategory:this.i18n.subCategoryBasemapImagery,tagsQuery:"tags:baseimagery"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+
this.i18n.subCategoryMultiSpectral,category:this.i18n.categoryImagery,subCategory:this.i18n.subCategoryMultiSpectral,tagsQuery:"tags:multispectral"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryTemporal,category:this.i18n.categoryImagery,subCategory:this.i18n.subCategoryTemporal,tagsQuery:"tags:temporal"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryEvent,category:this.i18n.categoryImagery,subCategory:this.i18n.subCategoryEvent,tagsQuery:"tags:event_imagery"});
a.push({label:this.i18n.categoryBasemaps,category:this.i18n.categoryBasemaps,subCategory:null,tagsQuery:"tags:basemaps"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryEsriBasemaps,category:this.i18n.categoryBasemaps,subCategory:this.i18n.subCategoryEsriBasemaps,tagsQuery:"tags:esri_basemap"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryPartnerBasemaps,category:this.i18n.categoryBasemaps,subCategory:this.i18n.subCategoryPartnerBasemaps,tagsQuery:"tags:partner_basemap"});
a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryUserBasemaps,category:this.i18n.categoryBasemaps,subCategory:this.i18n.subCategoryUserBasemaps,tagsQuery:"tags:user_basemap"});a.push({label:this.i18n.categoryHistoricalMaps,category:this.i18n.categoryHistoricalMaps,subCategory:null,tagsQuery:"tags:historical"});a.push({label:this.i18n.categoryDemographics,category:this.i18n.categoryDemographics,subCategory:null,tagsQuery:"tags:demographics"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+
this.i18n.subCategoryIncome,category:this.i18n.categoryDemographics,subCategory:this.i18n.subCategoryIncome,tagsQuery:"tags:income"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategorySpending,category:this.i18n.categoryDemographics,subCategory:this.i18n.subCategorySpending,tagsQuery:"tags:spending OR tags:behaviors"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryPopulation,category:this.i18n.categoryDemographics,subCategory:this.i18n.subCategoryPopulation,
tagsQuery:"tags:population OR tags:housing"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategorySegmentation,category:this.i18n.categoryDemographics,subCategory:this.i18n.subCategorySegmentation,tagsQuery:"tags:segmentation"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryBusiness,category:this.i18n.categoryDemographics,subCategory:this.i18n.subCategoryBusiness,tagsQuery:"tags:business OR tags:jobs"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+
this.i18n.subCategoryPoverty,category:this.i18n.categoryDemographics,subCategory:this.i18n.subCategoryPoverty,tagsQuery:'tags:"at risk" OR tags:poverty'});a.push({label:this.i18n.categoryLandscape,category:this.i18n.categoryLandscape,subCategory:null,tagsQuery:"tags:landscape"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryClimate,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategoryClimate,tagsQuery:"tags:climate OR tags:weather"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+
this.i18n.subCategoryEcology,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategoryEcology,tagsQuery:"tags:ecology"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategorySpecies,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategorySpecies,tagsQuery:"tags:species"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryDisturbance,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategoryDisturbance,tagsQuery:"tags:disturbance"});
a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryElevation,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategoryElevation,tagsQuery:"tags:elevation"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryLand,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategoryLand,tagsQuery:"tags:landcover"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryHazards,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategoryHazards,
tagsQuery:"tags:hazards"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryOceans,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategoryOceans,tagsQuery:"tags:oceans"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategorySoils,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategorySoils,tagsQuery:"tags:soils OR tags:geology"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategorySubsurface,category:this.i18n.categoryLandscape,
subCategory:this.i18n.subCategorySubsurface,tagsQuery:"tags:subsurface"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryWater,category:this.i18n.categoryLandscape,subCategory:this.i18n.subCategoryWater,tagsQuery:"tags:water"});a.push({label:this.i18n.categoryEarthObservations,category:this.i18n.categoryEarthObservations,subCategory:null,tagsQuery:'tags:"earth observations"'});a.push({label:this.i18n.categoryUrbanSystems,category:this.i18n.categoryUrbanSystems,subCategory:null,
tagsQuery:"tags:urban"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategory3DCities,category:this.i18n.categoryUrbanSystems,subCategory:this.i18n.subCategory3DCities,tagsQuery:"tags:3D"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryMovement,category:this.i18n.categoryUrbanSystems,subCategory:this.i18n.subCategoryMovement,tagsQuery:"tags:movement"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryParcels,category:this.i18n.categoryUrbanSystems,
subCategory:this.i18n.subCategoryParcels,tagsQuery:"tags:parcels"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryPeople,category:this.i18n.categoryUrbanSystems,subCategory:this.i18n.subCategoryPeople,tagsQuery:"tags:people"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryPlanning,category:this.i18n.categoryUrbanSystems,subCategory:this.i18n.subCategoryPlanning,tagsQuery:"tags:planning"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+
this.i18n.subCategoryPublic,category:this.i18n.categoryUrbanSystems,subCategory:this.i18n.subCategoryPublic,tagsQuery:"tags:public"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryWork,category:this.i18n.categoryUrbanSystems,subCategory:this.i18n.subCategoryWork,tagsQuery:"tags:work"});a.push({label:this.i18n.categoryTransportation,category:this.i18n.categoryTransportation,subCategory:null,tagsQuery:"tags:transportation"});"Boundaries \x26 Places";a.push({label:this.i18n.categoryBoundaries,
category:this.i18n.categoryBoundaries,subCategory:null,tagsQuery:"tags:boundaries"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryBoundaries,category:this.i18n.categoryBoundaries,subCategory:this.i18n.subCategoryBoundaries,tagsQuery:"tags:boundaries"});a.push({label:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryPlaces,category:this.i18n.categoryBoundaries,subCategory:this.i18n.subCategoryPlaces,tagsQuery:"tags:places"});this._categoriesStore=new d.data.AndOrWriteStore({data:{label:"label",
identifier:"label",items:a}});a=this._categoriesStore.getIdentity(a[0]);this._categorySelect.setStore(this._categoriesStore,a);this._categorySelectHandler=b.connect(this._categorySelect,"onChange",b.hitch(this,"doSearch"))},destroy:function(){b.disconnect(this._categorySelectHandler);this._categoriesStore.close();this.inherited(arguments)},doSearch:function(){var a=this.searchText.getValue();a&&-1<a.indexOf("*")?(arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorLabel,
message:this.i18n.error.wildCardSearchError}),this.searchText.focus()):(a&&a.length&&(a='"'+a+'"'),this._onlyEsriCheck.get("checked")&&(a+=" owner:esri"),arcgisonline.map.role.isAllowed("add_require_credits")||(a+=' -typekeywords:"Requires Credits"'),this._getItemFromStore(this._categoriesStore,this._categorySelect.get("value"),b.hitch(this,function(b){(b=this._categoriesStore.getValue(b,"tagsQuery"))&&b.length&&(a+=(a?" AND ":"")+"("+b+")");this.esriMapLayersGallery.refresh(a,this._mapExtentCheck.get("checked"))})))},
_onSearchClick:function(a){b.stopEvent(a);null!=a&&a.prefentDefault&&a.preventDefault();this.doSearch()},_onSearchBoxFocus:function(a){},_onSearchBoxBlur:function(a){this.searchText.getValue()},_onSearchKeyPress:function(a){a.keyCode==b.keys.ENTER&&(b.stopEvent(a),this._onSearchClick(a));this.onSearchFieldKeyPress(a)},onSearchFieldKeyPress:function(a){},onEsriCheckChanged:function(){this.doSearch()},onExtentCheckChanged:function(){this.doSearch()},_getItemFromStore:function(a,b,c){a.fetchItemByIdentity({identity:b,
onItem:c})},show:function(a){this.doSearch();c.byId("browse-layers-dialog").show()},onClose:function(){c.byId("browse-layers-dialog").hide()}})});