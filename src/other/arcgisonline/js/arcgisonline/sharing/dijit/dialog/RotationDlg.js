// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/dialog/RotationDlg",["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/Dialog"],function(c,a,e){a.provide("arcgisonline.sharing.dijit.dialog.RotationDlg");a.require("dijit._Widget");a.require("dijit._Templated");a.require("dijit.Dialog");a.declare("arcgisonline.sharing.dijit.dialog.RotationDlg",[c._Widget,c._Templated],{util:arcgisonline.sharing.util,widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContainer"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"rotation-dialog" title\x3d"${i18n.title}" execute\x3d""\x3e\r\n    \x3cdiv\x3e\r\n      \x3ctable cellspacing\x3d"5" width\x3d"100%"\x3e\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\x3ctd\x3e\r\n        \x3clabel\x3e${i18n.titleMsg}\x3c/label\x3e\r\n      \x3c/td\x3e\x3c/tr\x3e\r\n      \x3ctr\x3e\x3ctd\x3e\r\n        \x3cselect class\x3d"rendererInput" dojoAttachPoint\x3d"_rotationAttribute" dojoAttachEvent\x3d"onChange:_onChangeRotationAttribute" dojoType\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false" style\x3d"width:100%"\x3e\r\n        \x3c/select\x3e\r\n      \x3c/td\x3e\x3c/tr\x3e\r\n      \x3ctr\x3e\x3ctd\x3e\r\n        \x3cdiv style\x3d"height:5px"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\x3c/tr\x3e\r\n      \x3ctr\x3e\x3ctd \x3e\r\n        \x3clabel\x3e${i18n.angleMsg}\x3c/label\x3e\r\n      \x3c/td\x3e\x3c/tr\x3e\r\n      \x3ctr\x3e\x3ctd\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"rotationType" dojotype\x3d"dijit.form.RadioButton" id\x3d"rotationType:geographic" /\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n            \x3clabel for\x3d"linkType:geographic"\x3e\r\n              ${i18n.geographic}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"rotationType" dojotype\x3d"dijit.form.RadioButton" id\x3d"rotationType:arithmetic" /\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n            \x3clabel for\x3d"linkType:arithmetic"\x3e\r\n              ${i18n.arithmetic}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n      \x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3cdiv style\x3d"margin-top:10px;"\x3e\r\n        \x3cbutton dojoAttachPoint\x3d"cancelButton" dojoAttachEvent\x3d"onClick:onCancelClick" class\x3d"jevent cancel esriFloatTrailing" dojoType\x3d"dijit.form.Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n        \x3cbutton dojoAttachPoint\x3d"applyButton" dojoAttachEvent\x3d"onClick:onApplyClick" class\x3d"jevent cancel esriFloatTrailing" dojoType\x3d"dijit.form.Button"\x3e${i18n.apply}\x3c/button\x3e\r\n        \x3cbutton dojoAttachPoint\x3d"okButton" dojoAttachEvent\x3d"onClick:onDoneClick" class\x3d"jevent primary esriFloatTrailing" dojoType\x3d"dijit.form.Button"\x3e${i18n.done}\x3c/button\x3e\r\n\t\t\t\x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
i18n:null,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.RotationDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=a.clone(a.i18n.getLocalization("arcgisonline","arcgisonline").common);a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline","arcgisonline").rotationDlg)},postCreate:function(){this.loadConnections()},show:function(d,b){this.attributesStore=b;this._rotationAttribute.setStore(this.attributesStore,
"\x26lt;"+this.i18n.none+"\x26gt;",{query:"NOT type:'percent' AND NOT type:'selectAField' AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeString' AND NOT type:'esriFieldTypeDate'"});this.disableEvents=!0;c.byId("rotationType:geographic").set("checked",!0);this.rotationInfo=a.clone(d);d&&(this._rotationAttribute.set("value",d.field),"arithmetic"===d.type&&c.byId("rotationType:arithmetic").set("checked",!0));setTimeout(a.hitch(this,function(){this.disableEvents=
!1}),1E3);this.okButton.set("disabled",!0);this.cancelButton.set("disabled",!1);this.applyButton.set("disabled",!0);c.byId("rotation-dialog").show()},loadConnections:function(){a.query(".jevent").connect("onclick",function(a){a.preventDefault()});a.connect(a.byId("rotationType:geographic"),"onclick",a.hitch(this,"_onUpdateType"));a.connect(a.byId("rotationType:arithmetic"),"onclick",a.hitch(this,"_onUpdateType"))},hide:function(){c.byId("rotation-dialog").hide()},_onChangeRotationAttribute:function(d){this.attributesStore.fetchItemByIdentity({identity:this._rotationAttribute.get("value"),
onItem:a.hitch(this,function(a){this.disableEvents||(this.okButton.set("disabled",!1),this.applyButton.set("disabled",!1),this.cancelButton.set("disabled",!1))})})},_onUpdateType:function(a){!this.disableEvents&&"none"!==this._rotationAttribute.get("value")&&(this.okButton.set("disabled",!1),this.applyButton.set("disabled",!1),this.cancelButton.set("disabled",!1))},onCancelClick:function(){a.publish("onRotationChange",[this.rotationInfo,!1]);this.hide()},onDoneClick:function(d){d.preventDefault();
"none"==this._rotationAttribute.get("value")?(a.publish("onRotationChange",[null,!1]),this.hide()):this.attributesStore.fetchItemByIdentity({identity:this._rotationAttribute.get("value"),onItem:a.hitch(this,function(b){b={field:b.name[0],type:c.byId("rotationType:geographic").get("checked")?"geographic":"arithmetic"};a.publish("onRotationChange",[b,!1]);this.hide()})})},onApplyClick:function(d){"none"==this._rotationAttribute.get("value")?(a.publish("onRotationChange",[null,!0]),this.hide()):this.attributesStore.fetchItemByIdentity({identity:this._rotationAttribute.get("value"),
onItem:a.hitch(this,function(b){b={field:b.name[0],type:c.byId("rotationType:geographic").get("checked")?"geographic":"arithmetic"};a.publish("onRotationChange",[b,!0]);this.rotationInfo=b;this.okButton.set("disabled",!1);this.applyButton.set("disabled",!0);this.cancelButton.set("disabled",!0)})})},onKeyDown:function(a){var b;window.event?b=a.keyCode:a.which&&(b=a.which);if(13==b)this.onDoneClick(a)}})});