// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
require({cache:{"url:arcgisonline/sharing/dijit/dialog/templates/ResendInviteDlg.html":'\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv id\x3d"resendInvite-dialog" data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" title\x3d"${i18n.resendInviteTitle}"\x3e\r\n    \x3cp\x3e${i18n.resendInviteDesc}\x3c/p\x3e\r\n    \x3cp data-dojo-attach-point\x3d"_messageTitle"\x3e${i18n.messageTitle}\x3c/p\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_messageContainer" style\x3d"margin-bottom:1.0em;"\x3e\r\n      \x3ctextarea data-dojo-type\x3d"dijit/form/Textarea" data-dojo-attach-point\x3d"_message"\x3e\x3c/textarea\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing" data-dojo-attach-point\x3d"_buttons" style\x3d"margin-bottom:1.0em;"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_sendingLabel" style\x3d"display:none;"\x3e${i18n.sendingLabel}\x3c/span\x3e\r\n      \x3cbutton type\x3d"button" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_okBtn" data-dojo-attach-event\x3d"onClick:onOk" class\x3d"calcite primary"\x3e${i18n.resendLabel}\x3c/button\x3e\r\n      \x3cbutton type\x3d"button" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_cancelBtn" data-dojo-attach-event\x3d"onClick:onCancel" class\x3d"calcite cancel"\x3e${i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("arcgisonline/sharing/dijit/dialog/ResendInviteDlg","require dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dom-attr dojo/dom-style dojo/i18n dojo/json dojo/topic esri/lang arcgisonline/sharing/util arcgisonline/sharing/dijit/dialog/GeneralDlg dijit/_Widget dijit/_Templated dijit/Dialog dijit/form/Button dijit/form/Textarea dojo/text!arcgisonline/sharing/dijit/dialog/templates/ResendInviteDlg.html".split(" "),function(n,p,q,c,h,k,g,r,l,m,e,d,s,t,v,w,x,u){return p([s,t],{declaredClass:"arcgisonline.sharing.dijit.dialog.ResendInviteDlg",
basePath:n.toUrl("arcgisonline/sharing/dijit/dialog"),baseClass:"esriResendInviteDlg",widgetsInTemplate:!0,templateString:u,statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.ResendInviteDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n={};c.mixin(this.i18n,g.getLocalization("arcgisonline","arcgisonline").common);c.mixin(this.i18n,g.getLocalization("arcgisonline","arcgisonline").resendInviteDlg);
this.i18n.emailDifficultyAdminMsg=g.getLocalization("arcgisonline","arcgisonline").organizationInvite.email.emailDifficultyAdminMsg},show:function(b){this._clear();this._invitation=b;this._dialog.show()},onCancel:function(){this._dialog.hide()},onOk:function(){this._showSending();this._removeOldInvitation().then(c.hitch(this,function(){this._sendNewInvitation().then(c.hitch(this,function(b){b.notInvited&&0<b.notInvited.length?d.prototype.statics.getInstance().show({title:this.i18n.notice,message:this.i18n.errorSendingInvite}):
l.publish("invitation-resent",!0);this._hideSending();this._dialog.hide()}),c.hitch(this,function(b){d.prototype.statics.getInstance().show({title:this.i18n.notice,message:this.i18n.errorSendingInvite});this._hideSending();this._dialog.hide()}))}),c.hitch(this,function(b){d.prototype.statics.getInstance().show({title:this.i18n.notice,message:this.i18n.errorRemovingInvite});this._sendNewInvitation().then(c.hitch(this,function(a){a.notInvited&&0<a.notInvited.length?d.prototype.statics.getInstance().show({title:this.i18n.notice,
message:this.i18n.errorSendingInvite}):l.publish("invitation-resent",!0);this._hideSending();this._dialog.hide()}),c.hitch(this,function(a){d.prototype.statics.getInstance().show({title:this.i18n.notice,message:this.i18n.errorSendingInvite});this._hideSending();this._dialog.hide()}))}))},_clear:function(){this._invitation=null;this._isPortal=e.isPortal();this._message.set("value",this._getMessage());this._hideSending()},_hideSending:function(){k.set(this._sendingLabel,"display","none");h.set(this._okBtn.domNode,
"disabled",!1)},_showSending:function(){k.set(this._sendingLabel,"display","");h.set(this._okBtn.domNode,"disabled",!0)},_getMessage:function(){var b=e.getUser(),b=this._createFullName(b),a=e.isPortal()?this.i18n.messageBodyPortal:this.i18n.messageBody;return esri.substitute({user:b,organization:esriGeowConfig.self.name},a)},_buildEmailSubject:function(){var b=esri.substitute({organization:esriGeowConfig.self.name,portalName:esriGeowConfig.portalName||this.i18n.arcgisOnline},this.i18n.inviteSubject);
this._isPortal&&(b=esri.substitute({organization:esriGeowConfig.self.name},this.i18n.inviteSubjectPortal));return b},_buildEmailMessage:function(){var b=this._message.get("value"),a=e.getSecureUrl(esriGeowConfig.baseUrl),a=esriGeowConfig.baseUrl.indexOf(location.host),c="",d=e.isPortal(),f="";-1<a&&(c=esriGeowConfig.baseUrl.substring(a+location.host.length));esriGeowConfig.self.urlKey&&esriGeowConfig.self.customBaseUrl?(f=(esriGeowConfig.self.allSSL?"https://":"http://")+esriGeowConfig.self.urlKey+
"."+esriGeowConfig.self.customBaseUrl,f+=c,a="https://"+esriGeowConfig.self.portalHostname+c):(f=esriGeowConfig.baseUrl,a="https://"+esriGeowConfig.self.portalHostname+c,d&&(a=e.getSecureUrl(a)));d=this._createHTMLLineBreaks(b);b=a+esriGeowConfig.signin;if(esriGeowConfig.self.subscriptionInfo&&(c=esriGeowConfig.self.subscriptionInfo.type,"Trial"===c||"Trial Press"===c||"Evaluation"===c))b=a+esriGeowConfig.createAccount;a="\x3chtml\x3e\x3cbody\x3e\x3cp\x3e"+d+"\x3c/p\x3e"+("\x3cp\x3e"+this.i18n.clickToJoin+
'\x3cbr\x3e\x3ca href\x3d"'+b+'?invitation\x3d@@invitation.id@@"\x3e');a+=b+"?invitation\x3d@@invitation.id@@\x3c/a\x3e\x3c/p\x3e";this._isPortal||(a+="\x3cp\x3e",esriGeowConfig.self&&esriGeowConfig.self.user?(b=this._createFullName(esriGeowConfig.self.user),a+=esri.substitute({name:b,email:esriGeowConfig.self.user.email},this.i18n.emailDifficultyAdminMsg)):a+=this.i18n.emailDifficultyMsg,a+=" "+this.i18n.existingAddon+"\x3c/p\x3e");a+="\x3cp\x3e"+this.i18n.orgUrlMsg+"\x3cbr\x3e"+f+"\x3c/p\x3e";a+=
"\x3cp\x3e"+this.i18n.linkExpiresMsg+"\x3c/p\x3e";a+='\x3cp style\x3d"color:gray;"\x3e';a+=this.i18n.automatedMsg;return a+="\x3c/p\x3e\x3c/body\x3e\x3c/html\x3e"},_createFullName:function(b){var a=b.fullName;m.isDefined(b.firstName)&&m.isDefined(b.lastName)&&(a="ja"===q.locale?b.lastName+" "+b.firstName:b.firstName+" "+b.lastName);return a},_createHTMLLineBreaks:function(b){if(b)for(var a=-1;-1<(a=b.indexOf("\n"));)b=0===a?"\x3cbr/\x3e"+b.substring(a+1):b.substring(0,a)+"\x3cbr/\x3e"+b.substring(a+
1);return b},_removeOldInvitation:function(){return e.request({url:esriGeowConfig.restBaseUrl+"portals/self/invitations/"+this._invitation.id+"/delete"},{usePost:!0})},_sendNewInvitation:function(){var b=this._buildEmailSubject(),a=this._buildEmailMessage(),b={subject:b,html:a,invitationList:r.stringify({invitations:[{email:this._invitation.email,role:this._invitation.role}]})};return e.request({url:esriGeowConfig.restBaseUrl+"portals/self/invite",content:b},{usePost:!0})}})});