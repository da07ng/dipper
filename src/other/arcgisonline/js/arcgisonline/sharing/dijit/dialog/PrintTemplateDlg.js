// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
require({cache:{"url:arcgisonline/sharing/dijit/dialog/templates/PrintTemplateDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${baseClass} print-template-dialog" data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" title\x3d"${i18n.createTemplate}"\x3e\r\n    \x3ctable class\x3d"formTable"\x3e\r\n      \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"titleCol"\x3e${i18n.templateName}\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cinput type\x3d"text" class\x3d"textBox" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"_name" maxlength\x3d"50"\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"spacer"\x3e\x3ctd colspan\x3d"2"\x3e\x26nbsp;\x3c/td\x3e\x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"titleCol"\x3e${i18n.templateDescription}\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cinput type\x3d"text" class\x3d"textBox" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"_description" maxlength\x3d"120"\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"spacer"\x3e\x3ctd colspan\x3d"2"\x3e\x26nbsp;\x3c/td\x3e\x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"titleCol"\x3e${i18n.format}\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"comboBox" data-dojo-type\x3d"arcgisonline/sharing/dijit/ComboBox" data-dojo-attach-point\x3d"_formats"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"spacer"\x3e\x3ctd colspan\x3d"2"\x3e\x26nbsp;\x3c/td\x3e\x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"titleCol"\x3e${i18n.layout}\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"comboBox" data-dojo-type\x3d"arcgisonline/sharing/dijit/ComboBox" data-dojo-attach-point\x3d"_layouts"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"spacer"\x3e\x3ctd colspan\x3d"2"\x3e\x26nbsp;\x3c/td\x3e\x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"titleCol"\x3e\x26nbsp;\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_legendContainer"\x3e\r\n            \x3cinput id\x3d"printLegend" type\x3d"checkbox"\r\n                 data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"_legend"\x3e\r\n            \x3clabel for\x3d"printLegend"\x3e${i18n.legend}\x3c/label\x3e\r\n          \x3c/span\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n      \x3cbutton type\x3d"button" class\x3d"calcite blue small"\r\n              data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_okBtn"\x3e${i18n.create}\x3c/button\x3e\r\n      \x3cbutton type\x3d"button" class\x3d"calcite transparent small"\r\n              data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_cancelBtn"\x3e${i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr style\x3d"clear:both;"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("arcgisonline/sharing/dijit/dialog/PrintTemplateDlg","require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-style dojo/topic dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog dijit/form/Button dijit/form/CheckBox arcgisonline/sharing/dijit/ComboBox dijit/form/TextBox dojo/store/Memory esri/request arcgisonline/sharing/util arcgisonline/sharing/dijit/dialog/GeneralDlg dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/PrintTemplateDlg.html".split(" "),
function(q,r,e,y,l,s,z,t,u,v,A,B,C,D,E,m,F,n,w,p,x){var k=r("arcgisonline.sharing.dijit.dialog.PrintTemplateDlg",[t,u,v],{declaredClass:"arcgisonline.sharing.dijit.dialog.PrintTemplateDlg",baseClass:"esriPrintTemplateDlg",basePath:q.toUrl("arcgisonline/sharing/dijit/dialog"),templateString:x,widgetsInTemplate:!0,MODE_ADD:"add",MODE_EDIT:"edit",formatPNG:"PNG32",formatPDF:"PDF",defaultFormat:null,defaultFormats:[],defaultLayout:"MAP_ONLY",defaultLayouts:["MAP_ONLY"],postMixInProperties:function(){this.inherited(arguments);
this._mixinI18N()},postCreate:function(){this.inherited(arguments);this._generalDlg=w.prototype.statics.getInstance();this._createConnections();this._setDefaults()},startup:function(){this.inherited(arguments)},show:function(b,a){this._clear();this._set("serviceInfo",b);this._setMode(a);this._loadDataFromServiceInfo();this._setStores();this._fillTemplateInfo();this._dialog.show()},hide:function(){this._dialog.hide()},_mixinI18N:function(){var b={};e.mixin(b,p.common);e.mixin(b,p.printTemplates);this._set("i18n",
b)},_createConnections:function(){this.own(this._okBtn.on("click",e.hitch(this,this._okClick)),this._cancelBtn.on("click",e.hitch(this,this._cancelClick)),this._layouts.on("change",e.hitch(this,this._layoutChange)))},_setDefaults:function(){var b=this._get("i18n");this.defaultFormat=b.formats.image;this.defaultFormats=[b.formats.image,b.formats.pdf]},_setStores:function(){this._setFormats();this._setLayouts();this._createLayoutStore()},_setFormats:function(){this._formats.set("store",this._createFormatStore());
this._formats.set("value",this._get("format"))},_createFormatStore:function(){var b=[],a=this._get("formats"),c,d;for(d=0;d<a.length;d++)c=a[d],b.push({id:c,name:c});return new m({data:b})},_setLayouts:function(){this._layouts.set("store",this._createLayoutStore());this._layouts.set("value",this._get("layout"))},_createLayoutStore:function(){var b=[],a=this._get("layouts"),c,d;for(d=0;d<a.length;d++)c=a[d],b.push({id:c,name:c});return new m({data:b})},_clear:function(){this._setDefaultFormats();this._setDefaultLayouts();
this._set("url",null);this._setMode();this._name.set("value","");this._description.set("value","");this._legend.set("checked",!1);this._okBtn.set("label",this._get("i18n").create)},_setMode:function(b){var a=this._get("i18n");b?(this._set("mode",this.MODE_EDIT),this._set("template",b),this._okBtn.set("label",a.update)):(this._set("mode",this.MODE_ADD),this._set("template",{}),this._okBtn.set("label",a.create))},_loadDataFromServiceInfo:function(){var b=this._get("serviceInfo"),a=[],c=[],d,f,g,h;if(!b||
!b.parameters||0===b.parameters)this._set("format",this.defaultFormat),this._set("formats",this.defaultFormats),this._set("layout",this.defaultLayout),this._set("layouts",this.defaultLayouts);else{for(h=0;h<b.parameters.length;h++)g=b.parameters[h],"Layout_Template"===g.name&&(f=g.defaultValue,c=e.clone(g.choiceList));!d&&0===a.length&&(d=this.defaultFormat,a=this.defaultFormats);!f&&0===c.length&&(f=this.defaultLayout,c=this.defaultLayouts);this._set("format",d);this._set("formats",a);this._set("layout",
f);this._set("layouts",c)}},_setDefaultFormats:function(){this._set("format",this.defaultFormat);this._set("formats",this.defaultFormats)},_setDefaultLayouts:function(){this._set("layout",this.defaultLayout);this._set("layouts",this.defaultLayouts)},_fillTemplateInfo:function(){var b=this._get("i18n"),a=this._get("template"),c;a.label&&this._name.set("value",a.label);a.description&&this._description.set("value",a.description);a.format&&(c=a.format.toLowerCase(),c===this.formatPNG.toLowerCase()?this._formats.set("value",
b.formats.image):c===this.formatPDF.toLowerCase()?this._formats.set("value",b.formats.pdf):this._formats.set("value",b.formats.image));a.layout&&this._layouts.set("value",a.layout);a.layoutOptions&&a.layoutOptions.legend?this._legend.set("checked",!0===a.layoutOptions.legend):this._legend.set("checked",!1)},_isAddMode:function(){return this._get("mode")===this.MODE_ADD},_isEditMode:function(){return this._get("mode")===this.MODE_EDIT},_isValidTemplate:function(b){var a=this._get("i18n");return!b.label||
1>b.label.length?(this._showError(a.nameRequired),!1):b.description&&120<b.description.length?(this._showError(a.descriptionTooLong),!1):!0},_showError:function(b){var a=this._get("i18n");this._generalDlg.show({title:a.notice,message:b})},_publishToTopic:function(){s.publish("printTemplate-"+this._get("mode"),this._get("template"))},_okClick:function(b){b&&b.preventDefault();b=this._get("i18n");var a=this._get("template"),c=this._legend.get("checked"),d;a.label=e.trim(this._name.get("value"));a.description=
e.trim(this._description.get("value"));d=this._formats.get("value");a.format=d===b.formats.image?this.formatPNG:d===b.formats.pdf?this.formatPDF:this.formatPNG;a.layout=this._layouts.get("value");"MAP_ONLY"!==a.layout?a.layoutOptions?a.layoutOptions.legend=c:a.layoutOptions={legend:c}:delete a.layoutOptions;a.label=n.stripHTML(a.label);a.description=n.stripHTML(a.description);this._isValidTemplate(a)&&(this._set("template",a),this._publishToTopic(),this.hide())},_cancelClick:function(b){b&&b.preventDefault();
this.hide()},_layoutChange:function(){"MAP_ONLY"===this._layouts.get("value")?l.set(this._legendContainer,"visibility","hidden"):l.set(this._legendContainer,"visibility","visible")}});k.prototype.statics={getInstance:function(){this._instance||(this._instance=new k);return this._instance}};return k});