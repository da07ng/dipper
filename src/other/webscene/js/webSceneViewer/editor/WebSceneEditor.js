// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
require({cache:{"dojo/_base/html":function(){define("./kernel ../dom ../dom-style ../dom-attr ../dom-prop ../dom-class ../dom-construct ../dom-geometry".split(" "),function(k,r,e,p,m,n,s,h){k.byId=r.byId;k.isDescendant=r.isDescendant;k.setSelectable=r.setSelectable;k.getAttr=p.get;k.setAttr=p.set;k.hasAttr=p.has;k.removeAttr=p.remove;k.getNodeProp=p.getNodeProp;k.attr=function(a,f,d){return 2==arguments.length?p["string"==typeof f?"get":"set"](a,f):p.set(a,f,d)};k.hasClass=n.contains;k.addClass=n.add;
k.removeClass=n.remove;k.toggleClass=n.toggle;k.replaceClass=n.replace;k._toDom=k.toDom=s.toDom;k.place=s.place;k.create=s.create;k.empty=function(a){s.empty(a)};k._destroyElement=k.destroy=function(a){s.destroy(a)};k._getPadExtents=k.getPadExtents=h.getPadExtents;k._getBorderExtents=k.getBorderExtents=h.getBorderExtents;k._getPadBorderExtents=k.getPadBorderExtents=h.getPadBorderExtents;k._getMarginExtents=k.getMarginExtents=h.getMarginExtents;k._getMarginSize=k.getMarginSize=h.getMarginSize;k._getMarginBox=
k.getMarginBox=h.getMarginBox;k.setMarginBox=h.setMarginBox;k._getContentBox=k.getContentBox=h.getContentBox;k.setContentSize=h.setContentSize;k._isBodyLtr=k.isBodyLtr=h.isBodyLtr;k._docScroll=k.docScroll=h.docScroll;k._getIeDocumentElementOffset=k.getIeDocumentElementOffset=h.getIeDocumentElementOffset;k._fixIeBiDiScrollLeft=k.fixIeBiDiScrollLeft=h.fixIeBiDiScrollLeft;k.position=h.position;k.marginBox=function(a,f){return f?h.setMarginBox(a,f):h.getMarginBox(a)};k.contentBox=function(a,f){return f?
h.setContentSize(a,f):h.getContentBox(a)};k.coords=function(a,f){k.deprecated("dojo.coords()","Use dojo.position() or dojo.marginBox().");a=r.byId(a);var d=e.getComputedStyle(a),d=h.getMarginBox(a,d),q=h.position(a,f);d.x=q.x;d.y=q.y;return d};k.getProp=m.get;k.setProp=m.set;k.prop=function(a,f,d){return 2==arguments.length?m["string"==typeof f?"get":"set"](a,f):m.set(a,f,d)};k.getStyle=e.get;k.setStyle=e.set;k.getComputedStyle=e.getComputedStyle;k.__toPixelValue=k.toPixelValue=e.toPixelValue;k.style=
function(a,f,d){switch(arguments.length){case 1:return e.get(a);case 2:return e["string"==typeof f?"get":"set"](a,f)}return e.set(a,f,d)};return k})},"esri/views/3d/support/canvas3dUtils":function(){define([],function(){return{dataURItoBlob:function(k){var r=atob(k.split(",")[1]);k=k.split(",")[0].split(":")[1].split(";")[0];for(var e=new ArrayBuffer(r.length),p=new Uint8Array(e),m=0;m<r.length;m++)p[m]=r.charCodeAt(m);return new Blob([e],{type:k})}}})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare",
"dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(k,r,e){return k("dijit.form.RangeBoundTextBox",e,{rangeMessage:"",rangeCheck:function(e,m){return("min"in m?0<=this.compare(e,m.min):!0)&&("max"in m?0>=this.compare(e,m.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var e=this.get("value");if(null==e)return!1;var m=!1;"min"in this.constraints&&(m=this.constraints.min,m=0>this.compare(e,"number"==typeof m&&
0<=m&&0!=e?0:m));!m&&"max"in this.constraints&&(m=this.constraints.max,m=0<this.compare(e,"number"!=typeof m||0<m?m:0));return m},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(e){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(e))},getErrorMessage:function(e){var m=this.get("value");return null!=m&&""!==m&&("number"!=typeof m||!isNaN(m))&&!this.isInRange(e)?this.rangeMessage:this.inherited(arguments)},
postMixInProperties:function(){this.inherited(arguments);this.rangeMessage||(this.messages=r.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"esri/views/3d/layers/graphics/SymbolConverter":function(){define("../../../../core/screenUtils ../../../../symbols/SimpleLineSymbol ../../../../symbols/SimpleMarkerSymbol ../../../../symbols/PictureMarkerSymbol ../../../../symbols/SimpleFillSymbol ../../../../symbols/TextSymbol ../../../../symbols/Symbol3D ../../../../symbols/Symbol ../../../../symbols/LineSymbol3D ../../../../symbols/PointSymbol3D ../../../../symbols/PolygonSymbol3D ../../../../symbols/LabelSymbol3D ../../../../renderers/support/jsonUtils".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l){function c(b){return b.toRgb().map(function(b){return b})}function b(b){return Math.round(100*(1-b.a))}var t=function(g,l){var u;if(g instanceof r)u=a.fromJSON({symbolLayers:[{type:"Line",enable:!0,size:k.px2pt(g.width)||1,material:{color:g.color?c(g.color):[255,255,255],transparency:g.color?b(g.color):100}}]});else if(g instanceof p||g instanceof e){u=g.color?c(g.color):[255,255,255];var h=null==g.color?100:b(g.color),v,D;g instanceof p?(g.color&&0===g.color.r+
g.color.g+g.color.b&&(u=[255,255,255]),v=g.source.imageData&&g.source.contentType?{dataURI:"data:"+g.source.contentType+";base64,"+g.source.imageData}:"data:"===g.url.substring(0,5)?{dataURI:g.url}:{href:g.url},D=g.width):(v=g.style,D={},D[e.STYLE_CIRCLE]="circle",D[e.STYLE_CROSS]="cross",D[e.STYLE_DIAMOND]="kite",D[e.STYLE_SQUARE]="square",D[e.STYLE_X]="x",v in D?v=D[v]:(console.log(v+' cannot be mapped to Icon symbol. Fallback to "circle"'),v="circle"),v={primitive:v},D=g.size);u={type:"Icon",enable:!0,
size:k.px2pt(D),screenOffset:[g.xoffset,g.yoffset],resource:v,material:{color:u,transparency:h}};g.outline&&(g.outline.color&&0<g.outline.width)&&(u.outline={size:k.px2pt(g.outline.width),color:c(g.outline.color),transparency:b(g.outline.color)});u=f.fromJSON({symbolLayers:[u]})}else if(g instanceof m)u={symbolLayers:[{type:"Fill",enable:!0,material:{color:g.color?c(g.color):[255,255,255],transparency:g.color?b(g.color):100}}]},u=d.fromJSON(u),g.outline&&(h=t(g.outline,!1).symbolLayers[0],u.addLayer(h));
else if(g instanceof n){switch(g.verticalAlignment){case "top":u="top";break;case "middle":u="center";break;case "bottom":u="bottom";break;default:u="center"}switch(g.horizontalAlignment){case "left":u+="Left";break;case "center":u+="Center";break;case "right":u+="Right";break;default:u+="Center"}u=q.fromJSON({symbolLayers:[{type:"Text",enable:!0,size:k.px2pt(g.font.size),font:{family:g.font.family,weight:g.font.weight,style:g.font.style},material:{color:c(g.color)},placement:u,screenOffset:[k.px2pt(g.xoffset),
k.px2pt(g.yoffset)],text:g.text}]})}else g instanceof s?u=g:console.warn("SymbolConverter: don't know how to convert symbol of type '%s'",g.type||g.declaredClass);l&&u&&(u.id=g.id);return u};return{toWeb3DSymbol:t,toWeb3DRenderer:function(b){function a(b){return b instanceof h&&!(b instanceof s)?t(b,!1):b}var c=l.fromJSON(b.toJSON());c.defaultSymbol=a(c.defaultSymbol);c.symbol=a(c.symbol);Array.isArray(c.infos)&&c.infos.forEach(function(b){b.symbol=a(b.symbol)});"undefined"!==typeof b.isMaxInclusive&&
c.setMaxInclusive(b.isMaxInclusive);return c}}})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(k,r){return k("dijit._Contained",null,{_getSibling:function(e){var p=this.domNode;do p=p[e+"Sibling"];while(p&&1!=p.nodeType);return p&&r.byNode(p)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var e=this.getParent();return!e||!e.getIndexOfChild?-1:e.getIndexOfChild(this)}})})},
"dojox/mdnd/DropIndicator":function(){define(["dojo/_base/kernel","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","./AreaManager"],function(k,r,e,p){k=r("dojox.mdnd.DropIndicator",null,{node:null,constructor:function(){var m=document.createElement("div"),n=document.createElement("div");m.appendChild(n);e.add(m,"dropIndicator");this.node=m},place:function(e,n,s){s&&(this.node.style.height=s.h+"px");try{return n?e.insertBefore(this.node,n):e.appendChild(this.node),this.node}catch(h){return null}},
remove:function(){this.node&&(this.node.style.height="",this.node.parentNode&&this.node.parentNode.removeChild(this.node))},destroy:function(){this.node&&(this.node.parentNode&&this.node.parentNode.removeChild(this.node),p.destroy(this.node),delete this.node)}});dojox.mdnd.areaManager()._dropIndicator=new dojox.mdnd.DropIndicator;return k})},"webSceneViewer/editor/WebSceneEditorPanes/WebSceneSlidesPane":function(){define("esri/core/declare dojo/_base/lang dojo/dom-construct esri/core/watchUtils ./WebSceneEditorPaneBase webSceneViewer/widgets/SlideDeck/SlideDeckEditable dojo/i18n!../nls/editor".split(" "),
function(k,r,e,p,m,n,s){return k(m,{constructor:function(){r.mixin(this,{id:"slideDeck",title:s.panes.slides,actionButton:{title:s.buttons.done,action:"_navBackBtnNodeClickHandler"}});this._updateContent()},destroy:function(){},_updateContent:function(){var h=e.create("div",{className:"webSceneSlidesPane"});if(null==this.editor.webScene)e.place("\x3cp\x3einitialization problem\x3c/p\x3e",h);else{e.create("h3",{className:"paneSectionTitle"},h);var a=e.create("div",{},h);p.whenOnce(this.editor.view,
"ready",function(){new n({view:this.editor.view,webScene:this.editor.webScene,editor:this.editor},a)}.bind(this));this._addToContentNode(h)}}})})},"dojox/fx/style":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/fx dojo/fx ./_base dojo/_base/array dojo/dom dojo/dom-style dojo/dom-class dojo/_base/connect".split(" "),function(k,r,e,p,m,n,s,h,a,f){k.experimental("dojox.fx.style");var d=function(a){return n.map(m._allowedProperties,function(c){return a[c]})},q=function(a,c,b){a=s.byId(a);
var t=h.getComputedStyle(a),g=d(t);k[b?"addClass":"removeClass"](a,c);var f=d(t);k[b?"removeClass":"addClass"](a,c);var q={},e=0;n.forEach(m._allowedProperties,function(b){g[e]!=f[e]&&(q[b]=parseInt(f[e]));e++});return q};p={addClass:function(d,c,b){d=s.byId(d);var t=function(b){return function(){a.add(b,c);b.style.cssText=y}}(d),g=q(d,c,!0),y=d.style.cssText;d=e.animateProperty(r.mixin({node:d,properties:g},b));f.connect(d,"onEnd",d,t);return d},removeClass:function(d,c,b){d=s.byId(d);var t=function(b){return function(){a.remove(b,
c);b.style.cssText=y}}(d),g=q(d,c),y=d.style.cssText;d=e.animateProperty(r.mixin({node:d,properties:g},b));f.connect(d,"onEnd",d,t);return d},toggleClass:function(f,c,b,t){"undefined"==typeof b&&(b=!a.contains(f,c));return m[b?"addClass":"removeClass"](f,c,t)},_allowedProperties:"width height left top backgroundColor color borderBottomWidth borderTopWidth borderLeftWidth borderRightWidth paddingLeft paddingRight paddingTop paddingBottom marginLeft marginTop marginRight marginBottom lineHeight letterSpacing fontSize".split(" ")};
r.mixin(m,p);return p})},"webSceneViewer/widgets/SymbologyEditor/PolygonSymbolLayerEditor":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/PolygonSymbolLayerEditor.html dojo/dom-class dojo/_base/lang esri/views/3d/layers/graphics/SymbolConverter ./BaseSymbolLayerEditor".split(" "),function(k,r,e,p,m,n,s,h,a){return k([a,r,e,p],{name:"LineSymbolLayerEditor",baseClass:"SymbolLayerEditor",templateString:m,_setDimensionTypeAttr:function(a){this.inherited(arguments)},
constructor:function(a,d){},destroy:function(){this.inherited(arguments)},postCreate:function(){this.extrusionHeightInput.set("value",1);this.setSelectedColor(this._selectedColor[this.dimensionType]);var a=this.params.layer.renderer;a&&a.symbol&&"Fill"===this._getSymbolLayer(a).type&&(n.add(this.extrusionHeightInput.domNode,"hide"),n.add(this.extrusionHeightText,"hide"));this.updateUIFromSelectedValues();this._initUIStrings()},updateUIFromSelectedValues:function(){var a=this.getSelectedTransparency();
this.transparencyInput.set("value",a,!1);var d=this.getSelectedColor();this._setColorSwatch(d,a);this.extrusionHeightInput.set("value",this.getSelectedSize(),!1)},updateSymbolLayerFromUI:function(){var a=this.getSelectedColor(),d=this.getSelectedTransparency(),q=!0;this.symbolLayer&&100===d&&(q=!1);"2d"===this.dimensionType?this.set("symbolLayer",{type:"Fill",material:{color:s.clone(a),transparency:d},enable:q}):this.set("symbolLayer",{type:"Extrude",material:{color:s.clone(a),transparency:d},size:this.getSelectedSize(),
enable:q})},_getSymbolLayer:function(a){if(a&&a.symbol){a=h.toWeb3DRenderer(a);var d=a.symbol.symbolLayers[0];1<a.symbol.symbolLayers.length&&"Fill"!==d.type&&(d=a.symbol.symbolLayers[1]);return d}},_readLayerSymbology:function(a){a&&a.symbol&&(a=this._getSymbolLayer(a),"Fill"!==a.type&&"Extrude"!==a.type||("Extrude"===a.type&&(this._selectedSize["3d"]=a.size,this._initialSize=!1),this._readColorFromSymbolLayer(a)))},_onExtrusionHeightInputKeypressHandler:function(){},_updateExtrusionHeightSelectedValue:function(){this.extrusionHeightInput.get("value")!==
this.getSelectedSize()&&(this.setSelectedSize(this.extrusionHeightInput.get("value")),this.updateSymbolLayerFromUI())}})})},"dstore/Filter":function(){define(["dojo/_base/declare"],function(k){function r(e){return function(){var p=this.constructor,m=new p;m.type=e;m.args=arguments;return this.type?r("and").call(p.prototype,this,m):m}}k=k(null,{constructor:function(e){var p=typeof e;switch(p){case "object":var p=this,m;for(m in e)var n=e[m],p=n instanceof this.constructor?p[n.type](m,n.args[0]):n&&
n.test?p.match(m,n):p.eq(m,n);this.type=p.type;this.args=p.args;break;case "function":case "string":this.type=p,this.args=[e]}},and:r("and"),or:r("or"),eq:r("eq"),ne:r("ne"),lt:r("lt"),lte:r("lte"),gt:r("gt"),gte:r("gte"),contains:r("contains"),"in":r("in"),match:r("match")});k.filterCreator=r;return k})},"webSceneViewer/widgets/MessageListWidget/MessageListWidget":function(){define(["esri/core/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/MessageListWidget.html","./MessageWidget"],
function(k,r,e,p,m){return new (k([r,e],{declaredClass:"MessageListWidget",templateString:p,MessageTypes:{INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error"},direction:"b2t",constructor:function(e){},postCreate:function(){},show:function(e){"string"===typeof e&&(e={message:e});e=new m(e);"t2b"===this.direction?e.placeAt(this.MessageListContentNode,0):e.placeAt(this.MessageListContentNode)}}))})},"webSceneViewer/widgets/SymbologyEditor/ShapePicker":function(){define("esri/core/declare dijit/_WidgetBase dojo/dom dojo/dom-class dojo/dom-construct dojo/on dojo/i18n!../nls/widgets".split(" "),
function(k,r,e,p,m,n,s){var h=["circle","square","cross","x","kite"],a="sphere cube cylinder cone tetrahedron diamond".split(" ");return k([r],{name:"ShapePicker",baseClass:"ShapePicker",geometryType:void 0,symbolLayerDimensionType:void 0,_setSymbolLayerDimensionTypeAttr:function(a){a!==this.symbolLayerDimensionType&&("2d"==a?(this.shapes2dDomNode&&p.remove(this.shapes2dDomNode,"hide"),this.shapes3dDomNode&&p.add(this.shapes3dDomNode,"hide"),p.remove(this.domNode,"longer"),this._select(this._lastShape2d)):
(this.shapes3dDomNode&&p.remove(this.shapes3dDomNode,"hide"),this.shapes2dDomNode&&p.add(this.shapes2dDomNode,"hide"),p.add(this.domNode,"longer"),this._select(this._lastShape3d)),this._set("symbolLayerDimensionType",a))},constructor:function(a,d){this._onHandles=[];this._lastShape2d="circle";this._lastShape3d="sphere";this._selectedShape=this._selectedButton=null},destroy:function(){this.inherited(arguments);this.layer=null;this._onHandles.forEach(function(a){a.remove()});this._onHandles.length=
0},postCreate:function(){this.inherited(arguments);this.shapes2dDomNode=m.create("div",{className:"2d"===this.symbolLayerDimensionType?"":"hide"},this.domNode);this.shapes3dDomNode=m.create("div",{className:"3d"===this.symbolLayerDimensionType?"":"hide"},this.domNode);a.forEach(function(a){a=this._createShapeButton(a);m.place(a,this.shapes3dDomNode)}.bind(this));h.forEach(function(a){a=this._createShapeButton(a);m.place(a,this.shapes2dDomNode)}.bind(this))},_createShapeButton:function(a){var d=s.symbologyEditor.shapes[a],
d=m.create("div",{id:this.id+"_"+a,className:"shapeIcon"+a.charAt(0).toUpperCase()+a.slice(1),title:d}),q=n(d,"click",function(d){this._select(a)}.bind(this));this._onHandles.push(q);return d},_select:function(a){this._selectedButton&&p.remove(this._selectedButton,"selected");"2d"===this.symbolLayerDimensionType?this._lastShape2d=this._selectedShape||this._lastShape2d:this._lastShape3d=this._selectedShape||this._lastShape3d;this._selectedButton=e.byId(this.id+"_"+a);this._selectedShape=a;p.add(this._selectedButton,
"selected");this.emit("selection-change",{shape:a})}})})},"webSceneViewer/environmentUtils":function(){define(["esri/views/3d/SceneViewEnvironment","esri/core/watchUtils","./spatialReferenceUtils"],function(k,r,e){function p(e,m){e.lighting&&null!=e.lighting.displayUTCOffset&&(m.lighting||(m.lighting={}),m.lighting.displayUTCOffset=e.lighting.displayUTCOffset);return m}var m={fromJSON:function(e){return p(e,k.fromJSON(e))},toJSON:function(e){return p(e,e.toJSON())},clone:function(e){return p(e,e.clone())},
applyToView:function(e,m){if(e&&e.lighting){var h=e.lighting,a=m.environment.lighting;null!=h.date&&(a.date=h.date);null!=h.displayUTCOffset&&(a.displayUTCOffset=h.displayUTCOffset);a.directShadows=h.directShadows;a.ambientOcclusion=h.ambientOcclusion}},adjustLightDateForLatitude:function(m,s){e.getLatitudeOfPoint(s).then(function(e){var a=m.date.getMonth(),f;66<e&&(4>a||6<a)?f=5:-66>e&&(10>a&&0<a)&&(f=11);f&&(e=new Date(m.date),e.setMonth(f),m.date=e)})},adjustLightForLayer:function(e,s){s.then(function(){var h=
s.fullExtent;h&&r.whenTrueOnce(e.environment.lighting,"ready",function(){m.adjustLightDateForLatitude(e.environment.lighting,h.center)})})}};return m})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(k,r,e){return k([r,e],{})})},"dojox/fx/_base":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/fx dojo/fx dojo/dom dojo/dom-style dojo/dom-geometry dojo/_base/connect dojo/_base/html".split(" "),function(k,r,e,p,m,n,s,h,a){k=r.getObject("dojox.fx",
!0);r.mixin(k,{anim:e.anim,animateProperty:e.animateProperty,fadeTo:e._fade,fadeIn:e.fadeIn,fadeOut:e.fadeOut,combine:p.combine,chain:p.chain,slideTo:p.slideTo,wipeIn:p.wipeIn,wipeOut:p.wipeOut});k.sizeTo=function(a){var d=a.node=m.byId(a.node),q=a.method||"chain";a.duration||(a.duration=500);"chain"==q&&(a.duration=Math.floor(a.duration/2));var l,c,b,t,g,y=null,u=function(d){return function(){var q=n.getComputedStyle(d),u=q.position,e=q.width,h=q.height;l="absolute"==u?d.offsetTop:parseInt(q.top)||
0;b="absolute"==u?d.offsetLeft:parseInt(q.left)||0;g="auto"==e?0:parseInt(e);y="auto"==h?0:parseInt(h);t=b-Math.floor((a.width-g)/2);c=l-Math.floor((a.height-y)/2);"absolute"!=u&&"relative"!=u&&(q=n.coords(d,!0),l=q.y,b=q.x,d.style.position="absolute",d.style.top=l+"px",d.style.left=b+"px")}}(d),d=e.animateProperty(r.mixin({properties:{height:function(){u();return{end:a.height||0,start:y}},top:function(){return{start:l,end:c}}}},a)),q=e.animateProperty(r.mixin({properties:{width:function(){return{start:g,
end:a.width||0}},left:function(){return{start:b,end:t}}}},a));return p["combine"==a.method?"combine":"chain"]([d,q])};k.slideBy=function(a){var d,q,l=function(a){return function(){var b=n.getComputedStyle(a),t=b.position;d="absolute"==t?a.offsetTop:parseInt(b.top)||0;q="absolute"==t?a.offsetLeft:parseInt(b.left)||0;"absolute"!=t&&"relative"!=t&&(b=s.coords(a,!0),d=b.y,q=b.x,a.style.position="absolute",a.style.top=d+"px",a.style.left=q+"px")}}(a.node=m.byId(a.node));l();a=e.animateProperty(r.mixin({properties:{top:d+
(a.top||0),left:q+(a.left||0)}},a));h.connect(a,"beforeBegin",a,l);return a};k.crossFade=function(f){var d=f.nodes[0]=m.byId(f.nodes[0]),q=a.style(d,"opacity"),l=f.nodes[1]=m.byId(f.nodes[1]);a.style(l,"opacity");return p.combine([e[0==q?"fadeIn":"fadeOut"](r.mixin({node:d},f)),e[0==q?"fadeOut":"fadeIn"](r.mixin({node:l},f))])};k.highlight=function(f){var d=f.node=m.byId(f.node);f.duration=f.duration||400;var q=f.color||"#ffff99",l=a.style(d,"backgroundColor");"rgba(0, 0, 0, 0)"==l&&(l="transparent");
f=e.animateProperty(r.mixin({properties:{backgroundColor:{start:q,end:l}}},f));"transparent"==l&&h.connect(f,"onEnd",f,function(){d.style.backgroundColor=l});return f};k.wipeTo=function(f){f.node=m.byId(f.node);var d=f.node,q=d.style,l=f.width?"width":"height",c={};c[l]={start:function(){q.overflow="hidden";if("hidden"==q.visibility||"none"==q.display)return q[l]="1px",q.display="",q.visibility="",1;var b=a.style(d,l);return Math.max(b,1)},end:f[l]};return e.animateProperty(r.mixin({properties:c},
f))};return k})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(k,r,e,p,m,n,s,h){return k("dijit.form.Form",[m,n,s,h],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",
postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(a){r.set(this.domNode,"encType",a);p("ie")&&(this.domNode.encoding=a);this._set("encType",a)},reset:function(a){var f={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(f)&&f.returnValue&&
this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(a){var f=this.constructor.prototype;if(this.execute!=f.execute||this.onExecute!=f.onExecute)e.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(a)&&(a.stopPropagation(),a.preventDefault())},onSubmit:function(){return this.isValid()},
submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"webSceneViewer/editor/WebSceneEditorPanes/AddLayerPane":function(){define("esri/core/declare dojo/_base/lang dojo/dom-construct dojo/promise/all dojo/Deferred dojo/dom-class dojo/on dojo/keys dojo/mouse dojo/query ./WebSceneEditorPaneBase dijit/form/TextBox dojo/i18n!../nls/editor".split(" "),function(k,r,e,p,m,n,s,h,a,f,d,q,l){function c(b,a){for(var c in b)if(b.hasOwnProperty(c)){a[c]||(a[c]=[]);for(var g=b[c],t={"Scene Service":[],
"Feature Service":[]},d=0;d<g.length;d++)"Feature Service"===g[d].type?t["Feature Service"][g[d].title]=d:"Scene Service"===g[d].type&&(t["Scene Service"][g[d].title]=d);for(d=0;d<g.length;d++)"Feature Service"===g[d].type&&g[d].title in t["Feature Service"]&&g[d].title in t["Scene Service"]&&(a[c][g[d].title]=d)}return a}function b(b,c,g,t,d,f){var q=e.create("div",{id:b.id,"class":"layerListItem"},c);t.push(s(q,a.enter,function(){f(b.id,d,!0)}));t.push(s(q,a.leave,function(){f(b.id,d,!1);n.remove(q,
"hover")}));c=e.create("tr",{},q);var h=e.create("td",{},c),h=e.create("div",{className:"thumbOther"},h);if(null!=b.thumbnailUrl)h.style.backgroundImage="url("+b.thumbnailUrl+")";else if("scene service"===(b.type&&b.type.toLowerCase()||""))h.className="thumbScene";var h=e.create("td",{"class":"thumbDesc"},c),m=e.create("div",{},h);e.create("div",{className:"layerTypeIcon"},m).style.backgroundImage="url("+b.iconUrl+")";e.create("div",{"class":"title",innerHTML:b.title,title:b.title},m);if(b.displayName){var h=
e.create("div",{"class":"sub",title:b.displayName+" "+l.addLayerPane.by+" "+b.owner},h),m=e.create("div",{innerHTML:b.displayName,"class":"layerLink"},h),p=b.portal.getBaseUrl(),r=b.id;t.push(s(m,"click",function(b,a){a.preventDefault();a.stopPropagation();window.open(p+"item.html?id\x3d"+r,"_blank")}.bind(p,r)));e.create("div",{innerHTML:"\x26nbsp;"+l.addLayerPane.by+"\x26nbsp;","class":"inlineContainer"},h);e.create("div",{innerHTML:b.owner,"class":"inlineContainer"},h)}t="featured"===d?"importLayerAddButton":
"searchLayerAddButton";var k=e.create("td",{},c);e.create("div",{"class":t,title:"featured"===d?l.buttons.importLayer:l.buttons.add},k).onclick=function(a){n.add(q,"added");g&&(n.add(k.firstChild,"searchLayerLoading"),g(b.url,b.id,b.title,b.displayName,k,d))}}var t={user:l.addLayerPane.myContent,portal:l.addLayerPane.content,featured:l.addLayerPane.featuredContent};!0===window._demo&&(t.base="3D Base Layers");var g=[{title:"Thematic Buildings",url:"http://web3d.esri.com/SceneServerLocal/juneDemo/BuildingShell/",
thumbnailUrl:"http://devext.arcgis.com/sharing/rest/content/items/ed9998f9deb9457381bd90efbaed70a9/info/thumbnail/ThematicBuildings.jpg"},{title:"Thematic Trees",url:"http://web3d.esri.com/SceneServerLocal/juneDemo/Trees_3k/",thumbnailUrl:"http://devext.arcgis.com/sharing/rest/content/items/16fe4f3ca22e4f5999ed9e34750e3443/info/thumbnail/ThematicTrees.jpg"},{title:"Realistic Buildings",url:"http://web3d.esri.com/SceneServerLocal/juneDemo/SF_v12_lod_ccw",thumbnailUrl:"http://devext.arcgis.com/sharing/rest/content/items/6796812ee198446287581c2359f0e28a/info/thumbnail/RealisticBuildings.jpg"}];
return k([d],{_onHandles:void 0,_moreButtonHandles:void 0,_numberOfMoreItem:10,_featuredContentGroupId:void 0,constructor:function(){this._onHandles=[];this._moreButtonHandles=[];r.mixin(this,{id:"addLayer",title:l.panes.addLayers,actionButton:{title:l.buttons.done,action:"_navBackBtnNodeClickHandler"}});n.add(this.content,"addLayerPane");this.editor.portal?this._queryFeaturedContentGroup().then(function(b){this._updateContent()}.bind(this)):this.editor.watch("portal",function(){this._queryFeaturedContentGroup().then(function(b){this._updateContent()}.bind(this))}.bind(this))},
destroy:function(){this.emit("layer-found-visible",{clear:!0});this._onHandles.forEach(function(b){b.remove()});for(var b in this._moreButtonHandles)this._moreButtonHandles[b].remove()},_updateContent:function(){function b(){""!==c._textBox.get("value")&&n.contains(c._searchButton,"searchCross")&&c._textBox.set("value","");a()}function a(){var b=c._textBox.get("value");c._performSearch(c._textBox.get("value"));""!==b?n.replace(c._searchButton,"searchCross","searchButton"):n.replace(c._searchButton,
"searchButton","searchCross")}var c=this,g=e.create("div",{className:""});null==this.editor?e.place("\x3cp\x3einitialization problem\x3c/p\x3e",g):this.editor.portal&&(this._textBox=new q({className:"searchBox",placeHolder:l.addLayerPane.searchForLayer}),this._searchButton=e.create("div",{className:"searchButton",title:l.addLayerPane.search},this._textBox.domNode),s(this._searchButton,"click",b),this._textBox.placeAt(this.paneTopContainer),s(this._textBox,"keypress",function(b){(b.charOrCode||b.keyCode)==
h.ENTER&&a()}),this._loadingContainer=e.create("div",{className:"centered loading"},g),this._noResultContainer=e.create("div",{className:"centered hide"},g),this._noResultContainer.innerHTML=l.addLayerPane.noResult,this._domNodeResults=e.create("div",{className:"searchResultsDiv"},g),0<this.paneScrollableContainer.children.length&&this.paneScrollableContainer.removeChild(this.content.children[0]),this.paneScrollableContainer.appendChild(g))},_removeLayer:function(b,a,c,g,t,d,f){for(var q=0;q<b.length;q++)this.editor.map.remove(b[q]);
this.emit("layer-found-visible",{clear:!1,category:f,id:g});n.remove(a.firstChild,"searchLayerRemoveButton");a.firstChild.title="featured"===f?l.buttons.importLayer:l.buttons.add;a.firstChild.onclick=function(){n.add(a.parentNode.parentNode,"added");n.add(a.firstChild,"searchLayerLoading");this._addLayer(c,g,t,d,a,f)}.bind(this)},_addLayer:function(b,a,c,g,t,d){this.editor.addContentByItemId(a,"featured"===d).then(function(f){var q=f.layers,e=f.slides;this.editor.setWebSceneChanged();this.emit("layer-found-visible",
{clear:!1,category:d,id:a});n.remove(t.firstChild,"searchLayerLoading");n.remove(t.parentNode.parentNode,"added");n.add(t.firstChild,"searchLayerRemoveButton");t.firstChild.title=l.buttons.remove;t.firstChild.onclick=function(){this._removeLayer(q,t,b,a,c,g,d);e&&e.forEach(function(b){this.editor.webScene.presentation.removeSlideById(b.id);this.editor.webScene.set("presentation",this.editor.webScene.presentation.toJSON());this.editor.setWebSceneChanged()}.bind(this))}.bind(this)}.bind(this),function(b){n.remove(t.firstChild,
"searchLayerLoading");n.remove(t.parentNode.parentNode,"added")})},_toggleLayerPopup:function(b,a,c){this.emit("layer-toggle-popup",{itemID:b,category:a,show:c})},setLayerHover:function(b){f(".layerListItem").forEach(function(a){null!==b&&a.id===b?n.add(a,"hover"):n.remove(a,"hover")})},_performSearch:function(b){n.remove(this._loadingContainer,"hide");-1===this._noResultContainer.className.indexOf("hide")&&n.add(this._noResultContainer,"hide");console.log("searching for "+b);this._onHandles.forEach(function(b){b.remove()});
for(var a in this._moreButtonHandles)this._moreButtonHandles[a].remove();e.empty(this._domNodeResults);var c=(a=this.editor.portal)&&this.editor.portal.getPortalUser(),g=void 0!==b&&""!==b;this.editor.portal?(this.emit("layer-found-visible",{clear:!0}),this._performContentSearch(b,c,a,g,{base:[],featured:[],user:[],portal:[]})):e.create("p",{innerHTML:"You need to be signed in to add layers from portal"},this._domNodeResults)},_queryFeaturedContentGroup:function(){var b=this.editor.portal.queryGroups({q:'title:"Featured Maps And Apps" AND owner:esri'},
!0);b.then(function(b){0<b.results.length&&(this._featuredContentGroupId=b.results[0].id)}.bind(this));return b},_getContentQuery:function(b,a,c,g,t,d){var f='(type:"Scene Service" OR type:"Feature Service" OR type:"Map Service" OR type:"Image Service" OR typekeywords:"Elevation 3D Layer") -typekeywords:"Table"',l='(group:"'+this._featuredContentGroupId+'" AND tags:"scenes" AND type:"Web Scene")';a.role||(f+=' -typekeywords:"Requires Credits" -typekeywords:"Requires Subscription"');var q="";c&&(g=
"("+g+") AND ");switch(b){case "user":b={q:g+" owner:"+a.username+" AND "+f};break;case "portal":a&&(q=" -owner:"+a.username+" AND ");b={q:g+q+f+"AND -"+l,sortField:"numViews",sortOrder:"desc"};break;default:b={q:g+" "+l,sortField:"numViews",sortOrder:"desc"}}0<d&&(b.start=d);b.num=t;return b},_performContentSearch:function(b,a,c,t,d){var f=Math.ceil((this.paneScrollableContainer.clientHeight-60*(a?3:2))/64),f=9>f?9:f,l=this,q,e,h=new m,n=new m,s=new m;a&&(q=this._getContentQuery("user",a,t,b,2*f,
0));e=this._getContentQuery("portal",a,t,b,2*f,0);a=this._getContentQuery("featured",a,t,b,2*f,0);!t&&!0===window._demo&&(d.base=g);q?h=c.queryItems(q,c.canSearchPublic):h.resolve();e?n=c.queryItems(e,c.canSearchPublic):n.resolve();a?s=c.queryItems(a,!0):s.resolve();p([h,n,s]).then(function(a){a[0]&&(d.user=a[0].results);a[1]&&(d.portal=a[1].results);a[2]&&(d.featured=a[2].results);this._populateResults(l._domNodeResults,d,f,b)}.bind(this),function(){console.log(arguments)})},_populateResults:function(a,
g,d,f){n.add(this._loadingContainer,"hide");var q=!1,h=this._addLayer.bind(this),m=this._toggleLayerPopup.bind(this);e.empty(a);var p=c(g,{}),k=0;d=Math.ceil(d/3);for(var x in g){var G=g[x].length<d+k?g[x].length:d+k;if(0<G){var H=e.create("div",{},a);e.create("br",{},H);var C=e.create("h3",{},H),C=e.create("div",{className:"collapsibleContainerHeader"},C);this._onHandles.push(s(C,"click",r.hitch(this,function(b){this._toggleSearchContainerVisibility(b)})));e.create("div",{className:"portal"===x&&
""===f?"collapseIcon collapsed":"collapseIcon"},C);e.create("div",{className:"clickable"},C).textContent=t[x];var J=""===f?"portalContentIcon contentDisabledIcon":"portalContentIcon";switch(x){case "featured":J="featuredContentIcon";break;case "user":J="userContentIcon"}e.create("div",{className:J},C);C=e.create("div",{className:"portal"===x&&""===f?"resultLayerItems hideResultLayerItems":"resultLayerItems"},H);g[x].length<G&&(G=g[x].length);for(J=0;J<G&&!(g[x].length<G&&J>=g[x].length);J++){var K=
g[x][J];if("Feature Service"===K.type&&K.title in p[x])G++;else{if("featured"===x||"portal"===x||"user"===x)this.emit("layer-found",{item:K,category:x,showCategory:"portal"!==x||""!==f}),q=!0;b(K,C,h,this._onHandles,x,m)}}G<g[x].length&&(H=e.create("div",{className:"portal"===x&&""===f?"MoreButton hide":"MoreButton"},H),H.innerHTML=l.addLayerPane.more,this._moreButtonHandles[x]=s(H,"click",function(b,a,c,g,t){this._moreResults(b,this._numberOfMoreItem,a,t,c,g)}.bind(this,x,f,p,G+1)))}"base"!==x&&
(k+=d-G)}q||n.remove(this._noResultContainer,"hide")},onPaneSelected:function(){this._textBox&&this._performSearch(this._textBox.get("value"))},_moreResults:function(a,g,t,d,f,l){var q=d.target?d.target:d.srcElement,e=q.previousSibling,h=this.editor.portal&&this.editor.portal.getPortalUser();d=new m;var h=this._getContentQuery(a,h,void 0!==t&&""!==t,t,2*g,l),n=g;h&&(d=this.editor.portal.queryItems(h,"featured"===a));d.then(function(g){if(g){var d=this._addLayer.bind(this),h=this._toggleLayerPopup.bind(this);
g=g.results;var m=[];m[a]=g;f=c(m,f);m=!1;g.length<n&&(n=g.length,m=!0);for(var u=0;u<n&&!(g.length<n&&u>=g.length);u++){var p=g[u];if("Feature Service"===p.type&&p.title in f[a])n++;else{if("featured"===a||"portal"===a||"user"===a)this.emit("layer-found",{item:p,category:a,showCategory:"portal"!==a||""!==t});b(p,e,d,this._onHandles,a,h)}}m&&q.parentNode.removeChild(q);this._moreButtonHandles[a]&&this._moreButtonHandles[a].remove();this._moreButtonHandles[a]=s(q,"click",function(b,a,c,g,t){this._moreResults(b,
this._numberOfMoreItem,a,t,c,g)}.bind(this,a,t,f,n+l))}}.bind(this),function(){console.log(arguments)})},_toggleContentIconVisibility:function(b){-1!==b.className.indexOf("featuredContentIcon")?(this.emit("layer-found-visible",{clear:!1,category:"featured"}),n.toggle(b,"contentDisabledIcon")):-1!==b.className.indexOf("portalContentIcon")?(this.emit("layer-found-visible",{clear:!1,category:"portal"}),n.toggle(b,"contentDisabledIcon")):-1!==b.className.indexOf("userContentIcon")&&(this.emit("layer-found-visible",
{clear:!1,category:"user"}),n.toggle(b,"contentDisabledIcon"))},_toggleSearchContainerVisibility:function(b){b=b.target?b.target:b.srcElement;-1===b.className.indexOf("collapsibleContainerHeader")&&(b=b.parentNode);var a=b.childNodes[0];this._toggleContentIconVisibility(b.childNodes[2]);n.toggle(a,"collapsed");(b=b.parentNode.nextSibling)&&n.toggle(b,"hideResultLayerItems");(b=b.nextSibling)&&n.toggle(b,"hide")}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/sniff".split(" "),
function(k,r,e,p,m,n,s){function h(b){b.preventDefault()}var a={checkbox:1,radio:1,button:1},f=/\bdgrid-cell\b/,d=/\bdgrid-row\b/,q=k(null,{pageSkip:10,tabIndex:0,keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=p.mixin({},q.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=p.mixin({},q.defaultHeaderKeyMap))},postCreate:function(){function b(g){var c=g.target;return c.type&&(!a[c.type]||32===g.keyCode)}function c(a){function t(){g._focusedHeaderNode&&
(g._focusedHeaderNode.tabIndex=-1);if(g.showHeader){if(l)for(var b=g.headerNode.getElementsByTagName("th"),a=0,c;c=b[a];++a){if(q.test(c.className)){g._focusedHeaderNode=m=c;break}}else g._focusedHeaderNode=m=g.headerNode;m&&(m.tabIndex=g.tabIndex)}}var l=g.cellNavigation,q=l?f:d,h=a===g.headerNode,m=a;h?(t(),r.after(g,"renderHeader",t,!0)):r.after(g,"renderArray",function(b){var c=g._focusedNode||m;if(q.test(c.className)&&s.contains(a,c))return b;for(var t=a.getElementsByTagName("*"),d=0,f;f=t[d];++d)if(q.test(f.className)){c=
g._focusedNode=f;break}c.tabIndex=g.tabIndex;return b});g._listeners.push(e(a,"mousedown",function(a){b(a)||g._focusOnNode(a.target,h,a)}));g._listeners.push(e(a,"keydown",function(a){if(!a.metaKey&&!a.altKey){var c=g[h?"headerKeyMap":"keyMap"][a.keyCode];c&&!b(a)&&c.call(g,a)}}))}this.inherited(arguments);var g=this;this.tabableHeader&&(c(this.headerNode),e(this.headerNode,"dgrid-cellfocusin",function(){g.scrollTo({x:this.scrollLeft})}));c(this.contentNode)},removeRow:function(b){if(!this._focusedNode)return this.inherited(arguments);
var a=this,c=document.activeElement===this._focusedNode,g=this[this.cellNavigation?"cell":"row"](this._focusedNode),t=g.row||g,d;b=b.element||b;if(b===t.element){d=this.down(t,!0);if(!d||d.element===b)d=this.up(t,!0);this._removedFocus={active:c,rowId:t.id,columnId:g.column&&g.column.id,siblingId:!d||d.element===b?void 0:d.id};setTimeout(function(){a._removedFocus&&a._restoreFocus(t.id)},0);this._focusedNode=null}this.inherited(arguments)},insertRow:function(){var b=this.inherited(arguments);this._removedFocus&&
!this._removedFocus.wait&&this._restoreFocus(b);return b},_restoreFocus:function(b){var a=this._removedFocus,g;if((b=(b=b&&this.row(b))&&b.element&&b.id===a.rowId?b:"undefined"!==typeof a.siblingId&&this.row(a.siblingId))&&b.element){if(!b.element.parentNode.parentNode){a.wait=!0;return}"undefined"!==typeof a.columnId&&(g=this.cell(b,a.columnId))&&g.element&&(b=g);a.active&&0!==b.element.offsetHeight?this._focusOnNode(b,!1,null):(n(b.element,".dgrid-focus"),b.element.tabIndex=this.tabIndex,this._focusedNode=
b.element)}delete this._removedFocus},addKeyHandler:function(b,a,g){return r.after(this[g?"headerKeyMap":"keyMap"],b,a,!0)},_focusOnNode:function(b,a,g){var c="_focused"+(a?"Header":"")+"Node";a=this[c];var t=this.cellNavigation?"cell":"row",l=this[t](b),q,h,m,u,y;if(b=l&&l.element){if(this.cellNavigation){q=b.getElementsByTagName("input");y=0;for(m=q.length;y<m;y++)if(h=q[y],(-1!==h.tabIndex||"_dgridLastValue"in h)&&!h.disabled){h.focus();u=!0;break}}null!==g&&(g=p.mixin({grid:this},g),g.type&&(g.parentType=
g.type),g.bubbles||(g.bubbles=!0));a&&(n(a,"!dgrid-focus[!tabIndex]"),g&&(g[t]=this[t](a),e.emit(a,"dgrid-cellfocusout",g)));a=this[c]=b;g&&(g[t]=l);c=this.cellNavigation?f:d;!u&&c.test(b.className)&&(b.tabIndex=this.tabIndex,b.focus());n(b,".dgrid-focus");g&&e.emit(a,"dgrid-cellfocusin",g)}},focusHeader:function(b){this._focusOnNode(b||this._focusedHeaderNode,!0)},focus:function(b){(b=b||this._focusedNode)?this._focusOnNode(b,!1):this.contentNode.focus()}}),l=q.moveFocusVertical=function(b,a){var g=
this.cellNavigation,c=this[g?"cell":"row"](b),c=g&&c.column.id,t=this.down(this._focusedNode,a,!0);g&&(t=this.cell(t,c));this._focusOnNode(t,!1,b);b.preventDefault()};k=q.moveFocusUp=function(b){l.call(this,b,-1)};var c=q.moveFocusDown=function(b){l.call(this,b,1)},b=q.moveFocusPageUp=function(b){l.call(this,b,-this.pageSkip)},t=q.moveFocusPageDown=function(b){l.call(this,b,this.pageSkip)},g=q.moveFocusHorizontal=function(b,a){if(this.cellNavigation){var g=!this.row(b);this._focusOnNode(this.right(this["_focused"+
(g?"Header":"")+"Node"],a),g,b);b.preventDefault()}},y=q.moveFocusLeft=function(b){g.call(this,b,-1)},u=q.moveFocusRight=function(b){g.call(this,b,1)},F=q.moveHeaderFocusEnd=function(b,a){var g;this.cellNavigation&&(g=this.headerNode.getElementsByTagName("th"),this._focusOnNode(g[a?0:g.length-1],!0,b));b.preventDefault()},v=q.moveHeaderFocusHome=function(b){F.call(this,b,!0)},D=q.moveFocusEnd=function(b,a){var g=this.cellNavigation,c=this.contentNode,t=c.scrollTop+(a?0:c.scrollHeight),c=c[a?"firstChild":
"lastChild"],d=-1<c.className.indexOf("dgrid-preload"),f=d?c[(a?"next":"previous")+"Sibling"]:c,l=f.offsetTop+(a?0:f.offsetHeight),q;if(d){for(;f&&0>f.className.indexOf("dgrid-row");)f=f[(a?"next":"previous")+"Sibling"];if(!f)return}!d||1>c.offsetHeight?(g&&(f=this.cell(f,this.cell(b).column.id)),this._focusOnNode(f,!1,b)):(m("dom-addeventlistener")||(b=p.mixin({},b)),q=r.after(this,"renderArray",function(c){var t=c[a?0:c.length-1];g&&(t=this.cell(t,this.cell(b).column.id));this._focusOnNode(t,!1,
b);q.remove();return c}));t===l&&b.preventDefault()},A=q.moveFocusHome=function(b){D.call(this,b,!0)};q.defaultKeyMap={32:h,33:b,34:t,35:D,36:A,37:y,38:k,39:u,40:c};q.defaultHeaderKeyMap={32:h,35:F,36:v,37:y,39:u};return q})},"webSceneViewer/widgets/LayerWidget/LayerItemEditable":function(){define("esri/core/declare dojo/dom-construct dojo/dom-class dojo/on dojo/_base/lang ./LayerItem dijit/_WidgetsInTemplateMixin dojo/text!./templates/LayerItemEditable.html ../OptionsMenu/OptionsMenu dojo/i18n!../nls/widgets esri/layers/ArcGISElevationLayer".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d){function q(b){e.remove(b,"layerGroupTypeCheckbox");e.remove(b,"layerGroupTypeRadios");e.remove(b,"layerGroupTypeMerge");e.remove(b,"layerGroupTypeHidden")}function l(b,a){var g=r.create("div",{className:"groupTypeSwitchButton dropdown-navigation dropdown-wrapper"}),c=r.create("a",{className:"dropdown  btnLogo",href:"JavaScript:void(0);"},g);switch(b.layer.visibilityMode){case "independent":e.add(g,"layerGroupTypeCheckbox");break;case "exclusive":e.add(g,"layerGroupTypeRadios");
break;case "inherited":"hide-children"===b.layer.listMode?e.add(g,"layerGroupTypeMerge"):e.add(g,"layerGroupTypeHidden")}b.dropDownContent=r.create("div",{className:"dropdown-content"},g);var d=r.create("ul",{},b.dropDownContent);e.add(b.dropDownContent,"hide");b._onHandles.push(p(b.titleInlineEditBox,"click",function(){e.toggle(b.dropDownContent,"hide")}));b._onHandles.push(p(c,"click",function(){e.toggle(b.dropDownContent,"hide")}));b._onHandles.push(p(dojo.doc,"click",function(a){a.target!=c&&
(a.target!=b.titleInlineEditBox.domNode&&(!a.target.parentNode||"grouptype"!==a.target.parentNode.id))&&e.add(b.dropDownContent,"hide")}));var l=r.create("li",{},d),h=r.create("div",{},l);r.create("div",{className:"layerGroupTypeCheckbox"},h);r.create("div",{className:"layerGroupTypeText"},h).textContent=f.layerItemEditable.groupTypeCheckbox;var h=r.create("li",{},d),m=r.create("div",{},h);r.create("div",{className:"layerGroupTypeRadios"},m);r.create("div",{className:"layerGroupTypeText"},m).textContent=
f.layerItemEditable.groupTypeRadio;var m=r.create("li",{},d),n=r.create("div",{},m);r.create("div",{className:"layerGroupTypeMerge"},n);r.create("div",{className:"layerGroupTypeText"},n).textContent=f.layerItemEditable.groupTypeCompact;d=r.create("li",{},d);n=r.create("div",{},d);r.create("div",{className:"layerGroupTypeHidden"},n);r.create("div",{className:"layerGroupTypeText"},n).textContent=f.layerItemEditable.groupTypeHide;b._onHandles.push(p(l,"click",function(){q(g);e.add(g,"layerGroupTypeCheckbox");
b.layer.set("visibilityMode","independent");b.layer.set("listMode","show");b.layer._websceneEditorProperties.editedFlags.visibilityMode=!0;b.layer._websceneEditorProperties.editedFlags.listMode=!0;a.setWebSceneChanged()}));b._onHandles.push(p(h,"click",function(){q(g);e.add(g,"layerGroupTypeRadios");b.layer.set("visibilityMode","exclusive");b.layer.set("listMode","show");b.layer._websceneEditorProperties.editedFlags.visibilityMode=!0;b.layer._websceneEditorProperties.editedFlags.listMode=!0;a.setWebSceneChanged()}));
b._onHandles.push(p(m,"click",function(){q(g);e.add(g,"layerGroupTypeMerge");b.layer.set("visibilityMode","inherited");b.layer.set("listMode","hide-children");b.layer._websceneEditorProperties.editedFlags.visibilityMode=!0;b.layer._websceneEditorProperties.editedFlags.listMode=!0;b._layerItemOptionMenu.enableDisableMenuEntry("hide","inherited"!=b.layer.visibilityMode);a.setWebSceneChanged()}));b._onHandles.push(p(d,"click",function(){q(g);e.add(g,"layerGroupTypeHidden");b.layer.set("visibilityMode",
"inherited");b.layer.set("listMode","hide");b._layerItemOptionMenu.enableDisableMenuEntry("hide","inherited"!=b.layer.visibilityMode);b.layer._websceneEditorProperties.editedFlags.visibilityMode=!0;b.layer._websceneEditorProperties.editedFlags.listMode=!0;a.setWebSceneChanged()}));return g}var c=k([n,s],{name:"LayerItemEditable",templateString:h,editor:void 0,dropDownContent:void 0,configurable:void 0,constructor:function(b,a){this.configurable=!0},_setLayerTitleAttr:function(b){this._set("layerTitle",
b);this.titleNode&&(this.titleNode.textContent=b,this.titleNode.title=b);this.titleBox&&this.titleBox.title!==b&&(this.titleBox.title=b);this.titleInlineEditBox&&this.titleInlineEditBox.value!==b&&this.titleInlineEditBox.set("value",b)},destroy:function(){this.inherited(arguments);this._layerItemOptionMenu&&this._layerItemOptionMenu.destroy()},_init:function(){this.titleInlineEditBox.editorParams.invalidMessage=f.invalidTitle;this.isGroupLayer?this._initGroupLayerItems():this.configurable=!this.layer.isInstanceOf(d);
var b=[];this.isGroupLayer?b.push({id:"grouptype",title:f.layerItemEditable.changeGroupType,func:function(b){e.remove(this.dropDownContent,"hide")}.bind(this)}):b.push({id:"configure",title:f.layerItemEditable.configureLayer,func:function(b){this.layerWidget.emit("edit-layer",{layer:this.layer,parentGroup:this.parentGroup,parentLayerItem:this})}.bind(this)});b.push({id:"zoomTo",title:f.layerItemEditable.zoomToLayer,func:this._zoomToLayer.bind(this)},{id:"moveUp",title:f.moveUp,func:function(){var b=
this.parentGroup||this.view.map,a=b.layers.indexOf(this.layer);a<b.layers.get("length")&&b.reorder(this.layer,a+1)}.bind(this),className:this._isFirstLayerInParent()?"disabled":""},{id:"moveDown",title:f.moveDown,func:function(){var b=this.parentGroup||this.view.map,a=b.layers.indexOf(this.layer);a<b.layers.get("length")&&0<a&&b.reorder(this.layer,a-1)}.bind(this),className:this._isLastLayerInParent()?"disabled":""});this.isGroupLayer||b.push({id:"hide",title:"show"===this.layer.listMode?f.hideInMapLayers:
f.showInMapLayers,func:function(b){this.layer.set("listMode","show"===this.layer.listMode?"hide":"show");this.layer._websceneEditorProperties.editedFlags.listMode=!0}.bind(this)});b.push({id:"rename",title:f.rename,func:function(b){this.titleInlineEditBox.set("disabled",!1);this.titleInlineEditBox.edit()}.bind(this)},{id:"delete",title:f.layerItemEditable.deleteLayer,func:this._deleteLayer.bind(this)});this._layerItemOptionMenu=new a({entries:b});this.parentGroup&&this._layerItemOptionMenu.enableDisableMenuEntry("hide",
"inherited"!=this.parentGroup.visibilityMode);this.isGroupLayer||(this._layerItemOptionMenu.enableDisableMenuEntry("configure",this.configurable),this._layerItemOptionMenu.setMenuEntryTitle("hide","show"===this.layer.listMode?f.hideInMapLayers:f.showInMapLayers));this._layerItemOptionMenu.placeAt(this.layerEditButton);var c=function(){this.titleInlineEditBox.set("disabled",!0)}.bind(this);this.titleInlineEditBox.on("change",function(b){c();this.editor.setWebSceneChanged();this.layer.set("title",b)}.bind(this));
this.titleInlineEditBox.on("cancel",c);if(!this.isGroupLayer){var b=r.create("div",{className:"thumbOther"},this.layerItemIcon),g=r.create("div",{className:"framethumb"},this.layerItemIcon);this._onHandles.push(p(g,"click",m.hitch(this,this._zoomToLayer)));if(null!=this.layer._websceneEditorProperties.thumbnailUrl)b.style.backgroundImage="url("+this.layer._websceneEditorProperties.thumbnailUrl+")";else if(this.layer._websceneEditorProperties.portalLayerItem&&"scene service"===(this.layer._websceneEditorProperties.portalLayerItem.item.type&&
this.layer._websceneEditorProperties.portalLayerItem.item.type.toLowerCase()||""))b.className="thumbScene";this.configurable?this._onHandles.push(p(this.titleInlineEditBox,"click",m.hitch(this,function(){this.layerWidget.emit("edit-layer",{layer:this.layer,parentGroup:this.parentGroup,parentLayerItem:this})}))):e.add(this.titleInlineEditBox.domNode,"non-configurable")}},_addLayerItem:function(b,a){var g=new c({view:this.view,layer:b,layerWidget:this.layerWidget,parentGroup:this.layer,parentLayerItem:this,
editor:this.editor});g.placeAt(this.layersDomNode,a);this._layerItems.push(g)},_initGroupLayerItems:function(){this.inherited(arguments);this.isGroupLayer&&(this.groupTypeSwitchButton=l(this,this.editor),r.place(this.groupTypeSwitchButton,this.layerItemDomNode,"first"))},_deleteLayer:function(){this.parentGroup?this.parentGroup.remove(this.layer):this.view.map.remove(this.layer);this.editor.setWebSceneChanged()},_zoomToLayer:function(){this.view.animateTo(this.layer.get("fullExtent"))},_isFirstLayerInParent:function(){var b=
this.parentGroup||this.view.map;return b.layers.indexOf(this.layer)===b.layers.length-1},_isLastLayerInParent:function(){return 0===(this.parentGroup||this.view.map).layers.indexOf(this.layer)}});return c})},"dgrid/List":function(){define("dojo/_base/declare dojo/on dojo/has ./util/misc xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),function(k,r,e,p,m,n){function s(b,a){n(document.body,b,".dgrid-scrollbar-measure");var g=b["offset"+a]-b["client"+a];b.className=
"";b.parentNode&&document.body.removeChild(b);return g}function h(b){var a=b?"."+b.replace(l,"."):"";this._class&&(a="!"+this._class.replace(l,"!")+a);n(this.domNode,a);this._class=b}function a(){return this._class}m("mozilla","touch");e.add("pointer",function(b){return"PointerEvent"in b?"pointer":"MSPointerEvent"in b?"MSPointer":!1});var f,d;e.add("dom-scrollbar-width",function(b,a,g){return s(g,"Width")});e.add("dom-scrollbar-height",function(b,a,g){return s(g,"Height")});e.add("dom-rtl-scrollbar-left",
function(b,a,g){b=n("div");n(document.body,g,".dgrid-scrollbar-measure[dir\x3drtl]");n(g,b);a=!!e("ie")||!!e("trident")||b.offsetLeft>=e("dom-scrollbar-width");g.className="";g.parentNode&&document.body.removeChild(g);n(b,"!");g.removeAttribute("dir");return a});var q=0,l=/ +/g,c=function(){this._started&&this.resize()};return k(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!0,highlightDuration:250,postscript:function(b,a){var g=this;(this._Row=
function(b,a,g){this.id=b;this.data=a;this.element=g}).prototype.remove=function(){g.removeRow(this.element)};a&&(this.srcNodeRef=a=a.nodeType?a:document.getElementById(a));this.create(b,a)},listType:"list",create:function(b,a){var g=this.domNode=a||n("div"),c;b&&(this.params=b,k.safeMixin(this,b),c=b["class"]||b.className||g.className);this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=g.id=g.id||this.id||"dgrid_"+q++;this.buildRendering();
c&&h.call(this,c);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&this.startup()},buildRendering:function(){var b=this.domNode,a=this.addUiClasses,g=this,d,f,l,q;q=this.isRTL="rtl"===(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();b.className="";n(b,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(a?".ui-widget":""));d=this.headerNode=n(b,"div.dgrid-header.dgrid-header-row"+(a?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));
f=this.bodyNode=n(b,"div.dgrid-scroller");e("ff")&&(f.tabIndex=-1);this.headerScrollNode=n(b,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(a?".ui-widget-header":""));l=this.footerNode=n("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));n(b,l);q&&(b.className+=" dgrid-rtl"+(e("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));r(f,"scroll",function(a){g.showHeader&&(d.scrollLeft=a.scrollLeft||f.scrollLeft);a.stopPropagation();r.emit(b,"scroll",{scrollTarget:f})});this.configStructure();
this.renderHeader();this.contentNode=this.touchNode=n(this.bodyNode,"div.dgrid-content"+(a?".ui-widget-content":""));this._listeners.push(this._resizeHandle=r(window,"resize",p.throttleDelayed(c,this)))},postCreate:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this.sort))},configStructure:function(){},resize:function(){var b=this.bodyNode,a=this.footerNode,a=this.showFooter?a.offsetHeight:0;this.headerScrollNode.style.height=
b.style.marginTop=this.headerNode.offsetHeight+"px";b.style.marginBottom=a+"px";f||(f=e("dom-scrollbar-width"),d=e("dom-scrollbar-height"),e("ie")&&(f++,d++),p.addCssRule(".dgrid-scrollbar-width","width: "+f+"px"),p.addCssRule(".dgrid-scrollbar-height","height: "+d+"px"),17!==f&&(p.addCssRule(".dgrid-header-row","right: "+f+"px"),p.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+f+"px")))},addCssRule:function(b,a){var g=p.addCssRule(b,a);this.cleanAddedRules&&this._listeners.push(g);return g},
on:function(b,a){var g=r(this.domNode,b,a);e("dom-addeventlistener")||this._listeners.push(g);return g},cleanup:function(){for(var b in this._rowIdToObject)if(this._rowIdToObject[b]!==this.columns){var a=document.getElementById(b);a&&this.removeRow(a,!0)}},destroy:function(){if(this._listeners){for(var b=this._listeners.length;b--;)this._listeners[b].remove();this._listeners=null}this._started=!1;this.cleanup();n(this.domNode,"!")},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=
0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0})},highlightRow:function(b,a){b=b.element||b;n(b,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){n(b,"!dgrid-highlight!ui-state-highlight")},a||this.highlightDuration)},adjustRowIndices:function(b){var a=b.rowIndex;if(-1<a){do-1<b.rowIndex&&(this.maintainOddEven&&-1<(b.className+" ").indexOf("dgrid-row ")&&n(b,"."+(1===a%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0===a%2?"dgrid-row-odd":"dgrid-row-even")),
b.rowIndex=a++);while((b=b.nextSibling)&&b.rowIndex!==a)}},renderArray:function(b,a,g){g=g||{};var c=g.start||0,d=document.createDocumentFragment(),f=[],l=0,q=b.length;a||(this._lastCollection=b);for(;l<q;)f[l]=this.insertRow(b[l],d,null,c++,g),l++;if((b=a?a.parentNode:this.contentNode)&&b.parentNode&&(b!==this.contentNode||q))b.insertBefore(d,a||null),q&&this.adjustRowIndices(f[q-1]);return f},renderHeader:function(){},_autoId:0,insertRow:function(b,a,g,c,d){var f=this.id+"-row-"+(this.collection&&
this.collection.getIdentity?this.collection.getIdentity(b):this._autoId++),l=document.getElementById(f),q=l&&l.previousSibling;l&&(l===g&&(g=(g.connected||g).nextSibling),this.removeRow(l));l=this.renderRow(b,d);l.className=(l.className||"")+" dgrid-row "+(1===c%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[l.id=f]=b;a.insertBefore(l,g||null);l.rowIndex=c;q&&q.rowIndex!==l.rowIndex-1&&this.adjustRowIndices(q);return l},renderRow:function(b){return n("div",
""+b)},removeRow:function(b,a){b=b.element||b;delete this._rowIdToObject[b.id];a||n(b,"!")},row:function(b){var a;if(b instanceof this._Row)return b;b.target&&b.target.nodeType&&(b=b.target);if(b.nodeType){do{var g=b.id;if(a=this._rowIdToObject[g])return new this._Row(g.substring(this.id.length+5),a,b);b=b.parentNode}while(b&&b!==this.domNode)}else return"object"===typeof b?a=this.collection.getIdentity(b):(a=b,b=this._rowIdToObject[this.id+"-row-"+a]),new this._Row(a,b,document.getElementById(this.id+
"-row-"+a))},cell:function(a){return{row:this.row(a)}},_move:function(a,c,g,d){var f,l;l=f=a.element;c=c||1;do if(a=f[0>c?"previousSibling":"nextSibling"]){do if((f=a)&&-1<(f.className+" ").indexOf(g+" ")){l=f;c+=0>c?1:-1;break}while(a=(!d||!f.hidden)&&f[0>c?"lastChild":"firstChild"])}else if(f=f.parentNode,!f||f===this.bodyNode||f===this.headerNode)break;while(c);return l},up:function(a,c,g){a.element||(a=this.row(a));return this.row(this._move(a,-(c||1),"dgrid-row",g))},down:function(a,c,g){a.element||
(a=this.row(a));return this.row(this._move(a,c||1,"dgrid-row",g))},scrollTo:function(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},get:function(a){var c="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]},set:function(a,c){if("object"===typeof a)for(var g in a)this.set(g,
a[g]);else g="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[g]?this[g].apply(this,[].slice.call(arguments,1)):this[a]=c;return this},_getClass:a,_setClass:h,_getClassName:a,_setClassName:h,_setSort:function(a,c){this.sort="string"!==typeof a?a:[{property:a,descending:c}];this._applySort()},_applySort:function(){this.refresh();if(this._lastCollection){var a=this.sort;if(a&&0<a.length){var c=a[0].property,g=!!a[0].descending;this._lastCollection.sort(function(a,b){var d=a[c],f=
b[c];void 0===d&&(d="");void 0===f&&(f="");return d===f?0:d>f!==g?1:-1})}this.renderArray(this._lastCollection)}},_setShowHeader:function(a){var c=this.headerNode;this.showHeader=a;n(c,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(c.scrollLeft=this.getScrollPosition().x)},_setShowFooter:function(a){this.showFooter=a;n(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"webSceneViewer/urlUtils":function(){define("dojo/io/script dojo/io-query esri/geometry/Point esri/Viewpoint esri/Camera esri/geometry/SpatialReference".split(" "),
function(k,r,e,p,m,n){var s={viewpointFromUrlParameter:function(h){var a=h.split(";"),f=null;if(0<a.length){var d="";h="";for(var q=0;q<a.length;q++)-1!==a[q].indexOf("cam:")?d=a[q]:h=a[q];if(""!==d&&(d=d.substr(4,d.length-4),a=d.split(","),3<=a.length)){var q=d=f=0,f=parseFloat(a[0]),d=parseFloat(a[1]),q=parseFloat(a[2]),l=n.WGS84;4===a.length&&(l=new n(parseInt(a[3],10)));a=new e(f,d,q,l);d=f=0;""!==h&&(h=h.split(","),0<=h.length&&(f=parseFloat(h[0]),1<h.length&&(d=parseFloat(h[1]))));f=new p({targetGeometry:void 0,
scale:void 0,rotation:void 0,camera:new m({position:a,heading:f,tilt:d})})}}return f},viewpointToUrlParameter:function(e,a,f){var d=e;f=f?f:!1;e=-1===e.indexOf("?")?"?":"\x26";d+=e+"viewpoint\x3dcam:";e=a.position.spatialReference.isWebMercator()&&!f?a.position.longitude:a.position.x;e=Math.round(1E8*e)/1E8;var q=a.position.spatialReference.isWebMercator()&&!f?a.position.latitude:a.position.y,q=Math.round(1E8*q)/1E8,l=Math.round(1E3*a.position.z)/1E3,c=Math.round(1E3*a.heading)/1E3,b=Math.round(1E3*
a.tilt)/1E3;a=a.position.spatialReference.isWebMercator()&&!f?"":","+a.position.spatialReference.wkid;return d+(e+","+q+","+l+a+";"+c+","+b)},shortenUrl:function(e,a,f){if("undefined"===typeof esriGeowConfig)f&&f(e);else{var d=esriGeowConfig.bitlyUrl;"https:"==location.protocol&&(d=esriGeowConfig.bitlyUrlSSL);d+="\x26longUrl\x3d"+encodeURIComponent(e)+"\x26format\x3djson";k.get({url:d,callbackParamName:"callback",load:function(d){d&&200==d.status_code&&d.data&&d.data.url&&0<d.data.url.length?a(d.data.url,
e):f&&f(e)},error:function(a){f&&f(e)}})}},urlParams:function(){var e=r.queryToObject(window.location.search.replace(/^\?/,"")),e=e||{},a;for(a in e)e.hasOwnProperty(a)&&(e[a]=e[a].replace(/(&lt;|&gt;|<|>|%3C|%3E)/g,""));return e},cleanUrl:function(){var e=r.queryToObject(window.location.search.replace(/^\?/,"")),e=e||{},a=s.urlParams();if(a.hasOwnProperty("viewingmode")&&(a.hasOwnProperty("layers")||a.hasOwnProperty("url")||a.hasOwnProperty("webscene")))delete e.viewingmode,e=decodeURIComponent(r.objectToQuery(e)),
window.history.pushState(null,null,location.pathname+"?"+e)}};return s})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),function(k,r,e,p,m,n,s,h,a,f,d){e.isAsync||f(0,function(){d(["./fx/Toggler"])});e=e.fx={};f={_fire:function(a,b){this[a]&&this[a].apply(this,b||[]);return this}};var q=function(a){this._index=-1;this._animations=a||[];this._current=this._onAnimateCtx=this._onEndCtx=
null;this.duration=0;p.forEach(this._animations,function(a){this.duration+=a.duration;a.delay&&(this.duration+=a.delay)},this)};q.prototype=new r;k.extend(q,{_onAnimate:function(){this._fire("onAnimate",arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=m.after(this._current,"onAnimate",k.hitch(this,"_onAnimate"),
!0),this._onEndCtx=m.after(this._current,"onEnd",k.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,b){this._current||(this._current=this._animations[this._index=0]);if(!b&&"playing"==this._current.status())return this;var d=m.after(this._current,"beforeBegin",k.hitch(this,function(){this._fire("beforeBegin")}),!0),g=m.after(this._current,"onBegin",k.hitch(this,function(a){this._fire("onBegin",arguments)}),!0),f=m.after(this._current,"onPlay",k.hitch(this,function(a){this._fire("onPlay",
arguments);d.remove();g.remove();f.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=m.after(this._current,"onAnimate",k.hitch(this,"_onAnimate"),!0);this._onEndCtx&&this._onEndCtx.remove();this._onEndCtx=m.after(this._current,"onEnd",k.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=m.after(this._current,"onPause",k.hitch(this,function(b){this._fire("onPause",arguments);a.remove()}),!0);
this._current.pause()}return this},gotoPercent:function(a,b){this.pause();var d=this.duration*a;this._current=null;p.some(this._animations,function(a,b){if(d<=a.duration)return this._current=a,this._index=b,!0;d-=a.duration;return!1},this);this._current&&this._current.gotoPercent(d/this._current.duration);b&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=this._animations[this._index]}var b=
m.after(this._current,"onStop",k.hitch(this,function(a){this._fire("onStop",arguments);b.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});k.extend(q,f);e.chain=function(a){return new q(a)};var l=function(a){this._animations=a||[];this._connects=[];this.duration=this._finished=0;p.forEach(a,function(a){var b=
a.duration;a.delay&&(b+=a.delay);this.duration<b&&(this.duration=b);this._connects.push(m.after(a,"onEnd",k.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=new n.Animation({curve:[0,1],duration:this.duration});var b=this;p.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(a){b._connects.push(m.after(b._pseudoAnimation,a,function(){b._fire(a,arguments)},!0))})};k.extend(l,{_doAction:function(a,b){p.forEach(this._animations,function(d){d[a].apply(d,b)});
return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,b){var d=this._pseudoAnimation;d[a].apply(d,b)},play:function(a,b){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(a,b){var d=this.duration*a;p.forEach(this._animations,function(a){a.gotoPercent(a.duration<d?1:d/a.duration,b)});this._call("gotoPercent",
arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},destroy:function(){this.stop();p.forEach(this._connects,function(a){a.remove()})}});k.extend(l,f);e.combine=function(a){return new l(a)};e.wipeIn=function(a){var b=a.node=s.byId(a.node),d=b.style,g;a=n.animateProperty(k.mixin({properties:{height:{start:function(){g=d.overflow;d.overflow="hidden";if("hidden"==d.visibility||"none"==
d.display)return d.height="1px",d.display="",d.visibility="",1;var a=h.get(b,"height");return Math.max(a,1)},end:function(){return b.scrollHeight}}}},a));var f=function(){d.height="auto";d.overflow=g};m.after(a,"onStop",f,!0);m.after(a,"onEnd",f,!0);return a};e.wipeOut=function(a){var b=(a.node=s.byId(a.node)).style,d;a=n.animateProperty(k.mixin({properties:{height:{end:1}}},a));m.after(a,"beforeBegin",function(){d=b.overflow;b.overflow="hidden";b.display=""},!0);var g=function(){b.overflow=d;b.height=
"auto";b.display="none"};m.after(a,"onStop",g,!0);m.after(a,"onEnd",g,!0);return a};e.slideTo=function(c){var b=null,d=null,g=function(g){return function(){var c=h.getComputedStyle(g),f=c.position;b="absolute"==f?g.offsetTop:parseInt(c.top)||0;d="absolute"==f?g.offsetLeft:parseInt(c.left)||0;"absolute"!=f&&"relative"!=f&&(c=a.position(g,!0),b=c.y,d=c.x,g.style.position="absolute",g.style.top=b+"px",g.style.left=d+"px")}}(c.node=s.byId(c.node));g();c=n.animateProperty(k.mixin({properties:{top:c.top||
0,left:c.left||0}},c));m.after(c,"beforeBegin",g,!0);return c};return e})},"dstore/Memory":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array ./Store ./Promised ./SimpleQuery ./QueryResults".split(" "),function(k,r,e,p,m,n,s){return k([p,m,n],{constructor:function(){this.storage.version=0},postscript:function(){this.inherited(arguments);this.setData(this.data||[])},data:null,autoEmitEvents:!1,getSync:function(e){return this.storage.fullData[this.storage.index[e]]},putSync:function(e,
a){a=a||{};var f=this.storage,d=f.index,q=f.fullData,l=this.Model;l&&!(e instanceof l)&&(e=this._restore(e));var c=this.getIdentity(e);null==c&&(this._setIdentity(e,"id"in a?a.id:Math.random()),c=this.getIdentity(e));f.version++;var f=c in d?"update":"add",l={target:e},b;if("update"===f){if(!1===a.overwrite)throw Error("Object already exists");q.splice(b=d[c],1);c=b}else c=this.defaultNewToStart?0:q.length;var t;if("beforeId"in a){var g=a.beforeId;null===g?t=q.length:(t=d[g],b<t&&--t);void 0!==t?
l.beforeId=g:(console.error("options.beforeId was specified but no corresponding index was found"),t=c)}else t=c;q.splice(t,0,e);b=isFinite(b)?Math.min(b,t):t;for(c=q.length;b<c;++b)d[this.getIdentity(q[b])]=b;this.emit(f,l);return e},addSync:function(e,a){(a=a||{}).overwrite=!1;return this.putSync(e,a)},removeSync:function(e){var a=this.storage,f=a.index,a=a.fullData;if(e in f)return f=a.splice(f[e],1)[0],this._reindex(),this.emit("delete",{id:e,target:f}),!0},setData:function(e){this.parse&&(e=
this.parse(e));e.items&&(this.idProperty=e.identifier||this.idProperty,e=e.items);this.storage.fullData=this.data=e;this._reindex()},_reindex:function(){for(var e=this.storage,a=e.index={},f=e.fullData,d=this.Model,q=Object.prototype,l=0,c=f.length;l<c;l++){var b=f[l];if(d&&!(b instanceof d)){var t=this._restore(b,b.__proto__===q);b!==t&&(f[l]=b=t)}a[this.getIdentity(b)]=l}e.version++},fetchSync:function(){var e=this.data;if(!e||e._version!==this.storage.version){for(var e=this.storage.fullData,a=
this.queryLog,f=0,d=a.length;f<d;f++)e=a[f].querier(e);e._version=this.storage.version;this.data=e}return new s(e)},fetchRangeSync:function(e){var a=this.fetchSync();return new s(a.slice(e.start,e.end),{totalLength:a.length})},_includePropertyInSubCollection:function(e){return"data"!==e&&this.inherited(arguments)}})})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(k,r,e){var p=k.NodeList;r.extend(p,{_buildArrayFromCallback:function(e){for(var n=[],
s=0;s<this.length;s++){var h=e.call(this[s],this[s],n);h&&(n=n.concat(h))}return n},_getUniqueAsNodeList:function(m){for(var n=[],s=0,h;h=m[s];s++)1==h.nodeType&&-1==e.indexOf(n,h)&&n.push(h);return this._wrap(n,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(e,n){var s=this._getUniqueAsNodeList(e),s=n?k._filterResult(s,n):s;return s._stash(this)},_getRelatedUniqueNodes:function(e,n){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(n),e)},children:function(e){return this._getRelatedUniqueNodes(e,
function(e,m){return r._toArray(e.childNodes)})},closest:function(e,n){return this._getRelatedUniqueNodes(null,function(s,h){do if(k._filterResult([s],e,n).length)return s;while(s!=n&&(s=s.parentNode)&&1==s.nodeType);return null})},parent:function(e){return this._getRelatedUniqueNodes(e,function(e,m){return e.parentNode})},parents:function(e){return this._getRelatedUniqueNodes(e,function(e,m){for(var h=[];e.parentNode;)e=e.parentNode,h.push(e);return h})},siblings:function(e){return this._getRelatedUniqueNodes(e,
function(e,m){for(var h=[],a=e.parentNode&&e.parentNode.childNodes,f=0;f<a.length;f++)a[f]!=e&&h.push(a[f]);return h})},next:function(e){return this._getRelatedUniqueNodes(e,function(e,m){for(var h=e.nextSibling;h&&1!=h.nodeType;)h=h.nextSibling;return h})},nextAll:function(e){return this._getRelatedUniqueNodes(e,function(e,m){for(var h=[],a=e;a=a.nextSibling;)1==a.nodeType&&h.push(a);return h})},prev:function(e){return this._getRelatedUniqueNodes(e,function(e,m){for(var h=e.previousSibling;h&&1!=
h.nodeType;)h=h.previousSibling;return h})},prevAll:function(e){return this._getRelatedUniqueNodes(e,function(e,m){for(var h=[],a=e;a=a.previousSibling;)1==a.nodeType&&h.push(a);return h})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(e,n){return 0!=n%2})},odd:function(){return this.filter(function(e,n){return 0==
n%2})}});return p})},"webSceneViewer/webScene/WebScene":function(){define("esri/core/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/on dojo/string dojo/when esri/core/Accessor esri/core/Evented esri/core/watchUtils esri/request esri/core/lang esri/portal/support/PortalUtil esri/geometry/Extent esri/geometry/support/webMercatorUtils esri/geometry/SpatialReference webSceneViewer/spatialReferenceUtils esri/layers/GroupLayer esri/layers/FeatureLayer esri/layers/SceneLayer esri/layers/Layer esri/layers/support/TileInfo esri/layers/support/LayerDrawingOptions esri/Viewpoint esri/widgets/PopupLegacy/PopupTemplate esri/views/3d/support/cameraUtils esri/views/3d/support/viewpointUtils ../environmentUtils ../basemapUtils ../urlUtils ./WebSceneLayers ./Presentation ./LayerTemplates webSceneViewer/widgets/MessageListWidget/MessageListWidget webSceneViewer/widgets/Dialog/ConfirmDialog dojo/i18n!webSceneViewer/nls/viewer".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y,u,F,v,D,A,z,E,w,x,G,H,C,J,K,N,M,I,O,B){function P(a){if(a.renderer){var b=a.get("renderer");a._websceneEditorProperties.originalRenderer=new b.constructor(b.toJSON())}else a.then(function(b){b=a.get("renderer");a._websceneEditorProperties.originalRenderer=a.renderer?new b.constructor(b.toJSON()):null})}function U(a){if(!(!0===a.disablePopup||null!=a.popupTemplate))if(a.isInstanceOf(F)||a.isInstanceOf(v)&&null!=a._companionFeatureLayer){var b=a.popupTemplate||
new w({title:a.title,fieldInfos:a.fields&&a.fields.map(function(a){var b={fieldName:a.name,label:a.alias,visible:!0};"esriFieldTypeDate"===a.type&&(b.format={dateFormat:"longMonthDayYear"});return b})});a.set("disablePopup",!1);a.set("popupTemplate",b)}}function V(a,b,g){var c;if(b.layerDefinition&&b.layerDefinition.drawingInfo){var d=b.layerDefinition.drawingInfo,f=new z(r.clone(d));M.hasContentByReference(d.renderer)?c=M.createRenderer(d.renderer,g).then(function(b){a.renderer=b;a.showLegend=!1},
function(b){console.warn("Failed to create renderer by reference for "+a.title+": "+(b.message||b));I.show({message:'"'+a.title+'" '+B.messages.byReferenceRendererUnsupported,details:B.messages.layerDisplaysWithServiceSymbology+"\x3cbr\x3e"+a.url,type:I.MessageTypes.WARNING})}):f.renderer?(g=a instanceof v,(a instanceof F||g)&&!K.isFeatureServiceRendererSupported(d.renderer.type)?I.show({message:'"'+a.title+'" '+B.messages.featureServiceNotSupportedRendererType+" "+d.renderer.type,details:B.messages.layerDisplaysWithServiceSymbology+
"\x3cbr\x3e"+a.url,type:I.MessageTypes.WARNING}):a.renderer=f.renderer):b.layerDefinition.drawingInfo.renderer&&I.show({message:'"'+a.title+'" '+B.messages.featureServiceNotSupportedRendererType+" "+d.renderer.type,details:B.messages.layerDisplaysWithServiceSymbology+"\x3cbr\x3e"+a.url,type:I.MessageTypes.WARNING});f.hasOwnProperty("labelingInfo")&&a.set("labelingInfo",f.labelingInfo)}null!=b.minScale?a.minScale=b.minScale:b.layerDefinition&&null!=b.layerDefinition.minScale&&(a.minScale=b.layerDefinition.minScale);
null!=b.maxScale?a.maxScale=b.maxScale:b.layerDefinition&&null!=b.layerDefinition.maxScale&&(a.maxScale=b.layerDefinition.maxScale);b.layerDefinition&&(b.layerDefinition.elevationInfo&&0<Object.keys(b.layerDefinition.elevationInfo).length)&&a.set("elevationInfo",r.clone(b.layerDefinition.elevationInfo));b.visibilityMode&&a.set("visibilityMode",b.visibilityMode);b.listMode&&a.set("listMode",b.listMode);b.popupInfo&&(0===Object.keys(b.popupInfo).length?a.set("popupTemplate",null):a.set("popupTemplate",
new w(b.popupInfo)));b.hasOwnProperty("disablePopup")&&a.set("disablePopup",b.disablePopup);b.showLabels&&a.set("showLabels",b.showLabels);return c}function Q(a){return r.exists("spatialReference.wkid",a)?(a=a.spatialReference,a=a instanceof g?a.clone():g.fromJSON(a)):g.WGS84}function R(a,b,g,c){var d=[],f=K.create(a);if(void 0===f)return console.log("cannot apply layer to map "+a.id+" ",a.url),!1;var t=window._webSceneViewerView;switch(c){case 1:C._resetView(b,Q(a.serviceInfo),f.fullExtent);H.adjustLightForLayer(t,
f);break;case 2:var e=Q(a.serviceInfo);C._resetView(b,e,f.fullExtent);H.adjustLightForLayer(t,f);I.show({message:B.messages.BasemapDropWarningTitle,type:I.MessageTypes.WARNING,details:B.messages.BasemapDropWarning});e.isWebMercator()||(t.globeMode="planar")}f.on("graphics-controller-create",function(a){if(!r.exists("graphicsSource.layerDefinition.advancedQueryCapabilities.supportsPagination",f)||!1===f.graphicsSource.layerDefinition.advancedQueryCapabilities.supportsPagination)n.once(a.graphicsController,
"query-limit-exceeded",function(){var a={message:'"'+f.title+'" '+s.substitute(B.messages.layerDidNotDrawCompletely,{limit:f.maxRecordCount}),type:I.MessageTypes.WARNING,details:f.url};I.show(a)})});f._websceneEditorProperties={editedFlags:{renderer:!1,labelingInfo:!1,elevationInfo:!1,listMode:!1,visibilityMode:!1,popupInfo:!1,showLabels:!1,showLegend:!1}};a.thumbnailUrl&&(f._websceneEditorProperties.thumbnailUrl=a.thumbnailUrl);a.portalLayerItem&&(f._websceneEditorProperties.portalLayerItem=a.portalLayerItem);
a.originalOperationalLayer&&(f._websceneEditorProperties.originalOperationalLayer=a.originalOperationalLayer);f instanceof u&&a.layers.forEach(function(a,b){a.layerIndex=b;var c;a.itemId&&g?c=L.addContentByItemId(f,g,a.itemId,a):(a.itemId&&console.warn("Found item id in layer but no portal to query. Fallback to add by url.",a),c=L.addLayerToMapByUrl(f,a,g));d.push(c)});var l=J.urlParams();d.push(W(b,f,a).then(function(){0<c&&(y.pingGeometryService(f.fullExtent),t.viewpoint=l.viewpoint&&2===c?J.viewpointFromUrlParameter(l.viewpoint):
t.createViewpoint({target:f.fullExtent,heading:0,tilt:0.5}));return V(f,a,g)}).then(function(){P(f);U(f)}).then(function(){return f}));return d}function W(a,b,g){b._websceneIndex=g.layerIndex;a:{g=g.layerIndex;for(var c=a.layers.getAll(),d=0;d<c.length;d++){var f=c[d];if(g<f._websceneIndex){g=d;break a}else if(g>f._websceneIndex&&(f=c[d+1]?c[d+1]._websceneIndex:null,!f||g<f)){g=d+1;break a}}g=void 0}a.add(b,g);return b}function S(a){for(var b=0;b<K.layerHandlers.length;b++)if(K.layerHandlers[b].condition(a))return!0;
return!1}function T(a){a instanceof g||(a=g.fromJSON(a));return a.isWebMercator()}function X(a){return 4326===a.wkid||T(a)}var Y={title:B.defaultWebSceneName,type:"Web Scene",typeKeywords:"Web Scene, 3D, Map, Scene, Web, Streaming"},L=k([a,f],{normalizeCtorArgs:function(a){a&&a.spatialReference&&(1.3<=a.version?a.spatialReference=g.fromJSON(a.spatialReference):delete a.spatialReference);a&&a.clippingArea&&(a.clippingArea.geometry=b.fromJSON(a.clippingArea.geometry));a=r.mixin({},a);a.baseMap&&null==
a.baseMap.elevationLayers&&(a.baseMap.elevationLayers=C.DefaultBasemapJson.elevationLayers);return a},getDefaults:function(){return{baseMap:C.DefaultBasemapJson,operationalLayers:[],portalItemProperties:Y,presentation:new N,spatialReference:g.WebMercator,viewingMode:"global"}},initialize:function(){this._validate()},authoringApp:void 0,authoringAppVersion:void 0,baseMap:void 0,_initialStateSetter:function(a){a&&(a.environment&&!a.environment.declaredClass)&&(a.environment=H.fromJSON(a.environment));
return a},operationalLayers:void 0,portalItemProperties:void 0,presentation:void 0,_presentationSetter:function(a){if(!a)return a;a.declaredClass||(a=N.fromJSON(a));return a},_snippetGetter:function(){return this.portalItemProperties.snippet},_snippetSetter:function(a){this.portalItemProperties.snippet=a},_tagsGetter:function(){return this.portalItemProperties.tags},_tagsSetter:function(a){this.portalItemProperties.tags=a},_titleGetter:function(){return this.portalItemProperties.title},_titleSetter:function(a){this.portalItemProperties.title=
a},toc:void 0,version:void 0,addOperationalLayer:function(a){this.operationalLayers.push(a);return this.operationalLayers},removeOperationalLayer:function(a){for(var b=-1,g=0;g<this.operationalLayers.length;g++)if(this.operationalLayers[g].id===a){b=g;break}return this.operationalLayers.splice(b,1)},_updateLayerFromMap:function(a){var b=function(a,b){if(-1===a.indexOf("."))return b[a];var g=a.split(".");if(2==g.length)return b[g[0]][g[1]];if(3==g.length)return b[g[0]][g[1]][g[2]];if(4==g.length)return b[g[0]][g[1]][g[2]][g[3]];
if(5==g.length)return b[g[0]][g[1]][g[2]][g[3]][g[4]];if(5<g.length)throw Error("propName.length \x3e 5 is not implemented");},g=function(a,g){if(2<arguments.length)throw Error("get value if exists called with too many parameters");return r.exists(a,g)?b(a,g):void 0},c=function(a,b,g){return r.exists(a,b)?g:void 0},d=function(a,g,c){return r.exists(a,g)&&!0===b(a,g)?c:void 0},f=function(a){return a.elevationInfo&&0<Object.keys(a.elevationInfo).length?l.fixJson(a.elevationInfo):void 0},t=function(a){if(a.popupTemplate)return{title:a.popupTemplate.info.title,
fieldInfos:r.clone(a.popupTemplate.info.fieldInfos),description:a.popupTemplate.info.description,showAttachments:a.popupTemplate.info.showAttachments,mediaInfos:r.clone(a.popupTemplate.info.mediaInfos)}},q=function(a){if(a._websceneEditorProperties&&!1===a._websceneEditorProperties.editedFlags.labelingInfo)return g("originalOperationalLayer.layerDefinition.drawingInfo.labelingInfo",a._websceneEditorProperties);if(a._websceneEditorProperties&&!0===a._websceneEditorProperties.editedFlags.labelingInfo){var b=
new z;b.labelingInfo=a.labelingInfo;return(a=b.toJSON())&&a.labelingInfo}return null},m=function(a){if(a._websceneEditorProperties&&!1===a._websceneEditorProperties.editedFlags.renderer)return g("originalOperationalLayer.layerDefinition.drawingInfo.renderer",a._websceneEditorProperties);if(a._websceneEditorProperties&&!0===a._websceneEditorProperties.editedFlags.renderer){var b=new z;b.renderer=a.renderer;return(a=b.toJSON())&&a.renderer}return null},h={url:a.url,title:a.title,id:a.id,layerType:K.extrapolateTypeFromLayerInstance(a),
visibility:a.visible,opacity:a.opacity||1-a.transparency,layerDefinition:{drawingInfo:{}}},n=a._websceneEditorProperties&&a._websceneEditorProperties.originalOperationalLayer;h.itemId=g("portalLayerItem.item.id",a._websceneEditorProperties)||g("itemId",n);null!=n?(h.minScale=c("minScale",n,a.minScale),void 0===h.minScale&&(h.layerDefinition.minScale=c("layerDefinition.minScale",n,a.minScale)),h.maxScale=c("maxScale",n,a.maxScale),void 0===h.maxScale&&(h.layerDefinition.maxScale=c("layerDefinition.maxScale",
n,a.maxScale)),h.layerDefinition.definitionExpression=c("layerDefinition.definitionExpression",n,"string"===typeof a.definitionExpression&&0<a.definitionExpression.length?a.definitionExpression:void 0),h.layerDefinition.drawingInfo.labelingInfo=c("layerDefinition.drawingInfo.labelingInfo",n,q(a)),h.visibilityMode=d("_websceneEditorProperties.editedFlags.visibilityMode",a,a.visibilityMode)||g("visibilityMode",n),h.listMode=d("_websceneEditorProperties.editedFlags.listMode",a,a.listMode)||g("listMode",
n),h.popupInfo=d("_websceneEditorProperties.editedFlags.popupInfo",a,t(a))||g("popupInfo",n),h.showLabels=d("_websceneEditorProperties.editedFlags.showLabels",a,a.showLabels),h.showLegend=d("_websceneEditorProperties.editedFlags.showLegend",a,a.showLegend),void 0===h.showLabels&&(h.showLabels=g("showLabels",n)),void 0===h.showLegend&&(h.showLegend=g("showLegend",n)),h.layerDefinition.elevationInfo=d("_websceneEditorProperties.editedFlags.elevationInfo",a,f(a))||g("elevationInfo",n.layerDefinition),
h.layerDefinition.drawingInfo.renderer=m(a),h.disablePopup=d("_websceneEditorProperties.editedFlags.popupDisable",a,a.disablePopup),void 0===h.disablePopup&&(h.disablePopup=g("disablePopup",n))):(h.visibilityMode=d("_websceneEditorProperties.editedFlags.visibilityMode",a,a.visibilityMode),h.listMode=d("_websceneEditorProperties.editedFlags.listMode",a,a.listMode),h.popupInfo=d("_websceneEditorProperties.editedFlags.popupInfo",a,t(a)),h.showLabels=d("_websceneEditorProperties.editedFlags.showLabels",
a,a.showLabels),h.showLegend=d("_websceneEditorProperties.editedFlags.showLegend",a,a.showLegend),h.layerDefinition.elevationInfo=d("_websceneEditorProperties.editedFlags.elevationInfo",a,f(a)),h.layerDefinition.drawingInfo.renderer=m(a),h.disablePopup=d("_websceneEditorProperties.editedFlags.popupDisable",a,a.disablePopup));a instanceof u&&(delete h.url,h.layers=[],e.forEach(a.layers.getAll(),function(a){h.layers.push(this._updateLayerFromMap(a))}.bind(this)));a.url&&(0<a.url.indexOf("s3-eu-west-1.amazonaws.com")&&
a.resourceInfo)&&(h.resourceInfo=JSON.parse(a.resourceInfo));h=l.fixJson(h,!0);h.layerDefinition&&(h.layerDefinition.elevationInfo&&0===Object.keys(h.layerDefinition.elevationInfo).length)&&delete h.layerDefinition.elevationInfo;h.layerDefinition&&(h.layerDefinition.drawingInfo&&0===Object.keys(h.layerDefinition.drawingInfo).length)&&delete h.layerDefinition.drawingInfo;h.layerDefinition&&0===Object.keys(h.layerDefinition).length&&delete h.layerDefinition;return h},updateFromView:function(a,b){var g=
a.map;a.map.spatialReference&&(this.spatialReference=a.map.spatialReference.clone());this.viewingMode="spherical"===a.globeMode?"global":"local";var c=function(a,b){for(var g,c=0;c<b.length;c++)b[c].id===a&&(g=b[c]);return g},d=function(a,b){var g=c(a.id,b);g&&a.visibility!==g.visibility&&(console.debug("keeping visibility for layer "+g.id+" as "+g.visibility),a.visibility=g.visibility);g&&"GroupLayer"===a.layerType&&a.layers.forEach(function(a){d(a,g.layers)})},f=function(a){return"number"!==typeof a||
isNaN(a)?a:Math.round(1E6*a)/1E6};!1!==b&&(this.baseMap=C.toJSON(a,g.basemap));var e,l=[];e=this.calculateWebsceneExtent(g,b);g.layers.forEach(function(a){"SilentContentLayer"===a.id||"__basemapErrorFallbackLayer__"===a.id||(a=this._updateLayerFromMap(a),l.push(a))}.bind(this));if(!1===b&&this.operationalLayers&&0<this.operationalLayers.length)for(g=0;g<l.length;g++)d(l[g],this.operationalLayers);this.set("operationalLayers",l);e&&(e=t.webMercatorToGeographic(e),this.portalItemProperties.extent=f(e.xmin)+
", "+f(e.ymin)+", "+f(e.xmax)+", "+f(e.ymax))},calculateWebsceneExtent:function(a,b){var g=null;if(this.clippingArea&&this.clippingArea.clip&&this.clippingArea.geometry)g=this.clippingArea.geometry;else if(0<a.layers.length)a.layers.forEach(function(a){if(!("SilentContentLayer"===a.id||"__basemapErrorFallbackLayer__"===a.id))try{var b=a.get("fullExtent");b&&(b.spatialReference.isWebMercator()||(b=t.geographicToWebMercator(b)),g=null==g?b.clone():g.union(b))}catch(c){}}.bind(this));else if(b||!r.exists("portalItemProperties.extent",
this))g=x.toExtent(view,G.toCamera(view,E.fromJSON(this.initialState.viewpoint)));return g},toJSON:function(a){var b={operationalLayers:this.operationalLayers,baseMap:this.baseMap,version:(1).toString()+"."+(3).toString(),authoringApp:this.currentAuthoringApp,authoringAppVersion:this.currentAuthoringAppVersion,spatialReference:this.spatialReference.toJSON(),viewingMode:this.viewingMode};this.clippingArea&&(b.clippingArea={clip:this.clippingArea.clip,geometry:this.clippingArea.geometry.toJSON()});
this.initialState&&(b.initialState={viewpoint:this.initialState.viewpoint},this.initialState.environment&&(b.initialState.environment=H.toJSON(this.initialState.environment)));this.presentation&&(b.presentation=this.presentation.toJSON());return JSON.stringify(b,null,a)},_applyInitialState:function(a,b){var g=null,c=null;if(a){var f=window.location.hash;if(""!==f){var f=parseInt(f.substr(1),10)-1,t=this.presentation.slides.getAll();if((f=0>f||f>=t.length?null:t[f])&&f.viewpoint)c=E.fromJSON(f.viewpoint).camera}else if(b.viewpoint&&
(f=J.viewpointFromUrlParameter(b.viewpoint)))c=f.camera;this.initialState&&this.initialState.viewpoint&&(g=E.fromJSON(this.initialState.viewpoint).camera);if(g&&(this.initialState.environment||a.setInitialExtent(null,3)))a.camera=g;d.whenOnce(a,"ready",function(){c&&(a.camera=c);d.whenTrueOnce(a.environment.lighting,"ready",function(){this.get("initialState.environment.lighting")?H.applyToView(this.initialState.environment,a):H.adjustLightDateForLatitude(a.environment.lighting,a.camera.position)}.bind(this))}.bind(this))}},
applyToMap:function(a,b,c,d,f){var t=[];a.spatialReference=this.spatialReference||g.WebMercator;"local"===this.viewingMode&&(-1===this.portalItemProperties.typeKeywords.indexOf("viewingmode-local")&&(this.portalItemProperties.typeKeywords+=", ViewingMode-Local"),b.globeMode="planar",b.clippingArea=this.clippingArea&&this.clippingArea.clip?this.clippingArea.geometry:b.clippingArea);var e=[];if(!d||!0===d.basemap){var l=new m;h(C.setFromJSON(b,this.baseMap),function(){l.resolve()},function(a){l.reject({msg:a})});
t.push(l.promise)}(!d||!0===d.initialState)&&this._applyInitialState(b,f);this.operationalLayers.forEach(function(b,g){if(S(b))if(b.layerIndex=g,b.originalOperationalLayer=r.clone(b),"GroupLayer"===b.layerType){b.originalOperationalLayer.layers=null;for(var d=[],f=0;f<b.layers.length;f++)if(S(b.layers[f])){var e=b.layers[f];e.originalOperationalLayer=r.clone(b.layers[f]);d.push(e)}else I.show({message:B.messages.addLayerFailed+(""!==b.layers[f].title?": \x3ci\x3e"+b.layers[f].title+"\x3c/i\x3e":""),
type:I.MessageTypes.ERROR,details:B.messages.layerTypeNotSupported+" "+b.layers[f].layerType,collapsed:!1});b.layers=d;(d=R(b,a,c))&&(t=t.concat(d))}else b.itemId&&c?d=L.addContentByItemId(a,c,b.itemId,b):(b.itemId&&console.warn("Found item id in layer but no portal to query. Fallback to add by url.",b),d=L.addLayerToMapByUrl(a,b,c)),d&&t.push(d);else I.show({message:B.messages.addLayerFailed+(""!==b.title?": \x3ci\x3e"+b.title+"\x3c/i\x3e":""),type:I.MessageTypes.ERROR,details:B.messages.layerTypeNotSupported+
" "+b.layerType,collapsed:!1})}.bind(this));var q=new m,n=setTimeout(function(){q.reject("webscene not resolved on time")},2E4);if(0===t.length)return q.isResolved()||q.resolve({layers:e,slides:this.presentation.slides}),q;var y=t.length;for(b=0;b<t.length;b++)t[b].always(function(a,b){y--;a.isResolved()?b instanceof D?e.push(b):b&&b.layers&&(e=e.concat(b.layers)):I.show({message:B.messages.addLayerFailed,type:I.MessageTypes.ERROR,details:b.msg||b.message,collapsed:!1});0===y&&(clearTimeout(n),q.resolve({layers:e,
slides:this.presentation.slides}))}.bind(this,t[b]));q.then(function(b){a.layers.forEach(function(a){void 0!==a._websceneIndex&&delete a._websceneIndex})});return q},_validate:function(){if("global"===this.viewingMode){if(!T(this.spatialReference))throw Error(B.messages.websceneGlobalSR);var a=[];this.initialState&&this.initialState.viewpoint&&(this.initialState.viewpoint.camera&&a.push(this.initialState.viewpoint.camera.position.spatialReference),this.initialState.viewpoint.targetGeometry&&a.push(this.initialState.viewpoint.targetGeometry.spatialReference));
this.presentation&&this.presentation.slides&&this.presentation.slides.forEach(function(b){b.viewpoint&&(b.viewpoint.camera&&a.push(b.viewpoint.camera.position.spatialReference),b.viewpoint.targetGeometry&&a.push(b.viewpoint.targetGeometry.spatialReference))});if(!a.every(X))throw Error(B.messages.websceneGlobalEmbeddedSR);}else if(y.isGeographicCRS(this.spatialReference))throw Error(B.messages.websceneLocalSRGCS);}});r.mixin(L,{getFromUrl:function(a,b){var g=new m,d=new c(a);q({url:d.useSSL(window.location.protocol,
b)}).then(function(a){var b=L.checkVersion(a.version);if(b.isCompatible)try{var c=new L(a);g.resolve(c)}catch(d){g.reject(d.message)}else g.reject(b.message)},function(a){g.reject(a)});return g},getFromPortalItem:function(a,b){var g=new m,c=a.getItem(b).then(function(d){c=d;a.getItemData(b).then(function(d){var f=L.checkVersion(d.version);if(f.isCompatible)try{var t=new L(d);t.set("portalItemProperties",c);g.resolve(t);a.isSignedIn()||n(a,"sign-in",function(){a.getItem(b).then(function(a){t.set("portalItemProperties",
a)})})}catch(e){g.reject(e.message)}else g.reject(f.message)})},function(a){g.reject(a)});return g},addLayerHandlers:function(a){for(var b=0;b<a.length;b++)K.addHandler(a[b])},_getLayerHandlers:function(){return K.getHandlers()},addLayerByItemId:function(a,b,g,c,d){var f=new m;this.addContentByItemId(a,b,g,c,d).then(function(b){a.layers.forEach(function(a){void 0!==a._websceneIndex&&delete a._websceneIndex});f.resolve(b)},function(a){f.reject(a)});return f},addContentByItemId:function(a,b,g,c,d,f){var t=
this,e=new m;b.getItem(g).then(function(l){b.getItemData(g).then(function(q){q&&q.hasOwnProperty("_ssl")&&delete q._ssl;"Scene Service"===l.type?t._addSceneServiceItem(a,b,l,g,q,c,f).then(e.resolve,e.reject):"Web Scene"==l.type?t._importWebSceneItem(a,b,d,l,q).then(e.resolve,e.reject):t._doAddLayerByItemId(a,b,g,l,q,c,f).then(e.resolve,e.reject)},function(a){e.reject(a)})},function(a){e.reject(a)});e.then(function(a){if(a&&0<a.length)for(var b=0;b<a.length;b++)a[b][0]&&a[b][0].warning&&I.show({message:a[b].warning,
type:I.MessageTypes.WARNING,details:B.messages.itemId+" "+g+"\x3cbr\x3e"+B.messages.itemType+" "+a[b].type});console.log("layer added by item id: "+g)},function(a){I.show({message:a.itemType&&"WebScene"===a.itemType?B.messages.sceneRejectTitle:B.messages.addLayerFailed,type:I.MessageTypes.ERROR,details:(a.msg?a.msg+"\x3cbr\x3e"||"":"")+B.messages.itemId+" "+g,collapsed:!1})});return e.promise},_doAddLayerByItemId:function(a,b,g,c,d,f,t){var e=this,l=[];t=t?t:this.spatialReferenceLocked?0:1;if(!d||
0===Object.keys(d).length){var q=r.mixin({url:c.url,itemId:g,title:c.title,opacity:c.opacity,visibility:c.visibility,thumbnailUrl:c.thumbnailUrl},f);q.portalLayerItem={item:c,itemData:d};for(var n in q)null==q[n]&&delete q[n];n=e.addLayerToMapByUrl(a,q,b,t);l.push(n)}else if(("Feature Service"===c.type||"Scene Service"===c.type)&&d){var y=function(t,l,q,h){q=f&&f.url||c.url;null==q.match(/\/\d+\/?$/)&&null!=t.id&&("Scene Service"===c.type&&(q+="/layers"),q=q+"/"+t.id);delete t.id;q=r.mixin(t,{url:q,
itemId:g,opacity:c.opacity,visibility:c.visibility,thumbnailUrl:c.thumbnailUrl});q=L.mixLayerItemWithWebSceneOverrides(q,f);q.portalLayerItem={item:c,itemData:d};q.layerIndex=void 0!==t.layerIndex?t.layerIndex:l;for(var n in q)null==q[n]&&delete q[n];return e.addLayerToMapByUrl(a,q,b,h)};if(d.layers)if(f&&f.url&&null!=f.url.match(/\/\d+\/?$/)&&0<f.url.match(/\/\d+\/?$/).length){n=f.url.match(/\/\d+\/?$/)[0];n=Number(n.replace(/\//g,""));for(q=0;q<d.layers.length;q++)if(d.layers[q]&&d.layers[q].id==
n){l.push(y(d.layers[q],n,d.layers,t));break}}else{if("Scene Service"===c.type&&t){var u=t,s=h(null),p=[];d.layers.forEach(function(a,b,g){s=s.then(function(){return y(a,b,g,u)}).then(function(a){a instanceof D?p.push(a):p=p.concat(a.layers);0<p.length&&(u=0)}).otherwise(function(a){this._showLayerAddError(a.msg)}.bind(this))}.bind(this));return s=s.then(function(){return{layers:p}})}d.layers.forEach(function(a,b,g){l.push(y(a,b,g,t))})}else l.push(y({},null,[],t))}else if("Map Service"===c.type){n=
r.mixin({url:c.url,itemId:g,title:c.title,opacity:c.opacity,visibility:c.visibility,thumbnailUrl:c.thumbnailUrl},f);d&&(n.layerDefinition={minScale:d.minScale,maxScale:d.maxScale});n.portalLayerItem={item:c,itemData:d};for(q in n)null==n[q]&&delete n[q];var k=new m;l.push(k);e.addLayerToMapByUrl(a,n,b,t).then(function(a){k.resolve(a);I.show({message:B.messages.layerItemPropertiesFromMapServer,type:I.MessageTypes.WARNING})},function(a){k.reject(a)})}else if("Image Service"===c.type){n=r.mixin(d,{url:c.url,
itemId:g,title:c.title,opacity:c.opacity,visibility:c.visibility,thumbnailUrl:c.thumbnailUrl});n=L.mixLayerItemWithWebSceneOverrides(n,f);n.portalLayerItem={item:c,itemData:d};for(var F in n)null==n[F]&&delete n[F];n=e.addLayerToMapByUrl(a,n,b,t);l.push(n)}else{var G=new m;l.push(G);setTimeout(function(){G.reject({msg:B.messages.layerItemTypeNotSupported+" "+c.type})},0)}var x=l;if(1<x.length){var v=[],x=new m;for(n=0;n<l.length;n++)l[n].always(function(a,b){l.splice(l.indexOf(a),1);a.isResolved()?
b instanceof D?v.push(b):v=v.concat(b.layers):this._showLayerAddError(b.msg);0===l.length&&(0<v.length?x.resolve({layers:v}):x.reject())}.bind(this,l[n]))}else x=l[0];return x},_showLayerAddError:function(a){I.show({message:B.messages.addLayerFailed,type:I.MessageTypes.ERROR,details:a,collapsed:!1})},_addSceneServiceItem:function(a,b,g,c,d,f,t){var e=new m,l=this,q=new m;b.getRelatedItems(c).then(function(a){if(a&&1===a.total&&a.relatedItems&&0<a.relatedItems.length){for(var g=!1,c=0;!g&&c<a.relatedItems.length;)"Feature Service"===
a.relatedItems[c].type&&(g=!0,b.getItemData(a.relatedItems[c].id).then(function(a){a&&(a.layers&&1===a.layers.length)&&(null==f&&(f={}),f.popupInfo=a.layers[0].popupInfo,f.disablePopup=a.layers[0].disablePopup);q.resolve()},q.reject.bind(q))),c++;g||q.resolve()}else q.resolve()},q.reject.bind(q));q.promise.always(function(){l._doAddLayerByItemId(a,b,c,g,d,f,t).then(function(a){e.resolve(a)},function(a){e.reject(a)})});return e},_uniqueLayersIds:function(a,b,g){for(var c=0;c<a.length;c++){var d=a[c];
"GroupLayer"===d.layerType&&d.layers&&this._uniqueLayersIds(d.layers,b,g);var f=g[d.id];if(void 0!==f)d.id=f;else if(b.getLayer(d.id)){var f=d.id,t=f.match(/(.*-layer)(\d+)$/),e;t?(e=t[1],t=parseInt(t[2],10)):(e=f+"-",t=0);for(;b.getLayer(f);)t++,f=e+t.toString();f!==d.id&&(g[d.id]=f,d.id=f)}}},updateUniqueLayerIds:function(a,b){var g={};this._uniqueLayersIds(a.operationalLayers,b,g);a.presentation.slides.forEach(function(a){for(var b=0;b<a.visibleLayers.length;b++){var c=a.visibleLayers[b],d=g[c.id];
void 0!==d&&(c.id=d)}})},_importWebSceneItem:function(a,b,g,c,d){var f=new m,t=L.checkVersion(d.version);if(t.isCompatible)try{var e=new L(d),l=window._webSceneViewerView;if("spherical"===l.globeMode&&"local"===e.viewingMode)f.reject({itemType:"WebScene",msg:B.messages.sceneRejectL2G});else if("planar"===l.globeMode&&"global"===e.viewingMode)f.reject({itemType:"WebScene",msg:B.messages.sceneRejectG2L});else{if(e.spatialReference.equals(a.spatialReference))return L.updateUniqueLayerIds(e,a),e.set("portalItemProperties",
c),e.presentation.updateUniqueSlideIds(g.presentation.slides),e.presentation&&e.presentation.slides&&(e.presentation.slides.getAll().forEach(function(a){g.presentation.slides.addItem(a)}),g.set("presentation",g.presentation.toJSON())),e.applyToMap(a,null,b,{basemap:!1,initialState:!1});f.reject({itemType:"WebScene",msg:B.messages.sceneRejectSRTS})}}catch(q){f.reject({msg:q.message})}else f.reject({msg:t.message});return f},_updateDfd:function(a,b,g,c){if(0<b){if(a.resolve({layers:g}),0<c.length)for(b=
0;b<c.length;b++)this._showLayerAddError(c[b].msg)}else if(0<c.length){for(b=1;b<c.length;b++)this._showLayerAddError(c[b].msg);a.reject(c[0])}return a},_showBasemapDropConfirmDialog:function(a,b){var g=L._dropBasemapDialog.on("confirm",function(){c.remove();g.remove();a.resolve({dropBasemap:b})}.bind(this)),c=L._dropBasemapDialog.on("cancel",function(){c.remove();g.remove();a.resolve({dropBasemap:0})}.bind(this));L._dropBasemapDialog.show()},_checkForBasemapDropMapOrImageLayer:function(a,b,c,d,f,
t){d?(a=a instanceof g?a.clone():g.fromJSON(a),!a.equals(c)||b.basemapTerrain&&!b.basemapTerrain.tilingScheme.compatibleWith(d)?1===t&&"planar"===b.globeMode?this._showBasemapDropConfirmDialog(f,t):2===t?f.resolve({dropBasemap:t}):f.resolve({dropBasemap:0}):f.resolve({dropBasemap:0})):f.resolve({dropBasemap:0})},_checkForBasemapDropSceneLayer:function(a,b,g,c,d){a=Q(a);g=a.equals(g)?!0:g.isWebMercator()&&4326===a.wkid?!0:!1;g?c.resolve({dropBasemap:0}):1===d&&"planar"===b.globeMode?this._showBasemapDropConfirmDialog(c,
d):2===d?c.resolve({dropBasemap:d}):c.resolve({dropBasemap:0})},_checkForBasemapDrop:function(a,b){var g=new m;0!==a&&0<b.length?K.prepareOpLayerFromService(b[0],a).then(function(c){c=c.serviceInfo;var d=c.tileInfo instanceof A?c.tileInfo:A.fromJSON(c.tileInfo),f=b[0].serviceDetails.serviceType,t=window._webSceneViewerView,e=t.map.spatialReference,l=c.spatialReference;"MapServer"===f?this._checkForBasemapDropMapOrImageLayer(l,t,e,d,g,a):"ImageServer"===f?this._checkForBasemapDropMapOrImageLayer(l,
t,e,d,g,a):"FeatureServer"===f?g.resolve({dropBasemap:0}):("SceneServerLocal"===f||"SceneServer"===f)&&this._checkForBasemapDropSceneLayer(c,t,e,g,a)}.bind(this),function(a){g.resolve({dropBasemap:0,error:a})}):g.resolve({dropBasemap:0});return g.promise},addLayerToMapByUrl:function(a,b,g,c){b.url=K.useSSLIfRequired(b.url,g);var d=new m,f=[],t=[],e=[],l=0;K.prepareFromServiceUrl(b.url,b).then(function(q,h){var n=[];this._checkForBasemapDrop(c,h.services).then(function(c,d){for(var m=0;m<h.services.length;m++)n.push(K.prepareOpLayerFromService(h.services[m],
d.dropBasemap));var y=h.services.length;if(0===n.length)return q.resolve(),q.promise;for(var u=n.slice(0),s=0;s<n.length;s++)n[s].promise.always(function(c,h){var m=n.indexOf(c);n.splice(m,1);var k;if(c.isResolved())l++,m=b.layerIndex,void 0===m&&(m=u.length-u.indexOf(c)),h.layerIndex=m,h.id=b.id,h.visibility=b.visibility,h.opacity=b.opacity,h.layerDefinition=b.layerDefinition,h.minScale=b.minScale,h.maxScale=b.maxScale,h.visibilityMode=b.visibilityMode,h.listMode=b.listMode,h.popupInfo=b.popupInfo,
h.showLabels=b.showLabels,h.showLegend=void 0===b.showLegend?!0:b.showLegend,h.portalLayerItem=b.portalLayerItem,h.originalOperationalLayer=b.originalOperationalLayer,h.thumbnailUrl=b.thumbnailUrl,h.disablePopup=b.disablePopup,k=R(h,a,g,d.dropBasemap),f.push(k);else if(c.isRejected()&&(0===m&&d.error?e.push(d.error):e.push(h)),y--,0===y)return q=this._updateDfd(q,l,t,e),q.promise;if(k){var r=0;p(k).always(function(a,b){f.splice(f.indexOf(f[s]),1);for(var g=0;g<a.length;g++){var c=a[g],d=b[g];c.isResolved()?
(d instanceof D?t.push(d):t=t.concat(d.layers),r++):c.isRejected()&&(null==d&&(!Array.isArray(b)&&b.hasOwnProperty("error"))&&(console.error(B.messages.layerCreationErrorGeneric+" "+b.error),d={msg:B.messages.layerCreationErrorGeneric}),e.push(d))}y--;0===y&&(q=this._updateDfd(q,r,t,e))}.bind(this,k))}}.bind(this,n[s]),function(a,b){a.reject(b)}.bind(this,q))}.bind(this,d),function(a){q.reject(a)})}.bind(this,d),function(a,b){a.reject(b)}.bind(this,d));return d.promise},mixLayerItemWithWebSceneOverrides:function(a,
b){if(null==b)return a;if(null==a)return b;for(var g=Object.keys(a).concat(Object.keys(b)).concat(),c=0;c<g.length;++c)for(var d=c+1;d<g.length;++d)g[c]===g[d]&&g.splice(d--,1);for(c=0;c<g.length;c++)d=g[c],"layerDefinition"===d&&a.hasOwnProperty(d)&&b.hasOwnProperty(d)?a[d]=r.mixin(a[d],b[d]):b.hasOwnProperty(d)&&(a[d]=b[d]);return a},checkVersion:function(a){if(null==a)return{isCompatible:!1,version:{major:null,minor:null},message:B.messages.websceneLoadFail+"\x3cbr\x3e"+B.messages.websceneLoadFailNoVersion};
var b="string"===typeof a?a.split("."):[],g=2===b.length?parseInt(b[0],10):null,b=2===b.length?parseInt(b[1],10):null;return null===g||null===b?{isCompatible:!1,version:{major:null,minor:null},message:B.messages.websceneLoadFail+"\x3cbr\x3e"+s.substitute(B.messages.websceneLoadFailBadVersion,{websceneVersion:a})}:1>g&&!(0===g&&94===b)?{isCompatible:!1,version:{major:g,minor:b},message:B.messages.websceneLoadFail+"\x3cbr\x3e"+s.substitute(B.messages.websceneLoadFailIncompatVersion,{websceneVersion:a})+
" "+s.substitute(B.messages.websceneVersionRequires,{websceneRequiredVersion:"1.x"})}:1<g?{isCompatible:!1,version:{major:g,minor:b},message:B.messages.websceneLoadFail+"\x3cbr\x3e"+s.substitute(B.messages.websceneLoadFailIncompatVersion,{websceneVersion:a})+" (1.3)"}:{isCompatible:!0,version:{major:g,minor:b},message:""}}});L.spatialReferenceLocked=!1;L._dropBasemapDialog=new O({title:B.messages.basemapDropTitle,message:B.messages.basemapDrop,confirm:B.messages.basemapDropConfirm});return L})},"dojox/mdnd/AreaManager":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/window dojo/_base/array dojo/_base/sniff dojo/_base/lang dojo/query dojo/topic dojo/dom-class dojo/dom-geometry dojo/dom-construct dijit/registry dijit/_Widget ./Moveable".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b){r=r("dojox.mdnd.AreaManager",null,{autoRefresh:!0,areaClass:"dojoxDndArea",dragHandleClass:"dojoxDragHandle",constructor:function(){this._areaList=[];this.resizeHandler=e.connect(k.global,"onresize",this,function(){this._dropMode.updateAreas(this._areaList)});this._oldIndexArea=this._currentIndexArea=this._oldDropIndex=this._currentDropIndex=this._sourceIndexArea=this._sourceDropIndex=-1},init:function(){this.registerByClass()},registerByNode:function(a,b){var c=
this._getIndexArea(a);if(a&&-1==c){var c=(c=a.getAttribute("accept"))?c.split(/\s*,\s*/):["text"],d={node:a,items:[],coords:{},margin:null,accept:c,initItems:!1};m.forEach(this._getChildren(a),function(a){this._setMarginArea(d,a);d.items.push(this._addMoveableItem(a))},this);this._areaList=this._dropMode.addArea(this._areaList,d);b||this._dropMode.updateAreas(this._areaList);e.publish("/dojox/mdnd/manager/register",[a])}},registerByClass:function(){h("."+this.areaClass).forEach(function(a){this.registerByNode(a,
!0)},this);this._dropMode.updateAreas(this._areaList)},unregister:function(a){a=this._getIndexArea(a);return-1!=a?(m.forEach(this._areaList[a].items,function(a){this._deleteMoveableItem(a)},this),this._areaList.splice(a,1),this._dropMode.updateAreas(this._areaList),!0):!1},_addMoveableItem:function(a){a.setAttribute("tabIndex","0");var g=this._searchDragHandle(a),c=new b({handle:g,skip:!0},a);f.add(g||a,"dragHandle");g=a.getAttribute("dndType");g={item:c,type:g?g.split(/\s*,\s*/):["text"],handlers:[e.connect(c,
"onDragStart",this,"onDragStart")]};if(l&&l.byNode){var d=l.byNode(a);d&&(g.type=d.dndType?d.dndType.split(/\s*,\s*/):["text"],g.handlers.push(e.connect(d,"uninitialize",this,function(){this.removeDragItem(a.parentNode,c.node)})))}return g},_deleteMoveableItem:function(a){m.forEach(a.handlers,function(a){e.disconnect(a)});var b=a.item.node,c=this._searchDragHandle(b);f.remove(c||b,"dragHandle");a.item.destroy()},_getIndexArea:function(a){if(a)for(var b=0;b<this._areaList.length;b++)if(this._areaList[b].node===
a)return b;return-1},_searchDragHandle:function(a){if(a){var b=this.dragHandleClass.split(" "),c=b.length,d="";m.forEach(b,function(a,b){d+="."+a;b!=c-1&&(d+=", ")});return h(d,a)[0]}},addDragItem:function(a,b,c,d){var f=!0;d||(f=a&&b&&(null===b.parentNode||b.parentNode&&1!==b.parentNode.nodeType));if(f&&(d=this._getIndexArea(a),-1!==d)){var f=this._addMoveableItem(b),e=this._areaList[d].items;if(0<=c&&c<e.length){var l=e.slice(0,c),q=e.slice(c,e.length);l[l.length]=f;this._areaList[d].items=l.concat(q);
a.insertBefore(b,e[c].item.node)}else this._areaList[d].items.push(f),a.appendChild(b);this._setMarginArea(this._areaList[d],b);this._areaList[d].initItems=!1;return!0}return!1},removeDragItem:function(a,b){var c=this._getIndexArea(a);if(a&&-1!==c)for(var c=this._areaList[c].items,d=0;d<c.length;d++)if(c[d].item.node===b)return this._deleteMoveableItem(c[d]),c.splice(d,1),a.removeChild(b);return null},_getChildren:function(a){var b=[];m.forEach(a.childNodes,function(a){if(1==a.nodeType)if(l&&l.byNode){var c=
l.byNode(a);c?c.dragRestriction||b.push(a):b.push(a)}else b.push(a)});return b},_setMarginArea:function(a,b){a&&(null===a.margin&&b)&&(a.margin=d.getMarginExtents(b))},findCurrentIndexArea:function(a,b){this._oldIndexArea=this._currentIndexArea;this._currentIndexArea=this._dropMode.getTargetArea(this._areaList,a,this._currentIndexArea);if(this._currentIndexArea!=this._oldIndexArea){if(-1!=this._oldIndexArea)this.onDragExit(a,b);if(-1!=this._currentIndexArea)this.onDragEnter(a,b)}return this._currentIndexArea},
_isAccepted:function(a,b){this._accept=!1;for(var c=0;c<b.length;++c)for(var d=0;d<a.length;++d)if(a[d]==b[c]){this._accept=!0;break}},onDragStart:function(a,b,c){this.autoRefresh&&this._dropMode.updateAreas(this._areaList);var d=n("webkit")?k.body():k.body().parentNode;this._cover||(this._cover=q.create("div",{"class":"dndCover"}),this._cover2=s.clone(this._cover),f.add(this._cover2,"dndCover2"));this._cover.style.height=this._cover2.style.height=d.scrollHeight+"px";k.body().appendChild(this._cover);
k.body().appendChild(this._cover2);this._dragStartHandler=e.connect(a.ownerDocument,"ondragstart",k,"stopEvent");this._sourceIndexArea=this._lastValidIndexArea=this._currentIndexArea=this._getIndexArea(a.parentNode);for(var d=this._areaList[this._sourceIndexArea],l=d.items,h=0;h<l.length;h++)if(l[h].item.node==a){this._dragItem=l[h];this._dragItem.handlers.push(e.connect(this._dragItem.item,"onDrag",this,"onDrag"));this._dragItem.handlers.push(e.connect(this._dragItem.item,"onDragEnd",this,"onDrop"));
l.splice(h,1);this._currentDropIndex=this._sourceDropIndex=h;break}l=null;this._sourceDropIndex!==d.items.length&&(l=d.items[this._sourceDropIndex].item.node);7<n("ie")&&(this._eventsIE7=[e.connect(this._cover,"onmouseover",k,"stopEvent"),e.connect(this._cover,"onmouseout",k,"stopEvent"),e.connect(this._cover,"onmouseenter",k,"stopEvent"),e.connect(this._cover,"onmouseleave",k,"stopEvent")]);h=a.style;h.left=b.x+"px";h.top=b.y+"px";if("relative"==h.position||""==h.position)h.position="absolute";this._cover.appendChild(a);
this._dropIndicator.place(d.node,l,c);f.add(a,"dragNode");this._accept=!0;e.publish("/dojox/mdnd/drag/start",[a,d,this._sourceDropIndex])},onDragEnter:function(a,b){this._currentIndexArea===this._sourceIndexArea?this._accept=!0:this._isAccepted(this._dragItem.type,this._areaList[this._currentIndexArea].accept)},onDragExit:function(a,b){this._accept=!1},onDrag:function(a,b,c,d){a=this._dropMode.getDragPoint(b,c,d);this.findCurrentIndexArea(a,c);-1!==this._currentIndexArea&&this._accept&&this.placeDropIndicator(a,
c)},placeDropIndicator:function(a,b){this._oldDropIndex=this._currentDropIndex;var c=this._areaList[this._currentIndexArea];c.initItems||this._dropMode.initItems(c);this._currentDropIndex=this._dropMode.getDropIndex(c,a);this._currentIndexArea===this._oldIndexArea&&this._oldDropIndex===this._currentDropIndex||this._placeDropIndicator(b);return this._currentDropIndex},_placeDropIndicator:function(a){var b=this._areaList[this._currentIndexArea];this._dropMode.refreshItems(this._areaList[this._lastValidIndexArea],
this._oldDropIndex,a,!1);var c=null;-1!=this._currentDropIndex&&(c=b.items[this._currentDropIndex].item.node);this._dropIndicator.place(b.node,c);this._lastValidIndexArea=this._currentIndexArea;this._dropMode.refreshItems(b,this._currentDropIndex,a,!0)},onDropCancel:function(){if(!this._accept){var a=this._getIndexArea(this._dropIndicator.node.parentNode);this._currentIndexArea=-1!=a?a:0}},onDrop:function(a){this.onDropCancel();var b=this._areaList[this._currentIndexArea];f.remove(a,"dragNode");var c=
a.style;c.position="relative";c.left="0";c.top="0";c.width="auto";b.node==this._dropIndicator.node.parentNode?b.node.insertBefore(a,this._dropIndicator.node):(b.node.appendChild(a),this._currentDropIndex=b.items.length);c=this._currentDropIndex;-1==c&&(c=b.items.length);var d=b.items,l=d.slice(0,c),d=d.slice(c,d.length);l[l.length]=this._dragItem;b.items=l.concat(d);this._setMarginArea(b,a);m.forEach(this._areaList,function(a){a.initItems=!1});e.disconnect(this._dragItem.handlers.pop());e.disconnect(this._dragItem.handlers.pop());
this._resetAfterDrop();this._cover&&(k.body().removeChild(this._cover),k.body().removeChild(this._cover2));e.publish("/dojox/mdnd/drop",[a,b,c])},_resetAfterDrop:function(){this._accept=!1;this._dragItem=null;this._sourceDropIndex=this._sourceIndexArea=this._oldDropIndex=this._currentIndexArea=this._currentDropIndex=-1;this._dropIndicator.remove();this._dragStartHandler&&e.disconnect(this._dragStartHandler);7<n("ie")&&m.forEach(this._eventsIE7,e.disconnect)},destroy:function(){for(;0<this._areaList.length;)if(!this.unregister(this._areaList[0].node))throw Error("Error while destroying AreaManager");
e.disconnect(this.resizeHandler);this._dropIndicator.destroy();this._dropMode.destroy();dojox.mdnd.autoScroll&&dojox.mdnd.autoScroll.destroy();this.refreshListener&&e.unsubscribe(this.refreshListener);this._cover&&(q.destroy(this._cover),q.destroy(this._cover2),delete this._cover,delete this._cover2)}});c&&s.extend(c,{dndType:"text"});dojox.mdnd._areaManager=null;dojox.mdnd.areaManager=function(){dojox.mdnd._areaManager||(dojox.mdnd._areaManager=new dojox.mdnd.AreaManager);return dojox.mdnd._areaManager};
return r})},"webSceneViewer/editor/WebSceneEditorPanes/EditLayerPane":function(){define("esri/core/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/keys dojo/touch dijit/form/Select dijit/form/HorizontalSlider dijit/form/NumberTextBox esri/layers/SceneLayer esri/layers/FeatureLayer esri/widgets/PopupLegacy/PopupTemplate ./WebSceneEditorPaneBase ../../widgets/SymbologyEditor/SymbologyEditor ../../widgets/Switch/Switch ../../webScene/LayerTemplates ../../webScene/WebSceneLayers dojo/i18n!../nls/editor".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y,u){function F(a){return a.isInstanceOf(q)||a.isInstanceOf(d)&&"esriGeometryMesh"!==a.geometryType?(a=a.labelingInfo,Array.isArray(a)&&0<a.length):!1}function v(a){if(a.hasZ)return"absoluteHeight";switch(a.geometryType){case "esriGeometryPoint":return"relativeToGround";case "esriGeometryPolyline":case "esriGeometryPolygon":return"onTheGround";default:return null}}return k(c,{layer:void 0,_layer:void 0,layerTemplates:void 0,_layerSetter:function(a){this.customDestroy();
this._layer=a;this._updateContent()},_layerGetter:function(){return this._layer},parentGroup:void 0,constructor:function(a){r.mixin(this,{id:"editLayer",title:u.panes.configureLayer,actionButton:{title:u.buttons.done,action:"_navBackBtnNodeClickHandler"}});this._onHandles=[];this._updateContent()},customDestroy:function(){this._elevationDropdown&&this._elevationDropdown.destroy();this._elevationOffsetTextBox&&this._elevationOffsetTextBox.destroy();this._symbologyEditorWidget&&this._symbologyEditorWidget.destroy();
this._transparencySlider&&this._transparencySlider.destroy();this._labelsSwitch&&this._labelsSwitch.destroy();this._legendSwitch&&this._legendSwitch.destroy();this._popupSwitch&&this._popupSwitch.destroy();this._onHandles.forEach(function(a){a.remove()});this._onHandles.length=0},destroy:function(){this.customDestroy()},_updateContent:function(){var c=this,k=e.create("div",{className:"editLayerPane"});if(null==this._layer)e.place("\x3cp\x3eno layer\x3c/p\x3e",k);else{var z=e.create("div",{className:"layerTitle"},
k),E=e.create("div",{className:"paneLayerTitle"},z);e.create("div",{className:"paneLayerName"},E).textContent=this._layer.title;if(this._layer._websceneEditorProperties.portalLayerItem){E=e.create("div",{},E);e.create("div",{className:"layerTypeIcon"},E).style.backgroundImage="url("+this._layer._websceneEditorProperties.portalLayerItem.item.iconUrl+")";var E=e.create("div",{className:"layerTypeTitle"},E),w=e.create("div",{innerHTML:this._layer._websceneEditorProperties.portalLayerItem.item.displayName,
"class":"layerLink"},E);this._onHandles.push(m(w,"click",function(a){window.open(this._layer._websceneEditorProperties.portalLayerItem.item.portal.getBaseUrl()+"item.html?id\x3d"+this._layer._websceneEditorProperties.portalLayerItem.item.id,"_blank")}.bind(this)));e.create("div",{innerHTML:"\x26nbsp;"+u.addLayerPane.by+"\x26nbsp;","class":"inlineContainer"},E);e.create("div",{innerHTML:this._layer._websceneEditorProperties.portalLayerItem.item.owner,"class":"inlineContainer"},E)}z=e.create("div",
{className:"icon_frame",title:u.editLayerPane.zoomTo},z);this._onHandles.push(m(z,"click",function(){this.editor.view.animateTo(this._layer.fullExtent)}.bind(this)));e.create("div",{className:"lineBreak"},k);if(this._layer.isInstanceOf(q)||this._layer.isInstanceOf(d)&&"esriGeometryMesh"!==this._layer.geometryType){var x=c._layer.elevationInfo||{};e.create("div",{className:"paneSectionTitle"},k).textContent=u.editLayerPane.elevationMode;this._elevationDropdown=new h({className:"elevationDropDown",
options:[{label:u.editLayerPane.onTheGround,value:"onTheGround",selected:"onTheGround"===x.mode||null==x.mode&&"onTheGround"===v(c._layer)},{label:u.editLayerPane.relativeToGround,value:"relativeToGround",selected:"relativeToGround"===x.mode||null==x.mode&&"relativeToGround"===v(c._layer)},{label:u.editLayerPane.absoluteHeight,value:"absoluteHeight",selected:"absoluteHeight"===x.mode||null==x.mode&&"absoluteHeight"===v(c._layer)}]});this._onHandles.push(m(this._elevationDropdown,"change",function(a){"onTheGround"===
a?p.add(H,"disable"):p.remove(H,"disable");var b="onTheGround"===a?void 0:c._elevationOffsetTextBox.get("value");c._layer.set("elevationInfo",{offset:b,mode:a,featureExpression:x.featureExpression});c._layer._websceneEditorProperties.editedFlags.elevationInfo=!0;x=c._layer.elevationInfo;c.editor.setWebSceneChanged()}));this._elevationDropdown.startup();this._elevationDropdown.placeAt(k);var G=function(){x=c._layer.get("elevationInfo")||{};x.offset!==c._elevationOffsetTextBox.get("value")&&(c._layer.set("elevationInfo",
{offset:c._elevationOffsetTextBox.get("value"),mode:x.mode||v(c._layer),featureExpression:x.featureExpression}),c._layer._websceneEditorProperties.editedFlags.elevationInfo=!0,x=c._layer.elevationInfo,c.editor.setWebSceneChanged())};this._elevationOffsetTextBox=new f({className:"elevationTextBox",value:x.offset||0,constraints:{min:-1E7,max:1E7,places:0},required:!0,intermediateChanges:!1,onChange:G});m(this._elevationOffsetTextBox,"keypress",function(a){(a.charOrCode||a.keyCode)==n.ENTER&&G()});e.create("div",
{className:"lineBreak"},k);var H=e.create("div",{},k);e.create("div",{"for":this._elevationOffsetTextBox.domNode.id,className:"subSection paneSectionTitle"},H).textContent=u.editLayerPane.offsetMeters;this._elevationOffsetTextBox.placeAt(H);this._elevationOffsetTextBox.startup();"onTheGround"===this._elevationDropdown.get("value")?p.add(H,"disable"):p.remove(H,"disable");e.create("div",{className:"lineBreak"},k)}e.create("div",{className:"paneSectionTitle"},k).textContent=u.editLayerPane.transparency;
z=e.create("div",{className:"slideContainer"},k);this._transparencySlider=new a({value:1-this._layer.opacity,minimum:0,maximum:1,discreteValues:100,intermediateChanges:!1,showButtons:!0});this._transparencySlider.sliderHandle.title=Math.round(100*this._transparencySlider.value)+"%";var C=e.create("div",{className:"sliderTooltip hide"},this._transparencySlider.sliderHandle.parentNode),J=e.create("div",{className:"sliderTooltipArrow hide"},this._transparencySlider.sliderHandle.parentNode);C.innerHTML=
this._transparencySlider.sliderHandle.title;this._transparencySlider.placeAt(z);this._transparencySlider.startup();var z=this._transparencySlider.on("change",function(a){this._layer.set("opacity",1-a);this._layer._websceneEditorProperties.editedFlags.opacity=!0;this.editor.setWebSceneChanged();this._transparencySlider.sliderHandle.title=Math.round(100*a)+"%";p.add(C,"hide");p.add(J,"hide")}.bind(this)),E=this._transparencySlider.watch("value",function(a,b,c){C.innerHTML=Math.round(100*c)+"%"}),w=
m(this._transparencySlider.sliderHandle,s.release,function(){p.add(C,"hide");p.add(J,"hide")}.bind(this)),K=m(this._transparencySlider.sliderHandle,s.press,function(){p.remove(C,"hide");p.remove(J,"hide")});this._onHandles.push(z);this._onHandles.push(w);this._onHandles.push(K);this._onHandles.push(E);e.create("div",{className:"lineBreak"},k);F(this._layer)&&(z=this._layer.get("showLabels"),e.create("div",{className:"paneSectionTitle"},k).textContent=u.editLayerPane.labels,this._labelsSwitch=new t({switchOn:z}),
this._onHandles.push(m(this._labelsSwitch.domNode,"toggle",function(a){this._layer.set("showLabels",a.on);this._layer._websceneEditorProperties.editedFlags.showLabels=!0;this.editor.setWebSceneChanged()}.bind(this))),this._labelsSwitch.placeAt(k),this._labelsSwitch.startup());if(this._layer.isInstanceOf(q)||this._layer.isInstanceOf(d)&&(null!=this._layer.popupTemplate||null!=this._layer._companionFeatureLayer&&this._layer._companionFeatureLayer.isResolved())){var N=!this._layer.popupTemplate,M=this._layer.popupTemplate||
new l({title:this._layer.title,fieldInfos:this._layer.fields&&this._layer.fields.map(function(a){return{fieldName:a.name,label:a.alias,visible:!0}})});e.create("div",{className:"paneSectionTitle"},k).textContent=u.editLayerPane.popups;this._popupSwitch=new t({switchOn:(!1===this._layer.disablePopup||void 0===this._layer.disablePopup)&&!!this._layer.popupTemplate});this._onHandles.push(m(this._popupSwitch,"toggle",function(a){a.on?(this._layer.set("popupTemplate",M),this._layer.set("disablePopup",
!1)):(this._layer.set("popupTemplate",null),this._layer.set("disablePopup",!0));this._layer._websceneEditorProperties.editedFlags.popupInfo=N;this._layer._websceneEditorProperties.editedFlags.popupDisable=!0;this.editor.setWebSceneChanged()}.bind(this)));this._popupSwitch.placeAt(k);this._popupSwitch.startup()}if(r.exists("_websceneEditorProperties.originalOperationalLayer.layerDefinition.drawingInfo.renderer",this._layer)?!g.hasContentByReference(this._layer._websceneEditorProperties.originalOperationalLayer.layerDefinition.drawingInfo.renderer):
"ArcGISTiledImageServiceLayer"!==y.extrapolateTypeFromLayerInstance(this._layer))e.create("div",{className:"paneSectionTitle"},k).textContent=u.editLayerPane.legend,this._legendSwitch=new t({switchOn:this._layer.showLegend&&void 0!==this._layer.showLegend}),this._onHandles.push(m(this._legendSwitch.domNode,"toggle",function(a){c._layer.set("showLegend",a.on);c._layer._websceneEditorProperties.editedFlags.showLegend=!0;c.editor.setWebSceneChanged()}.bind(this))),this._legendSwitch.placeAt(k),this._legendSwitch.startup();
if(this._layer.isInstanceOf(q)||this._layer.isInstanceOf(d))this._symbologyEditorWidget=new b({layer:this._layer,view:c.editor.view,editor:c.editor}),this._symbologyEditorWidget.placeAt(k),this._symbologyEditorWidget.startup(),e.create("div",{className:"lineBreak"},k)}this._addToContentNode(k)}})})},"webSceneViewer/assertUtils":function(){define([],function(){function k(k){this.message=k}k.prototype.toString=function(){return"AssertException: "+this.message};return{AssertException:k,assert:function(r,
e){if(!r){var p=Error("dummy");p.stack&&console.log(p.stack);throw new k(e);}}}})},"webSceneViewer/widgets/LayerWidget/LayerWidgetEditable":function(){define("esri/core/declare dojo/dom-class dojo/on dojo/dom-geometry dojo/Evented ./LayerWidget ./LayerItemEditable dojo/topic dojox/mdnd/AreaManager dojox/mdnd/DropIndicator dojox/mdnd/dropMode/OverDropMode dojo/i18n!../nls/widgets".split(" "),function(k,r,e,p,m,n,s,h,a,f,d,q){var l=k([d],{addArea:function(a,c){try{var g=p.position(c.node,!0);c.coords=
{x:g.x,y:g.y};a.push(c)}catch(d){console.warn(d)}return a},_checkInterval:function(a,c,g,d){var f=a[c];a=f.coords;c=a.x2;var e=a.y,f=e+f.node.offsetHeight- -25;return a.x<=g&&g<=c&&e<=d&&d<=f?!0:!1}}),c=k([a,m],{findCurrentIndexArea:function(a,c){this._dropMode.updateAreas(this._areaList);this._areaList.forEach(function(a){r.contains(a.node,"layers")&&(a.coords.y+=-25)});this._oldIndexArea=this._currentIndexArea;var g=this._areaList;r.contains(this._dragItem.item.node,"GroupLayerItem")&&(g=[this._areaList[this._areaList.length-
1]]);var d=this._dropMode.getTargetArea(g,a);this._currentIndexArea=g!=this._areaList&&0===d?this._areaList.length-1:d;if(this._currentIndexArea!=this._oldIndexArea){if(-1!=this._oldIndexArea)this.onDragExit(a,c);if(-1!=this._currentIndexArea)this.onDragEnter(a,c)}return this._currentIndexArea},placeDropIndicator:function(a,c){this._dropMode.updateAreas(this._areaList);this._areaList[this._currentIndexArea].initItems=!1;this.emit("drop_indicator_added",{parentNode:this._areaList[this._currentIndexArea]});
return this.inherited(arguments)},onDragExit:function(a,c){this.emit("drop_indicator_removed",{parentNode:this._areaList[this._oldIndexArea]});return this.inherited(arguments)}});return k([n],{editor:void 0,postCreate:function(){r.add(this.domNode,"LayerWidgetEditable");this._initDragAndDrop();this.inherited(arguments)},_initDragAndDrop:function(){this._dragManager=new c;this._dragManager._dropIndicator=new f;this._dragManager._dropMode=new l;this._onHandles.push(e(this._dragManager,"drop_indicator_added",
function(a){this._removePlaceholder(a)}.bind(this)));this._onHandles.push(e(this._dragManager,"drop_indicator_removed",function(a){this._addPlaceholder(a)}.bind(this)));var a=h.subscribe("/dojox/mdnd/drop",function(a,b,c){setTimeout(function(){var d,f,e;b.node===this.domNode&&(e="map");this._layerItems.some(function(b){b.domNode===a?(f="map",d=b.layer):b.isGroupLayer&&b._layerItems.some(function(b){return b.domNode===a?(f=b.parentGroup,d=b.layer,!0):!1});if(!d)return!1}.bind(this));if(d){"map"!==
e&&this._layerItems.some(function(a){return b.node.parentNode===a.domNode?(e=a.layer,!0):!1}.bind(this));var l=0,l=this.map.layers.reduce(function(a,b){return a+("SilentContentLayer"===b.id||"__basemapErrorFallbackLayer__"===b.id?1:0)},0);if(0<l&&this.map.layers.length>l){var q=function(a,b){for(var c=a.layers.getAll(),g=0;g<c.length-1;g++)if(c[g].id===b){a.reorder(c[g],c.length-1);break}};q(this.map,"__basemapErrorFallbackLayer__");q(this.map,"SilentContentLayer")}this.editor.setWebSceneChanged();
"map"===f?"map"===e?(l=this.map.layers.get("length")-c-1-l,console.log("moving '"+(d.title||d.id)+"' from map to map. new idx\x3d"+l),this.map.reorder(d,l)):(c=0<c?c-1:c,l=e.layers.get("length")-c,console.log("moving '"+(d.title||d.id)+"' from map to '"+(e.title||e.id)+"'. new idx\x3d"+l),e.add(d,l)):"map"===e?(l=this.map.layers.get("length")-c-l,console.log("moving '"+(d.title||d.id)+"' from '"+(f.title||f.id)+"' to map. new idx\x3d"+l),this.map.add(d,l)):f===e?(l=e.layers.get("length")-c,console.log("moving '"+
(d.title||d.id)+"' within '"+(f.title||f.id)+"'. new idx\x3d"+l),f.reorder(d,l)):(c=0<c?c-1:c,l=e.layers.get("length")-c,console.log("moving '"+(d.title||d.id)+"' from '"+(f.title||f.id)+"' to '"+(e.title||e.id)+"'. new idx\x3d"+l),e.add(d,l))}}.bind(this),0)}.bind(this));this._onHandles.push(a)},_destroyAllLayerItems:function(){this._unregisterDragAreas();this.inherited(arguments)},_setupAllLayerItems:function(){for(var a=this.map.layers.get("length")-1;0<=a;a--){var c=this.map.layers.getItemAt(a);
"SilentContentLayer"===c.id||"__basemapErrorFallbackLayer__"===c.id||this._addLayerItem(c)}0<this._layerItems.length&&this._registerDragAreas()},_unregisterDragAreas:function(){this._layerItems.forEach(function(a){a.isGroupLayer&&this._dragManager.unregister(a.layersDomNode)}.bind(this));this._dragManager.unregister(this.domNode)},_registerDragAreas:function(){this._layerItems.forEach(function(a){a.isGroupLayer&&this._dragManager.registerByNode(a.layersDomNode)}.bind(this));this._dragManager.registerByNode(this.domNode)},
_createLayerItem:function(a){return new s({view:this.view,layer:a,layerWidget:this,editor:this.editor})},_removePlaceholder:function(a){a=a.parentNode.node;-1<a.className.indexOf("layers emptyPlaceholder")&&(a.textContent="",r.remove(a,"emptyPlaceholder"))},_addPlaceholder:function(a){a=a.parentNode.node;-1<a.className.indexOf("layers")&&0===a.childNodes.length-1&&(a.textContent=q.layerItemEditable.dragHere,r.add(a,"emptyPlaceholder"))},focusAddedGroupTitle:function(a){this._layerItems.forEach(function(c){c.isGroupLayer&&
c.layer===a&&(c.titleInlineEditBox.set("disabled",!1),c.titleInlineEditBox.edit())}.bind(this))}})})},"webSceneViewer/webScene/WebSceneLayers":function(){define("dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/request/xhr esri/request esri/config esri/geometry/Extent esri/geometry/SpatialReference webSceneViewer/spatialReferenceUtils esri/layers/SceneLayer esri/layers/FeatureLayer esri/layers/ArcGISTiledLayer esri/layers/ArcGISDynamicLayer esri/layers/ArcGISElevationLayer esri/layers/GroupLayer esri/layers/OpenStreetMapLayer esri/layers/support/TileInfo esri/views/3d/terrain/TilingScheme esri/views/3d/terrain/TerrainSurface dojo/i18n!webSceneViewer/nls/viewer".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y,u,F,v){function D(b){s.geometryService&&require(["dojo/on","esri/geometry/support/webMercatorUtils"],function(c,g){c.once(b,"load",function(){var c=b.fullExtent;c&&(102100===c.spatialReference.wkid||(3857===c.spatialReference.wkid||4326===c.spatialReference.wkid)||require(["esri/tasks/GeometryService","esri/tasks/support/ProjectParameters"],function(g,d){var f=s.geometryService,e=new d;e.geometries=[c];e.outSR=a.WebMercator;f.project(e).then(function(a){a&&
0<a.length&&b.set("fullExtent",a[0])})}))})})}function A(a){var b=null,c=a.search(/\/rest\/services\//i);0<c&&(b=a.substring(0,c+6));return b}function z(a){var b=document.createElement("a");b.href=a;a=b.hostname;for(var b=[".arcgis.com",".arcgisonline.com"],c=0;c<b.length;c++){var g=b[c];if(-1!==a.indexOf(g,a.length-g.length))return!0}return!1}function E(a){a instanceof y||(a=y.fromJSON(a));return u.WebMercatorAuxiliarySphere.compatibleWith(a)}function w(a,b){a instanceof y||(a=y.fromJSON(a));var c=
b.basemapTerrain&&b.basemapTerrain.tilingScheme;return c?c.compatibleWith(a):!0}function x(a,b){var c=F.checkUnsupported(a.tileInfo,a.fullExtent);if(c)return b.reject({msg:G(c)+C(a)}),!0}function G(a){switch(a.name){case "tilingscheme:gaps":return v.messages.tilingSchemeGaps;case "tilingscheme:power-of-two":return v.messages.tilingSchemePowerOfTwo;case "tilingscheme:tile-size":return v.messages.tilingSchemeTileSize;case "terrainsurface:num-root-tiles":return a.message;default:return v.messages.tilingSchemeGeneric}}
function H(b,c,g,d,e){if(c.tileInfo){b=z(b);if(!b&&10.22>g.currentVersion)return d.reject({msg:v.messages.tiledMapServicesMinVersion+C(c)}),!1;if(!b&&10.22===g.currentVersion&&!g._isCorsPatchDetected)return d.reject({msg:v.messages.tiledMapServicesMinVersionPatch+" "+v.messages.patchRequired+"\x3cbr\x3eArcGIS 10.2.2 for Server Patch - View Map and Image Services in the ArcGIS Online Scene Viewer"}),!1;g=window._webSceneViewerView;b=c.spatialReference instanceof a?c.spatialReference.clone():a.fromJSON(c.spatialReference);
var l=g.map.spatialReference,q="planar"===g.globeMode&&1===e;e=2===e;if(!e&&(!q||"spherical"===g.globeMode)&&!b.equals(l))return e=l.isWebMercator()?v.messages.tiledMapServicesSR+" Create a new local scene to add this layer.":v.messages.tiledMapServicesSRGeneric+" ("+l.wkid+")",d.reject({msg:e+C(c)}),!1;if(f.isGeographicCRS(b))return d.reject({msg:v.messages.tiledMapServiceSRGCS+C(c)}),!1;if("spherical"===g.globeMode){if(!e&&!E(c.tileInfo))return d.reject({msg:v.messages.tiledMapServicesTilingScheme+
C(c)}),!1}else if(!e&&!q&&!w(c.tileInfo,g))return d.reject({msg:v.messages.tiledMapServicesSRGeneric+C(c)}),!1;return x(c,d)?!1:"ArcGISTiledMapServiceLayer"}return"ArcGISMapServiceLayer"}function C(a){return a.name&&""!==a.name?"\x3cbr\x3e"+v.messages.serviceName+": "+a.name:""}function J(b,c,g){if(b.tileInfo){var d=b.spatialReference instanceof a?b.spatialReference.clone():a.fromJSON(b.spatialReference),e="LERC"===b.tileInfo.format,l=window._webSceneViewerView,q=l.map.spatialReference,t="planar"===
l.globeMode&&1===g;g=2===g;if(!g&&(!t||"spherical"===l.globeMode)&&!d.equals(q))return d=e?"spherical"===l.globeMode?v.messages.elevationImageServicesSR+" Create a new local scene to add this layer.":v.messages.tiledElevationServicesSRGeneric+" ("+q.wkid+")":"spherical"===l.globeMode?v.messages.imageServicesSR+" Create a new local scene to add this layer.":v.messages.tiledImageServicesSRGeneric+" ("+q.wkid+")",c.reject({msg:d+C(b)}),!1;if(f.isGeographicCRS(d))return c.reject({msg:v.messages.tiledMapServiceSRGCS+
C(b)}),!1;if("spherical"===l.globeMode){if(!g&&!E(b.tileInfo))return d=e?v.messages.elevationImageServicesTilingScheme:v.messages.tiledImageServicesTilingScheme,c.reject({msg:d+C(b)}),!1}else if(!t&&!g&&!w(b.tileInfo,l))return d=e?v.messages.tiledElevationServicesSRGeneric+C(b):v.messages.tiledImageServicesSRGeneric+C(b),c.reject({msg:d}),!1;return x(b,c)?!1:e?"ArcGISTiledElevationServiceLayer":"ArcGISTiledImageServiceLayer"}d=e?v.messages.elevationImageServicesCached:v.messages.imageServicesCached;
c.reject({msg:d+C(b)});return!1}function K(b,c,g){if(b){var d;d=k.exists("spatialReference.wkid",b)?new a(b.spatialReference.wkid):new a(4326);var e=window._webSceneViewerView,l=e.map.spatialReference,q="planar"===e.globeMode&&1===g;if(g=2!==g){if(q=!q||"spherical"===e.globeMode)q=d.equals(l)?!0:l.isWebMercator()&&4326===d.wkid?!0:!1,q=!q;g=q}return g?(d="spherical"===e.globeMode?v.messages.sceneLayerSRWM+" Create a new local scene to add this layer.":v.messages.sceneLayerSR+" ("+l.wkid+")",c.reject({msg:d+
C(b)}),!1):"planar"===e.globeMode&&f.isGeographicCRS(d)?(c.reject({msg:v.messages.sceneLayerSRGCS+C(b)}),!1):(d=b.drawingInfo&&b.drawingInfo.renderer&&b.drawingInfo.renderer.type)&&!B.isFeatureServiceRendererSupported(d)?(c.reject({msg:v.messages.featureServiceNotSupportedRendererType+" "+d+C(b)}),!1):!0}}function N(a,b,c){if(a.type&&"Table"===a.type)return c.reject({msg:v.messages.featureServiceNotSupportedTable+C(a)}),!1;if(a.geometryType&&"esriGeometryMultiPatch"===a.geometryType)return c.reject({msg:v.messages.featureServiceNotSupportedMultipatch+
C(a)}),!1;if(a.geometryType&&"esriGeometryMultipoint"===a.geometryType)return c.reject({msg:"Multipoint Feature Services are not supported"+C(a)}),!1;var g=a.drawingInfo&&a.drawingInfo.renderer&&a.drawingInfo.renderer.type;if(!g)return c.reject({msg:v.messages.featureServiceNotSupportedNoRenderer+C(a)}),!1;if(!B.isFeatureServiceRendererSupported(g))return c.reject({msg:v.messages.featureServiceNotSupportedRendererType+" "+g+C(a)}),!1;if(b.count>I)c.reject({msg:v.messages.featureServiceNotSupportedMaxFeatures+
" "+b.count+"/"+I+C(a)});else return!0}function M(a){return a&&a.replace(/_/g," ").replace(/\/$/,"")}var I=2E3,O=["simple","classBreaks","uniqueValue"],B={create:function(a){for(var b,c=0;c<B.layerHandlers.length;c++)if(B.layerHandlers[c].condition(a)){b=B.layerHandlers[c].create(a);break}return b},addHandler:function(a){B.layerHandlers.push(a)},getHandlers:function(){return B.layerHandlers},layerHandlers:[{name:"ArcGISSceneServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&
"ArcGISSceneServiceLayer"===a.layerType},create:function(a){return new d(a.url,B.evalOptions(a))}},{name:"ArcGISFeatureLayer",condition:function(a){return a.hasOwnProperty("layerType")&&"ArcGISFeatureLayer"===a.layerType},create:function(a){var b=B.evalOptions(a);b.mode=q.MODE_SNAPSHOT;b.returnZ=!0;b.outFields=["*"];a=new q(a.url,b);"spherical"===window._webSceneViewerView.globeMode?D(a):f.projectLayerExtentToSceneSR(a);return a}},{name:"ArcGISMapServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&
"ArcGISMapServiceLayer"===a.layerType},create:function(a){return new c(a.url,B.evalOptions(a))}},{name:"ArcGISTiledMapServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&"ArcGISTiledMapServiceLayer"===a.layerType},create:function(a){return new l(a.url,B.evalOptions(a))}},{name:"ArcGISTiledImageServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&"ArcGISTiledImageServiceLayer"===a.layerType},create:function(a){return new l(a.url,B.evalOptions(a))}},{name:"GroupLayer",
condition:function(a){return a.hasOwnProperty("layerType")&&"GroupLayer"===a.layerType},create:function(a){a=B.evalOptions(a);return new t(a)}},{name:"ArcGISTiledElevationServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&"ArcGISTiledElevationServiceLayer"===a.layerType},create:function(c){var g=B.evalOptions(c);0<c.url.indexOf("s3-eu-west-1.amazonaws.com")&&(void 0===c.resourceInfo&&(console.warn("missing s3 elevation info"),c.resourceInfo={}),g.resourceInfo=c.resourceInfo,
void 0===c.resourceInfo.tileInfo&&(g.resourceInfo.tileInfo={lods:P}),g.resourceInfo.fullExtent=void 0===c.resourceInfo||void 0===c.resourceInfo.fullExtent?new h(-2.103750722959434E7,-2.197186888040859E7,2.103750722959434E7,2.1971868880408563E7,a.WebMercator):new h(c.resourceInfo.fullExtent));return new b(c.url,g)}}],evalOptions:function(a){var b={visible:void 0===a.visibility?!0:a.visibility,title:a.title};a.id&&(b.id=a.id);void 0!==a.opacity&&(b.opacity=a.opacity);void 0!==a.visibilityMode&&(b.visibilityMode=
a.visibilityMode);b.showLegend=void 0===a.showLegend?!0:a.showLegend;void 0!==a.listMode&&(b.listMode=a.listMode);a.layerDefinition&&a.layerDefinition.definitionExpression&&(b.definitionExpression=a.layerDefinition.definitionExpression);return b},isFeatureServiceRendererSupported:function(a){return-1!==O.indexOf(a)},prepareFromServiceUrl:function(a,b){var c=new p;if(!a)return c.reject({msg:v.messages.invalidUrl}),c.promise;var g=B.validateServerUrl(a),d=g.serviceType,f=g.hasLayer;if(!g.isValidUrl)return c.reject({msg:v.messages.invalidUrl+
" "+a}),c.promise;if("MapServer"===d&&f)g.serviceType="FeatureServer";else if("ImageServer"===d&&f)return c.reject({msg:v.messages.unsupportedUrl+" "+a}),c.promise;var e={url:a,params:b,serviceDetails:g};g.needsGetLayer?n({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a,f){if("SceneServer"===d){var e;(e=f.serviceVersion)?(e=e.split("."),e=!e||1>e.length?!1:"1"===e[0]):e=!1;if(!e){c.reject({msg:v.messages.sceneLayerVersion});return}}e=a.url;for(var l=[],q=0;q<
f.layers.length;q++){var t="SceneServer"===d?e+"/layers/"+f.layers[q].id:e+("/"===e.substr(e.length-1,1)?"":"/")+f.layers[q].id;l.push({url:t,params:b,serviceDetails:g})}c.resolve({services:l})}.bind(this,e),function(a){console.log("serviceInfo query on "+e.serviceType+" failed");c.reject(a)}):c.resolve({services:[e]});return c.promise},prepareOpLayerFromService:function(a,b){b=void 0===b?0:b;var c=new p,g=a.serviceDetails,d=g.serviceType,f=a.params,l=a.url,q=[],t=l;if("SceneServer"!==d)if("SceneServerLocal"===
d)d=document.createElement("a"),d.href=l,d=d.host,0>s.request.corsEnabledServers.indexOf(d)&&s.request.corsEnabledServers.push(d),g.hasLayer||(t=l+"/nodes/0/");else if("FeatureServer"===d)g=n({url:l+"/query",content:{f:"json",where:f&&f.layerDefinition&&f.layerDefinition.definitionExpression||"1\x3d1",returnCountOnly:!0},handleAs:"json",callbackParamName:"callback"}),q.push(g);else if("MapServer"===d&&!1===z(l)){var h=A(l);if(h){var k=new p;n({url:h+"services/",content:{f:"json"},handleAs:"json",
callbackParamName:"callback"}).then(function(a){10.22===a.currentVersion?m(h+"self?f\x3djson",{headers:{"X-Requested-With":null},timeout:1E4,handleAs:"json"}).then(function(b){a._isCorsPatchDetected=!b||b.error?!1:!0;k.resolve(a)},function(b){a._isCorsPatchDetected=!1;k.resolve(a)}):k.resolve(a)},k.reject.bind(k));q.push(k)}}a.layer?q.unshift(a.layer.then(function(){return a.layer})):(t=n({url:t,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),q.unshift(t));e(q).then(function(a,g,
d){var e,l=a.serviceDetails.serviceType,q=d[0],t;if("MapServer"===l){if(d=H(g,q,d[1],c,b))e=d,t=a.params.title||B.parseTitleFromLayerUrl(f.url)}else if("ImageServer"===l){if(d=J(q,c,b))e=d,t=a.params.title||M(q.name)}else"FeatureServer"===l?N(q,d[1],c)&&(e="ArcGISFeatureLayer",t=a.serviceDetails.needsGetLayer?(a.params.title||M(a.serviceDetails.serverName))+" - "+M(d[0].name):a.params.title||M(a.serviceDetails.serverName)+" - "+M(d[0].name)):"SceneServer"===l?K(q,c,b)&&(e="ArcGISSceneServiceLayer",
t=d[0].alias||d[0].name,t=a.serviceDetails.needsGetLayer?(a.params.title||M(a.serviceDetails.serverName))+" - "+M(t):a.params.title||M(a.serviceDetails.serverName)+" - "+M(t)):"SceneServerLocal"===l&&(t=e="ArcGISSceneServiceLayer");e?c.resolve({layerType:e,title:t,url:g,serviceInfo:q}):setTimeout(function(){c.reject({msg:"Unsupported service "+g})},50)}.bind(this,a,l),function(a,b){c.reject({msg:b.message,details:a})}.bind(this,l));return c},validateServerUrl:function(a){a=a.replace(/\/$/,"");a=a.split("?")[0];
var b=a.replace(/http.+\/(arcgis\/rest\/services|arcgis\/services)\/?/ig,"").match(/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|WMServer|SceneServer|SceneServerLocal)).*/ig);if(null==b)return{isValidUrl:!1};var c;b&&b[0]&&(c=a.split(b)[0].split("/").pop(),b=b[0].substr(1));b=b&&b.length?b.split("/"):!1;a=b[0];var b=b.splice(1),g=!1,d=!1,f=!1;"SceneServerLocal"===a&&(g=0===b.length||2===b.length&&"layers"===b[0]&&!isNaN(b[1]),
d=2===b.length,f=!d);if("SceneServer"===a)g=0===b.length||2===b.length&&"layers"===b[0]&&!isNaN(b[1]),d=2===b.length,f=!d;else if("FeatureServer"===a)g=0===b.length||1===b.length&&!isNaN(b[0]),d=1===b.length,f=!d;else if("MapServer"===a||"ImageServer"===a)g=0===b.length||1===b.length&&!isNaN(b[0]),d=1===b.length,f=!1;return{serviceType:a,hasLayer:d,isValidUrl:g,needsGetLayer:f,serverName:c}},extrapolateTypeFromLayerInstance:function(a){if(a instanceof d)return"ArcGISSceneServiceLayer";if(a instanceof
q)return"ArcGISFeatureLayer";if(a instanceof l)return a.capabilities?-1!==a.capabilities.split(",").indexOf("Map")?"ArcGISTiledMapServiceLayer":"ArcGISTiledImageServiceLayer":a.url?"ImageServer"===B.validateServerUrl(a.url).serviceType?"ArcGISTiledImageServiceLayer":"ArcGISTiledMapServiceLayer":"ArcGISTiledMapServiceLayer";if(a instanceof c)return"ArcGISMapServiceLayer";if(a instanceof b)return"ArcGISTiledElevationServiceLayer";if(a instanceof t)return"GroupLayer";if(a instanceof g)return"OpenStreetMap"},
URL_REGEXP:"^https?://[^/]+/([^/]+/)*(((SceneServer|MapServer|FeatureServer|ImageServer)((/layers)?/[0-9]+)?/?)|(SceneServerLocal(/([^/]+/?)*)?))$",parseTitleFromLayerUrl:function(a){var b=RegExp(B.URL_REGEXP);a=b.test(a)?M(a.replace(b,"$1")):B.parseIdFromLayerUrl(a);return a.charAt(0).toUpperCase()+a.slice(1)},parseIdFromLayerUrl:function(a,b){var c;c=RegExp(B.URL_REGEXP);c.test(a)?c=b?a.replace(c,"$2__")+b.replace(" ","_").toLowerCase():a.replace(c,"$2__$1"):(c=new URL(a),c=c.pathname.length<c.hostname.length?
c.pathname.replace("/","_"):c.hostname.replace(".","_"));return c},useSSLIfRequired:function(a,b){(function(a){if(!a||!b)return!1;var c=!1;r.forEach(("undefined"===typeof window.esriGeowConfig?{httpsDomains:["arcgis.com","arcgisonline.com"]}:window.esriGeowConfig).httpsDomains,function(b){if(-1<a.indexOf("."+b+"/")||-1<a.indexOf("/"+b+"/"))c=!0});!c&&-1<a.indexOf(b.portalHostname)&&(c=!0);return c})(a)&&(a=b.portalUtil.useSSL(window.location.protocol,a));return a}},P=[{level:0,resolution:156543.03392800014,
scale:5.91657527591555E8},{level:1,resolution:78271.51696399994,scale:2.95828763795777E8},{level:2,resolution:39135.75848200009,scale:1.47914381897889E8},{level:3,resolution:19567.87924099992,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.992452562495,scale:4622324.434309},{level:8,resolution:611.4962262813797,scale:2311162.217155},
{level:9,resolution:305.74811314055756,scale:1155581.108577},{level:10,resolution:152.87405657041106,scale:577790.554289},{level:11,resolution:76.43702828507324,scale:288895.277144},{level:12,resolution:38.21851414253662,scale:144447.638572},{level:13,resolution:19.10925707126831,scale:72223.819286},{level:14,resolution:9.554628535634155,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.388657133974685,scale:9027.977411},{level:17,resolution:1.1943285668550503,
scale:4513.988705},{level:18,resolution:0.5971642835598172,scale:2256.994353},{level:19,resolution:0.29858214164761665,scale:1128.497176}];return B})},"webSceneViewer/editor/dijit/NavigatorContainer/NavigatorPane":function(){define(["esri/core/declare"],function(k){return k(null,{id:null,title:null,content:null,buttons:null,actionButton:null,backButton:!1,constructor:function(k){k=k||{};this.id=k.id;this.title=k.title;this.content=k.content;this.buttons=k.buttons||[];this.actionButton=k.actionButton;
this.backButton=k.hasOwnProperty("backButton")&&k.backButton},addNavButton:function(k,e){this.buttons.push({title:k,targetPane:e});return this},addNavButtonTo:function(k){this.addNavButton(k.title,k)},onPaneSelected:function(){this.emit("layer-found-visible",{clear:!0,hide:!0})}})})},"dstore/Promised":function(){define(["dojo/_base/declare","dojo/Deferred","./QueryResults","dojo/when"],function(k,r,e,p){function m(n,m){return function(){var h=new r;try{h.resolve(this[n].apply(this,arguments))}catch(a){h.reject(a)}return m?
(h=new e(h.promise),h.totalLength=p(h.totalLength),h):h.promise}}return k(null,{get:m("getSync"),put:m("putSync"),add:m("addSync"),remove:m("removeSync"),fetch:m("fetchSync",!0),fetchRange:m("fetchRangeSync",!0)})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(k,r,e){var p=function(m){function n(h){m[h]=function(){var a=arguments,f=e(m,function(d){Array.prototype.unshift.call(a,d);return p(k[h].apply(k,a))});if("forEach"!==h||s)return f}}
if(!m)return m;var s=!!m.then;s&&(m=r.delegate(m));n("forEach");n("filter");n("map");null==m.total&&(m.total=e(m,function(e){return e.length}));return m};r.setObject("dojo.store.util.QueryResults",p);return p})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(k){var r={};k.setObject("dojo.data.util.sorter",r);r.basicComparator=function(e,k){var m=-1;null===e&&(e=void 0);null===k&&(k=void 0);if(e==k)m=0;else if(e>k||null==e)m=1;return m};r.createSortFunction=function(e,k){function m(a,
c,b,d){return function(g,f){var e=d.getValue(g,a),q=d.getValue(f,a);return c*b(e,q)}}for(var n=[],s,h=k.comparatorMap,a=r.basicComparator,f=0;f<e.length;f++){s=e[f];var d=s.attribute;if(d){s=s.descending?-1:1;var q=a;h&&("string"!==typeof d&&"toString"in d&&(d=d.toString()),q=h[d]||a);n.push(m(d,s,q,k))}}return function(a,c){for(var b=0;b<n.length;){var d=n[b++](a,c);if(0!==d)return d}return 0}};return r})},"webSceneViewer/mapUtils":function(){define(["esri/Map","esri/layers/GroupLayer"],function(k,
r){var e={setVisibleLayerList:function(k,m){for(var n=k.layers.getAll(),s=void 0!==n.get?n.get("length"):n.length,h=0;h<s;h++){var a=void 0!==n.getItemAt?n.getItemAt(h):n[h];k.basemap&&k.basemap._mapGroupLayer===a||(0<=m.indexOf(a.get("id"))?a.set("visible",!0):a.set("visible",!1),a instanceof r&&e.setVisibleLayerList(a,m))}},getVisibleLayersList:function(e){function m(s){var h=[];s instanceof k&&(h=s.layers);s instanceof r&&(h=s.layers.getAll());s=void 0!==h.get?h.get("length"):h.length;for(var a=
0;a<s;a++){var f=void 0!==h.getItemAt?h.getItemAt(a):h[a];e.basemap&&e.basemap._mapGroupLayer===f||(f instanceof r?(f.get("visible")&&n.push(f),m(f)):f.get("visible")&&n.push(f))}}var n=[];m(e);return n}};return e})},"dstore/QueryMethod":function(){define([],function(){return function(k){var r=k.type,e=k.normalizeArguments,p=k.applyQuery,m=k.querierFactory;return function(){var n=Array.prototype.slice.call(arguments),k=e?e.apply(this,n):n,n={type:r,arguments:n,normalizedArguments:k},h=this._getQuerierFactory(r)||
m;h&&(n.querier=h.apply(this,k));k=this._createSubCollection({queryLog:this.queryLog.concat(n)});return p?p.call(this,k,n):k}}})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),function(k,r,e,p,m,n,s,h,a,f){return r("dijit._KeyNavContainer",[a,f,h],{connectKeyNavHandlers:function(a,f){var e=this._keyNavCodes={},c=n.hitch(this,"focusPrev"),b=n.hitch(this,
"focusNext");k.forEach(a,function(a){e[a]=c});k.forEach(f,function(a){e[a]=b});e[m.HOME]=n.hitch(this,"focusFirstChild");e[m.END]=n.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){p.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);k.forEach(this.getChildren(),n.hitch(this,"_startupChild"))},addChild:function(a,f){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=
this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(a){return(a=s.byNode(a))&&a.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),
function(k,r,e,p,m,n,s,h){return r("dijit._KeyNavMixin",h,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);e.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var a=this._keyNavCodes={};a[p.HOME]=m.hitch(this,"focusFirstChild");a[p.END]=m.hitch(this,"focusLastChild");a[this.isLeftToRight()?p.LEFT_ARROW:p.RIGHT_ARROW]=m.hitch(this,"_onLeftArrow");a[this.isLeftToRight()?p.RIGHT_ARROW:p.LEFT_ARROW]=m.hitch(this,"_onRightArrow");a[p.UP_ARROW]=m.hitch(this,
"_onUpArrow");a[p.DOWN_ARROW]=m.hitch(this,"_onDownArrow")}var f=this,a="string"==typeof this.childSelector?this.childSelector:m.hitch(this,"childSelector");this.own(n(this.domNode,"keypress",m.hitch(this,"_onContainerKeypress")),n(this.domNode,"keydown",m.hitch(this,"_onContainerKeydown")),n(this.domNode,"focus",m.hitch(this,"_onContainerFocus")),n(this.containerNode,n.selector(a,"focusin"),function(a){f._onChildFocus(s.getEnclosingWidget(this),a)}))},_onLeftArrow:function(){},_onRightArrow:function(){},
_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(a,f){a&&(this.focusedChild&&a!==this.focusedChild&&this._onChildBlur(this.focusedChild),
a.set("tabIndex",this.tabIndex),a.focus(f?"end":"start"))},_onContainerFocus:function(a){a.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){e.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(a){e.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex","-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(a){a&&a!=this.focusedChild&&
(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),a.set("tabIndex",this.tabIndex),this.lastFocused=a,this._set("focusedChild",a))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(a,f,d,e){a&&this.focusChild(a)},_keyboardSearchCompare:function(a,f){var d=a.domNode,d=(a.label||(d.focusNode?d.focusNode.label:"")||d.innerText||d.textContent||"").replace(/^\s+/,"").substr(0,f.length).toLowerCase();return f.length&&d==f?-1:0},_isFormElement:function(a){return"INPUT"===
a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||"BUTTON"===a.tagName},_onContainerKeydown:function(a){if(!this._isFormElement(document.activeElement)){var f=this._keyNavCodes[a.keyCode];f?(f(a,this.focusedChild),a.stopPropagation(),a.preventDefault(),this._searchString=""):a.keyCode==p.SPACE&&(this._searchTimer&&!a.ctrlKey&&!a.altKey&&!a.metaKey)&&(a.stopImmediatePropagation(),a.preventDefault(),this._keyboardSearch(a," "))}},_onContainerKeypress:function(a){if(!this._isFormElement(document.activeElement)&&
!(a.charCode<=p.SPACE||a.ctrlKey||a.altKey||a.metaKey))a.preventDefault(),a.stopPropagation(),this._keyboardSearch(a,String.fromCharCode(a.charCode).toLowerCase())},_keyboardSearch:function(a,f){var d=null,e,l=0;m.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=f;var a=/^(.)\1*$/.test(this._searchString)?1:this._searchString.length;e=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);
var b=this.focusedChild||null;if(1==a||!b)if(b=this._getNextFocusableChild(b,1),!b)return;a=b;do{var t=this._keyboardSearchCompare(b,e);t&&0==l++&&(d=b);if(-1==t){l=-1;break}b=this._getNextFocusableChild(b,1)}while(b!=a)})();this.onKeyboardSearch(d,a,e,l)},_onChildBlur:function(){},_getNextFocusableChild:function(a,f){var d=a;do{if(a)a=this._getNext(a,f);else if(a=this[0<f?"_getFirst":"_getLast"](),!a)break;if(null!=a&&a!=d&&a.isFocusable())return a}while(a!=d);return null},_getFirst:function(){return null},
_getLast:function(){return null},_getNext:function(a,f){if(a)for(a=a.domNode;a;)if((a=a[0>f?"previousSibling":"nextSibling"])&&"getAttribute"in a){var d=s.byNode(a);if(d)return d}return null}})})},"webSceneViewer/widgets/Dialog/ConfirmDialog":function(){define("esri/core/declare dojo/dom-class dijit/Dialog dijit/_WidgetsInTemplateMixin dojo/text!./templates/ConfirmDialog.html dojo/i18n!../../editor/nls/editor dijit/form/Form dijit/form/TextBox dijit/form/ValidationTextBox dijit/form/Button dijit/form/CheckBox dijit/form/Textarea".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q){return k([e,p],{templateString:m,message:"",confirm:"",cancel:"",title:"",constructor:function(a,c){},show:function(a){this.inherited(arguments);this._smoothBlendInOut(!0)},postCreate:function(){this.buttonConfirm.set("label",""!==this.confirm?this.confirm:n.confirmDialog.confirm);this.buttonCancel.set("label",""!==this.cancel?this.cancel:n.confirmDialog.cancelButton);this.Message.innerHTML=""!==this.message?this.message:"";this.titleNode.innerHTML=""!==this.title?
this.title:"";this.inherited(arguments)},_confirmButtonClickHandler:function(){this.emit("confirm",{});this._smoothBlendInOut(!1)},onCancel:function(){this.inherited(arguments);this.emit("cancel",{});this._smoothBlendInOut(!1)},_smoothBlendInOut:function(a){var c=document.getElementsByClassName("dijitDialogUnderlay _underlay");0!==c.length&&(c=c[0],a?r.add(c,"on"):r.remove(c,"on"))}})})},"webSceneViewer/editor/dijit/NavigatorContainer/NavigatorContainer":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/NavigatorContainer.html dojo/dom-class dojo/dom-construct dojo/on dojo/sniff dojo/i18n!../../nls/editor dojo/_base/lang".split(" "),
function(k,r,e,p,m,n,s,h,a,f){return k([r,e],{name:"NavigatorContainer",templateString:p,baseClass:"NavigatorContainer",panes:null,title:null,_setTitleAttr:{node:"titleNode",type:"innerHTML"},constructor:function(a,f){this._lastPaneIndexesQueue=[]},destroy:function(){this.inherited(arguments);for(var a in this.panes)this.panes.hasOwnProperty(a)&&this.panes[a].destroy();this._windowListener&&this._windowListener.remove();this._slideListener&&this._slideListener.remove()},postMixInProperties:function(){this.paneIds=
Object.keys(this.panes);this.mainPaneId=void 0===this.mainPaneId?0<this.paneIds.length?this.paneIds[0]:null:this.mainPaneId;for(var a in this.panes)this.panes.hasOwnProperty(a)&&"function"===typeof this.panes[a].emit&&s(this.panes[a],"navigate",function(a){"object"===typeof a.to?this.set("currentPane",a.to):this.set("currentPaneId",a.to);if(a.params)for(var d in a.params)a.params.hasOwnProperty(d)&&this.currentPane.set(d,a.params[d])}.bind(this))},postCreate:function(){this.set("currentPaneId",this.mainPaneId);
this._windowListener=s(window,"resize",this._recalculateInnerContentNodeHeight.bind(this));this._slideListener=s(this,"transitionend",f.hitch(this,function(a){this.emit("navcontainer-resize",{event:a})}));this.closeBtnNode.title=a.navigationContainer.closeOpen},currentPaneId:null,_setCurrentPaneIdAttr:function(a){0>this.paneIds.indexOf(a)&&(console.warn("trying to navigate to unexisting pane: "+a),a=this.mainPaneId);this.currentPaneId==a?console.warn("trying to navigate to current pane: "+a):(this._lastPaneIndexesQueue.push(a),
this._set("currentPaneId",a),this._set("currentPane",this.panes[a]),this._setPane(this.currentPane))},currentPane:null,_setCurrentPaneAttr:function(a){this.set("currentPaneId",a.id)},open:!0,_setOpenAttr:function(a){this._set("open",a);a?(this._recalculateInnerContentNodeHeight(),m.remove(this.domNode,"collapsed")):m.add(this.domNode,"collapsed")},_lastPaneIndexesQueue:null,_recalculateInnerContentNodeHeight:function(){if((h("ff")||h("ie")||h("trident"))&&this.domNode&&0!==this.domNode.getClientRects().length){var a=
this.domNode.getClientRects()[0].height,f=this.contentHeadNode.getClientRects()[0].height+this.navButtonsNode.getClientRects()[0].height;this.contentInnerScrollableNode.style.height=a-f-20+"px";console.log("new height:"+this.contentInnerScrollableNode.style.height)}},_setPane:function(d){0<this.contentNode.children.length&&this.contentNode.removeChild(this.contentNode.children[0]);0<this.navButtonsNode.children.length&&this.navButtonsNode.removeChild(this.navButtonsNode.children[0]);if(null==d)this.set("title",
null),this.set("backButtonVisible",!1);else{this.set("title",d.title);this.set("backButtonVisible",d.backButton);n.place(d.content,this.contentNode);var f,e,c,b=function(a,b){return function(){a.set("currentPaneId",b.id)}},t=function(a,b){a[b].apply(a)},g=n.create("div",{"class":"navButtonsList"},this.navButtonsNode);if(d.buttons&&0<d.buttons.length)for(var h=0;h<d.buttons.length;h++)f=d.buttons[h],e=n.create("div",{"class":"navButtonsListItem"+(0===h?" topBorder":"")},g),c=n.create("div",{"class":"navButtonsListItemText"},
e),c.textContent=f.title,n.create("button",{"class":"navButtonsListItemBtn",title:a.navigationContainer.open},e),s(e,"click",b(this,f.targetPane));d.actionButton&&(f=d.actionButton,e=n.create("div",{"class":"greenButton"},g),c=n.create("button",{"class":"greenButton"},e),c.textContent=f.title,f.tooltip&&(c.title=f.tooltip),f.targetPane?s(e,"click",b(this,f.targetPane)):f.action&&s(e,"click",dojo.partial(t,d,f.action)));d.onPaneSelected()}this._recalculateInnerContentNodeHeight()},_closeBtnNodeClickHandler:function(){this.set("open",
!this.open)},_navBackBtnNodeClickHandler:function(){this._lastPaneIndexesQueue.pop();var a=this._lastPaneIndexesQueue.pop();this.set("currentPaneId",a)}})})},"dojox/mdnd/dropMode/OverDropMode":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/dom-geometry dojox/mdnd/AreaManager".split(" "),function(k,r,e,p,m){k=r("dojox.mdnd.dropMode.OverDropMode",null,{_oldXPoint:null,_oldYPoint:null,_oldBehaviour:"up",constructor:function(){this._dragHandler=[e.connect(dojox.mdnd.areaManager(),
"onDragEnter",function(e,m){var h=dojox.mdnd.areaManager();-1==h._oldIndexArea&&(h._oldIndexArea=h._lastValidIndexArea)})]},addArea:function(e,k){var h=e.length,a=m.position(k.node,!0);k.coords={x:a.x,y:a.y};if(0==h)e.push(k);else{for(var f=k.coords.x,a=0;a<h;a++)if(f<e[a].coords.x){for(f=h-1;f>=a;f--)e[f+1]=e[f];e[a]=k;break}a==h&&e.push(k)}return e},updateAreas:function(e){for(var m=e.length,h=0;h<m;h++)this._updateArea(e[h])},_updateArea:function(e){var k=m.position(e.node,!0);e.coords.x=k.x;e.coords.x2=
k.x+k.w;e.coords.y=k.y},initItems:function(e){p.forEach(e.items,function(e){var h=m.position(e.item.node,!0);e.y=h.y+h.h/2});e.initItems=!0},refreshItems:function(e,m,h,a){if(-1!=m&&e&&h&&h.h){h=h.h;e.margin&&(h+=e.margin.t);for(var f=e.items.length;m<f;m++){var d=e.items[m];d.y=a?d.y+h:d.y-h}}},getDragPoint:function(e,m,h){return{x:h.x,y:h.y}},getTargetArea:function(e,m,h){var a=0,f=m.x,d=m.y,q=e.length,l=0,c="right",b=!1;-1==h||3>arguments.length?b=!0:this._checkInterval(e,h,f,d)?a=h:(this._oldXPoint<
f?l=h+1:(l=h-1,q=0,c="left"),b=!0);if(b)if("right"===c){for(;l<q;l++)if(this._checkInterval(e,l,f,d)){a=l;break}l==q&&(a=-1)}else{for(;l>=q;l--)if(this._checkInterval(e,l,f,d)){a=l;break}l==q-1&&(a=-1)}this._oldXPoint=f;return a},_checkInterval:function(e,m,h,a){var f=e[m];e=f.coords;m=e.x2;var d=e.y,f=d+f.node.offsetHeight;return e.x<=h&&h<=m&&d<=a&&a<=f?!0:!1},getDropIndex:function(e,m){var h=e.items.length,a=m.y;if(0<h)for(var f=0;f<h;f++){if(a<e.items[f].y)return f;if(f==h-1)break}return-1},destroy:function(){p.forEach(this._dragHandler,
e.disconnect)}});dojox.mdnd.areaManager()._dropMode=new dojox.mdnd.dropMode.OverDropMode;return k})},"webSceneViewer/editor/WebSceneEditorPanes/ContentsPane":function(){define("esri/core/declare dojo/_base/lang dojo/dom-construct dojo/on dojo/dom-class esri/layers/GroupLayer ./WebSceneEditorPaneBase webSceneViewer/widgets/LayerWidget/LayerWidgetEditable dojo/i18n!../nls/editor".split(" "),function(k,r,e,p,m,n,s,h,a){return k(s,{_onHandles:void 0,constructor:function(f){r.mixin(this,{id:"contents",
title:a.panes.contents,actionButton:{title:a.buttons.saveScene,tooltip:a.buttons.saveTooltip,action:"_saveWebScene"},backButton:!1});this._onHandles=[];this._updateContent();this._editor=f},destroy:function(){this._layerWidget.destroy();delete this._layerWidget;this._onHandles.forEach(function(a){a.remove()})},_saveWebScene:function(){this._editor.saveWebScene()},_updateContent:function(){var f=this,d=e.create("div",{className:"contentsPane"});this._layerWidget&&this._layerWidget.destroy();if(null==
this.editor)e.place("\x3cp\x3enot initialized\x3c/p\x3e",d);else{var q=e.create("button",{"class":"blueButton"},d);q.textContent="+ "+a.panes.addLayers;this._onHandles.push(p(q,"click",function(){f.emit("navigate",{to:"addLayer",from:this})}));this._layerWidget=new h({view:this.editor.view,editor:this.editor});this._layerWidget.placeAt(d);this._onHandles.push(p(this._layerWidget,"edit-layer",function(a){this.emit("navigate",{to:"editLayer",from:this,params:{layer:a.layer,parentGroup:a.parentGroup}})}.bind(this)));
this._onHandles.push(p(this._layerWidget,"edit-group",function(a){this.emit("navigate",{to:"editLayer",from:this,params:{layer:a.group}})}.bind(this)));this.addLayerGroupBtn=e.create("span",{"class":"CreateGroupLink"},d);this.addLayerGroupBtn.textContent=a.buttons.addGroup;this._onHandles.push(p(this.addLayerGroupBtn,"click",function(){var d=new n({title:a.contentsPane.newGroup+" "+(f.getNoOfGroupsInScene()+1)});d._websceneEditorProperties={editedFlags:{renderer:!1,labelingInfo:!1,elevationInfo:!1,
listMode:!1,visibilityMode:!1,popupInfo:!1}};f.editor.map.add(d,0);this._onHandles.push(p.once(f.editor.map,"layer-add",function(a){f._layerWidget.focusAddedGroupTitle(d)}.bind(f)));f.editor.setWebSceneChanged()}.bind(this)));this.toggleCreateLayerGroupLink(1<this.getNumberOfValidLayers());this._onHandles.push(p(this.editor.map,"layer-add",function(){this.toggleCreateLayerGroupLink(0<this.getNumberOfValidLayers())}.bind(this)));this._onHandles.push(p(this.editor.map,"layer-remove",function(){this.toggleCreateLayerGroupLink(0<
this.getNumberOfValidLayers())}.bind(this)))}this._addToContentNode(d)},getNumberOfValidLayers:function(){return this.editor.map.layers.reduce(function(a,d,e){return"SilentContentLayer"===d.id||"__basemapErrorFallbackLayer__"===d.id?a:a+1},0)},getNoOfGroupsInScene:function(){return this.editor.map.layers.reduce(function(a,d,e){return"SilentContentLayer"===d.id||"__basemapErrorFallbackLayer__"===d.id?a:a+(d instanceof n?1:0)},0)},toggleCreateLayerGroupLink:function(a){a?m.remove(this.addLayerGroupBtn,
"hide"):m.add(this.addLayerGroupBtn,"hide")},_createBasemapTocEntry:function(a,d){var q=e.create("div",{"class":"LayerItem editable"});e.create("span",{},q).textContent="Basemap ("+a.title+")";var l=e.create("div",{className:"tocEntryEditButton"},q);this._onHandles.push(p(l,"click",function(){this.emit("navigate",{to:"editBasemap",from:this})}.bind(this)));d&&e.place(q,d);return q}})})},"esri/widgets/Tags":function(){define("dojo/_base/array ../core/declare dojo/_base/lang dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/html dojo/keys dojo/on dojo/query dojo/sniff dojo/string dstore/Memory dijit/focus dijit/form/TextBox dijit/registry dijit/Tooltip dijit/_OnDijitClickMixin dijit/_TemplatedMixin ./Widget dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard ../core/lang dojo/i18n!../nls/jsapi dojo/NodeList-traverse dojo/NodeList-manipulate".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y,u,F,v,D,A,z,E,w,x){return r([D,F,v],{_attachmentNode:"",_autocompleteList:"",_grid:"",_store:"",_matchParam:"",_idProperty:"",_gridId:"",_filterId:"",_placeHolder:"",_noDataMsg:"",_inputTextBox:"",_gridHasFocus:!1,_metaKeyPressed:!1,_shiftKeyPressed:!1,_CSS_STYLES:{CLASS_SELECTOR:".",ALL_SELECTOR:"\x3e",MULTI:"select2-container select2-container-multi",CHOICES:"select2-choices",CHOICE:"select2-search-choice",SEARCH_CHOICE_FOCUS:"select2-search-choice-focus",
SEARCH_FIELD:"select2-search-field",CLOSE_ICON:"select2-search-choice-close"},_selRows:[],_CHOICE_SELECTOR:"",_CHOICE_FOCUS:"",_CHOICE_FOCUS_ALL:"",declaredClass:"esri.dijit.Tags",templateString:'\x3cdiv class\x3d"${baseClass}"\x3e\x3c/div\x3e',baseClass:"esri-tags",required:!1,values:[],_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},_setTagsAttr:function(a){a&&!Array.isArray(a)&&(a=a.split(","));this._isIE8?this._textTags&&this._textTags.set("value",
this._getUniqueTags(a).join(",")):(this.clearTags(),this.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):"":this.values?this.values.join(","):""},maxWidth:"auto",minWidth:"auto",_setKnownTagsAttr:function(a){this._isIE8||(this.clearTags(),this._store=new b({idProperty:this._idProperty,data:a&&0<a.length?a:[]}),this._grid.set("collection",this._store),this._grid.refresh())},constructor:function(a){this._idProperty=a.idProperty||
"tag";this.maxWidth=a.maxWidth||"auto";this.minWidth=a.minWidth||"auto";this._matchParam=a.matchParam||"first";this.values=[];this._selRows=[];this._CHOICE_ALL_SELECTOR=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE+this._CSS_STYLES.ALL_SELECTOR;this._CHOICE_FOCUS=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.SEARCH_CHOICE_FOCUS;this._CHOICE_FOCUS_ALL=this._CHOICE_FOCUS+this._CSS_STYLES.ALL_SELECTOR},postMixInProperties:function(){this.inherited(arguments);var a=(new Date).getTime();this._tagsId=
"userTags-"+a;this._gridId="grid-"+a;this._filterId="filter-"+a;this._isIE8=9>l("ie");this.i18n={};e.mixin(this.i18n,x.widgets.tags)},postCreate:function(){if(this._isIE8)this._textTags=new g({trim:!0,placeHolder:this.i18n.addTags,style:{minWidth:this.minWidth,maxWidth:this.maxWidth}},s.create("div",{id:this._tagsId},this.domNode)),this._textTags.startup(),n.add(this._textTags.domNode,"ie8-style");else{this._attachmentNode=s.create("div",{id:this._tagsId,className:"grid_1"},this.domNode);this._createContainerNode();
this._createTagList();this._createDropDownList();this._createInput();var a=[{field:this._idProperty}],c=[{property:this._idProperty,ascending:!0}];this._store=new b({idProperty:this._idProperty,data:[]});this._grid=new (r([A,z,E]))({collection:this._store,showHeader:!1,noDataMessage:this.i18n.noTagsFound,selectionMode:"extended",allowSelectAll:!0,cellNavigation:!1,columns:a,sort:c,renderRow:this._renderItem},this._dropDownList);this._grid.startup();n.add(this._grid.domNode,"grid-height-limiter");
var d;this.own(this._inputTextBox.watch("value",e.hitch(this,function(a,b,c){d&&(clearTimeout(d),d=null);this._grid.refresh()})));this.own(this._grid.on(".dgrid-row:click",e.hitch(this,function(a){var b="";!this._shiftKeyPressed&&!this._metaKeyPressed?(b=this._grid.row(a).data.tag,this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox()):!a.shiftKey&&(!a.metaKey&&!a.ctrlKey)&&(b=this._selRows[0],this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox())})));
this.own(this._grid.on("dgrid-deselect",e.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._grid.selection.hasOwnProperty(b)&&this._selRows.push(b)})));this.own(this._grid.on("dgrid-select",e.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._grid.selection.hasOwnProperty(b)&&this._selRows.push(b)})));this.own(this.connect(this.domNode,"keydown","_keydownHandler"));this.own(this.connect(this.domNode,"keyup","_keyupHandler"));window.onkeydown=
e.hitch(this,function(a){if(a.shiftKey||a.ctrlKey||224===a.keyCode)this._metaKeyPressed=!0});this.own(this.connect(document,"onkeydown",e.hitch(this,function(a){this._metaKeyPressed=this._shiftKeyPressed=!0})))}},_keyupHandler:function(a){0<(this._inputTextBox?this._inputTextBox.get("value").length:0)?this._applyFilter():this._removeFilter()},_keydownHandler:function(a){this._clearMessage();var b=q(this._CHOICE_FOCUS,p.byId(this.id)),g=q(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,p.byId(this.id)).last(),
d,l;void 0!==t.curNode.value&&(l=t.curNode.value.length);switch(a.keyCode){case f.RIGHT_ARROW:this._navigate(b,l,g,"right");this._hideGrid();break;case f.LEFT_ARROW:this._navigate(b,l,g,"left");this._hideGrid();break;case f.DOWN_ARROW:a.preventDefault();this._unhighlightTag(b);"none"===h.get(this._gridId,"display")&&this._showGrid();this._gridHasFocus||(this._grid.focus(this._setFocusOnFirstRow(this._grid,0)),this._gridHasFocus=!0);break;case f.UP_ARROW:break;case f.BACKSPACE:var m;if(0===l&&0===
q(this._CHOICE_FOCUS_ALL).length&&void 0!==q(this._CHOICE_ALL_SELECTOR)[q(this._CHOICE_ALL_SELECTOR).length-1]&&(m=q(this._CHOICE_ALL_SELECTOR)[q(this._CHOICE_ALL_SELECTOR).length-1].title,0<q("li",this._attachmentNode).length&&(s.destroy(g[0]),void 0!==m)))try{this._store.add({tag:m})}catch(n){}if(0<q(this._CHOICE_FOCUS_ALL).length&&(m=q(this._CHOICE_FOCUS_ALL).text(),s.destroy(b[0]),void 0!==m))try{this._store.add({tag:m})}catch(y){}this._grid.refresh();0===l&&this._hideGrid();this._removeTag(m);
this.validate();break;case f.CTRL:this._metaKeyPressed=!0;break;case f.META:this._metaKeyPressed=!0;break;case f.SHIFT:this._shiftKeyPressed=!0;break;case f.ENTER:if(0<l)b=this._stripHTML(t.curNode.value),b=b.split(","),d=[],k.forEach(b,function(a,b){-1===k.indexOf(d,a)&&d.push(c.trim(a))}),k.forEach(d,e.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(b=0;b<this._selRows.length;b++)this._createTags(this._selRows[b]),this._store.remove(this._selRows[b]);
this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();a.preventDefault();t.focus(p.byId(this._filterId));break;case f.TAB:if(!(t.curNode.id===this._filterId&&0===l)){if(0<l)b=this._stripHTML(t.curNode.value),b=b.split(","),d=[],k.forEach(b,function(a,b){-1===k.indexOf(d,a)&&d.push(c.trim(a))}),k.forEach(d,e.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(b=0;b<this._selRows.length;b++)this._createTags(this._selRows[b]),this._store.remove(this._selRows[b]);
this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();a.preventDefault();t.focus(p.byId(this._filterId))}break;case f.ESCAPE:this._hideGrid();break;default:-1<l&&("none"===h.get(p.byId(this._gridId),"display")&&this._showGrid(),this._unhighlightTag(b)),this._metaKeyPressed=!1}},_applyFilter:function(){var a=new this._store.Filter,b=this._inputTextBox?this._inputTextBox.get("value")+"":"",c=RegExp("^"+b.toLowerCase(),"i"),b=RegExp(b.toLowerCase(),"i"),a="first"===this._matchParam?
a.match(this._idProperty,c):a.match(this._idProperty,b);this._grid.set("collection",this._store.filter(a));this._grid.refresh()},_removeFilter:function(){this._grid.set("collection",this._store);this._grid.refresh()},_blurHandler:function(a,b,g){if(!this.focused){a=this._stripHTML(this._inputTextBox.value);if(0<a.length){var d=[];a=a.split(",");k.forEach(a,function(a,b){-1===k.indexOf(d,a)&&d.push(c.trim(a))});k.forEach(d,e.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||
this._createTags(a)}));this._resetInputTextBox()}this._hideGrid()}this.validate()},_clearMessage:function(){this._displayMessage(null)},_displayMessage:function(a){var b=this._isIE8?this._textTags.domNode:p.byId(this._tagsId);a&&this.focused?u.show(a,b):u.hide(b)},_resetInputTextBox:function(){this._inputTextBox.set("value","")},_isEmpty:function(a){return 0===a.trim().length},_navigate:function(a,b,c,g){0<a.length&&1>b?("right"===g?this._hightlightTag(a.next()):this._hightlightTag(a.prev()),this._unhighlightTag(a)):
1>b&&this._hightlightTag(c)},_contains:function(a,b){return 0<=k.indexOf(a,b)},_hightlightTag:function(a){a.addClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_unhighlightTag:function(a){a.removeClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_removeTag:function(a){a&&-1!==k.indexOf(this.values,a)&&this.values.splice(k.indexOf(this.values,a),1)},_hideGrid:function(){p.byId(this._gridId)&&h.set(p.byId(this._gridId),"display","none");this._gridHasFocus=!1},_showGrid:function(){h.set(p.byId(this._gridId),
"display","block");var a=h.get(p.byId(this._attachmentNode),"width");h.set(p.byId(this._gridId),"width",a+"px")},_setFocusOnFirstRow:function(a,b){return q(".dgrid-content .dgrid-cell",this._grid.domNode)[b]||q(".dgrid-content .dgrid-row",this._grid.domNode)[b]},_createTags:function(b){q(this._CHOICE_FOCUS,p.byId(this.id)).removeClass("select2-search-choice-focus");var c=s.create("li",null,this._autocompleteList);n.add(c,this._CSS_STYLES.CHOICE);c=s.create("div",{title:b},c);a.set(c,this._htmlEncode(b));
c=s.create("a",{href:"#"},c);n.add(c,this._CSS_STYLES.CLOSE_ICON);d(c,"click",e.hitch(this,function(a){var b=a.target.parentElement.innerText||a.target.parentElement.textContent;try{this._store.add({tag:b})}catch(c){}this._grid.refresh();this._removeTag(b);this._emitRemoved(b);this._emitChanged();s.destroy(a.target.parentNode.parentNode);a.preventDefault()}));c=y.byId(this._filterId);s.place(c.domNode,this._autocompleteList,"last");this._hideGrid();this.values.push(b);this._emitAdded(b);this._emitChanged()},
_emitAdded:function(a){this.emit("tags-add",{tag:a})},_emitRemoved:function(a){this.emit("tags-remove",{tag:a})},_emitChanged:function(){this.emit("tags-change",{tags:this.get("tags")})},_renderItem:function(a){return s.create("div",{innerHTML:a.tag})},_createContainerNode:function(){this._containerNode=s.create("div",null,this._attachmentNode);n.add(this._containerNode,this._CSS_STYLES.MULTI);h.set(this._containerNode,{maxWidth:this.maxWidth,minWidth:this.minWidth})},_createTagList:function(){this._autocompleteList=
s.create("ul",null,this._containerNode);n.add(this._autocompleteList,this._CSS_STYLES.CHOICES)},_createInput:function(){var a=s.create("li",null,this._autocompleteList,"last");n.add(a,this._CSS_STYLES.SEARCH_FIELD);this._inputTextBox=new g({id:this._filterId,placeHolder:this.i18n.addTags,intermediateChanges:!0,trim:!0,style:{border:"none"}},a);n.add(this._inputTextBox,"input-text-box");h.set(this._inputTextBox,"width",this.minWidth);(8<l("ie")||4<l("trident"))&&n.add(this._inputTextBox.domNode,"ie-style");
this.own(t.watch("curNode",e.hitch(this,this._blurHandler)))},_createDropDownList:function(){this._dropDownList=s.create("div",{id:this._gridId},this._containerNode);n.add(this._dropDownList,"drop-down-list");h.set(this._dropDownList,"width",this.minWidth)},_getUniqueTags:function(a){var b=[],c;k.forEach(a,e.hitch(this,function(a){c=this._stripHTML(a);w.isDefined(c)&&0<c.length&&b.push(c)}));return k.filter(b,e.hitch(this,function(a,c){return k.indexOf(b,a)===c}))},_stripHTML:function(a){return a&&
a.replace(/<(?:.|\s)*?>/g,"")},_htmlEncode:function(a){return!a?a:c.escape(a)},isValid:function(){var a=this.get("value");return!this.required||w.isDefined(a)&&0<a.length},validate:function(){this._created&&!this.isValid()?(m.set(this.domNode,"aria-invalid","true"),this._displayMessage(this.i18n.required)):(m.set(this.domNode,"aria-invalid","false"),this._clearMessage())},reset:function(){this.clearTags()},focus:function(){t.focus(this.domNode);this._isIE8?this._textTags.focus():this._inputTextBox.focus()},
prepopulate:function(a){k.forEach(a,e.hitch(this,function(a,b){this._createTags(a);this._store.remove(a)}))},clearTags:function(){var a=q(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,p.byId(this.id)),b=!1,c;0<a.length&&(b=!0,k.forEach(a,e.hitch(this,function(a,b){try{c=q(this._CHOICE_ALL_SELECTOR,p.byId(this.id))[0].title,this._store.add({tag:c})}catch(g){}s.destroy(a);this._emitRemoved(c)})),this.values=[],b&&this._emitChanged())},addStyledTags:function(b,c){n.add(p.byId(c),this._CSS_STYLES.MULTI);
var g=s.create("ul",null,p.byId(c));n.add(g,this._CSS_STYLES.CHOICES);h.set(g,"border","none");k.forEach(b,function(b,c){var d=s.create("li",null,g);h.set(d,"padding","3px 5px 3px 5px");n.add(d,"select2-search-resultSet");d=s.create("div",{title:b},d);a.set(d,b)})}})})},"webSceneViewer/widgets/OptionsMenu/OptionsMenu":function(){define("esri/core/declare dojo/dom-construct dojo/dom-class dojo/dom-style dojo/on dojo/_base/html dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/OptionsMenu.html".split(" "),
function(k,r,e,p,m,n,s,h,a,f){return k([h,a],{name:"OptionsMenu",templateString:f,constructor:function(a){this._onHandles=[]},postMixInProperties:function(){},createMenu:function(a){this.menu=r.create("div",{className:"menuOverlay"},a);this.wrapper=r.create("div",{className:"dropdown-wrapper"},this.menu);this.dropdownDomNode=r.create("div",{className:"dropdown-content"},this.wrapper);this.dropdownMenu=r.create("div",{className:"options-menu"},this.dropdownDomNode);this.menuListDomNode=r.create("ul",
{className:"options-menu"},this.dropdownMenu);this.entries.forEach(this._createMenuEntry.bind(this))},postCreate:function(){var a=dojo.byId("webscene-page");a&&this.createMenu(a);a=m(this.optionsMenuContainer,"click",function(){this.visible?this.hide():this.show()}.bind(this));this._onHandles.push(a)},destroy:function(){this._onHandles.forEach(function(a){a.remove()});var a=dojo.byId("webscene-page");a&&a.removeChild(this.menu)},show:function(){this.visible=!0;e.add(this.optionsMenu,"active");e.add(this.menu,
"show");var a=n.coords(this.optionsMenuContainer),f=a.x;e.contains(dojo.doc.body.parentNode,"esriRtl")&&(f=a.x-this.dropdownMenu.clientWidth+30);p.set(this.menu,"left",f+"px");p.set(this.menu,"top",a.y+a.h+"px");this._addHideListener()},hide:function(){this.visible&&(this.visible=!1,e.remove(this.optionsMenu,"active"),e.remove(this.menu,"show"),this._removeHideListener())},_createMenuEntry:function(a){a.className=a.className?a.className:"";var f=r.create("li",{className:"entry "+a.className,id:a.id},
this.menuListDomNode);r.create("a",{},f).textContent=a.title;f=m(f,"click",function(f){f.preventDefault();a.func.apply()});this._onHandles.push(f)},_addHideListener:function(){this._hideListener=m(document,"click",function(a){a.target!==this.optionsMenu&&(a.target!==this.dropdownButton&&a.target!==this.dropDownWrapper&&a.target!==this.optionsMenuContainer)&&this.hide()}.bind(this));this._hideListener=m(s(".NavigatorContainerContentInner")[0],"scroll",function(a){a.target!==this.dropdownButton&&this.hide()}.bind(this));
this._hideListener=m(window,"resize",function(a){a.target!==this.dropdownButton&&this.hide()}.bind(this))},_removeHideListener:function(){this._hideListener.remove()},setMenuEntryTitle:function(a,f){for(var e=0;e<this.menuListDomNode.children.length;e++){var c=this.menuListDomNode.children[e];c.id==a&&(c.children[0].textContent=f,this.entries[e].title=f)}},enableDisableMenuEntry:function(a,f){for(var l=0;l<this.menuListDomNode.children.length;l++){var c=this.menuListDomNode.children[l];c.id==a&&(f?
e.remove(c,"disabled"):e.add(c,"disabled"))}}})})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/on dojo/when ./util/misc put-selector/put".split(" "),function(k,r,e,p,m,n,s,h){return e([k,r],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:s.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var a=this;
m(this.bodyNode,"scroll",s[this.pagingMethod](function(f){a._processScroll(f)},null,this.pagingDelay))},renderQuery:function(a,f){var d=this,e=f&&f.container||this.contentNode,l={query:a,count:0},c,b=this.preload,t={node:h(e,"div.dgrid-preload",{rowIndex:0}),count:0,query:a,next:l};t.node.style.height="0";l.node=c=h(e,"div.dgrid-preload");l.previous=t;c.rowIndex=this.minRowsPerPage;b?((l.next=b.next)&&c.offsetTop>=b.node.offsetTop?l.previous=b:(l.next=b,l.previous=b.previous),l.previous.next=l,l.next.previous=
l):this.preload=l;var g=h(c,"-div.dgrid-loading");h(g,"div.dgrid-below").innerHTML=this.loadingMessage;f=p.mixin({start:0,count:this.minRowsPerPage},"level"in a?{queryLevel:a.level}:null);return this._trackError(function(){var b=a(f);return d.renderQueryResults(b,c,f).then(function(a){return n(b.totalLength,function(b){var e=a.length,q=c.parentNode,t=d.noDataNode;d._rows&&(d._rows.min=0,d._rows.max=e===b?Infinity:e-1);h(g,"!");"queryLevel"in f||(d._total=b);0===b&&(t&&(h(t,"!"),delete d.noDataNode),
d.noDataNode=t=h("div.dgrid-no-data"),q.insertBefore(t,d._getFirstRowSibling(q)),t.innerHTML=d.noDataMessage);for(t=q=0;t<e;t++)q+=d._calcRowHeight(a[t]);e&&q&&(d.rowHeight=q/e);b-=e;l.count=b;c.rowIndex=e;b?c.style.height=Math.min(b*d.rowHeight,d.maxEmptySpace)+"px":c.style.display="none";d._previousScrollPosition&&(d.scrollTo(d._previousScrollPosition),delete d._previousScrollPosition);return n(d._processScroll()).then(function(){return a})})}).otherwise(function(a){h(g,"!");throw a;})})},refresh:function(a){var f=
this,d=a&&a.keepScrollPosition;"undefined"===typeof d&&(d=this.keepScrollPosition);d&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this._renderedCollection)return this.renderQuery(function(a){return f._renderedCollection.fetchRange({start:a.start,end:a.start+a.count})}).then(function(){setTimeout(function(){m.emit(f.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:f})},0)})},resize:function(){this.inherited(arguments);this._processScroll()},cleanup:function(){this.inherited(arguments);
this.preload=null},renderQueryResults:function(a){var f=this.inherited(arguments),d=this._renderedCollection;d&&d.releaseRange&&n(f,function(f){f[0]&&!f[0].parentNode.tagName&&n(a.totalLength,function(){d.releaseRange(f[0].rowIndex,f[f.length-1].rowIndex+1)})});return f},_getFirstRowSibling:function(a){return a.lastChild},_calcRowHeight:function(a){var f=a.nextSibling;return f&&!/\bdgrid-preload\b/.test(f.className)?f.offsetTop-a.offsetTop:a.offsetHeight},lastScrollTop:0,_processScroll:function(a){function f(a,
b,c,g){var f=l.farOffRemoval,e=a.node;if(b>2*f){for(var t,q=e[c],m=0,n=0,k=[],p=q&&q.rowIndex,s;t=q;){var y=l._calcRowHeight(t);if(m+y+f>b||0>q.className.indexOf("dgrid-row")&&0>q.className.indexOf("dgrid-loading"))break;q=t[c];m+=y;n+=t.count||1;l.removeRow(t,!0);k.push(t);"rowIndex"in t&&(s=t.rowIndex)}l._renderedCollection.releaseRange&&("number"===typeof p&&"number"===typeof s)&&(g?l._renderedCollection.releaseRange(s,p+1):l._renderedCollection.releaseRange(p,s+1),l._rows[g?"max":"min"]=s,l._rows.max>=
l._total-1&&(l._rows.max=Infinity));a.count+=n;g?(e.rowIndex-=n,d(a)):e.style.height=e.offsetHeight+m+"px";var r=h("div",k);setTimeout(function(){h(r,"!")},1)}}function d(a,b){a.node.style.height=Math.min(a.count*l.rowHeight,b?Infinity:l.maxEmptySpace)+"px"}function e(a,b){do a=b?a.next:a.previous;while(a&&!a.node.offsetWidth);return a}var l=this,c=l.bodyNode;a=a&&a.scrollTop||this.getScrollPosition().y;var c=c.offsetHeight+a,b,t,g=l.preload,m=l.lastScrollTop,k=l.bufferRows*l.rowHeight,p=k-l.rowHeight,
s,r=!0;for(l.lastScrollTop=a;g&&!g.node.offsetWidth;)g=g.previous;for(;g&&g!==b;){b=l.preload;l.preload=g;t=g.node;var A=t.offsetTop;if(c+1+p<A)g=e(g,r=!1);else if(a-1-p>A+t.offsetHeight)g=e(g,r=!0);else{var A=((t.rowIndex?a-k:c)-A)/l.rowHeight,z=(c-a+2*k)/l.rowHeight,E=Math.max(Math.min((a-m)*l.rowHeight,l.maxRowsPerPage/2),l.maxRowsPerPage/-2),z=z+Math.min(Math.abs(E),10);0===t.rowIndex&&(A-=z);A=Math.max(A,0);10>A&&(0<A&&z+A<l.maxRowsPerPage)&&(z+=Math.max(0,A),A=0);z=Math.min(Math.max(z,l.minRowsPerPage),
l.maxRowsPerPage,g.count);if(0===z)g=e(g,r);else{var z=Math.ceil(z),A=Math.min(Math.floor(A),g.count-z),w={};g.count-=z;var x=t,G,E=l.queryRowsOverlap,H=(0<t.rowIndex||t.offsetTop>a)&&g;if(H){var C=g.previous;C&&(f(C,a-(C.node.offsetTop+C.node.offsetHeight),"nextSibling"),0<A&&C.node===t.previousSibling?(A=Math.min(g.count,A),g.previous.count+=A,d(g.previous,!0),t.rowIndex+=A,E=0):z+=A,g.count-=A);w.start=t.rowIndex-E;w.count=Math.min(z+E,l.maxRowsPerPage);t.rowIndex=w.start+w.count}else g.next&&
(f(g.next,g.next.node.offsetTop-c,"previousSibling",!0),x=t.nextSibling,x===g.next.node?(g.next.count+=g.count-A,g.next.node.rowIndex=A+z,d(g.next),g.count=A,E=0):G=!0),w.start=g.count,w.count=Math.min(z+E,l.maxRowsPerPage);G&&(x&&x.offsetWidth)&&(G=x.offsetTop);d(g);"level"in g.query&&(w.queryLevel=g.query.level);if("queryLevel"in w||!(w.start>l._total||0>w.count)){var J=h(x,"-div.dgrid-loading[style\x3dheight:"+z*l.rowHeight+"px]");h(J,"div.dgrid-"+(H?"below":"above")).innerHTML=l.loadingMessage;
J.count=z;l._trackError(function(){(function(a,b,c){var f=g.query(w);s=l.renderQueryResults(f,a,w).then(function(g){var e=l._rows;e&&(!("queryLevel"in w)&&g.length)&&(b?(e.max<=e.min&&(e.min=g[0].rowIndex),e.max=g[g.length-1].rowIndex):(e.max<=e.min&&(e.max=g[g.length-1].rowIndex),e.min=g[0].rowIndex));x=a.nextSibling;h(a,"!");c&&(x&&x.offsetWidth)&&(e=l.getScrollPosition(),l.scrollTo({x:e.x,y:e.y+x.offsetTop-c,preserveMomentum:!0}));n(f.totalLength,function(a){"queryLevel"in w||(l._total=a,l._rows&&
l._rows.max>=l._total-1&&(l._rows.max=Infinity));b&&(b.count=a-b.node.rowIndex,d(b))});l._processScroll();return g},function(b){h(a,"!");throw b;})})(J,H,G)});g=g.previous}}}}return s}})})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(k,r,e){return k("dijit.form.RadioButton",[r,e],{baseClass:"dijitRadio"})})},"dgrid/Selection":function(){define("dojo/_base/declare dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),
function(k,r,e,p,m,n,s){function h(a,c){for(var g=a.unselectable=c?"on":"",d=a.getElementsByTagName("*"),f=d.length;--f;)"INPUT"===d[f].tagName||"TEXTAREA"===d[f].tagName||(d[f].unselectable=g)}function a(a,c){var g=a.bodyNode,f=c?"text":21>e("ff")?"-moz-none":"none";d&&"msUserSelect"!==d?g.style[d]=f:e("dom-selectstart")?!c&&!a._selectstartHandle?a._selectstartHandle=r(g,"selectstart",function(a){var b=a.target&&a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):c&&a._selectstartHandle&&
(a._selectstartHandle.remove(),delete a._selectstartHandle):(h(g,!c),!c&&!a._unselectableHandle?a._unselectableHandle=p.after(a,"renderRow",function(a){h(a,!0);return a}):c&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle))}e.add("dom-comparedocumentposition",function(a,c,g){return!!g.compareDocumentPosition});e.add("css-user-select",function(a,c,g){a=g.style;c=["Khtml","O","ms","Moz","Webkit"];g=c.length;var d="userSelect";do if("undefined"!==typeof a[d])return d;
while(g--&&(d=c[g]+"UserSelect"));return!1});e.add("dom-selectstart","undefined"!==typeof document.onselectstart);var f=e("mac")?"metaKey":"ctrlKey",d=e("css-user-select"),q=(m=e("pointer"))&&"MS"===m.slice(0,2),l=m?m+(q?"Down":"down"):"mousedown",c=m?m+(q?"Up":"up"):"mouseup";return k(null,{selectionDelegate:".dgrid-row",selectionEvents:l+","+c+",dgrid-cellfocusin",selectionTouchEvents:e("touch")?n.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,
_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!==
this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},_setAllowTextSelection:function(b){"undefined"!==typeof b?a(this,b):a(this,"none"===this.selectionMode);this.allowTextSelection=b},_handleSelect:function(a,d){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(d))&&!("dgrid-cellfocusin"===a.type&&"mousedown"===a.parentType||a.type===c&&d!==this._waitForMouseUp)){this._waitForMouseUp=
null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32===a.keyCode)if(!a.shiftKey&&a.type===l&&this.isSelected(d))this._waitForMouseUp=d;else this[this._selectionHandlerName](a,d);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(a,c){var g=a.keyCode?a.ctrlKey:a[f];this._lastSelected===c?this.select(c,null,!g||!this.isSelected(c)):(this.clearSelection(),this.select(c),this._lastSelected=c)},_multipleSelectionHandler:function(a,c){var g=this._lastSelected,d=a.keyCode?a.ctrlKey:
a[f],e;a.shiftKey||(e=d?null:!0,g=null);this.select(c,g,e);g||(this._lastSelected=c)},_extendedSelectionHandler:function(a,c){(2===a.button?!this.isSelected(c):!(a.keyCode?a.ctrlKey:a[f]))&&this.clearSelection(null,!0);this._multipleSelectionHandler(a,c)},_toggleSelectionHandler:function(a,c){this.select(c,null,null)},_initSelectionEvents:function(){var a=this,d=this.contentNode,g=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};e("touch")&&!e("pointer")&&this.selectionTouchEvents?
(r(d,n.selector(g,this.selectionTouchEvents),function(c){a._handleSelect(c,this);a._ignoreMouseSelect=this}),r(d,r.selector(g,this.selectionEvents),function(g){a._ignoreMouseSelect!==this?a._handleSelect(g,this):g.type===c&&(a._ignoreMouseSelect=null)})):r(d,r.selector(g,this.selectionEvents),function(c){a._handleSelect(c,this)});this.addKeyHandler&&this.addKeyHandler(32,function(c){a._handleSelect(c,c.target)});if(this.allowSelectAll)this.on("keydown",function(c){c[f]&&(65===c.keyCode&&!/\bdgrid-input\b/.test(c.target.className))&&
(c.preventDefault(),a[a.allSelected?"clearSelection":"selectAll"]())});this._setCollection&&p.before(this,"_setCollection",function(c){a._updateDeselectionAspect(c)});this._updateDeselectionAspect()},_updateDeselectionAspect:function(a){function c(a,b){var d=g.row(a);if(d&&g.selection[d.id])g[b](d)}var g=this,d;this._removeDeselectSignals&&this._removeDeselectSignals();d=a&&a.track&&this._observeCollection?[p.before(this,"_observeCollection",function(a){d.push(a.on("delete",function(a){"undefined"===
typeof a.index&&c(a.id,"deselect")}))}),p.after(this,"_observeCollection",function(a){d.push(a.on("update",function(b){"undefined"!==typeof b.index&&c(a.getIdentity(b.target),"select")}))},!0)]:[p.before(this,"removeRow",function(a,b){var c;b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)})];this._removeDeselectSignals=function(){for(var a=d.length;a--;)d[a].remove();d=[]}},allowSelect:function(){return!0},_fireSelectionEvent:function(a){var c=this._selectionEventQueues[a],g=this._selectionTriggerEvent,
d;d={bubbles:!0,grid:this};g&&(d.parentType=g.type);d[this._selectionTargetType]=c;this._selectionEventQueues[a]=[];r.emit(this.contentNode,"dgrid-"+a,d)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,c;for(c in a)a[c].length&&this._fireSelectionEvent(c)},_select:function(a,c,g){var d,f,e;"undefined"===typeof g&&(g=!0);a.element||(a=this.row(a));if(!1===g||this.allowSelect(a))if(d=this.selection,f=!!d[a.id],null===g&&(g=!f),e=a.element,!g&&!this.allSelected?delete this.selection[a.id]:
d[a.id]=g,e&&(g?s(e,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):s(e,"!dgrid-selected!ui-state-active")),g!==f&&e&&this._selectionEventQueues[(g?"":"de")+"select"].push(a),c)if(c.element||(c=this.row(c)),c){if(c=c.element){d=this._determineSelectionDirection(e,c);d||(c=document.getElementById(c.id),d=this._determineSelectionDirection(e,c));for(;a.element!==c&&(a=this[d](a));)this._select(a,null,g)}}else this._lastSelected=e,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},
_determineSelectionDirection:e("dom-comparedocumentposition")?function(a,c){var g=c.compareDocumentPosition(a);return g&1?!1:2===g?"down":"up"}:function(a,c){return 1>c.sourceIndex?!1:c.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,c,g){this._select(a,c,g);this._fireSelectionEvents()},deselect:function(a,c){this.select(a,c,!1)},clearSelection:function(a,c){this.allSelected=!1;for(var g in this.selection)a!==g&&this._select(g,null,!1);c||(this._lastSelected=null);this._fireSelectionEvents()},
selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var c=this.row(this._rowIdToObject[a]);this._select(c.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},
renderArray:function(){var a=this.inherited(arguments),c=this.selection,g,d,f;for(g=0;g<a.length;g++)d=this.row(a[g]),(f=d.id in c?c[d.id]:this.allSelected)&&this.select(d,null,f);this._fireSelectionEvents();return a}})})},"webSceneViewer/webScene/Presentation":function(){define("esri/core/declare esri/core/lang esri/Viewpoint esri/core/Collection esri/views/3d/lib/glMatrix webSceneViewer/basemapUtils webSceneViewer/environmentUtils webSceneViewer/mapUtils webSceneViewer/assertUtils".split(" "),function(k,
r,e,p,m,n,s,h,a){var f=a.assert,d=m.vec3d,q=k(null,{declaredClass:"webScene.Presentation",slides:void 0,constructor:function(){this.slides=new p},toJSON:function(){for(var a={slides:[]},b=this.slides.getAll(),d=0;d<b.length;d++)a.slides[d]=q.slideToJson(b[d]);return r.fixJson(a)},addSlide:function(a){this.slides.addItem(a)},removeSlide:function(a){return"number"===typeof a?(f(a<this.slides.get("length")),this.slides.removeItemAt(a)):"object"===typeof a?this.slides.removeItem(a):null},removeSlideById:function(a){for(var b=
0;b<this.slides.items.length;b++)if(this.slides.items[b].id===a)return this.removeSlide(b);return null},getNewSlideId:function(){for(var a=1,b="slide_"+a.toString(),d=[],g=0;g<this.slides.items.length;g++)d[this.slides.items[g].id]=1;for(;d[b];)a++,b="slide_"+a.toString();return b},updateUniqueSlideIds:function(a){if(0!==a.length){for(var b=[],d=[],g=0;g<a.items.length;g++)d[a.items[g].id]=1;for(a=0;a<this.slides.length;a++){var g=this.slides.items[a],f=g.id,e=f.match(/(slide_)(\d+)$/),l;e?(l=e[1],
e=parseInt(e[2],10)):(l=f+"_",e=0);for(;d[f]||b[f];)e++,f=l+e.toString();b[f]=1;f!==g.id&&(g.id=f)}}},updateSlideDetails:function(a,b){var d=this.slides.getItemAt(a);b.title={text:d.title.text};b.description.text=d.description.text;b.id=d.id;this.slides.removeItemAt(a);this.slides.addItem(b,a)},moveSlide:function(a,b){var d;this.slides.getAll().forEach(function(b,f){b.id===a&&(d=b)});d&&this.slides.moveItem(d,b)}}),l=null;q.applySlideToView=function(a,b){var f=e.fromJSON(a.viewpoint).camera;f.fov=
b.get("camera").fov;if(a.environment&&a.environment.lighting&&null!=a.environment.lighting.date){var g=new Date(b.environment.lighting.date),q=g.getTime(),m=60*(60*g.getUTCHours()+g.getUTCMinutes())+g.getUTCSeconds(),k=a.environment.lighting.date,p=k.getTime(),r=60*(60*k.getUTCHours()+k.getUTCMinutes())+k.getUTCSeconds(),A=new Date,z=b.renderCoordsHelper,E=[0,0,0];z.toRenderCoords(b.camera.position,E);var w=[0,0,0];z.toRenderCoords(f.position,w);var x=[0,0,0],G=b.watch("camera",function(a){z.toRenderCoords(a.position,
x);var c=d.dist2(E,x),g=d.dist2(w,x);a=0;0!==c+g&&(a=c/(c+g));c=m+(r-m)*a;A.setTime(q+(p-q)*a);A.setUTCHours(c/3600);A.setUTCMinutes(c%3600/60);A.setUTCSeconds(c%3600%60);b.environment.lighting.date=A});l&&(l.stop(),l=null);b.environmentManager.autoAdjustTimezone=!1;b.environment.lighting=s.clone(a.environment).lighting;b.environment.lighting.date=g;l=b.animateTo(f);l.then(function(g){G.remove();"finished"===g.state&&(b.environment.lighting=s.clone(a.environment).lighting);l===g&&(b.environmentManager.autoAdjustTimezone=
!0)})}else s.applyToView(a.environment,b),b.animateTo(f);if(a.visibleLayers){f=[];for(g=0;g<a.visibleLayers.length;g++)f.push(a.visibleLayers[g].id);h.setVisibleLayerList(b.map,f)}a.baseMap&&n.setFromJSON(b,a.baseMap,!0)};q.fromJSON=function(a){var b=new q;if(a&&a.slides&&a.slides.length)for(var d=0;d<a.slides.length;d++){var g=a.slides[d];g.environment&&(g.environment=s.fromJSON(g.environment));g.baseMap&&g.baseMap.elevationLayers&&delete g.baseMap.elevationLayers;g.visibleLayers||(g.visibleLayers=
[]);b.addSlide(g)}return b};q.slideToJson=function(a){var b={id:a.id,title:a.title,thumbnail:a.thumbnail,description:a.description,baseMap:a.baseMap,viewpoint:a.viewpoint,visibleLayers:a.visibleLayers};a.environment&&(b.environment=s.toJSON(a.environment));return r.fixJson(b)};return q})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(k,r){function e(e,m){return r(this,function(n){for(var k=0,h=n.length;k<h;k++)e.call(m,n[k],k,n)})}return function(p,m){var n=m&&"totalLength"in
m;if(p.then){p=k.delegate(p);var s=p.then(function(e){var a=n?m.totalLength:e.totalLength||e.length;e.totalLength=a;return!n&&a});p.totalLength=n?m.totalLength:s;p.response=m&&m.response}else p.totalLength=n?m.totalLength:p.length;p.forEach=e;return p}})},"dijit/form/DropDownButton":function(){define("dojo/_base/declare dojo/_base/lang dojo/query ../registry ../popup ./Button ../_Container ../_HasDropDown dojo/text!./templates/DropDownButton.html ../a11yclick".split(" "),function(k,r,e,p,m,n,s,h,
a){return k("dijit.form.DropDownButton",[n,s,h],{baseClass:"dijitDropDownButton",templateString:a,_fillContent:function(){if(this.srcNodeRef){var a=e("*",this.srcNodeRef);this.inherited(arguments,[a[0]]);this.dropDownContainer=this.srcNodeRef}},startup:function(){if(!this._started){if(!this.dropDown&&this.dropDownContainer){var a=e("[widgetId]",this.dropDownContainer)[0];a&&(this.dropDown=p.byNode(a));delete this.dropDownContainer}this.dropDown&&m.hide(this.dropDown);this.inherited(arguments)}},isLoaded:function(){var a=
this.dropDown;return!!a&&(!a.href||a.isLoaded)},loadDropDown:function(a){var d=this.dropDown,e=d.on("load",r.hitch(this,function(){e.remove();a()}));d.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y,u){function F(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(h.hitch(this,a,b))}}var v=r("dijit.form._SelectMenu",l,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(a(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;
h.isArray(b)&&(b=b[b.length-1]);b&&k.forEach(this.parentWidget._getChildren(),function(c){c.option&&b===c.option.value&&(a=!0,this.focusChild(c,!1))},this);a||this.inherited(arguments)}});m=r("dijit.form.Select"+(f("dojo-bidi")?"_NoBidi":""),[d,q,g],{baseClass:"dijitSelect dijitValidationTextBox",templateString:u,_buttonInputDisabled:f("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new v({id:this.id+"_menu",parentWidget:this});p.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(!a.value&&!a.label)return new b({ownerDocument:this.ownerDocument});var g=h.hitch(this,"_setValueAttr",a);a=new c({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,
"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,onClick:g,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return!this.dropDown?[]:this.dropDown.getChildren()},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},focusChild:function(a){a&&
this.set("value",a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=y.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,c,g){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{k.forEach(this._getChildren(),
function(a){a.destroyRecursive()});var b=new c({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(a){this.inherited(arguments);e.set(this.valueNode,"value",this.get("value"));this._refreshState()},
_setNameAttr:"valueNode",_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?t.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):t.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);t.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=n.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(a(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var b=this._keyNavCodes;delete b[s.LEFT_ARROW];delete b[s.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
p.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);t.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){t.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
f("dojo-bidi")&&(m=r("dijit.form.Select",m,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));m._Menu=v;m.prototype._onContainerKeydown=F("_onContainerKeydown");m.prototype._onContainerKeypress=F("_onContainerKeypress");return m})},"webSceneViewer/webScene/LayerTemplates":function(){define("dojo/_base/lang esri/request esri/core/urlUtils dojo/Deferred dojo/promise/all dojo/sniff esri/renderers/Renderer esri/renderers/SimpleRenderer esri/renderers/UniqueValueRenderer esri/symbols/support/jsonUtils".split(" "),
function(k,r,e,p,m,n,s,h,a,f){var d={};k.mixin(d,{symbolFromJSON:function(a){d.adjustProtocolInSymbolRefs(a);(n("ie")||n("trident"))&&d.changeSVGRefsToPNG(a);return f.fromJSON(a)},removeProtocol:function(a){return a=a.replace(/^http:|https:/,"")},adjustProtocol:function(a){return a="https:"===location.protocol?a.replace(/^http:/,"https:"):a.replace(/^https:/,"http:")},removeProtocolFromSymbolRefs:function(a){if(a.symbolLayers)for(var f=0;f<a.symbolLayers.length;f++){var c=a.symbolLayers[f];if(c.resource&&
c.resource.href){var b=c.resource.href;e.fixUrl(b);b=d.removeProtocol(b);c.resource.href=b}}},adjustProtocolInSymbolRefs:function(a){if(a.symbolLayers)for(var f=0;f<a.symbolLayers.length;f++){var c=a.symbolLayers[f];if(c.resource&&c.resource.href){var b=c.resource.href,b=d.adjustProtocol(b);c.resource.href=b}}},changeSVGRefsToPNG:function(a){if(a.symbolLayers)for(var d=0;d<a.symbolLayers.length;d++){var c=a.symbolLayers[d];if(c.resource&&c.resource.href&&-1!==c.resource.href.indexOf(".svg",c.resource.href.length-
4)){var b=c.resource.href,b=b.replace(".svg",".png"),b=b.replace("/resource/","/resource/png/");c.resource.href=b}}},hasContentByReference:function(a){return!a?!1:a.styleUrl||a.styleName?"renderer":a.symbol&&a.symbol.type&&"styleSymbolReference"===a.symbol.type?"symbol":!1},getStyleFromUrl:function(a){var f=new p;r({url:d.adjustProtocol(a),content:{f:"json"},handleAs:"json"}).then(function(a){f.resolve(a)},function(a){f.reject(a)});return f},getStyle:function(a,d){var c=new p;if(!d)return c.reject("no portal to query styles"),
c;var b=d.stylesGroupQuery;if(!b)return c.reject("no stylesGroupQuery in portal.self"),c;d.queryGroups(b,!0).then(function(b){if(!b.results||0===b.results.length)return c.reject("no styles in styleGroup"),c;d.queryGroupItems(b.results[0].id,{q:"typekeywords:"+a},!0).then(function(b){0===b.total?c.reject("style name "+a+" not in style group"):d.getItemData(b.results[0].id).then(function(a){c.resolve(a)})})});return c},getSymbolSet:function(a){var f=new p;if(!a.symbolSetUrl)return f.reject("style does not provide url for symbolSet"),
f;r({url:d.adjustProtocol(a.symbolSetUrl),content:{f:"json"},handleAs:"json"}).then(function(c){(0===c.length||!c[0].name)&&f.reject("invalid syntax or missing data in symbol set");for(var b={defaultSymbol:void 0},e=0;e<c.length;e++){var g=d.symbolFromJSON(c[e]);b[c[e].name]=g;c[e].name===a.defaultItem&&(b.defaultSymbol=g)}b.defaultSymbol||(b.defaultSymbol=b[c[0].name]);f.resolve(b)});return f},getSymbolsIndividually:function(a){for(var f=[],c=0;c<a.items.length;c++)f.push(d.getSymbol(a.items[c].name));
return m(f)},getSymbol:function(a,f){for(var c=new p,b=0;b<a.items.length;b++)if(a.items[b].name===f)return r({url:d.adjustProtocol(a.items[b].webRef),content:{f:"json"},handleAs:"json"}).then(function(a){c.resolve(d.symbolFromJSON(a))},function(a){c.reject(a)}),c;c.reject("symbolName "+f+" not found in style");return c},getSymbolFromUrl:function(a){var f=new p;r({url:d.adjustProtocol(a),content:{f:"json"},handleAs:"json"}).then(function(a){f.resolve(d.symbolFromJSON(a))},function(a){f.reject(a)});
return f},createRenderer:function(a,f){var c,b=d.hasContentByReference(a);"renderer"===b?c=d._createUVRendererFromStyleUrl(a,f):"symbol"===b&&(c=d._createSimpleRendererWithStyleSymbolReference(a,f));return c},_patchInfosIntoRenderer:function(a,d){var c=new s(a);c.sizeInfo&&d.setProportionalSymbolInfo(c.sizeInfo);c.colorInfo&&d.setColorInfo(c.colorInfo);c.visualVariables&&d.setVisualVariables(c.visualVariables);return d},_createSimpleRendererWithStyleSymbolReference:function(a,f){var c=new p,b=a.symbol;
if(!b.name)return c.reject("no name in styleSymbolReference symbol"),c;var e;if(b.styleUrl)e=d.getStyleFromUrl(b.styleUrl);else if(b.styleName)e=d.getStyle(b.styleName,f);else return c.reject("no styleUrl or styleName in layerDefinition "+a),c;e.then(function(g){d.getSymbol(g,b.name).then(function(b){b=new h(b);b=d._patchInfosIntoRenderer(a,b);c.resolve(b)},function(a){c.reject("Can't get symbol. "+a)})},function(a){c.reject(a)});return c},_createUVRendererFromStyleUrl:function(f,e){var c=new p,b;
if(f.styleUrl)b=d.getStyleFromUrl(f.styleUrl);else if(f.styleName)b=d.getStyle(f.styleName,e);else return c.reject("no styleUrl or styleName in layerDefinition "+f),c;b.then(function(b){d.getSymbolSet(b).then(function(b){var e=new a(f.defaultSymbol&&b[f.defaultSymbol.name]?b[f.defaultSymbol.name]:b.defaultSymbol,f.field1),l;for(l in b)b.hasOwnProperty(l)&&e.addValue(l,b[l]);e=d._patchInfosIntoRenderer(f,e);c.resolve(e)},function(a){c.reject(a)})},function(a){c.reject(a)});return c}});return d})},
"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(k,r,e,p,m,n){return k("dijit.MenuSeparator",[e,p,m],{templateString:n,buildRendering:function(){this.inherited(arguments);r.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"webSceneViewer/editor/WebSceneEditorPanes/WebSceneEditorPaneBase":function(){define(["esri/core/declare","dojo/dom-construct","dojo/Evented",
"esri/core/Accessor","webSceneViewer/editor/dijit/NavigatorContainer/NavigatorPane"],function(k,r,e,p,m){return k([m,p,e],{editor:void 0,paneTopContainer:void 0,paneScrollableContainer:void 0,content:void 0,normalizeCtorArgs:function(){return{}},constructor:function(e){this.editor=e;this.content=r.create("div",{});this.paneTopContainer=r.create("div",{className:"paneTopContainer"});this.paneScrollableContainer=r.create("div",{className:"paneScrollableContainer"});this.content.appendChild(this.paneScrollableContainer);
this.content.appendChild(this.paneTopContainer)},_navBackBtnNodeClickHandler:function(){this.editor._navigatorWidget._navBackBtnNodeClickHandler()},_addToContentNode:function(e){0<this.paneScrollableContainer.children.length&&this.paneScrollableContainer.removeChild(this.paneScrollableContainer.children[0]);this.paneScrollableContainer.appendChild(e)}})})},"webSceneViewer/editor/WebSceneEditorPanes/WebScenePropertiesPane":function(){define("esri/core/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dijit/form/ValidationTextBox ./WebSceneEditorPaneBase esri/widgets/Tags dojo/Deferred ../../widgets/Switch/Switch ../../basemapUtils esri/views/3d/support/canvas3dUtils dojo/i18n!../nls/editor".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l){function c(a,c,d,f){a.set("value",d.get(c));a.initialSetup=!0;m(a,"change",function(a){null==a||""===a?this.set("value",d.get(c)):d.set(c,a);this.initialSetup?this.initialSetup=!1:f.setWebSceneChanged()});d.watch(c,function(c){a.set("value",c)})}return k(s,{thumbnailFileObject:void 0,_onHandles:void 0,constructor:function(){r.mixin(this,{id:"properties",title:l.panes.properties,actionButton:{title:l.buttons.done,action:"_navBackBtnNodeClickHandler"}});this._onHandles=
[];this._updateContent()},destroy:function(){this._onHandles.forEach(function(a){a.remove()});this._onHandles.length=0},_updateThumbnail:function(){var a=this.editor.webScene;if(a.portalItemProperties&&a.portalItemProperties._thumbnailFileObject)this.thumbnailFileObject=a.portalItemProperties._thumbnailFileObject,this.thumbnailImage.src=this.thumbnailFileObject.dataURI;else if(a.portalItemProperties.thumbnailUrl){var c=a.portalItemProperties.thumbnailUrl;try{if("public"!==a.portalItemProperties.access&&
-1===c.indexOf("token\x3d")&&this.editor.portal&&this.editor.portal.isSignedIn()){var d=this.editor.portal.getPortalUser().credential.token;a.portalItemProperties.thumbnailUrl+="?token\x3d"+d}}catch(f){}this.thumbnailImage.src=a.portalItemProperties.thumbnailUrl;this.thumbnailFileObject=void 0}else this.editor.view&&this._requestThumbnail(this.editor.view).then(function(a){this.thumbnailFileObject=a;this.thumbnailImage.src=a.dataURI}.bind(this))},_updateContentThumbnail:function(a){var c=e.create("tr",
{},a);a=e.create("td",{className:"topAlignment"},c);c=e.create("td",{},c);e.create("h3",{className:"paneSectionTitle",title:l.sceneProperties.thumbnail},a).textContent=l.sceneProperties.thumbnail;a=e.create("div",{className:"thumbnailContainer"},c);this.thumbnailImage=e.create("img",{className:"scenePropertiesInput","data-dojo-attach-point":"thumbnailBox",id:"${id}_thumbnailBox","data-dojo-props":"required: true"},a);a=e.create("div",{className:"iconRefreshContainer",title:l.sceneProperties.updateThumbnail},
a);e.create("div",{className:"iconRefresh"},a);m(a,"click",function(){this._thumbnailUpdateClickHandler()}.bind(this))},_updateContentTitle:function(a,d){var g=e.create("tr",{className:"separator"},a),f=e.create("td",{},g),g=e.create("td",{},g);e.create("h3",{className:"paneSectionTitle",title:l.sceneProperties.title},f).textContent=l.sceneProperties.title;this._titleTextBox=new n({className:"paneTextBox",placeHolder:l.sceneProperties.placeholderEnterTitle,required:!0,trim:!0,maxLength:60});this._titleTextBox.invalidMessage=
l.saveDialog.invalidTitle;this._titleTextBox.validator=function(a){return this._validateTitle(a)}.bind(this);c(this._titleTextBox,"title",d,this.editor);this._titleTextBox.placeAt(g)},_updateContentSummary:function(a,d){var g=e.create("tr",{className:"separator"},a),f=e.create("td",{},g),g=e.create("td",{},g);e.create("h3",{className:"paneSectionTitle",title:l.sceneProperties.summary},f).textContent=l.sceneProperties.summary;this._descriptionTextBox=new n({className:"paneTextBox",placeHolder:l.sceneProperties.placeholderEnterSummary,
value:d.portalItemProperties.description,required:!1,maxLength:250});this._descriptionTextBox.invalidMessage=l.saveDialog.invalidSummary;this._descriptionTextBox.validator=function(a){return this._validateTitle(a)}.bind(this);c(this._descriptionTextBox,"snippet",d,this.editor);this._descriptionTextBox.placeAt(g)},_updateContentTags:function(a,c){var d=e.create("tr",{className:"separator"},a),f=e.create("td",{},d),d=e.create("td",{},d);e.create("h3",{className:"paneSectionTitle",title:l.sceneProperties.tags},
f).textContent=l.sceneProperties.tags;this._tagsWidget=new h({minWidth:"220px",maxWidth:"220px",placeHolder:l.sceneProperties.placeholderEnterTags});this._tagsWidget.startup();this._tagsWidget.placeAt(d);this.initialTagsSetup=!1;this._onHandles.push(m(this._tagsWidget,"tags-add",function(a){this.initialTagsSetup||(this.editor.setWebSceneChanged(),c.set("tags",this._tagsWidget.get("value")))}.bind(this)));this._onHandles.push(m(this._tagsWidget,"tags-remove",function(a){this.editor.setWebSceneChanged();
c.set("tags",this._tagsWidget.get("value"))}.bind(this)))},_updateContentElevation:function(a){var c=e.create("tr",{className:"separator"},a);a=e.create("td",{className:"topAlignment"},c);c=e.create("td",{},c);e.create("h3",{className:"paneSectionTitle",title:l.sceneProperties.elevation},a).textContent=l.sceneProperties.elevation;a=r.exists("editor.map.basemap.elevationLayers",this)?0<this.editor.map.basemap.elevationLayers.length:!0;this._elevationSwitch=new f({switchOn:a});this._onHandles.push(m(this._elevationSwitch,
"toggle",function(a){a.on?d.turnOnElevation(this.editor.map):d.turnOffElevation(this.editor.map);this.editor.setWebSceneChanged()}.bind(this)));this._elevationSwitch.placeAt(c);this._elevationSwitch.startup();this._elevationWarningContainer=e.create("div",{className:"elevationWarning hide"},c);this._elevationWarningIcon=e.create("div",{className:"warningIcon"},this._elevationWarningContainer);this._elevationWarning=e.create("div",{className:"shareMessageText"},this._elevationWarningContainer);this._elevationWarning.innerHTML=
l.sceneProperties.elevationUnsupported;r.exists("editor.view.basemapTerrain.tilingScheme",this)&&this._compareElevationWithMapSR();this._onHandles.push(this.editor.view.watch("basemapTerrain.tilingScheme",function(){this._compareElevationWithMapSR()}.bind(this)))},_compareElevationWithMapSR:function(){try{d._checkDefaultElevationCompatibility(this.editor.view),this._elevationSwitch.enable(),p.add(this._elevationWarningContainer,"hide")}catch(a){this._elevationSwitch.turnOff(),d.turnOffElevation(this.editor.map),
this._elevationSwitch.disable(),this._elevationSwitch.SwitchContainer.title=l.sceneProperties.elevationUnsupported,p.remove(this._elevationWarningContainer,"hide")}},_updateContentClipping:function(a,c){var d=e.create("tr",{className:"separator"},a),q=e.create("td",{className:"topAlignment"},d),d=e.create("td",{},d);e.create("h3",{className:"paneSectionTitle",title:l.sceneProperties.clipping},q).textContent=l.sceneProperties.clipping;this._clippingSwitch=new f({switchOn:c.clippingArea?c.clippingArea.clip:
!1,className:"extent switch"});this._onHandles.push(m(this._clippingSwitch,"toggle",function(a){a.on?(c.clippingArea=!c.clippingArea?{geometry:this.editor.view.extent}:c.clippingArea,this.editor.view.clippingArea=c.clippingArea.geometry,c.clippingArea.clip=!0,c.clippingArea.geometry.intersects(this.editor.view.extent)||this.editor.view.animateTo(c.clippingArea.geometry)):(this.editor.view.clippingArea=null,c.clippingArea.clip=!1);this.editor.setWebSceneChanged()}.bind(this)));this._clippingSwitch.placeAt(d);
this._clippingSwitch.startup();q=e.create("div",{className:"updateClippingExtentLink"},d);d=e.create("div",{className:"iconContainer",title:l.sceneProperties.currentView},q);e.create("div",{className:"iconRefresh"},d);e.create("div",{className:"clippingText"},q).textContent=l.sceneProperties.currentView;this._onHandles.push(m(q,"click",function(){this.editor.view.clippingArea=this.editor.view.extent.clone();c.clippingArea=!c.clippingArea?{geometry:this.editor.view.extent}:c.clippingArea;c.clippingArea.geometry=
this.editor.view.extent.clone();c.clippingArea.clip=!0;this._clippingSwitch.turnOn()}.bind(this)))},_updateContent:function(){var a=e.create("div",{className:"webScenePropertiesPane"});if(null==this.editor.webScene)e.place("\x3cp\x3einitialization problem\x3c/p\x3e",a);else{var c=this.editor.webScene,d=e.create("table",{className:"propertiesTable"},a);this._updateContentThumbnail(d);this._updateContentTitle(d,c);this._updateContentSummary(d,c);this._updateContentTags(d,c);this._updateContentElevation(d);
"planar"===this.editor.view.globeMode&&this._updateContentClipping(d,c);this.editor.view.watch("globeMode",function(a){"planar"===a&&this._updateContentClipping(d,c)}.bind(this))}this._addToContentNode(a)},_thumbnailUpdateClickHandler:function(){this._requestThumbnail(this.editor.view).then(function(a){this.thumbnailFileObject=a;this.thumbnailImage.src=a.dataURI;this.editor.webScene.portalItemProperties._thumbnailFileObject=this.thumbnailFileObject}.bind(this));this.editor.setWebSceneChanged()},_requestThumbnail:function(b){var c=
new a;b.takeScreenshot({format:"jpeg",quality:80,width:200,height:133}).then(function(a){c.resolve({data:q.dataURItoBlob(a.dataURL),identifier:"thumbnail",name:"thumbnail",dataURI:a.dataURL})},c.reject);return c},onPaneSelected:function(){this._updateThumbnail();this.editor.portal&&this.editor.portal.getPortalUser().getTags().then(function(a){this._tagsWidget.set("knownTags",a);this.editor.webScene.portalItemProperties&&(this.initialTagsSetup=!0,this._tagsWidget.set("value",this.editor.webScene.portalItemProperties.tags),
this.initialTagsSetup=!1)}.bind(this),function(a){console.error(a)});this.editor.webScene.portalItemProperties&&(this._titleTextBox.set("value",this.editor.webScene.portalItemProperties.title),this._descriptionTextBox.set("value",this.editor.webScene.portalItemProperties.snippet),this.initialTagsSetup=!0,this._tagsWidget.set("value",this.editor.webScene.portalItemProperties.tags),this.initialTagsSetup=!1);this.editor.webScene&&this._clippingSwitch&&this.editor.webScene.clippingArea&&(this.editor.webScene.clippingArea.clip?
this._clippingSwitch.turnOn():this._clippingSwitch.turnOff())},_navBackBtnNodeClickHandler:function(){var a=this.editor.webScene;if(a.portalItemProperties&&!a.portalItemProperties._thumbnailFileObject&&!a.portalItemProperties.thumbnailUrl||!a.portalItemProperties)a.portalItemProperties._thumbnailFileObject=this.thumbnailFileObject,this.thumbnailFileObject.dataURI=this.thumbnailImage.src,this.editor.webScene.portalItemProperties._thumbnailFileObject=this.thumbnailFileObject,this.editor.setWebSceneChanged();
this.inherited(arguments)},_validateTitle:function(a){return-1!==a.indexOf("\x3e")||-1!==a.indexOf("\x3c")?!1:!0}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),function(k,r,e,p,m,n){var s=function(a){a=a||{};var f=e.getLocalization("dojo.cldr","number",e.normalizeLocale(a.locale)),d=a.pattern?a.pattern:f[(a.type||"decimal")+"Format"];a="number"==typeof a.places?a.places:"string"===typeof a.places&&
0<a.places.length?a.places.replace(/.*,/,""):-1!=d.indexOf(".")?d.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:f.decimal,places:a}},h=k("dijit.form.NumberTextBoxMixin",null,{pattern:function(a){return"("+(this.focused&&this.editOptions?this._regExpGenerator(r.delegate(a,this.editOptions))+"|":"")+this._regExpGenerator(a)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:m.format,_regExpGenerator:m.regexp,_decimalInfo:s(),postMixInProperties:function(){this.inherited(arguments);
this._set("type","text")},_setConstraintsAttr:function(a){var f="number"==typeof a.places?a.places:0;f&&f++;"number"!=typeof a.max&&(a.max=9*Math.pow(10,15-f));"number"!=typeof a.min&&(a.min=-9*Math.pow(10,15-f));this.inherited(arguments,[a]);this.focusNode&&(this.focusNode.value&&!isNaN(this.value))&&this.set("value",this.value);this._decimalInfo=s(a)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var a=this.get("value");"number"==typeof a&&!isNaN(a)&&(a=this.format(a,this.constraints),
void 0!==a&&(this.textbox.value=a));this.inherited(arguments)}},format:function(a,f){var d=String(a);if("number"!=typeof a)return d;if(isNaN(a))return"";if(!("rangeCheck"in this&&this.rangeCheck(a,f))&&!1!==f.exponent&&/\de[-+]?\d/i.test(d))return d;this.editOptions&&this.focused&&(f=r.mixin({},f,this.editOptions));return this._formatter(a,f)},_parser:m.parse,parse:function(a,f){var d=this._parser(a,r.mixin({},f,this.editOptions&&this.focused?this.editOptions:{}));this.editOptions&&(this.focused&&
isNaN(d))&&(d=this._parser(a,f));return d},_getDisplayedValueAttr:function(){var a=this.inherited(arguments);return isNaN(a)?this.textbox.value:a},filter:function(a){if(null==a||"string"==typeof a&&""==a)return NaN;"number"==typeof a&&(!isNaN(a)&&0!=a)&&(a=m.round(a,this._decimalInfo.places));return this.inherited(arguments,[a])},serialize:function(a,f){return"number"!=typeof a||isNaN(a)?"":this.inherited(arguments)},_setBlurValue:function(){var a=r.hitch(r.delegate(this,{focused:!0}),"get")("value");
this._setValueAttr(a,!0)},_setValueAttr:function(a,f,d){if(void 0!==a&&void 0===d)if(d=String(a),"number"==typeof a)if(isNaN(a))d="";else{if("rangeCheck"in this&&this.rangeCheck(a,this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(d))d=void 0}else a?a=void 0:(d="",a=NaN);this.inherited(arguments,[a,f,d])},_getValueAttr:function(){var a=this.inherited(arguments);if(isNaN(a)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&RegExp("^"+
m._realNumberRegexp(r.delegate(this.constraints))+"$").test(this.textbox.value))return a=Number(this.textbox.value),isNaN(a)?void 0:a}else return a},isValid:function(a){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var f=this.get("value");return!isNaN(f)&&this.rangeCheck(f,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var a="number"==typeof this.constraints.min,
f="number"==typeof this.constraints.max,d=this.get("value");if(isNaN(d)||!a&&!f)return this.inherited(arguments);var e=d|0,l=0>d,c=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),b=(this.maxLength||20)-this.textbox.value.length,h=c?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",e=c?e+"."+h:e+"",b=p.rep("9",b),c=d;l?c=Number(e+b):d=Number(e+b);return!(a&&d<this.constraints.min||f&&c>this.constraints.max)}});k=k("dijit.form.NumberTextBox",[n,h],{baseClass:"dijitTextBox dijitNumberTextBox"});
k.Mixin=h;return k})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(k,r,e,p){return k("dijit.DropDownMenu",p,{templateString:e,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(e){this._moveToPopup(e);e.stopPropagation();e.preventDefault()},_onLeftArrow:function(e){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();
else this.onCancel(!1);else e.stopPropagation(),e.preventDefault()}})})},"webSceneViewer/widgets/SlideDeck/SlideDeckEditable":function(){define("esri/core/declare dojo/dom-class dojo/dom-construct dojo/on dojo/Deferred webSceneViewer/mapUtils webSceneViewer/widgets/SlideDeck/SlideDeck dijit/InlineEditBox webSceneViewer/webScene/Presentation dojo/topic dojox/mdnd/AreaManager dojox/mdnd/DropIndicator dojox/mdnd/dropMode/OverDropMode ../OptionsMenu/OptionsMenu ../../basemapUtils ../../environmentUtils dojo/fx dojo/_base/fx dojox/fx/style dojo/fx/easing dojo/dom-geometry dojo/i18n!../nls/widgets".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y,u,F,v,D){function A(b,c){null==c.presentation&&(c.presentation=new a);c.presentation.addSlide(b)}function z(a){a=a.childNodes[0].childNodes[2];var b=document.getElementById("slideThumbnailAnimation"),c=document.getElementById("webscene-map"),d=v.position(a),f=v.position(c),c=[];c.push(u.addClass(a,"hidden",{duration:1}));b.style.left=f.x+"px";b.style.top=f.y-61+"px";b.style.height=f.h+"px";b.style.width=f.w+"px";b.style.opacity=0.2;b.style.backgroundColor=
"transparent";b.style.border="12px solid white";b.style.zIndex=101;b.style.backgroundSize="cover";b.style.backgroundRepeat="no-repeat";r.remove(b,"hide");f=y.animateProperty({node:"slideThumbnailAnimation",properties:{opacity:0.9},duration:100,easing:F.quadIn});c.push(f);f=y.animateProperty({node:"slideThumbnailAnimation",properties:{opacity:0.2},duration:100,easing:F.quadOut,onEnd:function(){b.style.backgroundImage="url("+a.src+")";b.style.opacity=0;b.style.border="0px solid white"}});c.push(f);
d=y.animateProperty({node:"slideThumbnailAnimation",properties:{height:d.h,width:d.w,top:d.y-61,left:d.x},duration:350,unit:"px",easing:F.quadOut});f=y.animateProperty({node:"slideThumbnailAnimation",properties:{opacity:0.95},duration:350,unit:"px",delay:50,easing:F.linear});c.push(g.combine([d,f]));c.push(u.removeClass(a,"hidden",{duration:1}));c.push(u.addClass(b,"hide",{duration:1}));g.chain(c).play()}return k(s,{name:"SlideDeckEditable",baseClass:"SlideDeckEditable",editor:void 0,editedSlideIndex:-1,
slideEdited:!1,constructor:function(a,b){this.editor=a.editor;this._createSlideEditables();this._createAddSlide(b);r.add(b,"slideDeckEditable")},_init:function(){this._initDragAndDrop();this.inherited(arguments)},_initDragAndDrop:function(){this._dragManager=new d;this._dragManager._dropIndicator=new q;this._dragManager._dropMode=new l;f.subscribe("/dojox/mdnd/drop",function(a,b,c){b.node===this.innerContainer&&(this.webScene.presentation.moveSlide(a.attributes.bmid.value,c),a.attributes.nr.value!=
c&&this.editor.setWebSceneChanged(),setTimeout(function(){this.webScene.presentation=this.webScene.presentation.toJSON()}.bind(this),0))}.bind(this))},_newSlideFromCamera:function(){for(var a=new m,c=[],d=n.getVisibleLayersList(this.view.map),g=0;g<d.length;g++)c.push({id:d[g].get("id")});var d=this.view.viewpoint,g=this.view.environment,f={thumbnail:{url:void 0},description:{text:""},baseMap:b.toJSON(this.view,this.view.map.basemap),viewpoint:d.toJSON(),visibleLayers:c,environment:t.clone(g)};this.view.takeScreenshot({format:"jpeg",
quality:80,width:112,height:61}).then(function(b){f.thumbnail.url=b.dataURL;a.resolve(f)},a.reject);return a.promise},_createAddSlide:function(a){var b=e.create("div",{"class":"slide addSlide"});e.place(b,a,"last");a=e.create("button",{"class":"slideButton"},b);e.create("p",{"class":"addChar",innerHTML:"+ "+D.slideDeckEditable.addSlide},a);p(a,"click",function(){this._newSlideFromCamera().then(function(a){var b=this.webScene.presentation.getNewSlideId(),c=1;if(this.webScene.presentation)for(var d=
this.webScene.presentation.slides,c=d.length+1;d.find(function(a){return a.title.text===D.slideDeckEditable.slide+" "+c});)c++;a.id=b;a.title={text:D.slideDeckEditable.slide+" "+c};A(a,this.webScene);this.startEditing=a.id;this._slideEdited(d.length-1);this.webScene.presentation=this.webScene.presentation.toJSON();this.editor.setWebSceneChanged()}.bind(this))}.bind(this))},_createSlideEditables:function(){for(var a=0;a<this.slideNodes.length;a++){var b=this.slideNodes[a],d=e.create("div",{"class":"slideDetails"},
b),g=this.webScene.presentation.slides.getItemAt(a),f=e.create("div",{"class":"editTitle",title:g.title.text},d),f=new h({autoSave:!0,value:g.title.text,editor:"dijit/form/ValidationTextBox",editorParams:{regExp:"[^\x3c\x3e]+"}},f);f.editorParams.invalidMessage=D.invalidTitle;this.startEditing===g.id&&(f.edit(),this.startEditing=null);p(f,"change",function(a,b){a.title.text=b;this.webScene.presentation=this.webScene.presentation.toJSON();this.editor.setWebSceneChanged()}.bind(this,g));var l=e.create("div",
{"class":"iconButtonContainer2",title:D.slideDeckEditable.updateSlide},d);e.create("div",{"class":"updateSlide"},l);p(l,"click",function(a,b){b.stopPropagation();this._updateSlide(a)}.bind(this,a));if(!navigator||!navigator.userAgent||!navigator.userAgent.match("((?:E|e)dge)/([0-9]+.?[0-9]*)$"))l=e.create("div",{"class":"iconButtonContainer",title:D.slideDeckEditable.deleteSlide},d),e.create("div",{"class":"deleteSlide"},l),p(l,"click",function(a,b){b.stopPropagation();this._deleteSlide(a)}.bind(this,
a));d=e.create("div",{"class":"editSlide"},d);(new c({entries:[{id:"update",title:D.slideDeckEditable.updateSlide,func:function(a){this._updateSlide(a)}.bind(this,a)},{id:"moveUp",title:D.moveUp,func:function(a,b){0<a&&(this.webScene.presentation.moveSlide(b,a-1),this.webScene.presentation=this.webScene.presentation.toJSON(),this.editor.setWebSceneChanged())}.bind(this,a,g.id),className:0===a?"disabled":""},{id:"moveDown",title:D.moveDown,func:function(a,b){a<this.slideNodes.length-1&&(this.webScene.presentation.moveSlide(b,
a+1),this.webScene.presentation=this.webScene.presentation.toJSON(),this.editor.setWebSceneChanged())}.bind(this,a,g.id),className:a===this.slideNodes.length-1?"disabled":""},{id:"rename",title:D.rename,func:function(a,b){a.edit()}.bind(this,f)},{id:"delete",title:D.layerItemEditable.deleteLayer,func:function(a){this._deleteSlide(a)}.bind(this,a)}]})).placeAt(d);this.slideEdited&&a===this.editedSlideIndex&&z(b)}this.slideEdited=!1},_deleteSlide:function(a){this.webScene.presentation.removeSlide(a);
this.webScene.presentation=this.webScene.presentation.toJSON();this.editor.setWebSceneChanged()},_updateSlide:function(a){this._newSlideFromCamera().then(function(a,b){this._slideEdited(a);this.webScene.presentation.updateSlideDetails(a,b,this.webScene);this.webScene.presentation=this.webScene.presentation.toJSON();this.editor.setWebSceneChanged()}.bind(this,a))},_update:function(){this.inherited(arguments);this._createSlideEditables()},_ui:function(){this.innerContainer&&this._dragManager.unregister(this.innerContainer);
this.inherited(arguments);this._dragManager.registerByNode(this.innerContainer)},_slideEdited:function(a){this.editedSlideIndex=a;this.slideEdited=!0}})})},"webSceneViewer/widgets/Dialog/SaveDialog":function(){define("esri/core/declare dojo/dom-class dojo/on dojo/Deferred dojo/keys dojo/string dijit/Dialog dijit/_WidgetsInTemplateMixin dojo/text!./templates/SaveDialog.html dojo/i18n!../../editor/nls/editor esri/views/3d/support/canvas3dUtils esri/widgets/Tags dijit/form/Form dijit/form/TextBox dijit/form/ValidationTextBox dijit/form/Button dijit/form/CheckBox dijit/form/Textarea".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y){return k([s,h],{templateString:a,view:void 0,thumbnailFileObject:void 0,portal:void 0,saveInMyContent:void 0,oldSaveInMyContent:void 0,_setPortalAttr:function(a){this._set("portal",a);a&&a.getPortalUser().getTags().then(function(a){this._tagsWidget.set("knownTags",a)}.bind(this),function(a){console.error(a)})},constructor:function(){this._titleDuplicated=!1},destroy:function(){this.buttonThumbnailUpdate.destroy();this.titleTextBox.destroy();this.descriptionTextBox.destroy();
this.saveAsCheckBox.destroy();this.saveInitialStateCheckBox.destroy();this._tagsWidget.destroy();this.inherited(arguments)},show:function(a,b){this._saving=!1;this.myUserName=a.myUserName;this.websceneOwner=a.webScene.portalItemProperties.owner?a.webScene.portalItemProperties.owner:a.myUserName;this.webScene=a.webScene;var c=a.myUserName===this.websceneOwner,d=c||(a.webScene.portalItemProperties?this._canEditScene(a.webScene.portalItemProperties.itemControl):!0),g=this.portal?this.portal.userHasEditingPrivileges():
!0;c||!d?this.saveInMyContent=!0:!c&&(d&&!g)&&(this.saveInMyContent=!1);this.view=b;this._websceneTitle=d?a.webScene.portalItemProperties.title:n.substitute(f.sceneProperties.copyTitle,{scenetitle:a.webScene.portalItemProperties.title,sceneauthor:a.webScene.portalItemProperties.owner});if(a.webScene.portalItemProperties&&a.webScene.portalItemProperties._thumbnailFileObject)this.thumbnailFileObject=a.webScene.portalItemProperties._thumbnailFileObject,this.thumbnailBox.src=this.thumbnailFileObject.dataURI;
else if(a.webScene.portalItemProperties.thumbnailUrl){var e=a.webScene.portalItemProperties.thumbnailUrl;try{if("public"!==a.webScene.portalItemProperties.access&&-1===e.indexOf("token\x3d")&&this.portal&&this.portal.isSignedIn()){var l=this.portal.getPortalUser().credential.token;a.webScene.portalItemProperties.thumbnailUrl+="?token\x3d"+l}}catch(q){}this.thumbnailBox.src=a.webScene.portalItemProperties.thumbnailUrl;this.thumbnailFileObject=void 0}else this._requestThumbnail(b).then(function(a){this.thumbnailFileObject=
a;this.thumbnailBox.src=a.dataURI}.bind(this));void 0===this.saveInMyContent?(r.remove(this.locationToggleContainer,"bold"),r.remove(this.hintLocation,"hide"),r.remove(this.otherLocationButton,"selected"),r.remove(this.myLocationButton,"selected")):this.saveInMyContent?(r.remove(this.otherLocationButton,"selected"),r.add(this.myLocationButton,"selected"),this.hintLocation.textContent=f.saveDialog.copyScene):(r.add(this.otherLocationButton,"selected"),r.remove(this.myLocationButton,"selected"),this.hintLocation.textContent=
f.saveDialog.overwriteScene);this.myLocationButton.textContent=f.saveDialog.myContent;!c&&d?(g||r.add(this.locationToggleContainer,"singleSelectShared"),this.otherLocationButton.textContent=a.webScene.portalItemProperties?n.substitute(f.saveDialog.otherContent,{sceneowner:a.webScene.portalItemProperties.owner}):""):r.add(this.locationToggleContainer,"singleSelect");this.ownerNode.innerHTML=c?f.saveDialog.ownerMe:n.substitute(f.saveDialog.owner,{ownerName:this.websceneOwner});this.titleTextBox.set("value",
this._websceneTitle);this.descriptionTextBox.set("value",a.webScene.portalItemProperties.snippet);this._tagsWidget.set("value",a.webScene.portalItemProperties.tags);this.saveAsCheckBox.set("checked",a.isNewWebScene||this.saveInMyContent&&!c&&d);this.saveAsCheckBox.set("disabled",a.isNewWebScene||!c&&d);this.saveInitialStateCheckBox.set("checked",!0);this.saveInitialStateCheckBox.set("disabled",a.isNewWebScene);this.checkDuplicateTitle();this.inherited(arguments);this._adjustLocationToggleWidth();
this._smoothBlendInOut(!0)},postCreate:function(){this.set("title",f.buttons.saveScene);this.inherited(arguments);this.labelThumbnail.textContent=f.sceneProperties.thumbnail;this.labelTitle.textContent=f.sceneProperties.title;this.labelDescription.textContent=f.sceneProperties.summary;this.labelTags.textContent=f.sceneProperties.tags;this.labelLocation.textContent=f.saveDialog.location;this.hintLocation.textContent=f.saveDialog.choseLocation;this.own(e(this.myLocationButton,"click",function(){this._saveLocationToggleClicked(!0)}.bind(this)));
this.own(e(this.otherLocationButton,"click",function(){this._saveLocationToggleClicked(!1)}.bind(this)));this.labelSaveInitialState.textContent=f.saveDialog.saveInitialState;this.labelSaveAs.textContent=f.saveDialog.saveAs;this.titleTextBox.set("placeholder",f.sceneProperties.placeholderEnterTitle);this.titleTextBox.invalidMessage=f.saveDialog.invalidTitle;this.titleTextBox.validator=function(a){return this._validateTitle(a)}.bind(this);this.descriptionTextBox.set("placeholder",f.sceneProperties.placeholderEnterSummary);
this.descriptionTextBox.invalidMessage=f.saveDialog.invalidSummary;this.descriptionTextBox.validator=function(a){return this._validateTitle(a)}.bind(this);this._tagsWidget=new q({minWidth:"403px",maxWidth:"403px",required:!0});this._tagsWidget.placeAt(this.tagsWidgetDiv);this._tagsWidget.startup();this.labelTags.setAttribute("for",this._tagsWidget._inputTextBox.id);this.buttonSave.set("innerHTML",f.buttons.save);this.buttonCancel.set("innerHTML",f.buttons.cancel);this.titleTextBox.on("change",this.checkDuplicateTitle.bind(this));
var a;this.titleTextBox.on("keypress",function(b){b.charOrCode===m.TAB||(b.charOrCode===m.ENTER||b.charOrCode===m.ESCAPE||b.charOrCode===m.SHIFT||b.charOrCode===m.CTRL||b.charOrCode===m.META||b.charOrdCode===m.ALT)||(void 0!==a&&clearTimeout(a),this.buttonSave.set("disabled",!0),a=setTimeout(this.checkDuplicateTitle.bind(this),1E3))}.bind(this));this.saveAsCheckBox.on("change",this.checkDuplicateTitle.bind(this))},checkDuplicateTitle:function(){var a=this.titleTextBox.get("value"),b=this.saveAsCheckBox.get("checked");
this.portal?null==a||0===a.length?(this._titleDuplicated=!1,this._lastValidatedTitle=a):this._lastValidatedTitle===a?this.buttonSave.set("disabled",!1):(a=a.trim(),this._lastValidatedTitle=null,!b&&this._websceneTitle===a?this._titleDuplicated=!1:(this.buttonSave.set("disabled",!0),b=JSON.stringify(a),b="owner:"+this.portal.getPortalUser().username+" title:"+b+' type:"Web Scene"',this.portal.queryItems({q:b}).then(function(b){this.buttonSave.set("disabled",!1);this._lastValidatedTitle=a;if(b&&1<=
b.total){this._titleDuplicated=!1;for(var c=0;c<b.results.length;c++)if(b.results[c]&&b.results[c].title&&b.results[c].title.toLowerCase()===a.toLowerCase()){this._titleDuplicated=!0;break}this._titleDuplicated&&(this.titleTextBox.focus(),this.titleTextBox.displayMessage(f.saveDialog.websceneTitleExists))}else this._titleDuplicated=!1}.bind(this),function(a){this._titleDuplicated=!1;this.buttonSave.set("disabled",!1);console.error(a)}.bind(this)))):(this.buttonSave.set("disabled",!1),this._titleDuplicated=
!1,this._lastValidatedTitle=a)},_saveButtonClickHandler:function(){if(!this._saving){if(!this.titleTextBox.isValid())return this.titleTextBox.focus(),this.titleTextBox.displayMessage(this.titleTextBox.invalidMessage),!1;if(!this._tagsWidget.isValid())return this._tagsWidget.focus(),this._tagsWidget._displayMessage(this._tagsWidget.i18n.required),!1;if(!this.descriptionTextBox.isValid())return this.descriptionTextBox.focus(),this.descriptionTextBox.displayMessage(this.descriptionTextBox.invalidMessage),
!1;if(this._titleDuplicated)return this.titleTextBox.focus(),this.titleTextBox.displayMessage(f.saveDialog.websceneTitleExists),!1;if(void 0===this.saveInMyContent)return r.add(this.locationToggleContainer,"bold"),!1;this._saving=!0;this.emit("save",{title:this.titleTextBox.get("value").trim(),snippet:this.descriptionTextBox.get("value"),tags:this._tagsWidget.get("value"),saveAsNewWebScene:this.saveAsCheckBox.get("checked"),saveInitialState:this.saveInitialStateCheckBox.get("checked"),thumbnailFileObject:this.thumbnailFileObject,
owner:this.saveInMyContent?this.myUserName:this.websceneOwner});this.oldSaveInMyContent=this.saveInMyContent;this._smoothBlendInOut(!1)}},_thumbnailUpdateClickHandler:function(){this._requestThumbnail(this.view).then(function(a){this.thumbnailFileObject=a;this.thumbnailBox.src=a.dataURI}.bind(this))},onCancel:function(){this.inherited(arguments);this.emit("cancel-save");this.saveInMyContent=this.oldSaveInMyContent;this._smoothBlendInOut(!1)},_requestThumbnail:function(a){var b=new p;a.takeScreenshot({format:"jpeg",
quality:80,width:200,height:133}).then(function(a){b.resolve({data:d.dataURItoBlob(a.dataURL),identifier:"thumbnail",name:"thumbnail",dataURI:a.dataURL})},b.reject);return b},_validateTitle:function(a){return-1!==a.indexOf("\x3e")||-1!==a.indexOf("\x3c")?!1:!0},_saveLocationToggleClicked:function(a){this.hintLocation.textContent=a?f.saveDialog.copyScene:f.saveDialog.overwriteScene;this.saveInMyContent=a;this.saveAsCheckBox.set("checked",a);this.saveAsCheckBox.set("disabled",!0);r.remove(this.locationToggleContainer,
"bold");a?(this._websceneTitle=n.substitute(f.sceneProperties.copyTitle,{scenetitle:this.titleTextBox.get("value"),sceneauthor:this.webScene.portalItemProperties.owner}),r.remove(this.otherLocationButton,"selected"),r.add(this.myLocationButton,"selected")):(this._websceneTitle=this.webScene.portalItemProperties.title,r.add(this.otherLocationButton,"selected"),r.remove(this.myLocationButton,"selected"));this.titleTextBox.set("value",this._websceneTitle)},_adjustLocationToggleWidth:function(){this.otherLocationButton.clientWidth>
this.myLocationButton.clientWidth?this.myLocationButton.style.width=this.otherLocationButton.clientWidth-14+"px":this.otherLocationButton.style.width=this.myLocationButton.clientWidth-14+"px"},_canEditScene:function(a){return"update"===a||"admin"===a},_smoothBlendInOut:function(a){var b=document.getElementsByClassName("dijitDialogUnderlay _underlay");0!==b.length&&(b=b[0],a?r.add(b,"on"):r.remove(b,"on"))}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/aspect dojo/on dojo/when put-selector/put".split(" "),
function(k,r,e,p,m,n,s){function h(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;m.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return k(null,{collection:null,_renderedCollection:null,_rows:null,_observerHandle:null,shouldTrackCollection:!0,getBeforePut:!0,noDataMessage:"",loadingMessage:"",_total:0,constructor:function(){this.dirty={};this._updating={};this._columnsWithSet={};p.before(this,"configStructure",r.hitch(this,
function(){this._columnsWithSet={}}))},destroy:function(){this.inherited(arguments);this._renderedCollection&&this._cleanupCollection()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_setCollection:function(a){this._renderedCollection&&(this.cleanup(),this._cleanupCollection({shouldRevert:!a||a.storage!==this._renderedCollection.storage}));if(a){var f=a;this.sort&&0<this.sort.length&&(f=a.sort(this.sort));f.track&&this.shouldTrackCollection&&(f=f.track(),
this._rows=[],this._observerHandle=this._observeCollection(f,this.contentNode,{rows:this._rows}));this._renderedCollection=f}this.collection=a;this.refresh()},_setStore:function(){this.collection||console.debug("set('store') call detected, but you probably meant set('collection') for 0.4")},_getTotal:function(){return this._total},_cleanupCollection:function(a){a=a||{};this._renderedCollection.tracking&&this._renderedCollection.tracking.remove();this._observerHandle&&(this._observerHandle.remove(),
this._observerHandle=this._rows=null);!1!==a.shouldRevert&&(this.dirty={});this._renderedCollection=this.collection=null},_applySort:function(){this.collection?this.set("collection",this.collection):this.store&&console.debug("_StoreMixin found store property but not collection; this is often the sign of a mistake during migration from 0.3 to 0.4")},row:function(){var a=this.inherited(arguments);a&&(a.data&&"undefined"!==typeof a.id)&&(a.id=this.collection.getIdentity(a.data));return a},refresh:function(){var a=
this.inherited(arguments);this.collection||(this.noDataNode=s(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return a},renderArray:function(){var a=this.inherited(arguments);this.collection||a.length&&this.noDataNode&&s(this.noDataNode,"!");return a},insertRow:function(a,f,d,e,l){var c=this.collection,b=this.dirty,c=c&&c.getIdentity(a),h;c in b&&!(c in this._updating)&&(h=b[c]);h&&(a=r.delegate(a,h));b=this.inherited(arguments);l&&l.rows&&(l.rows[e]=b);this.noDataNode&&
(s(this.noDataNode,"!"),this.noDataNode=null);return b},updateDirty:function(a,f,d){var e=this.dirty,l=e[a];l||(l=e[a]={});l[f]=d},save:function(){function a(a,b){return function(c){var g=f._columnsWithSet,e=f._updating,l,h;if("function"===typeof c.set)c.set(b);else for(l in b)c[l]=b[l];for(l in g)h=g[l].set(c),void 0!==h&&(c[l]=h);e[a]=!0;return n(d.put(c),function(){delete q[a];delete e[a]})}}var f=this,d=this.collection,q=this.dirty,l=new e,c=l.promise,b=function(a){var b;return f.getBeforePut||
!(b=f.row(a).data)?function(){return d.get(a)}:function(){return b}},h;for(h in q)var g=a(h,q[h]),c=c.then(b(h)).then(g);l.resolve();return c},revert:function(){this.dirty={};this.refresh()},_trackError:function(a){"string"===typeof a&&(a=r.hitch(this,a));var f=this,d;try{d=n(a())}catch(q){a=new e,a.reject(q),d=a.promise}d.otherwise(function(a){h.call(f,a)});return d},removeRow:function(a,f,d){var e={element:a};!f&&(this.noDataMessage&&this.up(e).element===a&&this.down(e).element===a)&&(this.noDataNode=
s(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);(e=d&&d.rows||this._rows)&&delete e[a.rowIndex];return this.inherited(arguments)},renderQueryResults:function(a,f,d){d=r.mixin({rows:this._rows},d);var e=this;return n(a).then(function(a){a=e.renderArray(a,f,d);delete e._lastCollection;return a})},_observeCollection:function(a,f,d){var e=this,l=d.rows,c,b=[a.on("delete, update",function(a){var b=a.previousIndex,h=a.index;void 0!==b&&l[b]&&("max"in l&&(void 0===h||
h<l.min||h>l.max)&&l.max--,c=l[b],c.parentNode===f&&e.removeRow(c,!1,d),l.splice(b,1),("delete"===a.type||"update"===a.type&&(b<h||void 0===h))&&l[b]&&l[b].rowIndex--,e._processScroll&&e._processScroll());"delete"===a.type&&(c=null)}),a.on("add, update",function(a){var b=a.previousIndex,h=a.index;if(void 0!==h&&(!("max"in l)||h>=l.min&&h<=l.max)){"max"in l&&(void 0===b||b<l.min||b>l.max)&&l.max++;if(l.length){if(b=l[h],!b&&(b=l[h-1]))b=(b.connected||b).nextSibling}else b=e._getFirstRowSibling&&e._getFirstRowSibling(f);
c&&(b&&c.id===b.id)&&(b=(b.connected||b).nextSibling);b&&!b.parentNode&&(b=document.getElementById(b.id));l.splice(h,0,void 0);c=e.insertRow(a.target,f,b,h,d);e.highlightRow(c)}c=null}),a.on("add, delete, update",function(b){var c="undefined"!==typeof b.previousIndex?b.previousIndex:Infinity,d="undefined"!==typeof b.index?b.index:Infinity,f=Math.min(c,d);c!==d&&l[f]&&e.adjustRowIndices(l[f]);e._onNotification(l,b,a);a===e._renderedCollection&&"totalLength"in b&&(e._total=b.totalLength)})];return{remove:function(){for(;0<
b.length;)b.pop().remove()}}},_onNotification:function(){}})})},"webSceneViewer/widgets/SlideDeck/SlideDeck":function(){define("esri/core/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/dom dojo/query webSceneViewer/assertUtils webSceneViewer/webScene/Presentation webSceneViewer/widgets/ScrollBar/ScrollBar".split(" "),function(k,r,e,p,m,n,s,h,a,f){var d=h.assert;return k(null,{name:"SlideDeck",baseClass:"SlideDeck",constructor:function(a,f){d(a.view);d(a.webScene);this.view=
a.view;this.webScene=a.webScene;this.cls=a["class"];this.mainContainerNode=f;e.add(f,"slideDeck");this.slideNodes=[];this._init()},_init:function(){this.webScene.presentation&&this.webScene.presentation.slides&&this._ui();this.webScene.watch("presentation",function(){this._update()}.bind(this))},_ui:function(){this.innerContainer&&p.destroy(this.outerContainer);var d=this.webScene.presentation.slides.get("length");if(0!==d){this.outerContainer=p.create("div",{"class":"Slidebar"});this.innerContainer=
p.create("ul",{"class":"slideDeckInner"});p.place(this.outerContainer,this.mainContainerNode,"first");p.place(this.innerContainer,this.outerContainer,"first");this.cls&&e.add(this.innerContainer,this.cls);for(var l=0;l<d;l++){var c=this.webScene.presentation.slides.getItemAt(l),b=p.create("li",{"class":"slide",nr:l,bmid:c.id},this.innerContainer);this.slideNodes.push(b);b=p.create("div",{"class":"slideButton",id:this.mainContainerNode.id+"slideButton"+c.id},b);p.create("p",{"class":"smallTitle",innerHTML:c.title.text,
title:c.title.text},b);p.create("div",{"class":"homeIcon"},b);p.create("img",{src:c.thumbnail.url},b);m(b,"click",r.partial(function(b){a.applySlideToView(b,this.view);this._highlightBookmark(this.mainContainerNode.id+"slideButton"+b.id)}.bind(this),c))}"SlideDeck"===this.name&&(this.horizontalScrollbar=new f({scrollTarget:this.innerContainer,view:this.view}),this.horizontalScrollbar.startup(),this.horizontalScrollbar.placeAt(this.outerContainer),this.horizontalScrollbar.updateWidth(),this.horizontalScrollbar.enableScrollTargetDrag())}},
_update:function(){this.slideNodes=[];this._ui()},_clearHighlight:function(){s(".slideButton.highlight").forEach(function(a,d,c){a.className="slideButton"})},_highlightBookmark:function(a){this._clearHighlight();(a=n.byId(a))&&e.add(a,"highlight")}})})},"webSceneViewer/widgets/LayerWidget/LayerItem":function(){define("esri/core/declare dojo/dom-construct dojo/dom-class dojo/dom-style dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerItem.html dijit/form/RadioButton dijit/form/CheckBox esri/layers/GroupLayer dojo/i18n!../nls/widgets".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q){var l=k([n,s],{name:"LayerItem",templateString:h,view:void 0,layer:void 0,_setLayerAttr:function(a){this._set("layer",a);a&&a instanceof d&&(this.isGroupLayer=!0,this.domNode&&e.add(this.domNode,"GroupLayerItem"))},parentGroup:void 0,parentLayerItem:void 0,layerTitle:void 0,_setLayerTitleAttr:function(a){this._set("layerTitle",a);this.titleNode&&(this.titleNode.textContent=a,this.titleNode.title=a)},layerVisible:void 0,_setLayerVisibleAttr:function(a){this._set("layerVisible",
a);this._layerVisDijitButton&&this._layerVisDijitButton.get("checked")!==a&&this._layerVisDijitButton.set("checked",a)},layerWidget:void 0,isGroupLayer:!1,_watchHandles:void 0,_onHandles:void 0,_layerItems:void 0,_previousProgressPercentage:-1,_previousProgressVisible:null,constructor:function(a,b){this._watchHandles=[];this._onHandles=[];this._layerItems=[]},postMixInProperties:function(){},postCreate:function(){this.set("layerTitle",this.layer.title||this.layer.id);var c=this.layer.watch("title",
function(a){this.set("layerTitle",this.layer.title)}.bind(this));this._watchHandles.push(c);this.set("layerVisible",this.layer.visible);c=this.layer.watch("visible",function(a){this.set("layerVisible",a)}.bind(this));this._watchHandles.push(c);(void 0===this.parentGroup||"hide"===this.layer.listMode)&&e.add(this.domNode,this.layer.listMode);this._layerVisDijitButton=this.parentGroup&&"exclusive"===this.parentGroup.visibilityMode?new a({name:this.parentGroup.id+"_radiogroup_"+this.id,checked:this.layerVisible},
this.layerVisInputCheckbox):new f({checked:this.layerVisible},this.layerVisInputCheckbox);c=m(this._layerVisDijitButton,"change",this._layerVisInputCheckboxChange.bind(this));this._onHandles.push(c);c=this.layer.watch("visibilityMode",function(a){this.layerWidget.reload()}.bind(this));this._watchHandles.push(c);c=this.layer.watch("listMode",function(a){this.layerWidget.reload()}.bind(this));this._watchHandles.push(c);c=this.view.getLayerView(this.layer);if(null==c)m.once(this.layer,"layer-view-create",
function(a){a.layerView.then(function(c){this.connectUpdating(c.layerView||a.layerView)}.bind(this))}.bind(this));else this.connectUpdating(c);this._init()},_addLayerItem:function(a,b){var d=new l({view:this.view,layer:a,layerWidget:this.layerWidget,parentGroup:this.layer,parentLayerItem:this});d.placeAt(this.layersDomNode,b);this._layerItems.push(d)},_removeLayerItem:function(a){for(var b=this._layerItems.length-1;0<=b;b--)if(this._layerItems[b].layer===a){this._layerItems.splice(b,1);this._layerItems[b].destroy();
break}},_init:function(){this.isGroupLayer&&"hide-children"!==this.layer.listMode&&this._initGroupLayerItems();var a=function(){e.remove(this.statDomNode,"layerAdd");this.layer.fullExtent&&e.remove(this.layerFrameButton,"inactive")}.bind(this);if(this.layer.loaded||this.layer instanceof d)a();else m.once(this.layer,"load",function(b){a()});this.layerFrameButton.title=q.layerItemEditable.zoomToLayer},_initGroupLayerItems:function(){if(this.isGroupLayer){this.layersDomNode=r.create("div",{className:"layers"},
this.domNode);r.create("div",{className:"layersLine"},this.layersDomNode);var a=m(this.layer,"layer-add",function(a){this.layerWidget.reload()}.bind(this)),b=m(this.layer,"layer-remove",function(a){this.layerWidget.reload()}.bind(this)),d=m(this.layer,"layer-reorder",function(a){this.layerWidget.reload()}.bind(this));this._onHandles.push(a);this._onHandles.push(b);this._onHandles.push(d);for(a=this.layer.layers.get("length")-1;0<=a;a--)b=this.layer.layers.getItemAt(a),this._addLayerItem(b);0===this.layer.layers.get("length")&&
(e.add(this.layersDomNode,"emptyPlaceholder"),this.layersDomNode.textContent=q.layerItemEditable.dragHere)}},destroy:function(){this._watchHandles.forEach(function(a){a.remove()});this._onHandles.forEach(function(a){a.remove()});this._layerItems.forEach(function(a){a.destroy()});this._watchHandles.length=0;this._onHandles.length=0;this._layerItems.length=0;this._layerVisDijitButton.destroy();r.empty(this.domNode);r.destroy(this.domNode)},connectUpdating:function(a){if(null!=this.statDomNode){var b=
function(){var b=a.get("updating"),d=a.get("updatingPercentage");null==d&&(d=100);b=b&&!a.suspended&&0<d;d===this._previousProgressPercentage&&b===this._previousProgressVisible||(b?(p.set(this.statDomNodeProgressbarUpper,"visibility","visible"),p.set(this.statDomNodeProgressbarLower,"visibility","visible"),p.set(this.statDomNodeProgressbarUpper,"height",100-d+"%"),p.set(this.statDomNodeProgressbarLower,"height",d+"%")):(p.set(this.statDomNodeProgressbarUpper,"visibility","hidden"),p.set(this.statDomNodeProgressbarLower,
"visibility","hidden")),this._previousProgressVisible=b,this._previousProgressPercentage=d)}.bind(this),d=m(a,"suspend",function(){p.set(this.statDomNodeProgressbarUpper,"visibility","hidden");p.set(this.statDomNodeProgressbarLower,"visibility","hidden")}.bind(this));this._onHandles.push(d);this._onHandles.push(m(a,"resume",b));b=a.watch(["updating","updatingPercentage"],b);this._watchHandles.push(b)}},_layerVisInputCheckboxChange:function(a){this.layer.get("visible")!==a&&this.layer.set("visible",
a)},_layerFrameButtonClick:function(){this.layer.fullExtent&&this.view.animateTo(this.layer.fullExtent)}});return l})},"webSceneViewer/widgets/LayerWidget/LayerWidget":function(){define(["esri/core/declare","dojo/dom-class","dojo/on","dijit/_WidgetBase","./LayerItem"],function(k,r,e,p,m){return k([p],{view:void 0,_layerItems:void 0,_onHandles:void 0,map:void 0,constructor:function(e,m){this._layerItems=[];this._onHandles=[]},destroy:function(){this._onHandles.forEach(function(e){e.remove()});this._onHandles.length=
0;this._destroyAllLayerItems()},postMixInProperties:function(){this.map=this.view.map},postCreate:function(){this._init();this.startup()},_init:function(){r.add(this.domNode,"LayerWidget");this._setupAllLayerItems();var m=e(this.map,"layer-add",function(a){this.reload()}.bind(this)),k=e(this.map,"layer-remove",function(a){this.reload()}.bind(this)),h=e(this.map,"layer-reorder",function(a){this.reload()}.bind(this));this._onHandles.push(m);this._onHandles.push(k);this._onHandles.push(h)},reload:function(){this._destroyAllLayerItems();
this._setupAllLayerItems()},_destroyAllLayerItems:function(){for(var e=0;e<this._layerItems.length;e++)this._layerItems[e].destroy();this._layerItems.length=0},_setupAllLayerItems:function(){for(var e=this.map.layers.get("length")-1;0<=e;e--){var m=this.map.layers.getItemAt(e);"SilentContentLayer"===m.id||"__basemapErrorFallbackLayer__"===m.id||this._addLayerItem(m)}},_addLayerItem:function(e){var m=this._createLayerItem(e);m.placeAt(this.domNode,this.map.layers.get("length")-this.map.layers.indexOf(e)-
1);this._layerItems.push(m)},_removeLayerItem:function(e){for(var m=0;m<this._layerItems.length;m++)this._layerItems[m].layer===e&&(this._layerItems[m].destroy(),this._layerItems.splice(m,1))},_createLayerItem:function(e){return new m({view:this.view,layer:e,layerWidget:this})}})})},"dijit/_PaletteMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on ./_CssStateMixin ./a11yclick ./focus ./typematic".split(" "),function(k,r,e,
p,m,n,s,h,a,f,d){return k("dijit._PaletteMixin",h,{defaultTimeout:500,timeoutChangeRate:0.9,value:"",_selectedCell:-1,tabIndex:"0",cellClass:"dijitPaletteCell",dyeClass:null,_dyeFactory:function(a){return new ("string"==typeof this.dyeClass?n.getObject(this.dyeClass):this.dyeClass)(a)},_preparePalette:function(f,e){this._cells=[];var c=this._blankGif;this.own(s(this.gridNode,a,n.hitch(this,"_onCellClick")));for(var b=0;b<f.length;b++)for(var h=p.create("tr",{tabIndex:"-1",role:"row"},this.gridNode),
g=0;g<f[b].length;g++){var k=f[b][g];if(k){var r=this._dyeFactory(k,b,g,e[k]),k=p.create("td",{"class":this.cellClass,tabIndex:"-1",title:e[k],role:"gridcell"},h);r.fillCell(k,c);k.idx=this._cells.length;this._cells.push({node:k,dye:r})}}this._xDim=f[0].length;this._yDim=f.length;var F={UP_ARROW:-this._xDim,DOWN_ARROW:this._xDim,RIGHT_ARROW:this.isLeftToRight()?1:-1,LEFT_ARROW:this.isLeftToRight()?-1:1},v;for(v in F)this.own(d.addKeyListener(this.domNode,{keyCode:m[v],ctrlKey:!1,altKey:!1,shiftKey:!1},
this,function(){var a=F[v];return function(b){this._navigateByKey(a,b)}}(),this.timeoutChangeRate,this.defaultTimeout))},postCreate:function(){this.inherited(arguments);this._setCurrent(this._cells[0].node)},focus:function(){f.focus(this._currentFocus)},_onCellClick:function(a){for(var d=a.target;"TD"!=d.tagName;){if(!d.parentNode||d==this.gridNode)return;d=d.parentNode}var c=this._getDye(d).getValue();this._setCurrent(d);f.focus(d);this._setValueAttr(c,!0);a.stopPropagation();a.preventDefault()},
_setCurrent:function(a){"_currentFocus"in this&&r.set(this._currentFocus,"tabIndex","-1");(this._currentFocus=a)&&r.set(a,"tabIndex",this.tabIndex)},_setValueAttr:function(a,d){0<=this._selectedCell&&e.remove(this._cells[this._selectedCell].node,this.cellClass+"Selected");this._selectedCell=-1;if(a)for(var c=0;c<this._cells.length;c++)if(a==this._cells[c].dye.getValue()){this._selectedCell=c;e.add(this._cells[c].node,this.cellClass+"Selected");break}this._set("value",0<=this._selectedCell?a:null);
if(d||void 0===d)this.onChange(a)},onChange:function(){},_navigateByKey:function(a,d){if(-1!=d){var c=this._currentFocus.idx+a;c<this._cells.length&&-1<c&&(c=this._cells[c].node,this._setCurrent(c),this.defer(n.hitch(f,"focus",c)))}},_getDye:function(a){return this._cells[a.idx].dye}})})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(k,r,e,p,m){function n(a){for(;a.childNodes[0]&&1==a.childNodes[0].nodeType;)a=
a.childNodes[0];return a}function s(a,f){"string"==typeof a?(a=p.toDom(a,f&&f.ownerDocument),11==a.nodeType&&(a=a.childNodes[0])):1==a.nodeType&&a.parentNode&&(a=a.cloneNode(!1));return a}var h=k.NodeList;r.extend(h,{_placeMultiple:function(a,f){for(var d="string"==typeof a||a.nodeType?k(a):a,e=[],l=0;l<d.length;l++)for(var c=d[l],b=this.length,h=b-1,g;g=this[h];h--)0<l&&(g=this._cloneNode(g),e.unshift(g)),h==b-1?p.place(g,c,f):c.parentNode.insertBefore(g,c),c=g;e.length&&(e.unshift(0),e.unshift(this.length-
1),Array.prototype.splice.apply(this,e));return this},innerHTML:function(a){return arguments.length?this.addContent(a,"only"):this[0].innerHTML},text:function(a){if(arguments.length){for(var e=0,d;d=this[e];e++)1==d.nodeType&&m.set(d,"textContent",a);return this}for(var h="",e=0;d=this[e];e++)h+=m.get(d,"textContent");return h},val:function(a){if(arguments.length){for(var f=r.isArray(a),d=0,h;h=this[d];d++){var l=h.nodeName.toUpperCase(),c=h.type,b=f?a[d]:a;if("SELECT"==l){l=h.options;for(c=0;c<l.length;c++){var m=
l[c];m.selected=h.multiple?-1!=e.indexOf(a,m.value):m.value==b}}else"checkbox"==c||"radio"==c?h.checked=h.value==b:h.value=b}return this}if((h=this[0])&&1==h.nodeType){a=h.value||"";if("SELECT"==h.nodeName.toUpperCase()&&h.multiple){a=[];l=h.options;for(c=0;c<l.length;c++)m=l[c],m.selected&&a.push(m.value);a.length||(a=null)}return a}},append:function(a){return this.addContent(a,"last")},appendTo:function(a){return this._placeMultiple(a,"last")},prepend:function(a){return this.addContent(a,"first")},
prependTo:function(a){return this._placeMultiple(a,"first")},after:function(a){return this.addContent(a,"after")},insertAfter:function(a){return this._placeMultiple(a,"after")},before:function(a){return this.addContent(a,"before")},insertBefore:function(a){return this._placeMultiple(a,"before")},remove:h.prototype.orphan,wrap:function(a){if(this[0]){a=s(a,this[0]);for(var e=0,d;d=this[e];e++){var h=this._cloneNode(a);d.parentNode&&d.parentNode.replaceChild(h,d);n(h).appendChild(d)}}return this},wrapAll:function(a){if(this[0]){a=
s(a,this[0]);this[0].parentNode.replaceChild(a,this[0]);a=n(a);for(var e=0,d;d=this[e];e++)a.appendChild(d)}return this},wrapInner:function(a){if(this[0]){a=s(a,this[0]);for(var e=0;e<this.length;e++){var d=this._cloneNode(a);this._wrap(r._toArray(this[e].childNodes),null,this._NodeListCtor).wrapAll(d)}}return this},replaceWith:function(a){a=this._normalize(a,this[0]);for(var e=0,d;d=this[e];e++)this._place(a,d,"before",0<e),d.parentNode.removeChild(d);return this},replaceAll:function(a){a=k(a);for(var e=
this._normalize(this,this[0]),d=0,h;h=a[d];d++)this._place(e,h,"before",0<d),h.parentNode.removeChild(h);return this},clone:function(){for(var a=[],e=0;e<this.length;e++)a.push(this._cloneNode(this[e]));return this._wrap(a,this,this._NodeListCtor)}});h.prototype.html||(h.prototype.html=h.prototype.innerHTML);return h})},"esri/layers/support/LayerDrawingOptions":function(){define("../../core/declare dojo/_base/lang dojo/_base/array ../../core/lang ../../renderers/support/jsonUtils ./LabelClass".split(" "),
function(k,r,e,p,m,n){return k(null,{declaredClass:"esri.layers.support.LayerDrawingOptions",constructor:function(k){if(k&&(r.mixin(this,k),k.renderer&&(this.renderer=m.fromJSON(k.renderer)),k.labelingInfo&&0<k.labelingInfo.length)){this.labelingInfo=[];var h;e.forEach(k.labelingInfo,function(a){h=new n(a);this.labelingInfo.push(h)},this)}},toJson:function(){try{throw Error("toJson is deprecated, use toJSON instead");}catch(e){console.warn(e.stack)}return this.toJSON()},toJSON:function(){var m={renderer:this.renderer&&
this.renderer.toJSON(),transparency:this.transparency,scaleSymbols:this.scaleSymbols,showLabels:this.showLabels};this.labelingInfo&&0<this.labelingInfo.length&&(m.labelingInfo=[],e.forEach(this.labelingInfo,function(e){m.labelingInfo.push(e.toJSON())}));return p.fixJson(m)}})})},"webSceneViewer/spatialReferenceUtils":function(){define("dojo/Deferred esri/config esri/geometry/SpatialReference esri/geometry/support/scaleUtils esri/tasks/support/ProjectParameters webSceneViewer/widgets/MessageListWidget/MessageListWidget dojo/i18n!webSceneViewer/nls/viewer".split(" "),
function(k,r,e,p,m,n,s){var h={isGeographicCRS:function(a){return 1E5<p.getUnitValueForSR(a)},projectLayerExtentToSceneSR:function(a,e){r.geometryService&&require(["dojo/on"],function(d){d.once(a,"load",function(){var d=a.fullExtent;if(d){var e=window._webSceneViewerView.map.spatialReference;if(!d.spatialReference.equals(e)){var c=r.geometryService,b=new m;b.geometries=[d];b.outSR=e.clone();c.project(b).then(function(b){b&&0<b.length&&a.set("fullExtent",b[0])})}}})})},getLatitudeOfPoint:function(a){var f=
new k,d=a.latitude;if(d)f.resolve(d);else{var d=r.geometryService,h=new m;h.geometries=[a];h.outSR=e.WGS84;d.project(h).then(function(a){a&&0<a.length?f.resolve(a[0].y):f.reject()},function(){f.reject()})}return f.promise},pingGeometryService:function(a){h.getLatitudeOfPoint(a).otherwise(function(a){n.show({message:s.messages.geometryServiceUnavailableTitle,type:n.MessageTypes.ERROR,details:s.messages.geometryServiceUnavailable})})}};return h})},"webSceneViewer/basemapUtils":function(){define("dojo/promise/all dojo/Deferred dojo/_base/lang esri/layers/ArcGISElevationLayer esri/core/watchUtils esri/geometry/SpatialReference webSceneViewer/webScene/WebSceneLayers esri/Basemap esri/core/Collection webSceneViewer/widgets/MessageListWidget/MessageListWidget webSceneViewer/spatialReferenceUtils esri/layers/OpenStreetMapLayer esri/layers/GraphicsLayer esri/views/3d/terrain/TilingScheme esri/geometry/support/webMercatorUtils esri/geometry/support/scaleUtils esri/geometry/Extent ./environmentUtils dojo/i18n!webSceneViewer/nls/viewer".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y,u){function F(a){var b=Error("Invalid basemap");b.errors=a;return b}function v(a){for(var b=[],c=[],d=0;d<a.length;d++){var e=a[d];if(e instanceof q)c.push({layer:e});else if(s.extrapolateTypeFromLayerInstance(e))if(e.url){var g=s.validateServerUrl(e.url);g.hasLayer?b.push({msg:u.messages.addLayerFailed,details:"unsupported url "+e.url}):c.push({layer:e,serviceDetails:g,url:e.url,params:{url:e.url}})}else b.push({msg:u.messages.addLayerFailed,details:"missing url"});
else b.push({msg:u.messages.onlyTiledLayerSupported,details:e.url})}if(0!==b.length)throw F(b);return c}function D(a){function b(){0===c.length?e.resolve(d):e.reject(F(c.filter(function(a){return!!a})))}for(var c=[],d=[],e=new r,g=a.length,f=0;f<a.length;f++){var l=a[f];l.serviceDetails?s.prepareOpLayerFromService(l,1).then(function(a,c){d[a]=c;0===--g&&b()}.bind(this,f),function(a,d){c[a]=d;0===--g&&b()}.bind(this,f)):(d[f]={layerType:s.extrapolateTypeFromLayerInstance(l.layer)},0===--g&&b())}0===
a.length&&b();return e.promise}function A(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];"ArcGISTiledMapServiceLayer"!==d.layerType&&("ArcGISTiledImageServiceLayer"!==d.layerType&&"ArcGISTiledElevationServiceLayer"!==d.layerType&&"OpenStreetMap"!==d.layerType)&&b.push({msg:u.messages.onlyTiledLayerSupported,details:a[c].url})}if(0<b.length)throw F(b);}var z,E={},w={_basemapLayersEqual:function(a,b){return a.length!==b.length?!1:!!a.reduce(function(a,c,d){d=b.getItemAt(d);return a&&d&&d instanceof
c.constructor&&c.url===d.url},!0)},equals:function(a,b){return!b?!1:w._basemapLayersEqual(a.baseLayers,b.baseLayers)&&w._basemapLayersEqual(a.referenceLayers,b.referenceLayers)&&w._basemapLayersEqual(a.elevationLayers,b.elevationLayers)},turnOnElevation:function(a){var b=a.basemap;b.elevationLayers&&0<b.elevationLayers.length||(b?b.elevationLayers=b._elevationLayersCache&&0<b._elevationLayersCache.length?b._elevationLayersCache:[w.DefaultElevationLayer]:a.basemap=new h({elevationLayers:[w.DefaultElevationLayer]}))},
turnOffElevation:function(a){var b=a.basemap;b&&(b._elevationLayersCache=b.get("elevationLayers").getAll(),b.elevationLayers=[],0===b.baseLayers.length&&(a.basemap=null))},_copyBasemapLayers:function(a,b){return b.map(function(b){var c=a.find(function(a){return b instanceof a.constructor&&a.url===b.url});return c?c:b})},fixSSL:function(a,b){function c(a){Array.isArray(a)&&a.forEach(function(a){a.url=s.useSSLIfRequired(a.url,b)})}b||(b=w.portal);c(a.baseMapLayers);c(a.elevationLayers);c(a.referenceLayers)},
fixJSON:function(a,b){var c=e.clone(a);Array.isArray(c.baseMapLayers)&&c.baseMapLayers.forEach(function(a){!a.layerType&&a.type&&(a.layerType=a.type,delete a.type);!a.urlTemplate&&a.templateUrl&&(a.urlTemplate=a.templateUrl)});this.fixSSL(c,b);return c},fromJSON:function(a,b){try{return h.fromJSON(this.fixJSON(a,b))}catch(c){throw Error("");}},fromJSONAndCopySubLayers:function(a,b,c){b=this.fromJSON(b);a&&(b.baseLayers=w._copyBasemapLayers(a.baseLayers,b.baseLayers),b.elevationLayers=c?a.elevationLayers:
w._copyBasemapLayers(a.elevationLayers,b.elevationLayers),b.referenceLayers=w._copyBasemapLayers(a.referenceLayers,b.referenceLayers));return b},_handleBasemapSetError:function(a,c){if(!a.map.isFulfilled()){var d=w.spatialReferenceLocked?a.map.spatialReference:n.WebMercator,e=new l({spatialReference:d,id:"__basemapErrorFallbackLayer__"});if(!b.canProject(e.fullExtent,e.spatialReference)){var h=5E4*t.getUnitValueForSR(e.spatialReference);e.fullExtent=new g({xmin:-h,xmax:h,ymin:-h,ymax:h,spatialReference:e.spatialReference})}a.map.spatialReference=
d;if("planar"===a.globeMode)m.once(a,"fullExtent",function(){a.map.remove(e);setTimeout(function(){a.extent=a.fullExtent},0)});else a.then(function(){a.map.remove(e)});a.map.add(e)}if(c&&c.errors)for(d=0;d<c.errors.length;d++)h=c.errors[d],f.show({message:u.dialogs.unsupportedBasemap,type:f.MessageTypes.ERROR,details:(h.msg||h.message)+(h.details?"\n"+h.details:"")});else c&&f.show({message:u.dialogs.unsupportedBasemap,type:f.MessageTypes.ERROR,details:(c.msg||c.message)+(c.details?"\n"+c.details:
"")})},validateAndSet:function(b,c,e,g){var l=b.map;z&&(z.cancel(E),z=null);if(c&&w.equals(c,l.basemap))e!==b.basemapTransparency&&w.applyTransparency(b,e);else{if(c){var h=new a;h.addItems(c.baseLayers);h.addItems(c.referenceLayers);h.addItems(c.elevationLayers);var q;return q=z=k(h.getAll()).then(v).then(D).then(A).then(function(){if(z===q||void 0===q){z=null;var a=this.getBasemapSR(c),h=!1;if(a&&(!a.equals(b.map.spatialReference)||!this._tilingSchemeEquals(c,b)))if(this._allowBasemapToSwitchSR(g,
b))h=c.baseLayers&&0<c.baseLayers.length&&c.baseLayers.getItemAt(0).fullExtent,this._resetView(b.map,a),d.pingGeometryService(h.center),h=!0;else{f.show({message:u.messages.selectedBasemapMismatchTitle,type:f.MessageTypes.ERROR,details:u.messages.selectedBasemapMismatch});return}0===c.baseLayers.length&&0===c.elevationLayers.length&&(c=null);if(l.basemap=c)this.checkAndSetDefaultElevationAvailability(b,h),(a=w.getFirstLayer(c))&&y.adjustLightForLayer(b,a);m.whenOnce(b,"ready",function(){l.basemap===
c&&w.applyTransparency(b,e)})}}.bind(this),function(a){if(a!==E&&(z===q||void 0===q))z=null,w._handleBasemapSetError(b,a)})}this._handleBasemapSetError(b,null)}},checkAndSetDefaultElevationAvailability:function(a,b){var c=a.map;try{w._checkDefaultElevationCompatibility(a),b&&w.turnOnElevation(c)}catch(d){w.turnOffElevation(c)}},_checkDefaultElevationCompatibility:function(a){var b=a.map.basemap,c=a.spatialReference,d;b?d=(b=b.elevationLayers&&0<b.elevationLayers.length?b.elevationLayers.getItemAt(0):
b._elevationLayersCache&&0<b._elevationLayersCache.length?b._elevationLayersCache[0]:w.DefaultElevationLayer)?b.spatialReference:null:(b=w.DefaultElevationLayer,d=w.DefaultElevationLayer.spatialReference);if(d&&c&&!d.equals(c))throw{msg:u.messages.elevationBasemapTitle,details:u.messages.elevationBasemapSR};a=a.basemapTerrain?a.basemapTerrain.tilingScheme:null;c=b?b.tileInfo:null;if(a&&c&&!a.compatibleWith(c))throw{msg:u.messages.elevationBasemapTitle,details:u.messages.elevationBasemapTS};},getBasemapTS:function(a){return(a=
a.baseLayers&&a.baseLayers.length?a.baseLayers.getItemAt(0):null)?new c(a.tileInfo):null},_allowBasemapToSwitchSR:function(a,b){var c=!b.map.layers.some(function(a){return"__basemapErrorFallbackLayer__"!==a.id&&"SilentContentLayer"!==a.id});return!a&&!w.spatialReferenceLocked&&c},_tilingSchemeEquals:function(a,b){var c=a.baseLayers&&a.baseLayers.items.length?a.baseLayers.items[0]:null;return c?b.basemapTerrain&&b.basemapTerrain.tilingScheme?b.basemapTerrain.tilingScheme.compatibleWith(c.tileInfo):
!0:!0},_resetView:function(a,b){b=b instanceof n?b.clone():n.fromJSON(b);a.basemap&&(a.basemap=null);a.spatialReference=b.clone()},setFromJSON:function(a,b,c,d){var e,g=a.map;try{e=w.fromJSONAndCopySubLayers(g.basemap,b,c)}catch(f){w._handleBasemapSetError(a,f);return}return w.validateAndSet(a,e,b.transparency,d)},isBasemapGlobalCapable:function(a){return 0<a.baseMapLayers.length&&a.baseMapLayers[0].resourceInfo?(a=a.baseMapLayers[0].resourceInfo.spatialReference,a instanceof n||(a=n.fromJSON(a)),
a.isWebMercator()):!0},getJsonBasemapSR:function(a){return 0<a.baseMapLayers.length&&a.baseMapLayers[0].resourceInfo?(a=a.baseMapLayers[0].resourceInfo.spatialReference,a instanceof n||(a=n.fromJSON(a)),a):n.WebMercator},getBasemapSR:function(a){if(a){if(a.baseLayers&&0<a.baseLayers.length&&a.baseLayers.getItemAt(0).spatialReference)return a.baseLayers.getItemAt(0).spatialReference;if(a.elevationLayers&&0<a.elevationLayers.length&&a.elevationLayers.getItemAt(0).spatialReference)return a.elevationLayers.getItemAt(0).spatialReference}return null},
_basemapLayersToJSON:function(a,b,c){a.forEach(function(a){var d={id:a.id},e=s.extrapolateTypeFromLayerInstance(a);"OpenStreetMap"!==e&&(d.url=a.url);null!=e&&(d.layerType=e);c&&(d.isReference=!0);b.push(d)});return b},toJSON:function(a,b){var c;b?(c={},c.visibility=b.visibility,null!=b.id&&(c.id=b.id),null!=b.title&&(c.title=b.title),c.baseMapLayers=[],w._basemapLayersToJSON(b.baseLayers,c.baseMapLayers),w._basemapLayersToJSON(b.referenceLayers,c.baseMapLayers,!0),c.elevationLayers=[],w._basemapLayersToJSON(b.elevationLayers,
c.elevationLayers)):c={id:"empty-basemap",baseMapLayers:[],elevationLayers:[]};void 0!==a.basemapTransparency&&0!==a.basemapTransparency&&(c.transparency=a.basemapTransparency);return c},applyTransparency:function(a,b){void 0!==b&&0!==b?(a.basemapTerrain.opacity=0.99,a.basemapTerrain.wireframe={mode:"shader",wireOpacity:1,surfaceOpacity:0,width:1,subdivision:"constant",subdivisionReduceLevels:2},a.basemapTerrain.frontMostTransparent=!0):(a.basemapTerrain.wireframe=!1,a.basemapTerrain.frontMostTransparent=
!1,a.basemapTerrain.opacity=1);a.basemapTransparency=b},getFirstLayer:function(a){return a.baseLayers&&a.baseLayers.getItemAt(0)||a.elevationLayers&&a.elevationLayers.getItemAt(0)},portal:null,spatialReferenceLocked:!1};w.defaultArcGISWorldElevationService=location.protocol+"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer";w.DefaultElevationLayer=new p({id:"globalElevation",url:w.defaultArcGISWorldElevationService});w.DefaultBasemapJson={baseMapLayers:[{id:"worldTopoBase",
opacity:1,visibility:!0,url:location.protocol+"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}],elevationLayers:[{id:"globalElevation",url:w.defaultArcGISWorldElevationService,layerType:"ArcGISTiledElevationServiceLayer"}],title:"Topographic"};return w})},"webSceneViewer/widgets/SymbologyEditor/SymbologyEditor":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/Select dojo/text!./templates/SymbologyEditor.html dojo/dom-class dojo/on esri/views/3d/layers/graphics/SymbolConverter esri/renderers/SimpleRenderer esri/symbols/PointSymbol3D esri/symbols/LineSymbol3D esri/symbols/PolygonSymbol3D esri/symbols/MeshSymbol3D ./PointSymbolLayerEditor ./LineSymbolLayerEditor ./PolygonSymbolLayerEditor dojo/i18n!../nls/widgets".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y){function u(a,b){if(null==a!==(null==b))return!1;if(a===b||null==a&&null==b||JSON.stringify(a.toJSON())===JSON.stringify(b.toJSON()))return!0;if(!(a.visualVariables!=b.visualVariables||null==a||null==b||null==a.symbol||null==b.symbol||null==a.symbol.symbolLayers||null==b.symbol.symbolLayers)&&a.symbol.symbolLayers&&b.symbol.symbolLayers&&0<a.symbol.symbolLayers.length&&0<b.symbol.symbolLayers.length){if(a.symbol.symbolLayers.length!==b.symbol.symbolLayers.length)return!1;
for(var c=!0,d=0;d<a.symbol.symbolLayers.length;d++){var e=a.symbol.symbolLayers[d],g=b.symbol.symbolLayers[d];c&&(c=e===g||null==e&&null==g?!0:JSON.stringify(e.toJSON())===JSON.stringify(g.toJSON())?!0:void 0)}return c}return!1}return k([r,e,p],{name:"SymbologyEditor",templateString:n,baseClass:"SymbologyEditor",editor:void 0,layer:void 0,view:void 0,symbolLayerDimensionType:void 0,_setSymbolLayerDimensionTypeAttr:function(a){a!==this.symbolLayerDimensionType&&(this._set("symbolLayerDimensionType",
a),this._symbolLayerEditors.forEach(function(b){b.set("dimensionType",a)}))},constructor:function(a,b){this._symbolLayerEditors=[];this._onHandles=[];this._geometryType=a.layer.geometryType;this._defaultDimension=(this._showShield=this._needsShield(a.layer.renderer))?"2d":this._readDimensionFromRenderer(a.layer.renderer)},destroy:function(){this.inherited(arguments);this._symbolLayerEditors.forEach(function(a){a.destroy()});this._symbolLayerEditors.length=0;this._onHandles.forEach(function(a){a.remove?
a.remove():a.unwatch&&a.unwatch()});this.layer=null},postCreate:function(){this.inherited(arguments);this.symbols.textContent=y.symbologyEditor.symbols;this._symbolEditDropdown=new m({className:"toggleOriginalEdited",options:[{label:y.symbologyEditor.originalSymbology,value:"Original",selected:!this.layer._websceneEditorProperties.editedFlags.renderer},{label:y.symbologyEditor.modifySymbology,value:"Change",selected:this.layer._websceneEditorProperties.editedFlags.renderer}]});this._onHandles.push(h(this._symbolEditDropdown,
"change",function(a){this._toggleSymbols(a)}.bind(this)));this._symbolEditDropdown.placeAt(this.originalChangeSymbology);this._symbolEditDropdown.startup();this.set("symbolLayerDimensionType",this._defaultDimension);this.dimensions.textContent=y.symbologyEditor.type;var a="2D",b="3D";"esriGeometryPolyline"===this._geometryType?(a=y.symbologyEditor.line2d,b=y.symbologyEditor.path3d):"esriGeometryPoint"===this._geometryType?(a=y.symbologyEditor.icon2d,b=y.symbologyEditor.object3D):"esriGeometryPolygon"===
this._geometryType&&(a=y.symbologyEditor.polygon2d,b=y.symbologyEditor.polygon3d);this._symbol2D3D=new m({className:"toggle2D3D",options:[{label:a,value:"2D",selected:"2d"===this._defaultDimension},{label:b,value:"3D",selected:"3d"===this._defaultDimension}]});this._onHandles.push(h(this._symbol2D3D,"change",function(a){this._toggleDimension(a)}.bind(this)));this._symbol2D3D.placeAt(this.changeDimension);this._symbol2D3D.startup();this._setupSymbolLayerEditors(!1);this.layer._websceneEditorProperties.editedFlags.renderer?
this._enableEditing(!1):this._disableEditing()},_toggleSymbols:function(a){"Original"===a?this._disableEditing():(this._enableEditing(!0),this.editor.setWebSceneChanged())},_toggleDimension:function(a){"2D"===a?this.set("symbolLayerDimensionType","2d"):this.set("symbolLayerDimensionType","3d")},_disableEditing:function(){this._editingInitialized&&this._resetLayerSymbology();s.add(this.editorWrapper,"disable")},_enableEditing:function(a){this.layer._websceneEditorProperties.editedFlags.renderer;s.remove(this.editorWrapper,
"disable");a&&this._symbolLayerEditors.forEach(function(a){a.updateSymbolLayerFromUI()});this._editingInitialized=!0},_resetLayerSymbology:function(){var a=this.layer._websceneEditorProperties.originalRenderer;a!==this.layer.get("renderer")&&(this.layer.set("renderer",a),this.layer._websceneEditorProperties.editedFlags.renderer=!1,this._symbolLayerEditors.forEach(function(a){a.updateUIFromSelectedValues()}))},_toggleOriginalSymbologyClickHandler:function(a){this._disableEditing()},_toggleEditedSymbologyClickHandler:function(a){this._enableEditing(!0);
this.editor.setWebSceneChanged()},_setupSymbolLayerEditors:function(a){switch(this._geometryType){case "esriGeometryPoint":this._createPointSymbolLayers(a);break;case "esriGeometryPolyline":this._createLineSymbolLayers(a);break;case "esriGeometryPolygon":this._createPolygonSymbolLayers(a);break;case "esriGeometryMesh":this.set("symbolLayerDimensionType","2d"),this._hide2d3dToggle(),this._createMeshSymbolLayers(a)}},_createPointSymbolLayers:function(a){var c=new b({dimensionType:this.symbolLayerDimensionType,
layer:this.layer,view:this.view,colorTitle:y.symbologyEditor.fillColor});this._addSymbolLayerEditor(c);var e=c.watch("symbolLayer",function(a,b,e){"Object"!==e.type?(s.remove(c.outlineSizeText,"hide"),s.remove(c.selectedOutlineColorDropdown.domNode,"hide"),s.remove(c.outlineSizeInput.domNode,"hide")):(s.add(c.outlineSizeText,"hide"),s.add(c.selectedOutlineColorDropdown.domNode,"hide"),s.add(c.outlineSizeInput.domNode,"hide"));a=d.fromJSON({type:"PointSymbol3D",symbolLayers:[e]});a=new f(a);this._applyRendererToLayer(a)}.bind(this));
this._onHandles.push(e);a&&c.updateSymbolLayerFromUI()},_createLineSymbolLayers:function(a){var b=new t({dimensionType:this.symbolLayerDimensionType,layer:this.layer,view:this.view});this._addSymbolLayerEditor(b);var c=b.watch("symbolLayer",function(a,b,c){a=q.fromJSON({type:"LineSymbol3D",symbolLayers:[c]});a=new f(a);this._applyRendererToLayer(a)}.bind(this));this._onHandles.push(c);a&&b.updateSymbolLayerFromUI()},_createPolygonSymbolLayers:function(a){var b=new g({dimensionType:this.symbolLayerDimensionType,
layer:this.layer,view:this.view,colorTitle:y.symbologyEditor.fillColor});this._addSymbolLayerEditor(b);var c=new t({dimensionType:this.symbolLayerDimensionType,layer:this.layer,view:this.view,colorTitle:y.symbologyEditor.outlineColor,sizeTitle:y.symbologyEditor.outlineSize});this._addSymbolLayerEditor(c);b.updateSymbolLayerFromUI();c.updateSymbolLayerFromUI();var d=b.watch("symbolLayer",function(a,b,d){a=c.get("symbolLayer");b=[];b.push(d);"Extrude"!==d.type&&"tube"!==a.profile?(b.push(a),s.remove(c.sizeText,
"hide"),s.remove(c.selectedColorDropdown.domNode,"hide"),s.remove(c.sizeInput.domNode,"hide")):(s.add(c.sizeText,"hide"),s.add(c.selectedColorDropdown.domNode,"hide"),s.add(c.sizeInput.domNode,"hide"));d=l.fromJSON({type:"PolygonSymbol3D",symbolLayers:b});d=new f(d);this._applyRendererToLayer(d)}.bind(this));this._onHandles.push(d);d=c.watch("symbolLayer",function(a,d,e){a=b.get("symbolLayer");d=[a];"Extrude"!==a.type&&(d.push(e),s.remove(c.sizeText,"hide"),s.remove(c.selectedColorDropdown.domNode,
"hide"),s.remove(c.sizeInput.domNode,"hide"));e=l.fromJSON({type:"PolygonSymbol3D",symbolLayers:d});e=new f(e);this._applyRendererToLayer(e)}.bind(this));this._onHandles.push(d);a&&b.updateSymbolLayerFromUI()},_createMeshSymbolLayers:function(a){var b=new g({dimensionType:this.symbolLayerDimensionType,layer:this.layer,view:this.view});this._addSymbolLayerEditor(b);var d=b.watch("symbolLayer",function(a,b,d){a=c.fromJSON({symbolLayers:[d]});a=new f(a);this._applyRendererToLayer(a)}.bind(this));this._onHandles.push(d);
a&&b.updateSymbolLayerFromUI()},_addSymbolLayerEditor:function(a){a.placeAt(this.symbolLayerContainer);a.startup();this._symbolLayerEditors.push(a)},_disable3d:function(){this.set("symbolLayerDimensionType","2d");this._symbol2D3D.set("value","2D");s.add(this._symbol2D3D.domNode,"disable")},_hide2d3dToggle:function(){s.add(this._symbol2D3D.domNode,"disable")},_needsShield:function(b){if(null==b)return!1;if(!b.toJSON||"simple"!==b.toJSON().type)return!0;if(!(null==b||(b.infos&&0<b.infos.length?null!=
b.infos[0].symbol.symbolLayers:b.symbol&&null!=b.symbol.symbolLayers)))null!=b&&(b=a.toWeb3DRenderer(b));b=b.symbol;if(!b||0===b.symbolLayers.length)return!0;switch(this._geometryType){case "esriGeometryPoint":if(1<b.symbolLayers.length||!b.symbolLayers[0].resource||!b.symbolLayers[0].resource.primitive)return!0;break;case "esriGeometryPolyline":if(1<b.symbolLayers.length)return!0;break;case "esriGeometryPolygon":if(2<b.symbolLayers.length)return!0}return!1},_readDimensionFromRenderer:function(b){if(b&&
b.symbol)return b=a.toWeb3DRenderer(b).symbol.symbolLayers[0],"Object"===b.type||"Path"===b.type||"Extrude"===b.type?"3d":"2d"},_applyRendererToLayer:function(a){u(this.layer.renderer,a)||(s.remove(this.symbologyLoading,"hide"),setTimeout(function(){this.layer.set("renderer",a);var b=this.view.getLayerView(this.layer);if(b["symbols-updating"])var b=this.view.getLayerView(this.layer),c=b.on("symbols-updating-change",function(a){!1===a.newValue&&(s.add(this.symbologyLoading,"hide"),c.remove())}.bind(this));
else s.add(this.symbologyLoading,"hide")}.bind(this),100),this.layer._websceneEditorProperties.editedFlags.renderer=!0)},updateUIFromSelectedValues:function(){var a=this.getSelectedShape();this.shapePickerDropdown.set("label",a);a=this.getSelectedColor();this._setColorSwatch(a);a=this.getSelectedSize();this.sizeInput.set("value",a,!1)}})})},"dojox/mdnd/Moveable":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/array dojo/_base/connect dojo/_base/event dojo/_base/sniff dojo/dom dojo/dom-geometry dojo/dom-style dojo/touch dojo/_base/window".split(" "),
function(k,r,e,p,m,n,s,h,a,f){return r("dojox.mdnd.Moveable",null,{handle:null,skip:!0,dragDistance:3,constructor:function(a,e){this.node=s.byId(e);this.d=this.node.ownerDocument;a||(a={});this.handle=a.handle?s.byId(a.handle):null;this.handle||(this.handle=this.node);this.skip=a.skip;this.events=[p.connect(this.handle,f.press,this,"onMouseDown")];dojox.mdnd.autoScroll&&(this.autoScroll=dojox.mdnd.autoScroll)},isFormElement:function(a){a=a.target;3==a.nodeType&&(a=a.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+
a.tagName.toLowerCase()+" ")},onMouseDown:function(a){if(!this._isDragging&&1==(a.which||a.button))if(!this.skip||!this.isFormElement(a))this.autoScroll&&(this.autoScroll.setAutoScrollNode(this.node),this.autoScroll.setAutoScrollMaxPage()),this.events.push(p.connect(this.d,f.release,this,"onMouseUp")),this.events.push(p.connect(this.d,f.move,this,"onFirstMove")),this._selectStart=p.connect(k.body(),"onselectstart",m.stop),this._firstX=a.clientX,this._firstY=a.clientY,m.stop(a)},onFirstMove:function(d){m.stop(d);
(this._firstX-d.clientX)*(this._firstX-d.clientX)+(this._firstY-d.clientY)*(this._firstY-d.clientY)>this.dragDistance*this.dragDistance&&(this._isDragging=!0,p.disconnect(this.events.pop()),a.set(this.node,"width",h.getContentBox(this.node).w+"px"),this.initOffsetDrag(d),this.events.push(p.connect(this.d,f.move,this,"onMove")))},initOffsetDrag:function(a){this.offsetDrag={l:a.pageX,t:a.pageY};a=h.position(this.node,!0);this.offsetDrag.l=a.x-this.offsetDrag.l;this.offsetDrag.t=a.y-this.offsetDrag.t;
var e={x:a.x,y:a.y};this.size={w:a.w,h:a.h};this.onDragStart(this.node,e,this.size)},onMove:function(a){m.stop(a);if(!(8==n("ie")&&20>new Date-this.date)){this.autoScroll&&this.autoScroll.checkAutoScroll(a);var e={x:this.offsetDrag.l+a.pageX,y:this.offsetDrag.t+a.pageY},f=this.node.style;f.left=e.x+"px";f.top=e.y+"px";this.onDrag(this.node,e,this.size,{x:a.pageX,y:a.pageY});8==n("ie")&&(this.date=new Date)}},onMouseUp:function(a){this._isDragging&&(m.stop(a),this._isDragging=!1,this.autoScroll&&this.autoScroll.stopAutoScroll(),
delete this.onMove,this.onDragEnd(this.node),this.node.focus());p.disconnect(this.events.pop());p.disconnect(this.events.pop());p.disconnect(this._selectStart);this._selectStart=null},onDragStart:function(a,e,f){},onDragEnd:function(a){},onDrag:function(a,e,f,c){},destroy:function(){e.forEach(this.events,p.disconnect);this.events=this.node=null}})})},"webSceneViewer/widgets/SymbologyEditor/PointSymbolLayerEditor":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/keys dojo/text!./templates/PointSymbolLayerEditor.html dojo/dom-style dojo/dom-class dojo/on dojo/query dojo/_base/lang dojox/gfx/_base esri/views/3d/layers/graphics/SymbolConverter ./BaseSymbolLayerEditor ./ShapePicker".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b){function t(a){a="#"==a.charAt(0)?a.substring(1,7):a;var b=parseInt(a.substring(0,2),16),c=parseInt(a.substring(2,4),16);a=parseInt(a.substring(4,6),16);return[b,c,a]}return k([c,r,e,p],{name:"PointSymbolLayerEditor",baseClass:"SymbolLayerEditor",templateString:n,_setDimensionTypeAttr:function(a){this.inherited(arguments);this._shapePicker&&this._shapePicker.set("symbolLayerDimensionType",a)},constructor:function(a,b){},destroy:function(){this.inherited(arguments)},
postCreate:function(){this._shapePicker=new b({geometryType:"esriGeometryPoint",symbolLayerDimensionType:this.dimensionType,baseClass:"ShapePicker"},this.shapePickerDomNode);a(this._shapePicker,"selection-change",this._onShapePickerSelectChange.bind(this));this._shapePicker.startup();this.setSelectedShape(this._selectedShape[this.dimensionType]);this.setSelectedColor(this._selectedColor[this.dimensionType]);this.setSelectedSize(this._selectedSize[this.dimensionType]);this.setSelectedOutlineSize(this._selectedOutlineSize[this.dimensionType]);
this.setSelectedOutlineColor(this._selectedOutlineColor[this.dimensionType]);this.updateUIFromSelectedValues();this._initUIStrings();"3d"===this.dimensionType&&(h.add(this.outlineSizeText,"hide"),h.add(this.selectedOutlineColorDropdown.domNode,"hide"),h.add(this.outlineSizeInput.domNode,"hide"))},setSelectedOutlineColor:function(a){this._setOutlineColorSwatch(a,this.getSelectedOutlineTransparency());this._selectedOutlineColor["2d"]=a;this._selectedOutlineColor["3d"]=a},getSelectedOutlineColor:function(){return this._selectedOutlineColor[this.dimensionType]},
setSelectedOutlineTransparency:function(a,b){this.outlineTransparencyInput&&this.outlineTransparencyInput.get("value")!==a&&(b?this.outlineTransparencyInput._set("value",a):this.outlineTransparencyInput.set("value",a));this._setOutlineColorSwatch(this.getSelectedOutlineColor(),a);this._selectedOutlineTransparency["2d"]=a;this._selectedOutlineTransparency["3d"]=a},getSelectedOutlineTransparency:function(){return this._selectedOutlineTransparency[this.dimensionType]},getSelectedOutlineSize:function(){return this._selectedOutlineSize[this.dimensionType]},
setSelectedOutlineSize:function(a,b){this.outlineSizeInput&&this.outlineSizeInput.get("value")!==a&&(b?this.outlineSizeInput._set("value",a):this.outlineSizeInput.set("value",a));this._selectedOutlineSize[this.dimensionType]=a},_onOutlineSizeInputKeypressHandler:function(a){(a.charOrCode||a.keyCode)==m.ENTER&&this._updateOutlineSizeInputSelectedValue()},_updateOutlineSizeInputSelectedValue:function(){0>this.outlineSizeInput.get("value")?this.outlineSizeInput.set("value",this._selectedOutlineSize[this.dimensionType]):
null!=this.outlineSizeInput.get("value")&&this.outlineSizeInput.get("value")!==this.getSelectedOutlineSize()&&(this.setSelectedOutlineSize(this.outlineSizeInput.get("value")),this.updateSymbolLayerFromUI())},updateUIFromSelectedValues:function(){var a=this.getSelectedShape();this.shapePickerDropdown.set("iconClass","smallShapeIcon shapeIcon"+a.charAt(0).toUpperCase()+a.slice(1));a=this.getSelectedSize();this.sizeInput.set("value",a,!1);a=this.getSelectedOutlineSize();this.outlineSizeInput.set("value",
a,!1);a=this.getSelectedOutlineTransparency();this.outlineTransparencyInput.set("value",a,!1);var b=this.getSelectedOutlineColor();this._setOutlineColorSwatch(b,a);a=this.getSelectedTransparency();this.transparencyInput.set("value",a,!1);b=this.getSelectedColor();this._setColorSwatch(b,a)},updateSymbolLayerFromUI:function(){var a=this.getSelectedShape(),b=this.getSelectedColor(),c=this.getSelectedSize(),e=this.getSelectedTransparency(),f=this.getSelectedOutlineSize(),l=this.getSelectedOutlineTransparency(),
h=this.getSelectedOutlineColor(),m=!0;this.symbolLayer&&100===e&&100===l&&(m=!1);a="2d"===this.dimensionType?{type:"Icon",size:q.px2pt(c),outline:{color:h,size:q.px2pt(f),transparency:l},material:{color:d.clone(b),transparency:e},resource:{primitive:a},enable:m}:{type:"Object",width:c,height:c,depth:c,material:{color:d.clone(b),transparency:e},resource:{primitive:a},enable:m};this.set("symbolLayer",a)},setSelectedShape:function(a){this.shapePickerDropdown&&this.shapePickerDropdown.set("iconClass",
"smallShapeIcon shapeIcon"+a.charAt(0).toUpperCase()+a.slice(1));this._selectedShape[this.dimensionType]=a},getSelectedShape:function(){return this._selectedShape[this.dimensionType]},_readLayerSymbology:function(a){if(a&&a.symbol)if(a=l.toWeb3DRenderer(a).symbol.symbolLayers[0],this._readColorFromSymbolLayer(a),"Object"===a.type){this._selectedShape["3d"]=a.resource.primitive||this._selectedShape["3d"];var b=a.width?a.width:a.height?a.height:a.depth;this._selectedSize["3d"]=Math.round(100*((b+(a.height?
a.height:b)+(a.depth?a.depth:b))/3))/100;this._initialSize=!1}else this._selectedShape["2d"]=a.resource.primitive||this._selectedShape["2d"],this._selectedSize["2d"]=Math.round(1E3*a.size)/1E3,this._selectedOutlineSize["2d"]=a.outline?Math.round(1E3*a.outline.size)/1E3:this._selectedOutlineSize["2d"],this._selectedOutlineColor["2d"]=a.outline?a.outline.color.toRgb():this._selectedOutlineColor["2d"],this._selectedOutlineTransparency["2d"]=a.outline?100*(1-a.outline.color.a):this._selectedOutlineTransparency["2d"]},
_setOutlineColorSwatch:function(a,b){var c=1-b/100;isNaN(c)&&(c=1);"string"!==typeof a&&(a="rgba("+a[0]+","+a[1]+","+a[2]+","+c+")");1<f(".colorSwatch",this.domNode).length?s.set(f(".colorSwatch",this.domNode)[1],"backgroundColor",a):setTimeout(function(){s.set(f(".colorSwatch",this.domNode)[1],"backgroundColor",a)}.bind(this),200)},_onShapePickerSelectChange:function(a){this.shapePickerDropdown.closeDropDown();a.shape!==this.getSelectedShape()&&(this.setSelectedShape(a.shape),this.updateSymbolLayerFromUI())},
_updateOutlineTransparencyInputSelectedValue:function(){0>this.outlineTransparencyInput.get("value")||100<this.outlineTransparencyInput.get("value")?this.outlineTransparencyInput.set("value",this._selectedOutlineTransparency[this.dimensionType]):null!=this.outlineTransparencyInput.get("value")&&this.outlineTransparencyInput.get("value")!==this.getSelectedOutlineTransparency()&&(this.setSelectedOutlineTransparency(this.outlineTransparencyInput.get("value")),this.updateSymbolLayerFromUI())},_onOutlineTransparencyInputKeypressHandler:function(a){(a.charOrCode||
a.keyCode)==m.ENTER&&this._updateOutlineTransparencyInputSelectedValue()},_onOutlineColorPaletteWidgetChange:function(a){this.selectedOutlineColorDropdown.closeDropDown();a!==this.getSelectedOutlineColor()&&(this.setSelectedOutlineColor(t(a)),this.updateSymbolLayerFromUI())}})})},"xstyle/has-class":function(){define(["dojo/has"],function(k){var r={};return function(){for(var e,p=arguments,m=0;m<p.length;m++)if(e=p[m],!r[e]){r[e]=!0;var n=e.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),s=k(n[2]),
h=-n[4];if((0<h?h<=s&&(-n[5]||h)>=s:!!s)==!n[1])document.documentElement.className+=" has-"+e}}})},"webSceneViewer/widgets/SymbologyEditor/LineSymbolLayerEditor":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/ColorPalette dijit/form/DropDownButton dijit/TooltipDialog dojo/text!./templates/LineSymbolLayerEditor.html dojo/dom-class dojo/_base/lang dojox/gfx/_base esri/views/3d/layers/graphics/SymbolConverter ./BaseSymbolLayerEditor".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l){return k([l,r,e,p],{name:"LineSymbolLayerEditor",baseClass:"SymbolLayerEditor",templateString:h,_setDimensionTypeAttr:function(a){this.inherited(arguments)},constructor:function(a,b){this._selectedSize["2d"]=1;this._readLayerSymbology(a.layer.renderer)},destroy:function(){this.inherited(arguments)},postCreate:function(){this.setSelectedColor(this._selectedColor[this.dimensionType]);this.setSelectedSize(this._selectedSize[this.dimensionType]);var c=this.params.layer.renderer;
c&&c.symbol&&"Extrude"===this._getSymbolLayer(c).type&&(a.add(this.sizeText,"hide"),a.add(this.selectedColorDropdown.domNode,"hide"),a.add(this.sizeInput.domNode,"hide"));this.updateUIFromSelectedValues();this._initUIStrings()},updateUIFromSelectedValues:function(){var a=this.getSelectedSize();this.sizeInput.set("value",a,!1);a=this.getSelectedTransparency();this.transparencyInput.set("value",a,!1);var b=this.getSelectedColor();this._setColorSwatch(b,a)},updateSymbolLayerFromUI:function(){var a=this.getSelectedColor(),
b=this.getSelectedSize(),d=this.getSelectedTransparency(),e=!0;this.symbolLayer&&100===d&&(e=!1);a="2d"===this.dimensionType?{type:"Line",size:b,material:{color:f.clone(a),transparency:d},enable:e}:{type:"Path",size:b,material:{color:f.clone(a),transparency:d},profile:"tube",enable:e};this.set("symbolLayer",a)},_getSymbolLayer:function(a){a=q.toWeb3DRenderer(a);var b=a.symbol.symbolLayers[0];1<a.symbol.symbolLayers.length&&("Line"!==b.type&&"Path"!==b.type)&&(b=a.symbol.symbolLayers[1]);return b},
_readLayerSymbology:function(a){a&&a.symbol&&(a=this._getSymbolLayer(a),"Line"!==a.type&&"Path"!==a.type||(this._readColorFromSymbolLayer(a),"Path"===a.type?(this._selectedSize["3d"]=a.size,this._initialSize=!1):this._selectedSize["2d"]=Math.round(1E3*d.px2pt(a.size))/1E3||1))}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(k,r,e,p){return k("dijit.form.MappedTextBox",p,{postMixInProperties:function(){this.inherited(arguments);
this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(e){return e.toString?e.toString():""},toString:function(){var e=this.filter(this.get("value"));return null!=e?"string"==typeof e?e:this.serialize(e,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=e.place("\x3cinput type\x3d'hidden'"+(this.name&&!r("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+
'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"dstore/SimpleQuery":function(){define(["dojo/_base/declare","dojo/_base/array"],function(k,r){function e(e,k){if(-1<e.indexOf(".")){var p=e.split("."),h=p.length;return function(a){for(var e=0;e<h;e++)a=a&&(k&&a.get?a.get(p[e]):a[p[e]]);return a}}return function(a){return a.get?a.get(e):a[e]}}var p={eq:function(e,k){return e===k},"in":function(e,k){return-1<r.indexOf(k.data||k,e)},ne:function(e,
k){return e!==k},lt:function(e,k){return e<k},lte:function(e,k){return e<=k},gt:function(e,k){return e>k},gte:function(e,k){return e>=k},match:function(e,k,p){return k.test(e,p)},contains:function(e,k,p,h){var a=this;return r.every(k.data||k,function(f){if("object"===typeof f&&f.type){var d=a._getFilterComparator(f.type);return r.some(e,function(e){return d.call(a,e,f.args[1],p,h)})}return-1<r.indexOf(e,f)})}};return k(null,{_createFilterQuerier:function(m){function k(f){var d=f.type;f=f.args;var m=
h._getFilterComparator(d);if(m){var l=f[0],c=e(l,p),b=f[1];b&&b.fetchSync&&(b=b.fetchSync());return function(a){return m.call(h,c(a),b,a,l)}}switch(d){case "and":case "or":for(var t=0,g=f.length;t<g;t++){var r=k(f[t]);a=a?function(a,b){return"and"===d?function(c){return a(c)&&b(c)}:function(c){return a(c)||b(c)}}(a,r):r}return a;case "function":return f[0];case "string":t=h[f[0]];if(!t)throw Error("No filter function "+f[0]+" was found in the collection");return t;case void 0:return function(){return!0};
default:throw Error('Unknown filter operation "'+d+'"');}}var p=this.queryAccessors,h=this,a=k(m);return function(e){return r.filter(e,a)}},_getFilterComparator:function(e){return p[e]||this.inherited(arguments)},_createSelectQuerier:function(e){return function(k){var p=e.length;return r.map(k,e instanceof Array?function(h){for(var a={},f=0;f<p;f++){var d=e[f];a[d]=h[d]}return a}:function(h){return h[e]})}},_createSortQuerier:function(m){var k=this.queryAccessors;return function(p){p=p.slice();p.sort("function"==
typeof m?m:function(h,a){for(var f=0;f<m.length;f++){var d,q=m[f];if("function"==typeof q)d=q(h,a);else{d=q.get||(q.get=e(q.property,k));var q=q.descending,l=d(h);d=d(a);null!=l&&(l=l.valueOf());null!=d&&(d=d.valueOf());d=l===d?0:!!q===(null===l||l>d&&null!==d)?-1:1}if(0!==d)return d}return 0});return p}}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q){s=k("dijit.MenuItem"+(n("dojo-bidi")?"_NoBidi":""),[h,a,f,d],{templateString:q,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var c="",b;b=a.search(/{\S}/);if(0<=b){var c=a.charAt(b+1),d=a.substr(0,b);a=a.substr(b+3);b=d+c+a;a=d+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+c+"\x3c/span\x3e"+a}else b=a;this.domNode.setAttribute("aria-label",b+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",c)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){a&&!("label"in this.params)&&this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);e.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&e.set(this.accelKeyNode,"id",this.id+"_accel");r.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==n("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(a){}},_setSelected:function(a){p.toggle(this.domNode,
"dijitMenuItemSelected",a)},setLabel:function(a){m.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){m.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(a){this.accelKeyNode&&(this.accelKeyNode.style.display=
a?"":"none",this.accelKeyNode.innerHTML=a,e.set(this.containerNode,"colSpan",a?"1":"2"));this._set("accelKey",a)}});n("dojo-bidi")&&(s=k("dijit.MenuItem",s,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return s})},"webSceneViewer/widgets/MessageListWidget/MessageWidget":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/dom-class dojo/on dojo/_base/fx dojo/text!./templates/MessageWidget.html".split(" "),
function(k,r,e,p,m,n,s){return k([r,e],{declaredClass:"MessageWidget",MessageTypes:{INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error"},templateString:s,message:void 0,details:void 0,type:void 0,timeout:void 0,collapsed:!1,constructor:function(e){},_remove:function(){clearTimeout(this.timer);var e=n.fadeOut({node:this.domNode,duration:500}).play();m.once(e,"End",function(a,e){this.destroy()}.bind(this))},postCreate:function(){if(void 0===this.type||this.type!==this.MessageTypes.INFO&&this.type!==
this.MessageTypes.SUCCESS&&this.type!==this.MessageTypes.WARNING&&this.type!==this.MessageTypes.ERROR)this.type=this.MessageTypes.INFO;void 0===this.collapsed&&(this.collapsed=!1);void 0===this.timeout&&(this.timeout=this.type===this.MessageTypes.ERROR?0:1E4);p.add(this.domNode,this.type);this.MessageShortDesc.innerHTML=this.message;this.MessageShortDesc.title=this.message;this.details&&""!==this.details?this.MessageDetails.innerHTML=this.details:(p.add(this.ExpandIcon,"hide"),p.add(this.MessageDetails,
"hide"));this.collapsed&&p.add(this.domNode,"collapsed");p.add(this.MessageTypeIcon,this.type+"Icon");0<this.timeout&&(this.timer=setTimeout(function(){this._remove()}.bind(this),this.timeout));n.fadeIn({node:this.domNode,duration:500}).play()},_expand:function(e){if(""!==this.details&&(e=e.target?e.target:e.srcElement,-1===e.className.indexOf("closeIcon")))if(-1===e.className.indexOf("MessageWidget")&&(e=e.parentNode),-1!==e.className.indexOf("expand"))p.remove(e,"expand");else for(var a=e.parentNode,
f=0;f<a.childNodes.length;f++){var d=a.childNodes[f];d===e?p.add(d,"expand"):p.remove(d,"expand")}}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b){return r("dijit._MenuBase",[q,b,c,l],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&
(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){m.toggle(this.domNode,"dijitMenuActive",a);m.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,childSelector:function(a){var b=d.byNode(a);return a.parentNode==this.containerNode&&b&&b.focus},postCreate:function(){var a=this,b="string"==
typeof this.childSelector?this.childSelector:n.hitch(this,"childSelector");this.own(h(this.containerNode,h.selector(b,s.enter),function(){a.onItemHover(d.byNode(this))}),h(this.containerNode,h.selector(b,s.leave),function(){a.onItemUnhover(d.byNode(this))}),h(this.containerNode,h.selector(b,f),function(b){a.onItemClick(d.byNode(this),b);b.stopPropagation()}),h(this.containerNode,h.selector(b,"focusin"),function(){a._onItemFocus(d.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,
b,c,d){this.inherited(arguments);if(a&&(-1==d||a.popup&&1==d))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);
this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),a.popup&&(!a.disabled&&!this.hover_timer)&&(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();
this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&
(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var c=/^key/.test(b._origType||b.type)||0==b.clientX&&0==b.clientY;this._openItemPopup(a,c)}else this.onExecute(),a._onClick?a._onClick(b):a.onClick(b)},_openItemPopup:function(a,
b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var c=a.popup;c.parentMenu=this;this.own(this._mouseoverHandle=h.once(c.domNode,"mouseover",n.hitch(this,"_onPopupHover")));var d=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&d.focusChild(a);d._cleanUp()},onExecute:n.hitch(this,"_cleanUp",!0),onClose:function(){d._mouseoverHandle&&(d._mouseoverHandle.remove(),
delete d._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(p.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&
this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l){k=k("dijit.TooltipDialog",[h,d,f,a],{title:"",doLayout:!1,autofocus:!0,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:q,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(n(this.domNode,"keydown",m.hitch(this,"_onKey")))},orient:function(a,b,d){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft",
"TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[b+"-"+d];r.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();
s.focus(this._firstFocusItem)},onOpen:function(a){this.orient(this.domNode,a.aroundCorner,a.corner);var b=a.aroundNodePos;"M"==a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=b.y+(b.h-this.connectorNode.offsetHeight>>1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=b.x+(b.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(a){if(a.keyCode==
p.ESCAPE)this.defer("onCancel"),a.stopPropagation(),a.preventDefault();else if(a.keyCode==p.TAB){var b=a.target;this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(s.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b==this._lastFocusItem&&!a.shiftKey?(s.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault()):a.stopPropagation()}}});e("dojo-bidi")&&k.extend({_setTitleAttr:function(a){this.containerNode.title=
this.textDir&&this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,a):a;this._set("title",a)},_setTextDirAttr:function(a){if(!this._created||this.textDir!=a)this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title))}});return k})},"dstore/Store":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/when dojo/Deferred dojo/_base/declare ./QueryMethod ./Filter dojo/Evented".split(" "),function(k,r,e,p,m,n,s,h,
a,f){function d(a){return function(c,b){var d=this;m(c,function(c){c={target:c};var e=b[1]||{};"beforeId"in e&&(c.beforeId=e.beforeId);d.emit(a,c)});return c}}p.add("object-proto",!!{}.__proto__&&!{}.watch);var q=p("object-proto");return s(f,{constructor:function(a){a&&s.safeMixin(this,a);this.Model&&this.Model.createSubclass&&(this.Model=this.Model.createSubclass([]).extend({_store:this}));this.storage=new f;var c=this;this.autoEmitEvents&&(e.after(this,"add",d("add")),e.after(this,"put",d("update")),
e.after(this,"remove",function(a,d){m(a,function(){c.emit("delete",{id:d[0]})});return a}))},autoEmitEvents:!0,idProperty:"id",queryAccessors:!0,getIdentity:function(a){return a.get?a.get(this.idProperty):a[this.idProperty]},_setIdentity:function(a,c){a.set?a.set(this.idProperty,c):a[this.idProperty]=c},forEach:function(a,c){var b=this;return m(this.fetch(),function(d){for(var e=0,f;void 0!==(f=d[e]);e++)a.call(c,f,e,b);return d})},on:function(a,c){return this.storage.on(a,c)},emit:function(a,c){c=
c||{};c.type=a;try{return this.storage.emit(a,c)}finally{return c.cancelable}},parse:null,stringify:null,Model:null,_restore:function(a,c){var b=this.Model;if(b&&a){var d=b.prototype,e=d._restore;e?a=e.call(a,b,c):q&&c?a.__proto__=d:a=k.delegate(d,a)}return a},create:function(a){return new this.Model(a)},_createSubCollection:function(a){var c=k.delegate(this.constructor.prototype),b;for(b in this)this._includePropertyInSubCollection(b,c)&&(c[b]=this[b]);return s.safeMixin(c,a)},_includePropertyInSubCollection:function(a,
c){return!(a in c)||c[a]!==this[a]},queryLog:[],filter:new h({type:"filter",normalizeArguments:function(a){var c=this.Filter;return a instanceof c?[a]:[new c(a)]}}),Filter:a,sort:new h({type:"sort",normalizeArguments:function(a,c){var b;"function"===typeof a?b=[a]:(b=a instanceof Array?a.slice():"object"===typeof a?[].slice.call(arguments):[{property:a,descending:c}],b=r.map(b,function(a){a=k.mixin({},a);a.descending=!!a.descending;return a}),b=[b]);return b}}),select:new h({type:"select"}),_getQuerierFactory:function(a){return this["_create"+
(a[0].toUpperCase()+a.substr(1))+"Querier"]}})})},"webSceneViewer/widgets/Switch/Switch":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Switch.html dojo/dom-class dojo/i18n!../nls/widgets".split(" "),function(k,r,e,p,m,n){return k([r,e],{templateString:p,_onHandles:void 0,switchOn:!1,_disabled:!1,constructor:function(e,h){this._onHandles=[]},destroy:function(){this._onHandles.forEach(function(e){e.remove()})},postCreate:function(){this.switchOn||
m.add(this.SwitchContainer,"off");this.SwitchContainer.title=this.switchOn?n.switchControl.on:n.switchControl.off},_toggleSwitch:function(e,h){this._disabled||(m.toggle(this.SwitchContainer,"off"),this.switchOn=!this.switchOn,this.SwitchContainer.title=this.switchOn?n.switchControl.on:n.switchControl.off,!0!==h&&this.emit("toggle",{on:this.switchOn}))},turnOn:function(){!1===this.switchOn&&this._toggleSwitch(null,!0)},turnOff:function(){!0===this.switchOn&&this._toggleSwitch(null,!0)},disable:function(){this._disabled=
!0;m.add(this.domNode,"incompatible")},enable:function(){this._disabled=!1;m.remove(this.domNode,"incompatible")}})})},"webSceneViewer/editor/WebSceneEditorPanes/AddLayerByUrlPane":function(){define("esri/core/declare dojo/_base/lang dojo/dom-construct dojo/on dojo/keys ./WebSceneEditorPaneBase webSceneViewer/webScene/WebSceneLayers dijit/form/ValidationTextBox dojo/i18n!../nls/editor".split(" "),function(k,r,e,p,m,n,s,h,a){return k(n,{constructor:function(){r.mixin(this,{id:"addLayerByUrl",title:a.panes.enterLayerUrl,
actionButton:{title:a.buttons.done,action:"_navBackBtnNodeClickHandler"}});this._updateContent()},customDestroy:function(){this._textBox.destroy();this._nameTextBox.destroy()},_updateContent:function(){function f(){if(d._textBox.isValid()){var b=d._textBox.get("value"),c=d._nameTextBox.get("value");d.editor.addLayerByUrl(b,c).then(function(){d.editor.setWebSceneChanged();d.emit("navigate",{to:"contents",from:this});d.customDestroy();d._updateContent()},function(){e.destroy(f)});var f=e.create("p",
{className:"confirmMessage"},k);f.textContent=a.addLayerByUrlPane.addingLayer}}var d=this,k=e.create("div",{className:"addLayerByUrlPane"});if(null==this.editor)e.place("\x3cp\x3einitialization problem\x3c/p\x3e",k);else{e.create("h4",{className:"paneSectionTitle"},k).textContent=a.addLayerByUrlPane.layerUrl;this._textBox=new h({className:"addLayerUrlTextBox",placeHolder:a.addLayerByUrlPane.placeholderLayerUrl,required:!0,pattern:s.URL_REGEXP,intermediateChanges:!0});this._textBox.placeAt(k);p(this._textBox,
"keypress",function(a){(a.charOrCode||a.keyCode)==m.ENTER&&f()});e.create("h4",{className:"paneSectionTitle"},k).textContent=a.addLayerByUrlPane.layerName;this._nameTextBox=new h({className:"addLayerUrlTextBox",placeHolder:a.addLayerByUrlPane.placeholderLayerName,required:!1});var l;p(this._textBox,"change",function(a){this._textBox.isValid()&&(a=s.parseTitleFromLayerUrl(a),a!==l&&(l=a,this._nameTextBox.set("value",a)))}.bind(this));this._nameTextBox.placeAt(k);p(this._nameTextBox,"keypress",function(a){(a.charOrCode||
a.keyCode)==m.ENTER&&f()});var c=e.create("button",{className:"blueButton"},e.create("p",{},k));c.textContent=a.buttons.add;p(c,"click",f)}this._addToContentNode(k)},onPaneSelected:function(){this.inherited(arguments);this._textBox.reset();this._nameTextBox.reset();this._textBox.focus()}})})},"dijit/ColorPalette":function(){define("require dojo/text!./templates/ColorPalette.html ./_Widget ./_TemplatedMixin ./_PaletteMixin ./hccss dojo/i18n dojo/_base/Color dojo/_base/declare dojo/dom-construct dojo/string dojo/i18n!dojo/nls/colors dojo/colors".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d){var q=a("dijit.ColorPalette",[e,p,m],{palette:"7x10",_palettes:{"7x10":["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "),"lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "),"silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "),"gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),
"dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "),"darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "),"black darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")],"3x4":[["white","lime","green","blue"],["silver","yellow","fuchsia","navy"],["gray","red","purple","black"]]},templateString:r,baseClass:"dijitColorPalette",_dyeFactory:function(a,c,b,d){return new this._dyeClass(a,
c,b,d)},buildRendering:function(){this.inherited(arguments);this._dyeClass=a(q._Color,{palette:this.palette});this._preparePalette(this._palettes[this.palette],s.getLocalization("dojo","colors",this.lang))}});q._Color=a("dijit._Color",h,{template:"\x3cspan class\x3d'dijitInline dijitPaletteImg'\x3e\x3cimg src\x3d'${blankGif}' alt\x3d'${alt}' title\x3d'${title}' class\x3d'dijitColorPaletteSwatch' style\x3d'background-color: ${color}'/\x3e\x3c/span\x3e",hcTemplate:"\x3cspan class\x3d'dijitInline dijitPaletteImg' style\x3d'position: relative; overflow: hidden; height: 12px; width: 14px;'\x3e\x3cimg src\x3d'${image}' alt\x3d'${alt}' title\x3d'${title}' style\x3d'position: absolute; left: ${left}px; top: ${top}px; ${size}'/\x3e\x3c/span\x3e",
_imagePaths:{"7x10":k.toUrl("./themes/a11y/colors7x10.png"),"3x4":k.toUrl("./themes/a11y/colors3x4.png")},constructor:function(a,c,b,d){this._title=d;this._row=c;this._col=b;this.setColor(h.named[a])},getValue:function(){return this.toHex()},fillCell:function(a,c){var b=d.substitute(n("highcontrast")?this.hcTemplate:this.template,{color:this.toHex(),blankGif:c,alt:this._title,title:this._title,image:this._imagePaths[this.palette].toString(),left:-20*this._col-5,top:-20*this._row-5,size:"7x10"==this.palette?
"height: 145px; width: 206px":"height: 64px; width: 86px"});f.place(b,a)}});return q})},"dgrid/Grid":function(){define("dojo/_base/declare dojo/_base/kernel dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(k,r,e,p,m,n,s){function h(a,e){e&&e.nodeType&&a.appendChild(e)}k=k(n,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!==typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,e){if(a.column&&
a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var d;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var h=a.columnId;if(h){e=h;d=a;break}a=a.parentNode}while(a&&a!==this.domNode)}if(!d&&"undefined"!==typeof e){var l=this.row(a);if(h=l&&l.element)for(var h=h.getElementsByTagName("td"),c=0;c<h.length;c++)if(h[c].columnId===e){d=h[c];break}}if(null!=a)return{row:l||this.row(a),column:e&&this.column(e),element:d}},createRowCells:function(a,e,d,h){var l=m("table.dgrid-row-table[role\x3dpresentation]"),
c=9>p("ie")?m(l,"tbody"):l,b,k,g,n,r,F,v,D,A,z;d=d||this.subRows;k=0;for(g=d.length;k<g;k++){F=d[k];b=m(c,"tr");F.className&&m(b,"."+F.className);n=0;for(r=F.length;n<r;n++){v=F[n];D=v.id;A=v.field?".field-"+s.escapeCssIdentifier(v.field,"-"):"";(z="function"===typeof v.className?v.className(h):v.className)&&(A+="."+z);A=m(a+".dgrid-cell"+(D?".dgrid-column-"+s.escapeCssIdentifier(D,"-"):"")+A.replace(/ +/g,".")+"[role\x3d"+("th"===a?"columnheader":"gridcell")+"]");A.columnId=D;if(D=v.colSpan)A.colSpan=
D;if(D=v.rowSpan)A.rowSpan=D;e(A,v);b.appendChild(A)}}return l},left:function(a,e){a.element||(a=this.cell(a));return this.cell(this._move(a,-(e||1),"dgrid-cell"))},right:function(a,e){a.element||(a=this.cell(a));return this.cell(this._move(a,e||1,"dgrid-cell"))},_defaultRenderCell:function(a,e,d){if(this.formatter){var h=this.formatter,l=this.grid.formatterScope;d.innerHTML="string"===typeof h&&l?l[h](e,a):this.formatter(e,a)}else null!=e&&d.appendChild(document.createTextNode(e))},renderRow:function(a,
e){var d=this,k=this.createRowCells("td",function(l,c){var b=a;c.get?b=c.get(a):"field"in c&&"_item"!==c.field&&(b=b[c.field]);c.renderCell?h(l,c.renderCell(a,b,l,e)):d._defaultRenderCell.call(c,a,b,l,e)},e&&e.subRows,a);return m("div[role\x3drow]\x3e",k)},renderHeader:function(){var a=this,f=this.headerNode,d=f.childNodes.length;for(f.setAttribute("role","row");d--;)m(f.childNodes[d],"!");d=this.createRowCells("th",function(a,d){var c=d.headerNode=a,b=d.field;b&&(a.field=b);if(d.renderHeaderCell)h(c,
d.renderHeaderCell(c));else if("label"in d||d.field)c.appendChild(document.createTextNode("label"in d?d.label:d.field));!1!==d.sortable&&(b&&"_item"!==b)&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[d.id=this.id+"-header"]=this.columns;f.appendChild(d);this._sortListener&&this._sortListener.remove();this._sortListener=e(d,"click,keydown",function(d){if("click"===d.type||32===d.keyCode||!p("opera")&&13===d.keyCode){var h=d.target,c,b,k;
do if(h.sortable){k=[{property:c=h.field||h.columnId,descending:(b=a.sort[0])&&b.property===c&&!b.descending}];c={bubbles:!0,cancelable:!0,grid:a,parentType:d.type,sort:k};e.emit(d.target,"dgrid-sort",c)&&(a._sortNode=h,a.set("sort",k));break}while((h=h.parentNode)&&h!==f)}})},resize:function(){var a=this.headerNode.firstChild,e=this.contentNode,d;this.inherited(arguments);e.style.width="";if(e&&a&&(d=a.offsetWidth)>e.offsetWidth)e.style.width=d+"px"},destroy:function(){this._destroyColumns();this._sortListener&&
this._sortListener.remove();this.inherited(arguments)},_setSort:function(){this.inherited(arguments);this.updateSortArrow(this.sort)},_findSortArrowParent:function(a){var e=this.columns,d;for(d in e){var h=e[d];if(h.field===a)return h.headerNode}},updateSortArrow:function(a,e){this._lastSortedArrow&&(m(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),m(this._lastSortedArrow,"!"),delete this._lastSortedArrow);e&&(this.sort=a);if(a[0]){var d=a[0].property,h=a[0].descending,d=this._sortNode||
this._findSortArrowParent(d),l;delete this._sortNode;d&&(d=d.contents||d,l=this._lastSortedArrow=m("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),l.innerHTML="\x26nbsp;",d.insertBefore(l,d.firstChild),m(d,h?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(a,e){return this.addCssRule("#"+s.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+s.escapeCssIdentifier(a,"-"),e)},_configColumns:function(a,e){var d=[],h=e instanceof Array;s.each(e,function(l,c){"string"===
typeof l&&(e[c]=l={label:l});!h&&!l.field&&(l.field=c);c=l.id=l.id||(isNaN(c)?c:a+c);this._configColumn&&(this._configColumn(l,e,a),c=l.id);h&&(this.columns[c]=l);l.grid=this;"function"===typeof l.init&&(r.deprecated("colum.init","Column plugins are being phased out in favor of mixins for better extensibility. column.init may be removed in a future release."),l.init());d.push(l)},this);return h?e:d},_destroyColumns:function(){var a=this.subRows,e=a&&a.length,d,h,l,c;this.cleanup();for(d=0;d<e;d++){h=
0;for(c=a[d].length;h<c;h++)l=a[d][h],"function"===typeof l.destroy&&(r.deprecated("colum.destroy","Column plugins are being phased out in favor of mixins for better extensibility. column.destroy may be removed in a future release."),l.destroy())}},configStructure:function(){var a=this.subRows,e=this._columns=this.columns;this.columns=!e||e instanceof Array?{}:e;if(a)for(e=0;e<a.length;e++)a[e]=this._configColumns(e+"-",a[e]);else this.subRows=[this._configColumns("",e)]},_getColumns:function(){return this._columns||
this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this.sort.length?this.updateSortArrow(this.sort):this.resize())}});k.appendIfNode=h;return k})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),
function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t){return k("dijit._HasDropDown",t,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(a){!this.disabled&&!this.readOnly&&("MSPointerDown"!=a.type&&"pointerdown"!=a.type&&a.preventDefault(),this.own(d.once(this.ownerDocument,q.release,f.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},
_onDropDownMouseUp:function(a){var b=this.dropDown,c=!1;if(a&&this._opened){var d=n.position(this._buttonNode,!0);if(!(a.pageX>=d.x&&a.pageX<=d.x+d.w)||!(a.pageY>=d.y&&a.pageY<=d.y+d.h)){for(d=a.target;d&&!c;)m.contains(d,"dijitPopup")?c=!0:d=d.parentNode;if(c){d=a.target;if(b.onItemClick){for(var e;d&&!(e=l.byNode(d));)d=d.parentNode;if(e&&e.onClick&&e.getParent)e.getParent().onItemClick(e,a)}return}}}if(this._opened){if(b.focus&&(!1!==b.autoFocus||"mouseup"==a.type&&!this.hovering))this._focusDropDownTimer=
this.defer(function(){b.focus();delete this._focusDropDownTimer})}else this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",
left:"Left",right:"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";m.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},postCreate:function(){this.inherited(arguments);var a=this.focusNode||this.domNode;this.own(d(this._buttonNode,q.press,f.hitch(this,"_onDropDownMouseDown")),d(this._buttonNode,"click",f.hitch(this,"_onDropDownClick")),d(a,"keydown",f.hitch(this,"_onKey")),d(a,"keyup",f.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);
this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),delete this.dropDown);this.inherited(arguments)},_onKey:function(b){if(!this.disabled&&!this.readOnly){var c=this.dropDown,d=b.target;if(c&&(this._opened&&c.handleKey)&&!1===c.handleKey(b))b.stopPropagation(),b.preventDefault();else if(c&&this._opened&&b.keyCode==a.ESCAPE)this.closeDropDown(),b.stopPropagation(),b.preventDefault();else if(!this._opened&&(b.keyCode==a.DOWN_ARROW||(b.keyCode==a.ENTER||b.keyCode==a.SPACE&&(!this._searchTimer||
b.ctrlKey||b.altKey||b.metaKey))&&("input"!==(d.tagName||"").toLowerCase()||d.type&&"text"!==d.type.toLowerCase())))this._toggleOnKeyUp=!0,b.stopPropagation(),b.preventDefault()}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(f.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=
new r,b=f.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});this.isLoaded()?b():this.loadDropDown(b);return a},toggleDropDown:function(){!this.disabled&&!this.readOnly&&(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,c=a.domNode,d=this._aroundNode||this.domNode,e=this,h=b.open({parent:this,popup:a,around:d,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){e.closeDropDown(!0)},onCancel:function(){e.closeDropDown(!0)},
onClose:function(){p.set(e._popupStateNode,"popupActive",!1);m.remove(e._popupStateNode,"dijitHasDropDownOpen");e._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&d.offsetWidth>a._popupWrapper.offsetWidth){var d=d.offsetWidth-a._popupWrapper.offsetWidth,l={w:a.domNode.offsetWidth+d};f.isFunction(a.resize)?a.resize(l):n.setMarginBox(c,l);"R"==h.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-d+"px")}p.set(this._popupStateNode,"popupActive","true");m.add(this._popupStateNode,
"dijitHasDropDownOpen");this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"!==c.getAttribute("role")&&!c.getAttribute("aria-labelledby")&&c.setAttribute("aria-labelledby",this.id);return h},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),
b.close(this.dropDown),this._opened=!1)}})})},"webSceneViewer/widgets/ScrollBar/ScrollBar":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ScrollBar.html dojo/_base/lang esri/core/domUtils dojo/on dojo/has dojo/dom-class".split(" "),function(k,r,e,p,m,n,s,h,a){var f=[],d=function(a,b,d){f.push(s(a,d,function(a){a.preventDefault();a.stopPropagation();var c=document.createEvent("MouseEvent");c.initMouseEvent(d,a.bubbles,a.cancelable,window,a.detail,
a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget);a.wheelDelta&&(c.wheelDelta=a.wheelDelta);b.dispatchEvent(c)}))},q=function(a){a.stopPropagation();var b=a.changedTouches[0],d="";if(!(1<a.touches.length)){switch(a.type){case "touchstart":d="mousedown";break;case "touchmove":d="mousemove";break;case "touchend":var d="mouseup",e=document.createEvent("MouseEvent");e.initMouseEvent("click",!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,
!1,!1,!1,!1,0,null);b.target.dispatchEvent(e);a.preventDefault();break;default:return}e=document.createEvent("MouseEvent");e.initMouseEvent(d,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(e);a.preventDefault()}},l=function(a){a&&a.stopPropagation();return!1};return k([r,e],{templateString:p,scrollTarget:void 0,view:void 0,_onHandles:void 0,constructor:function(a,b){this._onHandles=[]},destroy:function(){this._onHandles.forEach(function(a){a.remove()});
f.forEach(function(a){a.remove()});this._viewPortResize&&this._viewPortResize.remove();this.scrollTarget.removeEventListener("click",l,!0);this.scrollTarget.removeEventListener("mousedown",m.hitch(this,function(){this._stopScrollTargetDragging(event)}),!0);this.scrollTarget.removeEventListener("touchmove",q,!0);this.scrollTarget.removeEventListener("touchstart",q,!0);this.scrollTarget.removeEventListener("touchend",q,!0);this.scrollTarget.removeEventListener("touchcancel",q,!0)},postCreate:function(){this.PAGE_Y=
(this.vertical=!1,"pageX");this.DIMENSION=this.vertical?"height":"width";this.OFFSET_DIMENSION=this.vertical?"offsetHeight":"offsetWidth";this.TOP=this.vertical?"top":"left";a.contains(dojo.doc.body.parentNode,"esriRtl")&&(this.TOP=this.vertical?"top":"right");this.wheelDir=this.vertical?-1:1;this.min=this.mousePosRelativeToHandle=this.state=this.relativeSliderPosition=0;this.max=1;this.originMousePos=this.easing=0;this._updatePosition(this.relativeSliderPosition,!0);this._viewPortResize=this.view.on("resize",
m.hitch(this,function(){this._updatePosition(this.relativeSliderPosition,!0);this.updateWidth()}));this._setupEventHandlers()},_startScrollTargetDragging:function(c){this.scrollTarget.removeEventListener("click",l,!0);document.addEventListener("mouseup",m.hitch(this,function(a){this._stopScrollTargetDragging(a)}),!0);c=c||window.event;c.preventDefault();this.originMousePos=c.clientX;this.startMouseCoords={x:0,y:0};this.startMouseCoords.x=c.clientX;this.startMouseCoords.y=c.clientY;document.onmousemove=
m.hitch(this,function(b){this.scrollTarget.removeEventListener("click",l,!0);if(!(3>Math.abs(Math.abs(b.clientX)-Math.abs(this.startMouseCoords.x))&&1>Math.abs(Math.abs(b.clientY)-Math.abs(this.startMouseCoords.y)))){this.scrollTarget.addEventListener("click",l,!0);b=b||window.event;b.preventDefault();b=b.clientX;var c=this.originMousePos-b;a.contains(dojo.doc.body.parentNode,"esriRtl")&&(c=-c);this.originMousePos=b;this._updatePosition(this._calcRelativePosition(this._calcPosition(this.relativeSliderPosition)+
c));return!1}})},_stopScrollTargetDragging:function(a){document.onmousemove=function(){};a.preventDefault()},_setupEventHandlers:function(){var c=s(this.scrollBarSpace,"click",m.hitch(this,function(a){a.preventDefault();this.updateWidth();this._updatePosition((a[this.PAGE_Y]-this.scrollBarContainer.getBoundingClientRect()[this.TOP])/this._getDimension());a.stopPropagation()}));this._onHandles.push(c);c=s(this.scrollTarget,void 0===h("mozilla")?"mousewheel":"DOMMouseScroll",m.hitch(this,function(a){a.preventDefault();
a.stopPropagation();a=void 0===h("mozilla")?a.wheelDelta:-60*a.detail;this._updatePosition((this._getAbsoluteDimension()-a/(12*this.wheelDir))/this._getTrackDimension())}));this._onHandles.push(c);c=s(this.scrollBarHandleHitArea,"mousedown",m.hitch(this,function(b){b.preventDefault();b.stopPropagation();1==b.which&&(this.state=1,a.contains(dojo.doc.body.parentNode,"esriRtl")?this.mousePosRelativeToHandle=Math.min(this.scrollBarHandleHitArea[this.OFFSET_DIMENSION],Math.max(0,-b[this.PAGE_Y]+this.scrollBarHandleHitArea.getClientRects()[0][this.TOP])):
this.mousePosRelativeToHandle=Math.min(this.scrollBarHandleHitArea[this.OFFSET_DIMENSION],Math.max(0,b[this.PAGE_Y]-this.scrollBarHandleHitArea.getClientRects()[0][this.TOP])))}));this._onHandles.push(c);c=s(document,"mousemove",m.hitch(this,function(b){1==this.state&&(b.preventDefault(),a.contains(dojo.doc.body.parentNode,"esriRtl")?this._updatePosition((this.scrollBarContainer.getBoundingClientRect()[this.TOP]-b[this.PAGE_Y]-this.mousePosRelativeToHandle)/this._getTrackDimension()):this._updatePosition((b[this.PAGE_Y]-
this.scrollBarContainer.getBoundingClientRect()[this.TOP]-this.mousePosRelativeToHandle)/this._getTrackDimension()))}));this._onHandles.push(c);c=s(document,"mouseup",m.hitch(this,function(a){1==this.state&&(a.preventDefault(),this.state=0)}));this._onHandles.push(c);d(this.scrollBarContainer,this.scrollTarget,void 0===h("mozilla")?"mousewheel":"DOMMouseScroll")},_calcRelativePosition:function(a){return a/(this.scrollTarget.scrollWidth-this.scrollTarget.offsetWidth)},_calcPosition:function(a){return a*
(this.scrollTarget.scrollWidth-this.scrollTarget.offsetWidth)},_getDimension:function(){return this.scrollBarContainer[this.OFFSET_DIMENSION]},_getTrackDimension:function(){return this.scrollBarHandleContainer[this.OFFSET_DIMENSION]},_getAbsoluteDimension:function(){return Math.round(this._getTrackDimension()*this.relativeSliderPosition)},_updatePosition:function(a,b,d){this.relativeSliderPosition=Math.min(Math.max(a,0.0010),0.999);this.scrollBarHandleHitArea.style[this.TOP]=this._getAbsoluteDimension()-
this.scrollBarHandleHitArea[this.OFFSET_DIMENSION]/2+"px";b||this._scrollTo(this.relativeSliderPosition)},_scrollTo:function(c){var b=this.scrollTarget.scrollWidth-this.scrollTarget.offsetWidth;c=Math.ceil(c*b);c=c<=b?c:b;c=0<c?c:0;if(a.contains(dojo.doc.body.parentNode,"esriRtl"))if(h("mozilla"))c=-c;else if(h("chrome")||h("safari"))c=b-c;this.scrollTarget.scrollLeft=c},setRange:function(a,b){this.min=a;this.max=b},get:function(){return this.relativeSliderPosition},set:function(a,b){0===this.state&&
this.updatePos(a,b)},setInRange:function(a){this.set((a-this.min)/(this.max-this.min))},enableScrollTargetDrag:function(){this.scrollTarget&&(this.scrollTarget.addEventListener("mousedown",m.hitch(this,function(a){this._startScrollTargetDragging(a)}),!0),this.scrollTarget.addEventListener("touchmove",q,!0),this.scrollTarget.addEventListener("touchstart",q,!0),this.scrollTarget.addEventListener("touchend",q,!0),this.scrollTarget.addEventListener("touchcancel",q,!0))},disableScrollTargetDrag:function(){this.scrollTarget&&
(this.scrollTarget.removeEventListener("mousedown",m.hitch(this,function(a){this._stopScrollTargetDragging(a)}),!0),this.scrollTarget.removeEventListener("touchmove",q,!0),this.scrollTarget.removeEventListener("touchstart",q,!0),this.scrollTarget.removeEventListener("touchend",q,!0),this.scrollTarget.removeEventListener("touchcancel",q,!0))},resize:function(){this.scrollBarHandleContainer.style[this.DIMENSION]=this._getDimension()+"px";this.scrollBarSpace.style[this.DIMENSION]=this._getDimension()+
"px";this.scrollBarHandleHitArea.getClientRects()[0]&&(this.scrollBarHandleContainer.style[this.DIMENSION]=this._getDimension()-this.scrollBarHandleHitArea.getClientRects()[0][this.DIMENSION]+"px");this._updatePosition(this.relativeSliderPosition)},updateWidth:function(){var a=0.2*this.scrollTarget.offsetWidth,a=Math.max(Math.min(this.scrollTarget.offsetWidth-(this.scrollTarget.scrollWidth-this.scrollTarget.offsetWidth),0.5*this.scrollTarget.offsetWidth),a);this.scrollBarHandleHitArea.style.width=
a+"px";16>this.scrollTarget.scrollWidth-this.scrollTarget.offsetWidth?n.hide(this.scrollBarHandleHitArea):n.show(this.scrollBarHandleHitArea);this.resize()}})})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),function(k,r,e,p,m,n,s,h,a,f,d,q,l){return m("dijit.form._FormSelectWidget",
l,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,onLoadDeferred:null,getOptions:function(c){var b=this.options||[];if(null==
c)return b;if(a.isArray(c))return k.map(c,"return this.getOptions(item);",this);a.isString(c)&&(c={value:c});a.isObject(c)&&(k.some(b,function(a,b){for(var d in c)if(!(d in a)||a[d]!=c[d])return!1;c=b;return!0})||(c=-1));return 0<=c&&c<b.length?b[c]:null},addOption:function(c){k.forEach(a.isArray(c)?c:[c],function(b){b&&a.isObject(b)&&this.options.push(b)},this);this._loadChildren()},removeOption:function(c){c=this.getOptions(a.isArray(c)?c:[c]);k.forEach(c,function(a){a&&(this.options=k.filter(this.options,
function(c){return c.value!==a.value||c.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(c){k.forEach(a.isArray(c)?c:[c],function(a){var c=this.getOptions({value:a.value}),d;if(c)for(d in a)c[d]=a[d]},this);this._loadChildren()},setStore:function(a,b,d){h.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,b,d)},_deprecatedSetStore:function(c,b,f){var g=this.store;f=f||{};if(g!==c){for(var h;h=this._notifyConnections.pop();)h.remove();c.get||(a.mixin(c,{_oldAPI:!0,get:function(a){var b=new r;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(b,c){var d=new r(function(){e.abort&&e.abort()});d.total=new r;var e=this.fetch(a.mixin({query:b,onBegin:function(a){d.total.resolve(a)},
onComplete:function(a){d.resolve(a)},onError:function(a){d.reject(a)}},c));return new q(d)}}),c.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[e.after(c,"onNew",a.hitch(this,"_onNewItem"),!0),e.after(c,"onDelete",a.hitch(this,"_onDeleteItem"),!0),e.after(c,"onSet",a.hitch(this,"_onSetItem"),!0)]));this._set("store",c)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);f.query&&this._set("query",f.query);f.queryOptions&&this._set("queryOptions",f.queryOptions);c&&c.query&&(this._loadingStore=!0,this.onLoadDeferred=new r,this._queryRes=c.query(this.query,this.queryOptions),d(this._queryRes,a.hitch(this,function(d){if(this.sortByLabel&&!f.sort&&d.length)if(c.getValue)d.sort(p.createSortFunction([{attribute:c.getLabelAttributes(d[0])[0]}],c));else{var e=this.labelAttr;d.sort(function(a,b){return a[e]>b[e]?1:b[e]>
a[e]?-1:0})}f.onFetch&&(d=f.onFetch.call(this,d,f));k.forEach(d,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(a.hitch(this,function(a,b,c){b==c?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=c&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:b);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(d):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)}));return g},_setValueAttr:function(c,b){this._onChangeActive||(b=null);if(this._loadingStore)this._pendingValue=c;else if(null!=c){c=a.isArray(c)?k.map(c,function(b){return a.isObject(b)?b:{value:b}}):a.isObject(c)?[c]:[{value:c}];c=k.filter(this.getOptions(c),function(a){return a&&a.value});var d=this.getOptions()||[];if(!this.multiple&&(!c[0]||!c[0].value)&&d.length)c[0]=d[0];k.forEach(d,
function(a){a.selected=k.some(c,function(b){return b.value===a.value})});d=k.map(c,function(a){return a.value});if(!("undefined"==typeof d||"undefined"==typeof d[0])){var e=k.map(c,function(a){return a.label});this._setDisplay(this.multiple?e:e[0]);this.inherited(arguments,[this.multiple?d:d[0],b]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=k.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?a:a[0]},
_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(k.forEach(this._getChildren(),function(a){a.destroyRecursive()}),k.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var b=this;k.forEach(this._getChildren(),function(d){var e=k.some(a,function(a){return d.option&&
a===d.option.value});e&&!b.multiple&&(b.focusedChild=d);s.toggle(d.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),e);d.domNode.setAttribute("aria-selected",e?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var b=k.filter(a,function(a){return a.selected})[0];if(b&&b.value)return b.value;a[0].selected=!0;return a[0].value}return this.multiple?k.map(k.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,b){(!b||!b.parent)&&this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var b=this.store,d=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:b.getLabel(a);return{value:d?b.getIdentity(a):null,label:d,item:a}},_addOptionForItem:function(a){var b=this.store;b.isItemLoaded&&!b.isItemLoaded(a)?b.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);n.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?f("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+h._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);e.after(this,"onChange",a.hitch(this,"_updateSelection"));var c=this.store;if(c&&(c.getIdentity||c.getFeatures()["dojo.data.api.Identity"]))this.store=null,this._deprecatedSetStore(c,this._oValue,
{query:this.query,queryOptions:this.queryOptions});this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main".split(" "),function(k,r,e,p,m,n,s,h,a,f,d,q,l,c,b,t){function g(){this._popupWrapper&&(n.destroy(this._popupWrapper),delete this._popupWrapper)}
e=e(null,{_stack:[],_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var a=this._firstAroundPosition,b=s.position(this._firstAroundNode,!0),c=b.x-a.x,a=b.y-a.y;if(c||a){this._firstAroundPosition=b;for(b=0;b<this._stack.length;b++){var e=this._stack[b].wrapper.style;e.top=parseFloat(e.top)+a+"px";"auto"==e.right?e.left=parseFloat(e.left)+c+"px":e.right=parseFloat(e.right)-c+"px"}}this._aroundMoveListener=setTimeout(d.hitch(this,"_repositionAll"),c||a?10:50)}},_createWrapper:function(a){var b=
a._popupWrapper,c=a.domNode;b||(b=n.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":a["aria-label"]||a.label||a.name||a.id},a.ownerDocumentBody),b.appendChild(c),c=c.style,c.display="",c.visibility="",c.position="",c.top="0px",a._popupWrapper=b,r.after(a,"destroy",g,!0),"ontouchend"in document&&q(b,"touchend",function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}));return b},moveOffScreen:function(a){var b=this._createWrapper(a);a=
s.isBodyLtr(a.ownerDocument);var c={visibility:"hidden",top:"-9999px",display:""};c[a?"left":"right"]="-9999px";c[a?"right":"left"]="auto";h.set(b,c);return b},hide:function(a){var b=this._createWrapper(a);h.set(b,{display:"none",height:"auto",overflow:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},getTopPopup:function(){for(var a=this._stack,b=a.length-1;0<b&&a[b].parent===a[b-1].widget;b--);return a[b]},open:function(e){for(var g=this._stack,k=e.popup,
n=k.domNode,r=e.orient||["below","below-alt","above","above-alt"],t=e.parent?e.parent.isLeftToRight():s.isBodyLtr(k.ownerDocument),z=e.around,E=e.around&&e.around.id?e.around.id+"_dropdown":"popup_"+this._idGen++;g.length&&(!e.parent||!p.isDescendant(e.parent.domNode,g[g.length-1].widget.domNode));)this.close(g[g.length-1].widget);var w=this.moveOffScreen(k);k.startup&&!k._started&&k.startup();var x,G=s.position(n);if("maxHeight"in e&&-1!=e.maxHeight)x=e.maxHeight||Infinity;else{x=b.getEffectiveBox(this.ownerDocument);
var H=z?s.position(z,!1):{y:e.y-(e.padding||0),h:2*(e.padding||0)};x=Math.floor(Math.max(H.y,x.h-(H.y+H.h)))}G.h>x&&(G=h.getComputedStyle(n),h.set(w,{overflowY:"scroll",height:x+"px",border:G.borderLeftWidth+" "+G.borderLeftStyle+" "+G.borderLeftColor}),n._originalStyle=n.style.cssText,n.style.border="none");m.set(w,{id:E,style:{zIndex:this._beginZIndex+g.length},"class":"dijitPopup "+(k.baseClass||k["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:e.parent?e.parent.id:""});0==g.length&&z&&(this._firstAroundNode=
z,this._firstAroundPosition=s.position(z,!0),this._aroundMoveListener=setTimeout(d.hitch(this,"_repositionAll"),50));a("config-bgIframe")&&!k.bgIframe&&(k.bgIframe=new c(w));E=k.orient?d.hitch(k,"orient"):null;r=z?l.around(w,z,r,t,E):l.at(w,e,"R"==r?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],e.padding,E);w.style.visibility="visible";n.style.visibility="visible";n=[];n.push(q(w,"keydown",d.hitch(this,function(a){if(a.keyCode==f.ESCAPE&&e.onCancel)a.stopPropagation(),a.preventDefault(),e.onCancel();
else if(a.keyCode==f.TAB&&(a.stopPropagation(),a.preventDefault(),(a=this.getTopPopup())&&a.onCancel))a.onCancel()})));k.onCancel&&e.onCancel&&n.push(k.on("cancel",e.onCancel));n.push(k.on(k.onExecute?"execute":"change",d.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));g.push({widget:k,wrapper:w,parent:e.parent,onExecute:e.onExecute,onCancel:e.onCancel,onClose:e.onClose,handlers:n});if(k.onOpen)k.onOpen(r);return r},close:function(a){for(var b=this._stack;a&&k.some(b,
function(b){return b.widget==a})||!a&&b.length;){var c=b.pop(),d=c.widget,e=c.onClose;d.bgIframe&&(d.bgIframe.destroy(),delete d.bgIframe);if(d.onClose)d.onClose();for(var f;f=c.handlers.pop();)f.remove();d&&d.domNode&&this.hide(d);e&&e()}0==b.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return t.popup=new e})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),
function(k,r,e,p,m,n){return r("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var e=[];m("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(p.hitch(this,function(h){h.name==this.name&&h.form==this.focusNode.form&&(h=n.getEnclosingWidget(h))&&e.push(h)}));return e},_setCheckedAttr:function(e){this.inherited(arguments);this._created&&e&&k.forEach(this._getRelatedWidgets(),p.hitch(this,function(e){e!=this&&e.checked&&e.set("checked",!1)}))},_getSubmitValue:function(e){return null==
e?"on":e},_onClick:function(m){return this.checked||this.disabled?(m.stopPropagation(),m.preventDefault(),!1):this.readOnly?(m.stopPropagation(),m.preventDefault(),k.forEach(this._getRelatedWidgets(),p.hitch(this,function(h){e.set(this.focusNode||this.domNode,"checked",h.checked)})),!1):this.inherited(arguments)}})})},"webSceneViewer/widgets/SymbologyEditor/BaseSymbolLayerEditor":function(){define("esri/core/declare dojo/keys dojo/dom-class dojo/dom-style dojo/query esri/geometry/ScreenPoint dojo/i18n!../nls/widgets".split(" "),
function(k,r,e,p,m,n,s){function h(a){a="#"==a.charAt(0)?a.substring(1,7):a;var e=parseInt(a.substring(0,2),16),d=parseInt(a.substring(2,4),16);a=parseInt(a.substring(4,6),16);return[e,d,a]}return k([],{view:void 0,layer:void 0,dimensionType:void 0,colorTitle:void 0,sizeTitle:void 0,_initialSize:void 0,_setDimensionTypeAttr:function(a){a!==this.dimensionType&&(this.sizeText&&(this.sizeText.textContent=this.sizeTitle+" ("+("2d"===a?s.symbologyEditor.px:s.symbologyEditor.meters)+")"),this.extrusionHeightInput&&
("3d"===a?(e.remove(this.extrusionHeightInput.domNode,"hide"),e.remove(this.extrusionHeightText,"hide")):(e.add(this.extrusionHeightInput.domNode,"hide"),e.add(this.extrusionHeightText,"hide"))),this._set("dimensionType",a),this._set("dimensionType",a),this._initialSize&&this.updateOptimal3DSize(),this.updateUIFromSelectedValues(),this.updateSymbolLayerFromUI())},symbolLayer:void 0,constructor:function(a,e){this._selectedShape={"2d":"circle","3d":"sphere"};this._selectedColor={"2d":[50,205,50],"3d":[50,
205,50]};this._selectedSize={"2d":16,"3d":50};this._selectedTransparency={"2d":0,"3d":0};this._selectedOutlineColor={"2d":[0,0,0],"3d":[0,0,0]};this._selectedOutlineSize={"2d":1,"3d":1};this._selectedOutlineTransparency={"2d":0,"3d":0};this._initialSize=!0;this._readLayerSymbology(a.layer.renderer)},destroy:function(){this.inherited(arguments);this.layer=null},_initUIStrings:function(){void 0===this.colorTitle&&(this.colorTitle=s.symbologyEditor.color);void 0===this.sizeTitle&&(this.sizeTitle=s.symbologyEditor.size);
this.extrusionHeightInput&&"2d"===this.dimensionType&&(e.add(this.extrusionHeightInput.domNode,"hide"),e.add(this.extrusionHeightText,"hide"));this.extrusionHeightText&&(this.extrusionHeightText.textContent=s.symbologyEditor.extrusion);this.shapeText&&(this.shapeText.textContent=s.symbologyEditor.shape);this.colorText&&(this.colorText.textContent=this.colorTitle);this.sizeText&&(this.sizeText.textContent=this.sizeTitle+" ("+("2d"===this.dimensionType?s.symbologyEditor.px:s.symbologyEditor.meters)+
")");this.transparencyText&&(this.transparencyText.textContent=s.symbologyEditor.transparency);this.outlineSizeText&&(this.outlineSizeText.textContent=s.symbologyEditor.outlineSize+" ("+("2d"===this.dimensionType?s.symbologyEditor.px:s.symbologyEditor.meters)+")");this.OutlineTransparencyText&&(this.OutlineTransparencyText.textContent=s.symbologyEditor.transparency);this.outlineColorText&&(this.outlineColorText.textContent=s.symbologyEditor.outlineColor)},setSelectedColor:function(a){this._setColorSwatch(a,
this.getSelectedTransparency());this._selectedColor["2d"]=a;this._selectedColor["3d"]=a},getSelectedColor:function(){return this._selectedColor[this.dimensionType]},setSelectedTransparency:function(a,e){this.transparencyInput&&this.transparencyInput.get("value")!==a&&(e?this.transparencyInput._set("value",a):this.transparencyInput.set("value",a));this._setColorSwatch(this.getSelectedColor(),a);this._selectedTransparency["2d"]=a;this._selectedTransparency["3d"]=a},getSelectedTransparency:function(){return this._selectedTransparency[this.dimensionType]},
setSelectedSize:function(a,e){this.sizeInput&&this.sizeInput.get("value")!==a&&(e?this.sizeInput._set("value",a):this.sizeInput.set("value",a));this._selectedSize[this.dimensionType]=a},updateOptimal3DSize:function(){if("3d"===this.dimensionType){var a=this.view.pixelSizeAt(new n(0.5*this.view.width,0.5*this.view.height));0>=a&&(a=this.view.pixelSizeAt(new n(0.5*this.view.width,0.95*this.view.height)),0>=a&&(a=this.view.get("camera").position,a.z=0,a=2*this.view.pixelSizeAt(a)));this._initialSize=
!1;this._selectedSize[this.dimensionType]=this._roundToUserFriendly(10*a)}},getSelectedSize:function(){return this._selectedSize[this.dimensionType]},_roundToUserFriendly:function(a){return 10>=a?Math.round(10*a)/10:1E3>=a?Math.round(a):10*Math.round(a/10)},updateUIFromSelectedValues:function(){throw Error("this method must be implemented in a subclass");},updateSymbolLayerFromUI:function(){throw Error("this method must be implemented in a subclass");},_readLayerSymbology:function(a){throw Error("this method must be implemented in a subclass");
},_readColorFromSymbolLayer:function(a){a.material&&(a=a.material.get("color"),this._selectedColor["3d"]=a.toRgb(),this._selectedColor["2d"]=a.toRgb(),a=100*(1-a.a),this._selectedTransparency["3d"]=a,this._selectedTransparency["2d"]=a)},_setColorSwatch:function(a,e){var d=1-e/100;isNaN(d)&&(d=1);"string"!==typeof a&&(a="rgba("+a[0]+","+a[1]+","+a[2]+","+d+")");0<m(".colorSwatch",this.domNode).length?p.set(m(".colorSwatch",this.domNode)[0],"backgroundColor",a):setTimeout(function(){p.set(m(".colorSwatch",
this.domNode)[0],"backgroundColor",a)}.bind(this),200)},_onColorPaletteWidgetChange:function(a){this.selectedColorDropdown.closeDropDown();a!==this.getSelectedColor()&&(this.setSelectedColor(h(a)),this.updateSymbolLayerFromUI())},_updateSizeInputSelectedValue:function(){0>this.sizeInput.get("value")?this.sizeInput.set("value",this._selectedSize[this.dimensionType]):null!=this.sizeInput.get("value")&&this.sizeInput.get("value")!==this.getSelectedSize()&&(this.setSelectedSize(this.sizeInput.get("value")),
this.updateSymbolLayerFromUI())},_onSizeInputKeypressHandler:function(a){(a.charOrCode||a.keyCode)==r.ENTER&&this._updateSizeInputSelectedValue()},_updateTransparencyInputSelectedValue:function(){0>this.transparencyInput.get("value")||100<this.transparencyInput.get("value")?this.transparencyInput.set("value",this._selectedTransparency[this.dimensionType]):null!=this.transparencyInput.get("value")&&this.transparencyInput.get("value")!==this.getSelectedTransparency()&&(this.setSelectedTransparency(this.transparencyInput.get("value")),
this.updateSymbolLayerFromUI())},_onTransparencyInputKeypressHandler:function(a){(a.charOrCode||a.keyCode)==r.ENTER&&this._updateTransparencyInputSelectedValue()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(k,r){k.add("dom-contains",function(a,e,d){return!!d.contains});var e=[],p,m,n,s=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,h={defaultDelay:15,throttle:function(a,e,d){var k=!1;d=d||h.defaultDelay;return function(){k||(k=!0,a.apply(e,arguments),setTimeout(function(){k=
!1},d))}},throttleDelayed:function(a,e,d){var k=!1;d=d||h.defaultDelay;return function(){if(!k){k=!0;var h=arguments;setTimeout(function(){k=!1;a.apply(e,h)},d)}}},debounce:function(a,e,d){var k;d=d||h.defaultDelay;return function(){k&&(clearTimeout(k),k=null);var h=arguments;k=setTimeout(function(){a.apply(e,h)},d)}},each:function(a,e,d){var h,l;if(a)if("number"===typeof a.length){h=0;for(l=a.length;h<l;h++)e.call(d,a[h],h,a)}else for(h in a)e.call(d,a[h],h,a)},contains:function(a,e){return k("dom-contains")?
a.contains(e):a.compareDocumentPosition(e)&8},addCssRule:function(a,f){p||(p=r(document.getElementsByTagName("head")[0],"style"),p=p.sheet||p.styleSheet,m=p.deleteRule?"deleteRule":"removeRule",n=p.cssRules?"cssRules":"rules");var d=e.length;e[d]=(p.cssRules||p.rules).length;p.addRule?p.addRule(a,f):p.insertRule(a+"{"+f+"}",e[d]);return{get:function(a){return p[n][e[d]].style[a]},set:function(a,f){"undefined"!==typeof e[d]&&(p[n][e[d]].style[a]=f)},remove:function(){var a=e[d],f,c;if(void 0!==a){p[m](a);
e[d]=void 0;f=d+1;for(c=e.length;f<c;f++)e[f]>a&&e[f]--}}}},escapeCssIdentifier:function(a,e){return"string"===typeof a?a.replace(s,e||"\\$1"):a}};return h})},"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',"url:webSceneViewer/widgets/ScrollBar/templates/ScrollBar.html":'\x3cdiv data-dojo-attach-point\x3d"scrollBarContainer" class\x3d"scrollBarContainer"\x3e\r\n    \x3cdiv class\x3d"scrollBarSpace" data-dojo-attach-point\x3d"scrollBarSpace" \x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"scrollBarHandleContainer" class\x3d"scrollBarHandleContainer"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"scrollBarHandleHitArea" class\x3d"scrollBarHandleHitArea" \x3e\r\n            \x3cdiv class\x3d"scrollBarHandle" \x3e\r\n                \x3cdiv style\x3d"display: none;" class\x3d"handleT"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:webSceneViewer/widgets/LayerWidget/templates/LayerItemEditable.html":'\x3cdiv class\x3d"editable"\x3e\r\n  \x3cdiv class\x3d"LayerItem" data-dojo-attach-point\x3d"layerItemDomNode"\x3e\r\n    \x3cdiv class\x3d"layerItemIcon" data-dojo-attach-point\x3d"layerItemIcon"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"titleInlineEditBoxWrapper" data-dojo-attach-point\x3d"titleBox" title\x3d""\x3e\r\n      \x3cdiv class\x3d"titleInlineEditBox" data-dojo-attach-point\x3d"titleInlineEditBox" data-dojo-type\x3d"dijit/InlineEditBox" data-dojo-props\x3d"disabled:true,editor:\'dijit/form/ValidationTextBox\',editorParams:{regExp:\'\\[^\x3c\x3e]+\'}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layerEditButton" data-dojo-attach-point\x3d"layerEditButton"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:webSceneViewer/widgets/Dialog/templates/SaveDialog.html":'\x3cdiv class\x3d"dijitDialog saveDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title" role\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"0"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"ownerNode" class\x3d"ownershipText" \x3eowned by ...\x3c/div\x3e\r\n    \x3cdiv class\x3d"dijitDialogPaneContentArea"\x3e\r\n      \x3cdiv class\x3d"saveDialogContentNode"\x3e\r\n        \x3cdiv class\x3d"scenePropertiesNode"\x3e\r\n          \x3clabel for\x3d"${id}_thumbnailBox" data-dojo-attach-point\x3d"labelThumbnail" class\x3d"thumbnailLabel"\x3e\x3c/label\x3e\r\n          \x3ctable\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd colspan\x3d2 rowspan\x3d4\x3e\r\n                \x3cdiv class\x3d"thumbnailContainer"\x3e\r\n                  \x3cimg class\x3d"scenePropertiesInput thumbnail" data-dojo-attach-point\x3d"thumbnailBox" id\x3d"${id}_thumbnailBox" data-dojo-props\x3d"required: true"\x3e\r\n                  \x3cbutton class\x3d"thumbnailUpdateButton" data-dojo-type\x3d"dijit/form/Button" type\x3d"button" data-dojo-attach-event\x3d"click: _thumbnailUpdateClickHandler" data-dojo-attach-point\x3d"buttonThumbnailUpdate" data-dojo-props\x3d"iconClass:\'iconRefresh\', showLabel:false"\x3e\x3c/button\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3clabel for\x3d"${id}_titleTextBox" data-dojo-attach-point\x3d"labelTitle"\x3e\x3c/label\x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3cinput class\x3d"scenePropertiesInput marginBelow" data-dojo-attach-point\x3d"titleTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" id\x3d"${id}_titleTextBox" data-dojo-props\x3d"required: true, trim: false, maxLength: 100" \x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3clabel for\x3d"${id}_descriptionTextBox" data-dojo-attach-point\x3d"labelDescription"\x3e\x3c/label\x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3cinput class\x3d"scenePropertiesInput" data-dojo-attach-point\x3d"descriptionTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" id\x3d"${id}_descriptionTextBox" data-dojo-props\x3d"required: false, maxLength: 250"\x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/table\x3e\r\n          \x3cbr\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"labelTags" class\x3d"tagsLabel"\x3e\x3c/label\x3e\r\n          \x3cdiv class\x3d"dijitInline"  data-dojo-attach-point\x3d"tagsWidgetDiv" id\x3d"${id}_tagsTextBox"\x3e\x3c/div\x3e\r\n          \x3cbr\x3e\r\n          \x3cbr\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"labelLocation" class\x3d"locationLabel"\x3e\x3c/label\x3e\r\n          \x3cdiv class\x3d"locationToggleContainer" data-dojo-attach-point\x3d"locationToggleContainer"\x3e\r\n            \x3cdiv class\x3d"locationToggle"  data-dojo-attach-point\x3d"locationToggle"\x3e\r\n              \x3cdiv class\x3d"otherLocationDiv"  data-dojo-attach-point\x3d"otherLocationButton"\x3e\x3c/div\x3e\r\n              \x3cdiv class\x3d"myLocationDiv" data-dojo-attach-point\x3d"myLocationButton"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"locationHint" data-dojo-attach-point\x3d"hintLocation"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cbr\x3e\r\n          \x3cbr\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"saveInitialStateCheckBox" data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"${id}_saveInitialStateCheckBox"\x3e\r\n        \x3clabel for\x3d"${id}_saveInitialStateCheckBox" data-dojo-attach-point\x3d"labelSaveInitialState"\x3e\x3c/label\x3e\r\n        \x3cbr\x3e\r\n        \x3cbr\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"saveAsCheckBox" data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"${id}_saveAsCheckBox"\x3e\r\n        \x3clabel for\x3d"${id}_saveAsCheckBox" data-dojo-attach-point\x3d"labelSaveAs"\x3e\x3c/label\x3e\r\n        \x3cbr\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"dijitDialogPaneActionBar"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" type\x3d"submit" data-dojo-attach-event\x3d"click: _saveButtonClickHandler" data-dojo-attach-point\x3d"buttonSave"\x3e\x3c/button\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" type\x3d"button" data-dojo-attach-event\x3d"click: onCancel" title\x3d"${buttonCancel}" data-dojo-attach-point\x3d"buttonCancel"\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/DropDownButton.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d\'dijitReset dijitInline dijitButtonNode\'\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" data-dojo-attach-point\x3d"_buttonNode"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon"\r\n\t\t\t\tdata-dojo-attach-point\x3d"iconNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonInner"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonChar"\x3e\x26#9660;\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\tdata-dojo-attach-point\x3d"valueNode" role\x3d"presentation" aria-hidden\x3d"true"\r\n/\x3e\x3c/span\x3e\r\n',
"url:webSceneViewer/widgets/MessageListWidget/templates/MessageWidget.html":'\x3cdiv class\x3d"MessageWidget"  data-dojo-attach-event\x3d"click:_expand"\x3e\r\n    \x3cdiv class\x3d"" data-dojo-attach-point\x3d"MessageTypeIcon"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"MessageShortDesc" class \x3d "MessageTitle"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"MessageDetails" class \x3d "MessageContent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"closeIcon" data-dojo-attach-event\x3d"click:_remove"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"ExpandIcon" class\x3d"arrowIcon"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:webSceneViewer/editor/dijit/NavigatorContainer/templates/NavigatorContainer.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${baseClass}Inner" \x3e\r\n    \x3cdiv class\x3d"${baseClass}Head" data-dojo-attach-point\x3d"contentHeadNode"\x3e\r\n      \x3cdiv class\x3d"${baseClass}Title" data-dojo-attach-point\x3d"titleBarNode"\x3e\r\n        \x3cspan class\x3d"${baseClass}TitleTextNode" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${baseClass}Content"\x3e\r\n      \x3cdiv class\x3d"${baseClass}ContentInner" data-dojo-attach-point\x3d"contentInnerScrollableNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"contentNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${baseClass}NavButtons" data-dojo-attach-point\x3d"navButtonsNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${baseClass}ClosedContent" data-dojo-attach-event\x3d"ondijitclick:_closeBtnNodeClickHandler"\x3e\r\n    \x3cdiv class\x3d"closeBtnContainer"\x3e\r\n      \x3cspan class\x3d"${baseClass}CloseBtn" data-dojo-attach-point\x3d"closeBtnNode"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:webSceneViewer/widgets/Switch/templates/Switch.html":'\x3cdiv class\x3d"switch" data-dojo-attach-event\x3d"click:_toggleSwitch"\x3e\r\n    \x3cdiv class\x3d"switchContainer" data-dojo-attach-point\x3d"SwitchContainer"\x3e\r\n        \x3cdiv class\x3d"labelOn" data-dojo-attach-point\x3d"LabelOn"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"slider"\x3e\x3cdiv class\x3d"sliderInner"\x3e\x3c/div\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"labelOff" data-dojo-attach-point\x3d"LabelOff"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:webSceneViewer/widgets/OptionsMenu/templates/OptionsMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"optionsMenuContainer"\x3e\r\n    \x3cdiv class\x3d"OptionsMenu" data-dojo-attach-point\x3d"optionsMenu"\x3e\r\n      \x3cdiv class\x3d"dropdown-wrapper" data-dojo-attach-point\x3d"dropDownWrapper"\x3e\r\n        \x3ca data-dojo-attach-point\x3d"dropdownButton" href\x3d"#" class\x3d"dropdown"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/ColorPalette.html":'\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellSpacing\x3d"0" cellPadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e\r\n',"url:webSceneViewer/widgets/SymbologyEditor/templates/PointSymbolLayerEditor.html":'\x3cdiv\x3e\r\n  \x3ctable\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"shapeText" class\x3d"paneSectionTitle symbolLayerText"\x3e\x3c/td\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3cdiv class\x3d"iconDropdown"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"shapePickerDropdown" class\x3d"shapeButton" data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-props\x3d"dropDownPosition: [\'after-centered\']"\x3e\r\n            \x3cspan\x3e\x3c/span\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"shapePickerDomNode"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"sizeText" class\x3d"paneSectionTitle symbolLayerText"\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv class\x3d"numberText"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"sizeInput" data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" data-dojo-props\x3d"minimum: 0.001, maximum:99999999, className:\'sizeInputTextBox\'" data-dojo-attach-event\x3d"keypress:_onSizeInputKeypressHandler,change:_updateSizeInputSelectedValue"\x3e\x3c/input\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv class\x3d"colorButton" data-dojo-attach-point\x3d"selectedColorDropdown" data-dojo-type\x3d"dijit/form/DropDownButton"\x3e\r\n          \x3cspan \x3e\r\n            \x3cdiv class\x3d"colorSwatchContainer"\x3e\r\n              \x3cdiv class\x3d"colorSwatch"\x3e\x26nbsp;\x26nbsp;\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/span\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"colorPalette"\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/ColorPalette" data-dojo-attach-point\x3d"colorPaletteWidget" data-dojo-attach-event\x3d"change:_onColorPaletteWidgetChange"\x3e\x3c/div\x3e\r\n            \x3ctable class\x3d"transparencyTable"\x3e\r\n             \x3ctr\x3e\r\n              \x3ctd data-dojo-attach-point\x3d"transparencyText"\x3e\x3c/td\x3e\r\n              \x3ctd class\x3d"transparencyInputColumn"\x3e\r\n                \x3cdiv \x3e\r\n                  \x3cinput class\x3d"transparencyInput" data-dojo-attach-point\x3d"transparencyInput" data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" data-dojo-props\x3d"minimum: 0, maximum:100, className:\'transparencyInput\'" data-dojo-attach-event\x3d"keypress:_onTransparencyInputKeypressHandler,change:_updateTransparencyInputSelectedValue"\x3e\x3c/input\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n\r\n    \x3c/tr\x3e\r\n\r\n    \x3ctr\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"outlineSizeText" class\x3d"paneSectionTitle symbolLayerText"\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv class\x3d"numberText"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"outlineSizeInput" data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" data-dojo-props\x3d"minimum: 0.001, maximum:99999999, className:\'sizeInputTextBox\'" data-dojo-attach-event\x3d"keypress:_onOutlineSizeInputKeypressHandler,change:_updateOutlineSizeInputSelectedValue"\x3e\x3c/input\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv class\x3d"colorButton" data-dojo-attach-point\x3d"selectedOutlineColorDropdown" data-dojo-type\x3d"dijit/form/DropDownButton"\x3e\r\n          \x3cspan \x3e\r\n            \x3cdiv class\x3d"colorSwatchContainer"\x3e\r\n              \x3cdiv class\x3d"colorSwatch"\x3e\x26nbsp;\x26nbsp;\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/span\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"outlineColorPalette"\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/ColorPalette" data-dojo-attach-point\x3d"outlineColorPaletteWidget" data-dojo-attach-event\x3d"change:_onOutlineColorPaletteWidgetChange"\x3e\x3c/div\x3e\r\n            \x3ctable class\x3d"transparencyTable"\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd data-dojo-attach-point\x3d"OutlineTransparencyText"\x3e\x3c/td\x3e\r\n                \x3ctd class\x3d"transparencyInputColumn"\x3e\r\n                  \x3cdiv \x3e\r\n                    \x3cinput class\x3d"transparencyInput" data-dojo-attach-point\x3d"outlineTransparencyInput" data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" data-dojo-props\x3d"minimum: 0, maximum:100, className:\'transparencyInput\'" data-dojo-attach-event\x3d"keypress:_onOutlineTransparencyInputKeypressHandler,change:_updateOutlineTransparencyInputSelectedValue"\x3e\x3c/input\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:webSceneViewer/widgets/SymbologyEditor/templates/LineSymbolLayerEditor.html":'\x3cdiv\x3e\r\n  \x3ctable\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"sizeText" class\x3d"paneSectionTitle symbolLayerText "\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv\x3e\r\n          \x3cdiv class\x3d"numberText"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"sizeInput" data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" data-dojo-props\x3d"minimum: 0.001, maximum:999999999, className:\'sizeInputTextBox\'" data-dojo-attach-event\x3d"keypress:_onSizeInputKeypressHandler,change:_updateSizeInputSelectedValue"\x3e\x3c/input\x3e\r\n          \x3c/div\x3e\r\n\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv class\x3d"colorButton" data-dojo-attach-point\x3d"selectedColorDropdown" data-dojo-type\x3d"dijit/form/DropDownButton"\x3e\r\n          \x3cspan \x3e\r\n            \x3cdiv class\x3d"colorSwatchContainer"\x3e\r\n              \x3cdiv class\x3d"colorSwatch"\x3e\x26nbsp;\x26nbsp;\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/span\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"colorPalette"\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/ColorPalette" data-dojo-attach-point\x3d"colorPaletteWidget" data-dojo-attach-event\x3d"change:_onColorPaletteWidgetChange"\x3e\x3c/div\x3e\r\n            \x3ctable class\x3d"transparencyTable"\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd data-dojo-attach-point\x3d"transparencyText"\x3e\x3c/td\x3e\r\n                \x3ctd class\x3d"transparencyInputColumn"\x3e\r\n                  \x3cdiv\x3e\r\n                    \x3cinput class\x3d"transparencyInput" data-dojo-attach-point\x3d"transparencyInput" data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" data-dojo-props\x3d"minimum: 0, maximum:100, className:\'transparencyInput\'" data-dojo-attach-event\x3d"keypress:_onTransparencyInputKeypressHandler,change:_updateTransparencyInputSelectedValue"\x3e\x3c/input\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:webSceneViewer/widgets/LayerWidget/templates/LayerItem.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"LayerItem" data-dojo-attach-point\x3d"LayerItem"\x3e\r\n    \x3clabel\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"layerVisInputCheckbox"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"layerItemSpan"\x3e\x3c/span\x3e\r\n    \x3c/label\x3e\r\n    \x3cbutton class\x3d"icon_frame right inactive" data-dojo-attach-point\x3d"layerFrameButton" data-dojo-attach-event\x3d"click:_layerFrameButtonClick" title\x3d"Frame layer" \x3e\x3c/button\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"statDomNode" class\x3d"status layerAdd"\x3e\r\n        \x3cdiv class\x3d"layerUpdatingPercentageContainer"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"statDomNodeProgressbarUpper" class\x3d"progressbarUpper"\x3e \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"statDomNodeProgressbarLower" class\x3d"progressbarLower"\x3e \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:webSceneViewer/widgets/Dialog/templates/ConfirmDialog.html":'\x3cdiv class\x3d"dijitDialog confirmDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title" role\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"0"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\r\n    \x3cdiv class\x3d"dijitDialogPaneContentArea"\x3e\r\n      \x3cdiv class\x3d"confirmDialogContentNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"Message"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"dijitDialogPaneActionBar"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" type\x3d"submit" data-dojo-attach-event\x3d"click: _confirmButtonClickHandler" data-dojo-attach-point\x3d"buttonConfirm"\x3e\x3c/button\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" type\x3d"button" data-dojo-attach-event\x3d"click: onCancel" title\x3d"${buttonCancel}" data-dojo-attach-point\x3d"buttonCancel"\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:webSceneViewer/widgets/SymbologyEditor/templates/PolygonSymbolLayerEditor.html":'\x3cdiv\x3e\r\n  \x3ctable\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd\x3e\x3cspan data-dojo-attach-point\x3d"colorText" class\x3d"paneSectionTitle symbolLayerText"\x3e\x3c/span\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv class\x3d"colorButton" data-dojo-attach-point\x3d"selectedColorDropdown" data-dojo-type\x3d"dijit/form/DropDownButton"\x3e\r\n         \x3cspan \x3e\r\n            \x3cdiv class\x3d"colorSwatchContainer"\x3e\r\n              \x3cdiv class\x3d"colorSwatch"\x3e\x26nbsp;\x26nbsp;\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/span\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"colorPalette"\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/ColorPalette" data-dojo-attach-point\x3d"colorPaletteWidget" data-dojo-attach-event\x3d"change:_onColorPaletteWidgetChange"\x3e\x3c/div\x3e\r\n            \x3ctable class\x3d"transparencyTable"\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd data-dojo-attach-point\x3d"transparencyText"\x3e\x3c/td\x3e\r\n                \x3ctd class\x3d"transparencyInputColumn"\x3e\r\n                  \x3cdiv\x3e\r\n                    \x3cinput class\x3d"transparencyInput" data-dojo-attach-point\x3d"transparencyInput" data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" data-dojo-props\x3d"minimum: 0, maximum:100, className:\'transparencyInput\'" data-dojo-attach-event\x3d"keypress:_onTransparencyInputKeypressHandler,change:_updateTransparencyInputSelectedValue"/\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"extrusionHeightText" class\x3d"paneSectionTitle symbolLayerText "\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv\x3e\r\n          \x3cdiv class\x3d"extrusionHeightNumberText"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"extrusionHeightInput" data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" data-dojo-props\x3d"minimum:-999999999, maximum:999999999, className:\'sizeInputTextBox\'" data-dojo-attach-event\x3d"keypress:_onExtrusionHeightInputKeypressHandler,change:_updateExtrusionHeightSelectedValue" value\x3d"0"/\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:webSceneViewer/widgets/MessageListWidget/templates/MessageListWidget.html":'\x3cdiv class\x3d"MessageList" data-dojo-attach-point\x3d"MessageList"\x3e\r\n    \x3cdiv class\x3d"MessageListContent" data-dojo-attach-point\x3d"MessageListContentNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:webSceneViewer/widgets/SymbologyEditor/templates/SymbologyEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"paneSectionTitle" data-dojo-attach-point\x3d"symbols"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"originalChangeSymbology" class\x3d"changeSymbols"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"editorWrapper" data-dojo-attach-point\x3d"editorWrapper"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"symbologyLoading" class\x3d"symbologyLoading hide"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"paneSectionTitle subSection" data-dojo-attach-point\x3d"dimensions"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"toggle2d3d" data-dojo-attach-point\x3d"changeDimension"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"symbolLayerContainer" class\x3d"subSection"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \r\n\x3c/div\x3e\r\n',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\t\t\t${!actionBarTemplate}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"*now":function(k){k(['dojo/i18n!*preload*webSceneViewer/editor/nls/WebSceneEditor*["ar","ca","cs","da","de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])}}});
define("esri/core/declare dojo/_base/lang dojo/Evented dojo/on dojo/Deferred dojo/io-query dojo/string dojo/dom-construct dojo/dom-class dojo/_base/window esri/core/Accessor webSceneViewer/editor/dijit/NavigatorContainer/NavigatorContainer webSceneViewer/editor/WebSceneEditorPanes/WebScenePropertiesPane webSceneViewer/editor/WebSceneEditorPanes/WebSceneSlidesPane webSceneViewer/editor/WebSceneEditorPanes/ContentsPane webSceneViewer/editor/WebSceneEditorPanes/AddLayerPane webSceneViewer/editor/WebSceneEditorPanes/AddLayerByUrlPane webSceneViewer/editor/WebSceneEditorPanes/EditLayerPane webSceneViewer/webScene/WebScene webSceneViewer/widgets/Dialog/SaveDialog webSceneViewer/widgets/MessageListWidget/MessageListWidget webSceneViewer/environmentUtils dojo/i18n!./nls/editor".split(" "),function(k,
r,e,p,m,n,s,h,a,f,d,q,l,c,b,t,g,y,u,F,v,D,A){function z(a,b){var c=document.createElementNS("http://www.w3.org/1999/xhtml","a");if("download"in c){c.href=a;c.download=b;var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);c.dispatchEvent(d)}else console.warn("your browser does not support a.download - https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#attr-download")}return k([d,e],{_domNode:void 0,map:void 0,_navigationContainerResizeHandler:void 0,
unsavedChanges:!1,_onHandles:void 0,_webScene:void 0,shareEmailClicked:!1,sceneSRLocked:!1,_webSceneSetter:function(a){this._webScene=a;this._initializeUI()},_webSceneGetter:function(){return this._webScene},_portal:void 0,_portalSetter:function(a){this._portal=a;this.portal&&(window.onbeforeunload=function(){if(this.unsavedChanges&&!this.shareEmailClicked)return A.messages.pendingChangesConfirm;this.shareEmailClicked=!1}.bind(this));this._saveDialog&&this._saveDialog.set("portal",a)},_shareEmailClickedSetter:function(a){return a},
_portalGetter:function(){return this._portal},normalizeCtorArgs:function(){return{}},constructor:function(a){this._domNode=a;this._saveDialog=new F;this._saveDialog.on("save",this._saveWebScene.bind(this));this._saveDialog.on("cancel-save",function(){this.saveShortCutKeyHandle=p(f.doc,"keydown",this._saveShortCutKeyHandler.bind(this))}.bind(this));this._onHandles=[];this._pressedCtrlS=!1;this.saveShortCutKeyHandle=p(f.doc,"keydown",this._saveShortCutKeyHandler.bind(this));this._onHandles.push(p(f.doc,
"keyup",function(a){if(83===a.keyCode||17===a.keyCode)this._pressedCtrlS=!1}.bind(this)))},_saveShortCutKeyHandler:function(a){83===a.keyCode&&(a.metaKey||a.ctrlKey)?(a.preventDefault(),this._pressedCtrlS||(this._pressedCtrlS=!0,console.debug("trigger save"),a=!0,this.portal&&(a=(this.webScene.portalItemProperties?"update"===this.webScene.portalItemProperties.itemControl||"admin"===this.webScene.portalItemProperties.itemControl:!0)||this.webScene.portalItemProperties.owner===this.portal.getPortalUser().username),
void 0===this.webScene.portalItemProperties.id||!a?this.saveWebScene():this._saveWebScene({title:this.webScene.portalItemProperties.title,snippet:this.webScene.portalItemProperties.snippet,tags:this.webScene.portalItemProperties.tags,saveAsNewWebScene:!1,saveInitialState:!0,thumbnailFileObject:this.webScene.portalItemProperties._thumbnailFileObject,owner:this.webScene.portalItemProperties.owner}))):this._pressedCtrlS=!1},destroy:function(){this.inherited(arguments);this._navigatorWidget.destroy();
h.empty(this._domNode);this._navigationContainerResizeHandler&&this._navigationContainerResizeHandler.remove();this._onHandles.forEach(function(a){a.remove()})},show:function(){this._navigatorWidget.set("open",!0)},hide:function(){this._navigatorWidget.set("open",!1)},isOpen:function(){return this._navigatorWidget.open},saveWebScene:function(){this.saveShortCutKeyHandle.remove();this.saveShortCutKeyHandle=p(f.doc,"keydown",function(a){83===a.keyCode&&(a.metaKey||a.ctrlKey)&&a.preventDefault()});this._saveDialog.show({webScene:this.webScene,
isNewWebScene:this._isNewWebScene(),myUserName:this.portal?this.portal.getPortalUser().username:"me"},this.view)},_isNewWebScene:function(){return null==this.webScene.portalItemProperties.id||this.webScene.portalItemProperties.owner!==this.portal.getPortalUser().username&&"update"!==this.webScene.portalItemProperties.itemControl&&"admin"!==this.webScene.portalItemProperties.itemControl},_saveWebScene:function(a){this.saveShortCutKeyHandle.remove();this.saveShortCutKeyHandle=p(f.doc,"keydown",function(a){83===
a.keyCode&&(a.metaKey||a.ctrlKey)&&a.preventDefault()});a.saveInitialState&&this.webScene.set("initialState",{viewpoint:this.view.viewpoint.toJSON(),environment:D.clone(this.view.environment)});this.webScene.set("title",a.title);this.webScene.set("snippet",a.snippet);this.webScene.set("tags",a.tags);this.webScene.portalItemProperties._thumbnailFileObject=a.thumbnailFileObject;this.webScene.portalItemProperties.owner=a.owner?a.owner:this.webScene.portalItemProperties.owner;var b=a.saveAsNewWebScene;
(b?this._createAndAddWebSceneItem(a.saveInitialState):this._updateWebSceneItem(a.saveInitialState)).then(function(a){var c;c="undefined"!==typeof esriGeowConfig?esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id:this.portal.url+"/home/item.html?id\x3d"+a.id;var d=a.id,e=n.queryToObject(window.location.search.substring(1)),g;for(g in e)"webscene"===g.toLowerCase()&&delete e[g];delete e.url;delete e.layers;delete e.viewingmode;delete e.viewpoint;e.webscene=d;d=decodeURIComponent(n.objectToQuery(e));window.history.pushState(null,
null,location.pathname+"?"+d);d=A.messages.webSceneSaved;this.portal&&this.webScene.portalItemProperties.owner!==this.portal.getPortalUser().username&&(d=s.substitute(A.messages.webSceneSavedShared,{sceneowner:this.webScene.portalItemProperties.owner}));v.show({message:d,details:"\x3ca href\x3d'"+c+"' target\x3d'_blank'\x3e"+A.messages.viewItemDetails+"\x3c/a\x3e",type:v.MessageTypes.SUCCESS});this.saveShortCutKeyHandle=p(f.doc,"keydown",this._saveShortCutKeyHandler.bind(this));console.log("Web Scene saved successfully with ItemID \x3d "+
a.id);this.unsavedChanges=!1;this.emit("unsaved-change",{unsavedChanges:this.unsavedChanges});this.emit("scene-save",{webscene:this.webScene,saveAsNew:b})}.bind(this),function(a){v.show({message:A.dialogs.webSceneSaveFailed,type:v.MessageTypes.ERROR,details:a});this.saveShortCutKeyHandle=p(f.doc,"keydown",this._saveShortCutKeyHandler.bind(this))})},addLayerByUrl:function(a,b,c,d){var e={url:a,title:b};void 0!==d&&(e.visibility=d);d=u.addLayerToMapByUrl(this.map,e,null,!u.spatialReferenceLocked?1:
0);d.then(function(a){this.map.layers.forEach(function(a){void 0!==a._websceneIndex&&delete a._websceneIndex})}.bind(this),function(d){var e=c?c+" / "+b:b;v.show({message:A.messages.addLayerFailed+(""!==e?": \x3ci\x3e"+e+"\x3c/i\x3e":""),type:v.MessageTypes.ERROR,details:(""!==(d.msg||d.message)?(d.msg||d.message)+"\x3cbr\x3e":"")+a,collapsed:!1})});return d},addContentByItemId:function(a,b){return b?u.addContentByItemId(this.map,this.portal,a,{},this.webScene):u.addLayerByItemId(this.map,this.portal,
a,{},this.webScene)},_createAndAddWebSceneItem:function(a){this.webScene.updateFromView(this.view,a);a={};a.text=this.webScene.toJSON();for(var b in this.webScene.portalItemProperties)this.webScene.portalItemProperties.hasOwnProperty(b)&&"function"!==typeof this.webScene.portalItemProperties[b]&&"_thumbnailFileObject"!==b&&(a[b]=this.webScene.portalItemProperties[b]);return this._storeWebSceneItem(a,this.webScene.portalItemProperties._thumbnailFileObject)},_storeWebSceneItem:function(a,b){var c=new m,
d=this,e=function(a){d.portal.getItem(a.id).then(function(a){d.webScene.portalItemProperties=r.mixin(d.webScene.portalItemProperties,a);c.resolve({id:a.id})})},g=function(){c.reject(arguments)};if(this.portal)null==this.portal.getPortalUser()?this.portal.signIn().then(function(){d.portal.addItem(a,b).then(e,g)}):this.portal.addItem(a,b).then(e,g);else try{var h="data:application/json,"+encodeURIComponent(this.webScene.toJSON(2));z(h,"webScene.json");d.saveShortCutKeyHandle=p(f.doc,"keydown",d._saveShortCutKeyHandler.bind(d))}catch(k){console.error(k)}return c},
uploadItem:function(a,b,c){var d=new m,e=this,f=function(a){e.portal.getItem(a.id).then(function(a){e.webScene.portalItemProperties=r.mixin(e.webScene.portalItemProperties,a);d.resolve({id:a.id})})},g=function(){d.reject(arguments)};null==this.portal.getPortalUser()?this.portal.signIn().then(function(){e.portal.addItem(a,b).then(f,g)}):e.portal.addItem(a,b).then(f,g);return d},_updateWebSceneItem:function(a){var b=new m,c=this;this.webScene.updateFromView(this.view,a);var d={};d.text=this.webScene.toJSON();
for(var e in this.webScene.portalItemProperties)this.webScene.portalItemProperties.hasOwnProperty(e)&&"function"!==typeof this.webScene.portalItemProperties[e]&&"_thumbnailFileObject"!==e&&(d[e]=this.webScene.portalItemProperties[e]);var f=function(a){c.portal.getItem(a.id).then(function(a){c.webScene.portalItemProperties=r.mixin(c.webScene.portalItemProperties,a);b.resolve({id:a.id})})},g=function(){b.reject(arguments)};null==this.portal.getPortalUser()?this.portal.signIn().then(function(){c.portal.updateItem(c.webScene.portalItemProperties.id,
d,c.webScene.portalItemProperties.ownerFolder,c.webScene.portalItemProperties._thumbnailFileObject,c.webScene.portalItemProperties.owner).then(f,g)}):c.portal.updateItem(c.webScene.portalItemProperties.id,d,c.webScene.portalItemProperties.ownerFolder,c.webScene.portalItemProperties._thumbnailFileObject,c.webScene.portalItemProperties.owner).then(f,g);return b},_initializeUI:function(){null!=this._navigatorWidget&&this._navigatorWidget.destroy();this._editFlap=h.create("div",{className:"editFlap show"},
this._domNode);var d=h.create("div",{className:"editFlapIconContainer"},this._editFlap);h.create("div",{className:"editFlapIcon"},d);h.create("div",{className:"editFlapText"},this._editFlap).textContent=A.panes.modifyScene;this._onHandles.push(p(this._editFlap,"click",function(){this.show()}.bind(this)));d={properties:new l(this),slideDeck:new c(this),contents:new b(this),addLayerByUrl:new g(this),addLayer:new t(this),editLayer:new y(this)};d.contents.addNavButton(A.panes.slides,d.slideDeck);d.contents.addNavButton(A.panes.properties,
d.properties);d.addLayer.addNavButtonTo(d.addLayerByUrl);p(d.addLayer,"layer-found",r.hitch(this,function(a){this.emit("layer-found",a)}));p(d.addLayer,"layer-found-visible",r.hitch(this,function(a){this.emit("layer-found-visible",a)}));p(d.addLayer,"layer-toggle-popup",r.hitch(this,function(a){this.emit("layer-toggle-popup",a)}));p(d.addLayerByUrl,"layer-found-visible",r.hitch(this,function(a){this.emit("layer-found-visible",a)}));p(d.contents,"layer-found-visible",r.hitch(this,function(a){this.emit("layer-found-visible",
a)}));this._navigatorWidget=new q({panes:d,mainPaneId:"contents",closedLabel:A.panes.modifyScene,open:!1});this._navigatorWidget.startup();this._navigatorWidget.placeAt(this._domNode);p(this._navigatorWidget,"layer-found-visible",r.hitch(this,function(a){this.emit("layer-found-visible",a)}));this._onHandles.push(this._navigatorWidget.watch("open",function(b,c,d){this.emit("open-change",{open:d});d?a.remove(this._editFlap,"show"):a.add(this._editFlap,"show")}.bind(this)));this.view.popup.on("selection-change",
function(){var a=this.view.popup.getSelectedFeature();if(a){var b=a.id;a.attributes&&a.attributes.isGISSearchFeature&&this._navigatorWidget.panes.addLayer.setLayerHover(b)}else this._navigatorWidget.panes.addLayer.setLayerHover(null)}.bind(this));this.view.popup.on("hide",function(){this._navigatorWidget.panes.addLayer.setLayerHover(null)}.bind(this))},setWebSceneChanged:function(){this.unsavedChanges||this.emit("unsaved-change",{unsavedChanges:!0});this.unsavedChanges=!0;this.shareEmailClicked=!1;
this.portal&&console.log(A.messages.pendingChangesConfirm)},goToshareEmail:function(a){this.shareEmailClicked=!0;window.location.href=a}})});