// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/OrganizationSetup",["dijit","dojo","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dijit/form/CheckBox,dijit/form/FilteringSelect,dijit/form/TextBox,dijit/layout/ContentPane,dijit/Tooltip,dojo/data/ItemFileReadStore,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/dijit/dialog/GeneralDlg"],function(g,b,h){b.provide("arcgisonline.sharing.dijit.OrganizationSetup");
b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("dijit.form.CheckBox");b.require("dijit.form.FilteringSelect");b.require("dijit.form.TextBox");b.require("dijit.layout.ContentPane");b.require("dijit.Tooltip");b.require("dojo.data.ItemFileReadStore");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.requireLocalization("arcgisonline",
"arcgisonline");b.declare("arcgisonline.sharing.dijit.OrganizationSetup",[g._Widget,g._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3cdiv  class\x3d"esriFloatLeading" style\x3d"width:780px; clear:both; padding-left:10px;"\x3e${i18n.thankYou}\x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"width:780px; clear:both; margin-top:2em; padding-left:10px;" class\x3d"esriFloatLeading"\x3e\r\n\r\n    \x3ctable\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.orgName}\x3c/strong\x3e\x3cbr/\x3e\x3cbr/\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_orgNameImg" alt\x3d"${i18n.orgName}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            ${i18n.orgNameDesc}\r\n            \x3cbr/\x3e\x3cbr/\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"_nameTextBox" data-dojo-type\x3d"dijit.form.TextBox" type\x3d"text" data-dojo-props\x3d"trim:true"\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.orgAbbr}\x3c/strong\x3e\x3cbr/\x3e\x3cbr/\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_orgAbbrImg" alt\x3d"${i18n.orgAbbr}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            ${!i18n.orgAbbrDesc}\r\n            \x3cbr/\x3e\x3cbr/\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"_urlKeyTextBox" data-dojo-type\x3d"dijit.form.TextBox" type\x3d"text" data-dojo-props\x3d"trim:true" data-dojo-attach-event\x3d"onChange:checkUrlKey,onKeyUp:checkUrlKey"\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"_urlKeyStatusLabel" style\x3d"vertical-align:middle; width:125px;"\x3e\x3c/label\x3e\r\n            \x3cbr/\x3e\x3cbr/\x3e\r\n            ${i18n.sampleOrgUrl}\r\n            \x3cbr/\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_sampleUrlTextBox"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.languageSetting}\x3c/strong\x3e\x3cbr/\x3e\x3cbr/\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_languageImg" alt\x3d"${i18n.languageSetting}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            ${i18n.languageDesc} ${i18n.browserDefaultAGOL}\r\n            \x3cbr/\x3e\x3cbr/\x3e\r\n            \x3clabel for\x3d"languageSelect"\x3e${i18n.languageLabel}\x3c/label\x3e \x3cdiv id\x3d"languageSelect" name\x3d"languageSelect" data-dojo-attach-point\x3d"_languageSelect" data-dojo-type\x3d"dijit.form.FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.regionSetting}\x3c/strong\x3e\x3cbr/\x3e\x3cbr/\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_regionImg" alt\x3d"${i18n.regionSetting}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            ${!i18n.regionDesc}\r\n            \x3cbr/\x3e\x3cbr/\x3e\r\n            \x3clabel for\x3d"regionSelect"\x3e${i18n.regionLabel}\x3c/label\x3e \x3cdiv id\x3d"regionSelect" name\x3d"regionSelect" data-dojo-attach-point\x3d"_regionSelect" data-dojo-type\x3d"dijit.form.FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.security}\x3c/strong\x3e\x3cbr/\x3e\x3cbr/\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_securityImg" alt\x3d"${i18n.security}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            \x3cinput id\x3d"sslCheckBox" name\x3d"sslCheckBox" data-dojo-attach-point\x3d"_sslCheckBox" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkBox" data-dojo-attach-event\x3d"onClick:onSSLCheck"\x3e\r\n            \x3clabel for\x3d"sslCheckBox" data-dojo-attach-point\x3d"_sslCheckBoxLabel"\x3e\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.link}\x3c/strong\x3e\x3cbr/\x3e\x3cbr/\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd class\x3d"titleColumn"\x3e\r\n                \x3cimg data-dojo-attach-point\x3d"_linkImg" alt\x3d"${i18n.link}"\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd class\x3d"valignTop"\x3e\r\n              \x3clabel\x3e${i18n.linkDesc}\x3c/label\x3e\x3cbr/\x3e\x3cbr/\x3e\r\n              \x3ctable\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd class\x3d"valignTop" style\x3d"width:15em;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"_linkCheckBox" id\x3d"linkCheckBox" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n                      \x3clabel data-dojo-attach-point\x3d"_linkTooltip" id\x3d"linkTooltip" for\x3d"linkCheckBox"\x3e\x3c/label\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd class\x3d"valignTop"\x3e\r\n                      \x3cdiv data-dojo-attach-point\x3d"_link" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true" style\x3d"width:25em;"\x3e\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n              \x3cbutton data-dojo-attach-point\x3d"_saveButton" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onSave" type\x3d"button" class\x3d"calcite blue" iconClass\x3d"esriSaveIcon"\x3e${i18n.saveContinue}\x3c/button\x3e\r\n              \x3cbutton data-dojo-attach-point\x3d"_signOutButton" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onSignOut" type\x3d"button" class\x3d"calcite transparent" iconClass\x3d"esriOpenIcon"\x3e${i18n.signOut}\x3c/button\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
_util:arcgisonline.sharing.util,_account:arcgisonline.sharing.geow.Account,_geow:arcgisonline.sharing.geow.Geow,_user:null,_settings:null,_validUrlKey:!1,_urlKeyAlreadySet:!1,_tooltips:[],accountAdminRole:"account_admin",browserDefault:"browser",i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").organizationSetup)},postCreate:function(){this.inherited(arguments);
this.loadImages()},startup:function(){this.localization();this.setupTooltips();this.checkAccess();b.when(this._account.getSupportedLanguagesAndRegions(),b.hitch(this,function(a){a&&(this._initLanguage(a.languages),this._initRegion(a.regions),this.loadOrganization())}),b.hitch(this,this._handleError))},loadImages:function(){this._orgNameImg&&b.attr(this._orgNameImg,"src",this._util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-general-logo-name.png"));this._orgAbbrImg&&b.attr(this._orgAbbrImg,
"src",this._util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-general-logo-name.png"));this._languageImg&&b.attr(this._languageImg,"src",this._util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-language.png"));this._regionImg&&b.attr(this._regionImg,"src",this._util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-region.png"));this._securityImg&&b.attr(this._securityImg,"src",this._util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-security-https.png"));
this._linkImg&&b.attr(this._linkImg,"src",this._util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-links.png"))},localization:function(){b.attr(b.byId("item-title"),"innerHTML",this.i18n.setupYourOrg);this._sslCheckBoxLabel.innerHTML=esri.substitute({span:'\x3cspan id\x3d"sslTooltip" style\x3d"border-bottom: 1px dotted #487696;"\x3e',spanEnd:"\x3c/span\x3e"},this.i18n.securityDesc);b.attr(this._linkTooltip,"innerHTML",esri.substitute({startSpan:'\x3cspan class\x3d"orgSettingTooltip"\x3e',
endSpan:"\x3c/span\x3e"},this.i18n.contactUs));this._link.set("placeholder",this.i18n.contactUsExample)},setupTooltips:function(){this._tooltips.push(this._createTooltip("linkTooltip",this.i18n.contactUsTooltip));this._tooltips.push(this._createTooltip("sslTooltip",this.i18n.sslTooltip))},_createTooltip:function(a,b,d,c){d=esri.isDefined(d)?d:200;c=esri.isDefined(c)?c:300;return new g.Tooltip({label:'\x3cdiv style\x3d"max-width:'+c+'px;"\x3e'+b+"\x3c/div\x3e",connectId:[a],id:"tooltip_"+a,showDelay:d})},
checkAccess:function(){this._util.isLoggedIn()?(this._user=this._util.getUser(),!this._user.accountId&&this._user.role!==this.accountAdminRole&&(window.location=esriGeowConfig.baseUrl+"error.html?c\x3dAccessDenied")):this._showUser||this._util.requireAuthentication()},_initLanguage:function(a){if(a){var f=[{culture:this.browserDefault,displayName:this.i18n.browserDefaultSelection,language:this.i18n.browserDefaultSelection,localizedName:this.i18n.browserDefaultSelection}];b.forEach(a,function(a){a.displayName=
a.language+(a.localizedName?"-"+a.localizedName:"");f.push(a)});a=new b.data.ItemFileReadStore({data:{identifier:"culture",label:"displayName",items:f}});this._languageSelect.set("store",a);this._languageSelect.set("searchAttr","displayName")}},_initRegion:function(a){a&&(a=new b.data.ItemFileReadStore({data:{identifier:"region",label:"localizedName",items:a}}),this._regionSelect.set("store",a),this._regionSelect.set("searchAttr","localizedName"))},loadOrganization:function(){this._account.getSelf(b.hitch(this,
function(a){a&&!a.code&&!a.message?(this._settings=a,this._sslCheckBox.set("checked",this._settings.allSSL),this._settings.name&&"My Account"!==this._settings.name&&this._nameTextBox.set("value",this._settings.name),this._settings.urlKey?(this._urlKeyAlreadySet=this._validUrlKey=!0,this._settings.customBaseUrl?b.attr(this._sampleUrlTextBox,"innerHTML",(this._settings.allSSL?"https://":"http://")+this._settings.urlKey+"."+this._settings.customBaseUrl):b.attr(this._sampleUrlTextBox,"innerHTML",this._settings.allSSL?
esriGeowConfig.baseUrl.replace("http:","https:"):esriGeowConfig.baseUrl.replace("https:","http:")),this._urlKeyTextBox.set("disabled",!0),this._urlKeyTextBox.set("value",this._settings.urlKey)):(this._validUrlKey=!1,b.attr(this._sampleUrlTextBox,"innerHTML","")),this._languageSelect.store.fetchItemByIdentity({identity:a.culture,onItem:b.hitch(this,function(b){!esri.isDefined(b)||0===a.culture.length?this._languageSelect.set("displayedValue",this.i18n.browserDefaultSelection):this._languageSelect.set("displayedValue",
this._languageSelect.store.getValue(b,"displayName"))})}),this._regionSelect.store.fetchItemByIdentity({identity:a.region,onItem:b.hitch(this,function(a){a&&this._regionSelect.set("displayedValue",this._regionSelect.store.getValue(a,"localizedName"))})}),this._settings.portalProperties&&(this._settings.portalProperties.links&&this._settings.portalProperties.links.contactUs)&&(this._linkCheckBox.set("checked",!!this._settings.portalProperties.links.contactUs.visible),this._link.set("value",this._settings.portalProperties.links.contactUs.url))):
console.log(a)}))},checkUrlKey:function(a){this._urlKeyAlreadySet||((a=this._urlKeyTextBox.getValue())&&(a=b.trim(a)),a&&0<a.length&&17>a.length?this.containsInvalidChars(a)?(this._validUrlKey=!1,this._urlKeyStatusLabel.innerHTML=this.i18n.errors.urlKeyInvalidChars,b.removeClass(this._urlKeyStatusLabel,"statusGood"),b.addClass(this._urlKeyStatusLabel,"statusBad")):(b.attr(this._sampleUrlTextBox,"innerHTML",(this._settings.allSSL?"https://":"http://")+a+"."+this._settings.customBaseUrl),this._util.getJson(esriGeowConfig.restBaseUrl+
"portals/isUrlKeyAvailable?urlKey\x3d"+a,b.hitch(this,this.handleCheckUrlKey),b.hitch(this,this.handleCheckUrlKey))):(this._validUrlKey=!1,b.attr(this._sampleUrlTextBox,"innerHTML",""),a&&16<a.length?(this._urlKeyStatusLabel.innerHTML=this.i18n.urlKeyTooLong,b.removeClass(this._urlKeyStatusLabel,"statusGood"),b.addClass(this._urlKeyStatusLabel,"statusBad")):(this._urlKeyStatusLabel.innerHTML="",b.removeClass(this._urlKeyStatusLabel,"statusGood"),b.removeClass(this._urlKeyStatusLabel,"statusBad"))))},
containsInvalidChars:function(a){return a.match(/^[a-zA-Z0-9\-]*$/)?!1:!0},handleCheckUrlKey:function(a,f){a&&!a.code&&!a.message?a.available?(this._validUrlKey=!0,this._urlKeyStatusLabel.innerHTML=this.i18n.available,b.removeClass(this._urlKeyStatusLabel,"statusBad"),b.addClass(this._urlKeyStatusLabel,"statusGood")):(this._validUrlKey=!1,this._urlKeyStatusLabel.innerHTML=this.i18n.unavailable,b.removeClass(this._urlKeyStatusLabel,"statusGood"),b.addClass(this._urlKeyStatusLabel,"statusBad")):(this._validUrlKey=
!1,console.log(a))},handleUpdateAccount:function(a,b){if(a&&!a.code&&!a.message)if(this._settings.urlKey&&this._settings.customBaseUrl){var d=null;-1===window.location.host.indexOf(this._settings.urlKey+"."+this._settings.customBaseUrl)&&(d=this._util.getCookie("esri_auth"));var c=(this._settings.allSSL?"https:":"http:")+"//"+this._settings.urlKey+"."+this._settings.customBaseUrl,e=esriGeowConfig.baseUrl.indexOf(location.host),c=-1<e?c+(esriGeowConfig.baseUrl.substring(e+location.host.length)+"organization.html"):
this._settings.allSSL?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:");d&&(c=this._util.getBridgeUrl(c,d));window.location=c}else window.location="account_admin"===user.role&&!this._settings.urlKey?this._settings.allSSL?this.orgRedirectUrl.replace("http:","https:"):this.orgRedirectUrl.replace("https:","http:"):this._settings.allSSL?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:");else console.log(a),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,
message:this.i18n.errors.unableToSave}),this._saveButton.set("disabled",!1),this._saveButton.set("label",this.i18n.saveContinue)},validates:function(){var a=this._nameTextBox.getValue(),f=this._link.get("value"),d=this._linkCheckBox.get("checked"),c=this.i18n.errors.pleaseCorrect,e=!1;a?(a=b.trim(a),0<a.length?-1<a.indexOf("\x3c")||-1<a.indexOf("\x3e")||-1<a.indexOf("%")?(e=!0,c+="\x3cbr/\x3e"+this.i18n.errors.orgNameInvalidChars):55<a.length&&(e=!0,c+="\x3cbr/\x3e"+this.i18n.errors.orgNameTooLong):
(e=!0,c+="\x3cbr/\x3e"+this.i18n.errors.orgNameRequired)):(e=!0,c+="\x3cbr/\x3e"+this.i18n.errors.orgNameRequired);this._validUrlKey||(e=!0,c+="\x3cbr/\x3e"+this.i18n.errors.urlKeyRequired);if(d&&(!esri.isDefined(f)||0===f.length))e=!0,c+="\x3cbr/\x3e"+this.i18n.errors.finishContactUsSetup;e&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:c});return!e},onSSLCheck:function(a){a=this._sslCheckBox.attr("checked");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.warning,
message:a?this.i18n.sslOnWarning:this.i18n.sslOffWarning})},onSave:function(a){this._saveButton.set("disabled",!0);this._saveButton.set("label",this.i18n.saving);if(this.validates()){a=this._nameTextBox.getValue();var f=this._urlKeyTextBox.getValue(),d=this._sslCheckBox.attr("checked");this._settings.name=b.trim(a);this._settings.urlKey=b.trim(f);this._settings.allSSL=d;this._languageSelect.store.fetch({query:{displayName:this._languageSelect.get("displayedValue")},onItem:b.hitch(this,function(a){a&&
(a=this._languageSelect.store.getValue(a,"culture"),this._settings.culture=a===this.browserDefault?"":a)})});this._regionSelect.store.fetch({query:{localizedName:this._regionSelect.get("displayedValue")},onItem:b.hitch(this,function(a){a&&(this._settings.region=this._regionSelect.store.getValue(a,"region"))})});this._settings.portalProperties=this._settings.portalProperties||{};this._settings.portalProperties.mustWelcome=!0;this._settings.portalProperties.links=this._settings.portalProperties.links||
{};a=this._link.get("value");esri.isDefined(a)&&0<a.length?(0!==a.indexOf("http")&&0!==a.indexOf("mailto:")&&0<a.indexOf("@")?a="mailto:"+a:0!==a.indexOf("http")&&(0>a.indexOf("mailto:")&&0>a.indexOf("@"))&&(a="http://"+a),this._settings.portalProperties.links.contactUs={url:a,visible:!!this._linkCheckBox.get("checked")}):delete this._settings.portalProperties.links.contactUs;this._settings.basemapGalleryGroupQuery=null;this._settings.colorSetsGroupQuery=null;this._settings.defaultBasemap=null;this._settings.defaultExtent=
null;this._settings.featuredGroups=null;this._settings.featuredGroupsId=null;this._settings.featuredItemsGroupQuery=null;this._settings.homePageFeaturedContent=null;this._settings.layerTemplatesGroupQuery=null;this._settings.rotatorPanels=null;this._settings.symbolSetsGroupQuery=null;this._settings.templatesGroupQuery=null;this._settings.contacts=this._settings.contacts||[];this._account.updateAccount(this._settings,b.hitch(this,this.handleUpdateAccount),b.hitch(this,this.handleUpdateAccount))}else this._saveButton.set("disabled",
!1),this._saveButton.set("label",this.i18n.saveContinue)},onSignOut:function(a){b.cookie("esri_webmap","",{expires:-1,path:"/"});a=this.allSSL?arcgisonline.sharing.util.getSecureUrl():arcgisonline.sharing.util.getHttpUrl();this._geow.signout(a+"index.html")},_handleError:function(a){console.log(a)}})});