// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/UserProfile",["dijit","dojo","dojox","dojo/require!dijit/_Templated,dijit/Dialog,dijit/form/Button,dijit/form/FilteringSelect,dijit/form/Form,dijit/form/RadioButton,dijit/layout/ContentPane,dojo/Deferred,dojo/io/iframe,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Community,arcgisonline/sharing/geow/Roles,arcgisonline/sharing/dijit/ComboBox,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/DeleteWarningDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg"],
function(e,a,q){a.provide("arcgisonline.sharing.dijit.UserProfile");a.require("dijit._Templated");a.require("dijit.Dialog");a.require("dijit.form.Button");a.require("dijit.form.FilteringSelect");a.require("dijit.form.Form");a.require("dijit.form.RadioButton");a.require("dijit.layout.ContentPane");a.require("dojo.Deferred");a.require("dojo.io.iframe");a.require("arcgisonline.sharing.util");a.require("arcgisonline.sharing.geow.Account");a.require("arcgisonline.sharing.geow.Community");a.require("arcgisonline.sharing.geow.Roles");
a.require("arcgisonline.sharing.dijit.ComboBox");a.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");a.require("arcgisonline.sharing.dijit.dialog.DeleteWarningDlg");a.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");a.declare("arcgisonline.sharing.dijit.UserProfile",[e._Widget,e._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"containerNode" class\x3d"${baseClass}"\x3e\r\n  \x3cdiv id\x3d"editMenu" data-dojo-attach-point\x3d"editMenu" class\x3d"ownerOnly topButtonBar"\x3e\r\n    \x3cdiv id\x3d"profileEditButton" class\x3d"dijitInline calcite blue readOnly"\r\n         data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:_startEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.editMyProfile}\x3c/div\x3e\r\n    \x3cdiv id\x3d"profileSaveButton" class\x3d"dijitInline calcite blue editOnlyBtn" style\x3d"display:none;" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:_saveEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.save}\x3c/div\x3e\r\n    \x3cdiv id\x3d"profileCancelButton" class\x3d"dijitInline calcite transparent editOnlyBtn" style\x3d"display:none;" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:_cancelEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.cancel}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"userDetails"\x3e\r\n    \x3cdiv class\x3d"profileTitle"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_profileTitle"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading userThumbnailInfo"\x3e\r\n      \x3cdiv class\x3d"profileThumbnailBox" data-dojo-attach-point\x3d"_thumbnailDiv" style\x3d"position:relative"\x3e\r\n        \x3cimg data-dojo-attach-point\x3d"thumbnailImage" class\x3d"profileThumbnail" src\x3d""/\x3e\r\n      \x3c/div\x3e\r\n      \x3ccenter\x3e\r\n        \x3cp class\x3d"editOnly"\x3e\r\n          ${i18n.clickThumbnail}\r\n        \x3c/p\x3e\r\n        \x3cdiv class\x3d"readOnly"\x3e\r\n          \x3cbr /\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"relatedLinks" class\x3d"esriItemLinks"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/center\x3e\r\n      \x3cdiv class\x3d"socialProvider ownerOnly hide" data-dojo-attach-point\x3d"_socialProviderlDiv"\x3e\r\n        \x3cspan class\x3d"socialIcon" data-dojo-attach-point\x3d"_socialProviderlIcon"\x3e\x3c/span\x3e\x3cspan class\x3d"socialProviderName" data-dojo-attach-point\x3d"_socialProviderName"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin3 userProfileColumn"\x3e\r\n      \x3cdiv id\x3d"firstNameProperty" class\x3d"property"\x3e\r\n        \x3clabel for\x3d"first_name"\x3e\x3cstrong\x3e${i18n.firstNameLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"readOnly" data-dojo-attach-point\x3d"_firstNameLabel"\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_firstNameInput" class\x3d"editOnly"\x3e\x3cinput id\x3d"first_name" name\x3d"first_name" data-dojo-attach-point\x3d"firstName" data-dojo-props\x3d"trim:\'true\'" data-dojo-type\x3d"dijit.form.TextBox"/\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"lastNameProperty" class\x3d"property"\x3e\r\n        \x3clabel for\x3d"last_name"\x3e\x3cstrong\x3e${i18n.lastNameLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"readOnly" data-dojo-attach-point\x3d"_lastNameLabel"\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_lastNameInput" class\x3d"editOnly"\x3e\x3cinput id\x3d"last_name" name\x3d"last_name" data-dojo-attach-point\x3d"lastName" data-dojo-props\x3d"trim:\'true\'" data-dojo-type\x3d"dijit.form.TextBox"/\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"user_email_edit" class\x3d"ownerOnly"\x3e\r\n        \x3cdiv class\x3d"property readOnly"\x3e\r\n          \x3clabel\x3e\x3cstrong\x3e${i18n.changeEmailLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr/\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_displayEmail"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"editOnly"\x3e\r\n          \x3cdiv class\x3d"property"\x3e\r\n            \x3clabel for\x3d"newEmail"\x3e\x3cstrong\x3e${i18n.newEmailLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr/\x3e\r\n            \x3cdiv id\x3d"newEmail" data-dojo-attach-point\x3d"newEmail"\r\n                 data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true, type:\'text\'"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"property"\x3e\r\n            \x3clabel for\x3d"verifyNewEmail"\x3e\x3cstrong\x3e${i18n.verifyNewEmailLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr/\x3e\r\n            \x3cdiv id\x3d"verifyNewEmail" data-dojo-attach-point\x3d"verifyNewEmail"\r\n                 data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true, type:\'text\'"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"user_profile_edit" class\x3d"property"\x3e\r\n        \x3cspan id\x3d"user_profile_edit_title"\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"label_username"\x3e\x3c/span\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x3ca style\x3d"display:none;" id\x3d"user_profile_edit_link" href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"editUsernameLink" onclick\x3d"window.open(esriGeowConfig.account_edit);"\x3e${i18n.editLabel}\x3c/a\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"property"\x3e\r\n        \x3clabel\x3e\x3cstrong\x3e${i18n.bioLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv class\x3d"esriItemLinks readOnly bioSpan" data-dojo-attach-point\x3d"label_description"\x3e\x3c/div\x3e\r\n        \x3ctextarea class\x3d"editOnly bioBox" data-dojo-attach-point\x3d"descriptionTextArea" rows\x3d"" cols\x3d""\x3e\r\n        \x3c/textarea\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1 ownerOnly userProfileColumn"\x3e\r\n      \x3cdiv id\x3d"new_password_edit" style\x3d"display:none;"\x3e\r\n        \x3cdiv id\x3d"oAuthChangePwd" class\x3d"property"\x3e\r\n          \x3cspan\x3e\x3cstrong\x3e${i18n.newPwdLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n          \x3cdiv style\x3d""\x3e\x3cbutton data-dojo-attach-point\x3d"_changePwdBtn" data-dojo-type\x3d"dijit.form.Button" class\x3d"calcite tertiary small"\r\n                                data-dojo-attach-event\x3d"onClick:onChangePassword"\x3e${i18n.changePwd}\x3c/button\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"nonOAuthChangePwd" class\x3d"property" style\x3d"display:none;"\x3e\r\n          \x3cspan\x3e\x3cstrong\x3e${i18n.changePwdLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n          \x3cdiv class\x3d"esriLeadingMargin3 esriTrailingMargin3" style\x3d"margin-bottom:1em;" data-dojo-attach-point\x3d"newPassword"\r\n               data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true,type:\'password\'"\x3e\x3c/div\x3e\r\n          \x3cbr style\x3d"clear:both;"/\x3e\r\n          \x3cdiv class\x3d"esriLeadingMargin3 esriTrailingMargin3" data-dojo-attach-point\x3d"verifyNewPassword"\r\n               data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true, type:\'password\'"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"mfa_edit" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.multiFactorAuth}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"readOnly esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"mfa_setting"\x3e\x3c/span\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"editOnly"\x3e\r\n          \x3cbutton data-dojo-attach-point\x3d"_enableMFA" data-dojo-type\x3d"dijit.form.Button" class\x3d"calcite tertiary small"\r\n                  data-dojo-attach-event\x3d"onClick:onEnableMFA"\x3e${i18n.enable}\x3c/button\x3e\r\n          \x3cbutton data-dojo-attach-point\x3d"_disableMFA" data-dojo-type\x3d"dijit.form.Button" class\x3d"calcite caution small"\r\n                  data-dojo-attach-event\x3d"onClick:onDisableMFA"\x3e${i18n.disable}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"question_edit" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.questionLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cdiv class\x3d"arrowSpaceMedium" style\x3d"width:300px;" data-dojo-attach-point\x3d"questionSelect"\r\n             data-dojo-type\x3d"dijit.form.FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"answer_edit" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.answerLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"questionAnswer"\r\n             data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true, type:\'text\'"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"property"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.whoSeeProfile}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"readOnly" data-dojo-attach-point\x3d"label_privacy"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"editOnlyBtn" style\x3d"display:none;"\x3e\r\n          \x3cspan id\x3d"privacy_public_span"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" name\x3d"privacy" id\x3d"privacy_public"/\x3e\r\n            \x3clabel for\x3d"privacy_public"\x3e${i18n.everyone}\x3c/label\x3e\r\n            \x3cbr/\x3e\r\n          \x3c/span\x3e\r\n          \x3cspan id\x3d"privacy_organization_span"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" name\x3d"privacy" id\x3d"privacy_account"/\x3e\r\n            \x3clabel for\x3d"privacy_account"\x3e${i18n.organization}\x3c/label\x3e\r\n            \x3cbr/\x3e\r\n          \x3c/span\x3e\r\n          \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" name\x3d"privacy" id\x3d"privacy_private"/\x3e\r\n          \x3clabel for\x3d"privacy_private"\x3e${i18n.privateLabel}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"language_edit" class\x3d"property" style\x3d"width:300px;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.languageLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"readOnly esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"language_setting"\x3e\x3c/span\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"editOnly arrowSpaceMedium" data-dojo-attach-point\x3d"languageSelect"\r\n             data-dojo-type\x3d"dijit.form.FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"region_edit" class\x3d"property"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.regionLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"esriItemLinks editOrgOnly" data-dojo-attach-point\x3d"region_setting"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"editNonOrgOnly" data-dojo-attach-point\x3d"regionSelect" data-dojo-type\x3d"dijit.form.FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"units_edit" class\x3d"property"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.unitsLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"readOnly esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"units_setting"\x3e\x3c/span\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"editOnly arrowSpaceMedium" data-dojo-attach-point\x3d"unitsSelect"\r\n             data-dojo-type\x3d"dijit.form.FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"organization_role_div" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.roleLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"organization_role"\x3e\x3c/span\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"organization_link_div" class\x3d"property"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.orgLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"organization_link"\x3e\x3c/span\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"organization_url_div" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.orgHomeurl}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"organization_url_link"\x3e\x3c/span\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"licensed_for_div" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.licensedProducts}\x3c/strong\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cdiv id\x3d"licensed_products_list"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv\x3e\x26nbsp;\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"editOnlyBtn bottomButtonBar" style\x3d"display:none;"\x3e\r\n    \x3cdiv id\x3d"lowerProfileSaveButton" class\x3d"dijitInline calcite blue" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:_saveEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.save}\x3c/div\x3e\r\n    \x3cdiv id\x3d"lowerProfileCancelButton" class\x3d"dijitInline calcite transparent" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:_cancelEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.cancel}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"editForm" method\x3d"post" enctype\x3d"multipart/form-data" onSubmit\x3d"return false;"\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"username"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"fullName"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"firstName"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"lastName"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"email"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"organization"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"tags"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"description"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"preferredView"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"defaultGroupId"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"access"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"sharing"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"culture"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"region"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"units"/\x3e\r\n\r\n    \x3cinput type\x3d"hidden" name\x3d"clearEmptyFields" value\x3d"true"/\x3e\r\n\r\n    \x3cdiv id\x3d"profile-thumbnail-dialog" class\x3d"thumbnailDialog dijitDialog"\x3e\r\n      \x3cdiv id\x3d"profile-thumbnail-header"\x3e\r\n        \x3cdiv style\x3d"background:none;padding-top:2px;" class\x3d"dijitDialogTitle dijitDialogTitleBar"\x3e\r\n          ${i18n.uploadThumbnail}\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"profile-thumbnail-close" title\x3d"${i18n.close}" class\x3d"dijitDialogCloseIcon"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"profile-thumbnail-content"\x3e\r\n        \x3cp\x3e\r\n          \x3cspan\x3e\r\n            \x3clabel for\x3d"profile-thumbnail-file"\x3e\r\n              ${i18n.specifyImage}\r\n            \x3c/label\x3e\r\n          \x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cdiv\x3e\r\n          \x3cspan style\x3d"margin-top:6px;"\x3e\r\n            \x3clabel for\x3d"profile-thumbnail-file"\x3e\r\n              ${i18n.imageLabel}\r\n            \x3c/label\x3e\r\n          \x3c/span\x3e\r\n          \x3cinput type\x3d"hidden" name\x3d"MAX_FILE_SIZE" value\x3d"1024000"\x3e\x3cinput type\x3d"file" id\x3d"profile-thumbnail-file" name\x3d"thumbnail" size\x3d"44" data-dojo-attach-point\x3d"thumbnailPath"\x3e\r\n        \x3c/div\x3e\r\n        \x3cp style\x3d"margin-top: 1.5em;"\x3e\r\n          \x3cspan\x3e${i18n.forBestResults}\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cdiv style\x3d"margin-top: 1.5em;"\x3e\r\n          \x3cbutton id\x3d"profile-thumbnail-cancel" class\x3d"jevent esriFloatTrailing calcite transparent" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.cancel}\r\n          \x3c/button\x3e\r\n          \x3cbutton id\x3d"profile-thumbnail-ok" class\x3d"jevent esriFloatTrailing calcite blue" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.ok}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"float: none; clear:both; width: 100%; height: 0;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
baseClass:"esriUserProfile",_account:arcgisonline.sharing.geow.Account,_community:arcgisonline.sharing.geow.Community,_util:arcgisonline.sharing.util,_user:null,_showUser:null,_isOwner:!1,_profile:null,_isSingleTenant:!1,_userProviderRetrieved:!1,_proListing:null,noDescriptionText:"",thumbnailPath:null,thumbnailImage:null,label_fullName:null,label_description:null,label_privacy:null,label_username:null,label_defaultGroup:null,editForm:null,organization_link:null,accountAdminRole:"account_admin",accountPublisherRole:"account_publisher",
accountUserRole:"account_user",accountViewerRole:"account_viewer",arcgisProvider:"arcgis",bothProvider:"both",enterpriseProvider:"enterprise",socialProviders:["google","facebook"],descriptionTextArea:null,descriptionEditorContainer:null,descriptionEditor:null,defaultGroupSelect:null,relatedLinks:null,questionSelect:null,questionAnswer:null,questionStore:null,newPassword:null,verifyNewPassword:null,newEmail:null,verifyNewEmail:null,languageSelect:null,regionSelect:null,reloadOnUpdate:!1,editConnects:[],
licenseKeywords:{proBasic:"desktopBasicN",proStandard:"desktopStdN",proAdvanced:"desktopAdvN",spatialAnalyst:"spatialAnalystN",threeDAnalyst:"3DAnalystN",networkAnalyst:"networkAnalystN",geostatAnalyst:"geostatAnalystN",dataReviewer:"dataReviewerN",workflowManager:"workflowMgrN",dataInterop:"dataInteropN",defenseMapping:"defenseN",fmv:"FMVN",businessBasic:"businessBasicN",businessStandard:"businessStdN",roadsHighways:"roadsHighwaysN",publisher:"publisherN",productionMap:"productionMapN",schematics:"schematicsN",
tracking:"trackingN",aviation:"aviationN",airports:"airportsN",maritime:"maritimeN",bathymetry:"bathymetryN"},i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=a.i18n.getLocalization("arcgisonline","arcgisonline").common;a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline","arcgisonline").userProfile);this.i18n.securityQuestions=a.i18n.getLocalization("arcgisonline","arcgisonline").securityQuestions;this.i18n.licenseTypes=a.i18n.getLocalization("arcgisonline","arcgisonline").manageLicenses.licenseTypes;
this.noDescriptionText=this.i18n.noDescriptionText},constructor:function(){var b=a.queryToObject(window.location.search.slice(1));b.user&&0<b.user.length&&(this._showUser=b.user);b.requireSecurity&&(this._requireSecurity=!0);this._rolesAPI=new arcgisonline.sharing.geow.Roles},postCreate:function(){this.inherited(arguments);esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;this._isSingleTenant=void 0!==esriGeowConfig.isMultiTenant&&null!==esriGeowConfig.isMultiTenant&&!1===esriGeowConfig.isMultiTenant;
this.thumbnailImage.src=this._util.relativeToExplicitUrl("js/arcgisonline/css/images/transparent.gif")},startup:function(){this.inherited(arguments);this._requireSecurity&&(this._requireSecurityHandler=a.connect(this,"onProfileLoad",a.hitch(this,function(b){this._requireSecurityHandler&&a.disconnect(this._requireSecurityHandler);if(this._requireSecurity)var c=setInterval(a.hitch(this,function(){this._userProviderRetrieved&&(clearInterval(c),this._startEdit(),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.notice,
message:this.i18n.noQuestionSetText}))}),100)})));this._account.getSelf(a.hitch(this,this._initUI))},_isDevSubscription:function(a){return a&&a.type&&"trial developer"===a.type.toLowerCase()},_initUI:function(b){this._self=b;this._isDeveloperSubscription=this._isDevSubscription(this._self.subscriptionInfo);a.queryToObject(window.location.search.slice(1)).passwordReset&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.passwordChanged,message:this.i18n.passwordChangedMsg});
this._oAuthInfo={url:this._util.getSecureUrl(esriGeowConfig.restBaseUrl)+"oauth2/authorize",clientId:"arcgisonline",redirectUri:esriGeowConfig.baseUrl+"postresetpassword.html",parent:window.location.protocol+"//"+window.location.host,expiration:20160,locale:a.locale};if(this._util.isLoggedIn()){if((this._user=this._util.getUser())&&this._user.accountId&&this._user.role)this._isAdmin=esriGeowConfig.userRole.isAdmin(),esriGeowConfig.userRole.isCustom()&&(this._roleCanView=(this._isCustomRole=esriGeowConfig.userRole.isCustom())&&
esriGeowConfig.userRole.canViewUsers(),this._roleCanUpdate=this._isCustomRole&&esriGeowConfig.userRole.canUpdateUsers(),this._roleCanManageLicenses=this._isCustomRole&&esriGeowConfig.userRole.canManageLicenses());this._isOwner=this._showUser?this._user.email===this._showUser:!0}else this._showUser||this._util.requireAuthentication();b=a.create;this.noDescriptionText=b("span");var c=b("span");if(this._isOwner){b("span",{innerHTML:this.i18n.writeSomething},c);var d=b("ul",null,c);b("li",{innerHTML:this.i18n.yourOrg},
d);b("li",{innerHTML:this.i18n.contactInfo},d);b("li",{innerHTML:this.i18n.areaOfExpertise},d);b("li",{innerHTML:this.i18n.interests},d);b("li",{innerHTML:this.i18n.anyOtherInfo},d)}else b("span",{id:"noDescriptionSpan",innerHTML:this.i18n.userNoInfo},c);this.noDescriptionText=b("span").appendChild(c).innerHTML;a.byId("user_profile_edit_title").innerHTML="\x3cb\x3e"+this.i18n.userNameLabel+"\x3c/b\x3e";esriGeowConfig.useDefaultIdentityStore?a.style(a.byId("user_profile_edit_link"),"display","none"):
esriGeowConfig.account_edit||a.style(a.byId("user_profile_edit_link"),"display","none");this._user&&this._user.accountId&&this._user.role&&this._user.role?(b("a",{href:"organization.html",innerHTML:this.i18n.myOrg},this.organization_link,"only"),10>=a.isIE?a.style(a.byId("organization_link_div"),"display",""):a.style(a.byId("organization_link_div"),"display","block")):a.style(a.byId("organization_link_div"),"display","none");this._isOwner||(b("a",{id:"viewItemsLink",href:esriGeowConfig.baseUrl+"search.html?q\x3downer:"+
this._showUser,innerHTML:this.i18n.viewItems},b("div",null,this.relatedLinks)),b("a",{id:"viewGroupsLink",href:esriGeowConfig.baseUrl+"search.html?t\x3dgroups\x26f\x3downer:"+this._showUser,innerHTML:this.i18n.viewGroups},b("div",null,this.relatedLinks)));this._isOwner&&a.query(".ownerOnly",this.domNode).style("display","block");this._isSingleTenant&&a.style(a.byId("region_edit"),"display","none");"ja"===a.locale&&a.place(a.byId("lastNameProperty"),a.byId("firstNameProperty"),"before");a.when(this._account.getSupportedLanguagesAndRegions(),
a.hitch(this,function(b){b&&(this._initLanguage(b.languages),this._initRegion(b.regions),b=this._username=this._isOwner?this._user.email:this._showUser,this._community.getProfile(b,a.hitch(this,this._handle_getProfile)))}),a.hitch(this,this._handleError));this._initUnits()},_getUserProvider:function(){var b=new a.Deferred;return this._util.request({url:esriGeowConfig.restBaseUrl+"community/users/"+this._username+"/forgotPassword"},{}).then(a.hitch(this,function(c){this._userProviderRetrieved=!0;if(this._user&&
this._isOwner){this._user.provider=c.provider;"ecas"===this._user.provider&&a.style(this.editUsernameLink,"display","inline-block");if("google"===this._user.provider||"facebook"===this._user.provider){var d=this._user.provider.charAt(0).toUpperCase()+this._user.provider.slice(1);a.addClass(this._socialProviderlIcon,"socialIcon"+d);a.attr(this._socialProviderName,"innerHTML",this.i18n["signedIn"+d]);a.removeClass(this._socialProviderlDiv,"hide")}-1<c.securityQuestionIdx&&(this._securityIdx=c.securityQuestionIdx)}else this._profile&&
(this._profile.provider=c.provider,-1<c.securityQuestionIdx&&(this._securityIdx=c.securityQuestionIdx));b.resolve()}),a.hitch(this,function(a){b.resolve()}))},_initLanguage:function(b){if(b){var c=[];a.forEach(b,function(a){a.displayName=a.language+(a.localizedName?"-"+a.localizedName:"");c.push(a)});b=new a.data.ItemFileReadStore({data:{identifier:"culture",label:"displayName",items:c}});this.languageSelect.set("store",b);this.languageSelect.set("searchAttr","displayName")}},_initRegion:function(b){b&&
(b=new a.data.ItemFileReadStore({data:{identifier:"region",label:"localizedName",items:b}}),this.regionSelect.set("store",b),this.regionSelect.set("searchAttr","localizedName"))},_initUnits:function(){if(!esri.isDefined(this.unitsStore)){var b=new a.data.ItemFileReadStore({data:{identifier:"id",label:"name",items:[{id:"english",name:this.i18n.unitsEnglish},{id:"metric",name:this.i18n.unitsMetric}]}});this.unitsSelect.set("store",b)}},_handle_getAccount:function(b,c){if(b&&!b.code&&!b.message){if(this._user.username===
this._profile.username||this._user.accountId===this._profile.accountId){var d="";b.thumbnail&&0<b.thumbnail.length&&(d+='\x3cimg src\x3d"'+this._buildOrganizationThumbnail(b)+'" align\x3d"center" class\x3d"groupThumbnail"/\x3e ');if(this._profile.firstName&&this._profile.lastName){var k="ja"===a.locale?this._profile.lastName+" "+this._profile.firstName:this._profile.firstName+" "+this._profile.lastName;a.attr(a.byId("myProfile"),"innerHTML",d+k)}else a.attr(a.byId("myProfile"),"innerHTML",d+this._profile.fullName+
"");a.style(a.byId("myProfile"),"display","inline-block");!this._isOwner&&(this._user.accountId&&this._user.accountId===this._profile.accountId)&&(a.attr(a.byId("viewItemsLink"),"innerHTML",this.i18n.viewMembersItems),a.attr(a.byId("viewGroupsLink"),"innerHTML",this.i18n.viewMembersGroups))}this._util.isPortal()&&esriGeowConfig.restrictOrganizationPageToAdmin&&this._user.role!==this.accountAdminRole?a.create("span",{innerHTML:b.name},this.organization_link,"only"):a.create("a",{href:"organization.html",
innerHTML:b.name},this.organization_link,"only");b.urlKey&&b.customBaseUrl&&(10>=a.isIE?a.style(a.byId("organization_url_div"),"display",""):a.style(a.byId("organization_url_div"),"display","block"),this.organization_url_link.innerHTML=location.protocol+"//"+b.urlKey+"."+b.customBaseUrl)}},_buildOrganizationThumbnail:function(a){var c=this._util.getToken();return esriGeowConfig.restBaseUrl+"portals/self/resources/"+a.thumbnail+(c?"?token\x3d"+c:"")},_handle_getProfile:function(b,c){this._profile=
b;esri.isDefined(b.orgId)&&(this._profile.accountId=b.orgId);esri.isDefined(b.role)&&(this._profile.role=this._util.normalizeOrgRole(b.role));if(this._isAdmin||this._roleCanView){if(!this._profile.accountId||this._profile.accountId!==this._user.accountId)this._isAdmin=!1;if(this._isAdmin||this._roleCanView&&this._profile.accountId&&this._profile.accountId===this._user.accountId)a.query(".ownerOnly",this.domNode).style("display","block"),!this._isOwner&&(!this._isAdmin&&!this._roleCanUpdate)&&a.style(a.byId("editMenu"),
"display","none"),(!esriGeowConfig.useDefaultIdentityStore&&!this._isOwner||!this._roleCanUpdate)&&a.style(a.byId("user_profile_edit_link"),"display","none"),this._profile.username!==this._user.email&&e.byId("profileEditButton").set("label",this.i18n.editProfile)}this._profile.accountId?this._handle_getAccount(this._self):a.attr(a.byId("myProfile"),"innerHTML",this._profile.fullName);this._getUserProvider().then(a.hitch(this,function(){this._loadProfile(this._profile);this.onProfileLoad(this._profile)}))},
onProfileLoad:function(a){},_loadProfile:function(b){if(b.culture&&a.locale!==b.culture.toLowerCase()){var c=arcgisonline.sharing.util.getCookie("esri_auth");if(c&&(c.username=c.username||c.email,c&&c.username===b.username)){if(9>a.isIE&&c.auth_tier&&"web"===c.auth_tier){var d=new Date;c.expires=new Date(d.setSeconds(d.getSeconds()+Number(7200)))}if(!c.culture||c.culture&&c.culture.toLowerCase()!==b.culture.toLowerCase())c.culture=b.culture.toLowerCase(),arcgisonline.sharing.geow.Geow.setAuthCookie(c);
window.location.reload()}}this.thumbnailImage.src=b.thumbnail&&0<b.thumbnail.length?this._community.getProfileThumbnailUrl(b):this._util.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg");b.firstName&&b.lastName?(a.attr(this._profileTitle,"innerHTML",esri.substitute({name:b.firstName},this.i18n.profileTitleLabel)),a.attr(this._firstNameLabel,"innerHTML",b.firstName),a.attr(this._lastNameLabel,"innerHTML",b.lastName)):(a.attr(this._profileTitle,"innerHTML",esri.substitute({name:a.trim(b.fullName)},
this.i18n.profileTitleLabel)),this._isEnterpriseUser(),c=b.fullName.indexOf(" "),0<c?b.culture&&"ja"===b.culture?(a.attr(this._lastNameLabel,"innerHTML",b.fullName.substring(0,c)),a.attr(this._firstNameLabel,"innerHTML",b.fullName.substring(c+1))):(a.attr(this._firstNameLabel,"innerHTML",b.fullName.substring(0,c)),a.attr(this._lastNameLabel,"innerHTML",b.fullName.substring(c+1))):a.attr(this._firstNameLabel,"innerHTML",b.fullName));c=a.create;this._util.htmlHasText(b.description)?(d=this._util.linkifyText(b.description),
8>a.isIE&&(d="\x3cpre class\x3d'esriProfileDesc'\x3e"+d+"\x3c/pre\x3e"),c("span",{innerHTML:d,style:"white-space:pre-wrap"},this.label_description,"only")):(c("span",{innerHTML:this.noDescriptionText,"class":"dim"},this.label_description,"only"),!this._isOwner&&(this._user&&this._user.accountId&&b.accountId&&this._user.accountId===b.accountId)&&a.attr("noDescriptionSpan","innerHTML",this.i18n.memberNoDescriptionText));c("span",{innerHTML:"public"===b.access?this.i18n.everyone:"org"===b.access?this.i18n.organization:
this.i18n.noonePrivate},this.label_privacy,"only");c("span",{innerHTML:b.username},this.label_username,"only");this.set("culture",b.culture);this.set("region",b.region);this.set("units",b.units);b.role&&(c="",this.accountAdminRole===b.role&&!esri.isDefined(b.roleId)?c=this.i18n.adminRole:this.accountPublisherRole===b.role&&!esri.isDefined(b.roleId)?c=this.i18n.publisherRole:this.accountUserRole===b.role&&!esri.isDefined(b.roleId)?c=this.i18n.userRole:esri.isDefined(b.roleId)&&this._rolesAPI.getRole(b.roleId).then(a.hitch(this,
function(b){b&&b.name&&(esriGeowConfig.userRole.name=b.name,esriGeowConfig.userRole.description=b.description,a.attr(this.organization_role,"innerHTML",b.name))})),a.attr(this.organization_role,"innerHTML",c),a.isIE?a.style(a.byId("organization_role_div"),"display",""):a.style(a.byId("organization_role_div"),"display","block"));this._self.mfaEnabled&&esriGeowConfig.multiFactorEnabled&&!this._util.isPortal()&&!this._isDeveloperSubscription&&this._isArcGISUser()&&(this._isAdmin||this._isOwner)&&this._user.accountId&&
this._profile.accountId&&this._user.accountId===this._profile.accountId?(a.style(a.byId("mfa_edit"),"display",""),b.mfaEnabled?(a.attr(this.mfa_setting,"innerHTML",this.i18n.enabledLabel),a.style(this._enableMFA.domNode,"display","none"),a.style(this._disableMFA.domNode,"display","")):(a.attr(this.mfa_setting,"innerHTML",this.i18n.disabledLabel),a.style(this._disableMFA.domNode,"display","none"),a.style(this._enableMFA.domNode,"display",""))):a.style(a.byId("mfa_edit"),"display","none");this._isArcGISUser()&&
(this._user&&!this._user.accountId&&this._isOwner||esriGeowConfig.userRole&&esriGeowConfig.userRole.isAdmin())?(this.newEmail.set("value",b.email),this.verifyNewEmail.set("value",""),a.attr(this._displayEmail,"innerHTML",b.email)):a.style(a.byId("user_email_edit"),"display","none");(this._isOwner||this._isAdmin||this._roleCanView&&this._roleCanManageLicenses)&&this._util.findProListing().then(a.hitch(this,function(b){b?(this._proListing=b,this._util.request({url:esriGeowConfig.restBaseUrl+"content/listings/"+
this._proListing.listing.itemId+"/userEntitlements/"+this._profile.username}).then(a.hitch(this,function(b){b&&!b.code&&b.userEntitlements&&b.userEntitlements.entitlements?(this._writeLicenseEntitlements(b.userEntitlements.entitlements),a.style(a.byId("licensed_for_div"),"display","")):a.style(a.byId("licensed_for_div"),"display","none")}),a.hitch(this,function(b){a.style(a.byId("licensed_for_div"),"display","none")}))):a.style(a.byId("licensed_for_div"),"display","none")}),a.hitch(this,function(b){a.style(a.byId("licensed_for_div"),
"display","none")}))},_writeLicenseEntitlements:function(b){a.attr(a.byId("licensed_products_list"),"innerHtml","");var c="",d=this.i18n.licenseTypes.agsProLabel+" ";-1<a.indexOf(b,this.licenseKeywords.proBasic)?d+=this.i18n.licenseTypes.basicLabel:-1<a.indexOf(b,this.licenseKeywords.proStandard)?d+=this.i18n.licenseTypes.standardLabel:-1<a.indexOf(b,this.licenseKeywords.proAdvanced)&&(d+=this.i18n.licenseTypes.advancedLabel);c+=d+"\x3cbr/\x3e";a.forEach(b,a.hitch(this,function(a){a===this.licenseKeywords.spatialAnalyst?
c+=this.i18n.licenseTypes.spatialAnalyst+"\x3cbr/\x3e":a===this.licenseKeywords.threeDAnalyst?c+=this.i18n.licenseTypes.threeDAnalyst+"\x3cbr/\x3e":a===this.licenseKeywords.networkAnalyst?c+=this.i18n.licenseTypes.networkAnalyst+"\x3cbr/\x3e":a===this.licenseKeywords.geostatAnalyst?c+=this.i18n.licenseTypes.geostatisticalAnalyst+"\x3cbr/\x3e":a===this.licenseKeywords.dataReviewer?c+=this.i18n.licenseTypes.dataReviewer+"\x3cbr/\x3e":a===this.licenseKeywords.workflowManager?c+=this.i18n.licenseTypes.workflowManager+
"\x3cbr/\x3e":a===this.licenseKeywords.dataInterop?c+=this.i18n.licenseTypes.dataInterop+"\x3cbr/\x3e":a===this.licenseKeywords.defenseMapping?c+=this.i18n.licenseTypes.defenseMapping+"\x3cbr/\x3e":a===this.licenseKeywords.fmv?c+=this.i18n.licenseTypes.fullMotionVideo+"\x3cbr/\x3e":a===this.licenseKeywords.businessBasic?c+=this.i18n.licenseTypes.businessBasic+"\x3cbr/\x3e":a===this.licenseKeywords.businessStandard?c+=this.i18n.licenseTypes.businessStd+"\x3cbr/\x3e":a===this.licenseKeywords.roadsHighways?
c+=this.i18n.licenseTypes.roadsHighways+"\x3cbr/\x3e":a===this.licenseKeywords.publisher?c+=this.i18n.licenseTypes.publisher+"\x3cbr/\x3e":a===this.licenseKeywords.productionMap?c+=this.i18n.licenseTypes.productionMapping+"\x3cbr/\x3e":a===this.licenseKeywords.schematics?c+=this.i18n.licenseTypes.schematics+"\x3cbr/\x3e":a===this.licenseKeywords.tracking?c+=this.i18n.licenseTypes.tracking+"\x3cbr/\x3e":a===this.licenseKeywords.aviation?c+=this.i18n.licenseTypes.aviation+"\x3cbr/\x3e":a===this.licenseKeywords.airports?
c+=this.i18n.licenseTypes.airports+"\x3cbr/\x3e":a===this.licenseKeywords.maritime?c+=this.i18n.licenseTypes.maritime+"\x3cbr/\x3e":a===this.licenseKeywords.bathymetry&&(c+=this.i18n.licenseTypes.bathymetry+"\x3cbr/\x3e")}));a.attr(a.byId("licensed_products_list"),"innerHTML",c)},_loadProfileEdit:function(b){this.descriptionTextArea.value=b.description||"";"public"===b.access?e.byId("privacy_public").set("checked",!0):"org"===b.access?e.byId("privacy_account").set("checked",!0):e.byId("privacy_private").set("checked",
!0);this._profile.accountId&&(this._self.canSharePublic?a.style(a.byId("privacy_public_span"),"display",""):(a.style(a.byId("privacy_public_span"),"display","none"),"public"===this._profile.access&&e.byId("privacy_account").set("checked",!0)))},_startEdit:function(){this._loadProfileEdit(this._profile);if(this._isArcGISUser()&&(this._isOwner||this._util.isPortal()))a.style(a.byId("new_password_edit"),"display",""),a.style(a.byId("question_edit"),"display",""),a.style(a.byId("answer_edit"),"display",
""),this.questionSelect.set("displayedValue",this.i18n.questionPrompt),this.questionAnswer.set("value",""),this._util.isPortal()&&!esriGeowConfig.self.supportsOAuth&&(a.style(a.byId("oAuthChangePwd"),"display","none"),a.style(a.byId("nonOAuthChangePwd"),"display",""),this.newPassword.set("value",""),this.verifyNewPassword.set("value","")),esri.isDefined(this.questionStore)||(this.securityQuestionsArr=[{id:1,name:this.i18n.securityQuestions[1]},{id:2,name:this.i18n.securityQuestions[2]},{id:3,name:this.i18n.securityQuestions[3]},
{id:4,name:this.i18n.securityQuestions[4]},{id:5,name:this.i18n.securityQuestions[5]},{id:6,name:this.i18n.securityQuestions[6]},{id:7,name:this.i18n.securityQuestions[7]},{id:8,name:this.i18n.securityQuestions[8]},{id:9,name:this.i18n.securityQuestions[9]},{id:10,name:this.i18n.securityQuestions[10]},{id:11,name:this.i18n.securityQuestions[11]},{id:12,name:this.i18n.securityQuestions[12]},{id:13,name:this.i18n.securityQuestions[13]},{id:14,name:this.i18n.securityQuestions[14]}],this.questionStore=
new a.data.ItemFileReadStore({data:{identifier:"id",label:"name",items:this.securityQuestionsArr}}),this.questionSelect.set("store",this.questionStore)),this.questionSelect.set("displayedValue",-1<this._securityIdx?this.i18n.securityQuestions[this._securityIdx]:this.i18n.questionPrompt);a.query(".readOnly",this.domNode).style("display","none");a.query(".editOnlyBtn",this.domNode).style("display","");a.query(".editOnly",this.domNode).style("display","block");this._user.accountId||(a.query(".editOrgOnly",
this.domNode).style("display","none"),a.query(".editNonOrgOnly",this.domNode).style("display","block"));this._isArcGISUser()&&(this._profile&&this._user.username!==this._profile.username&&!this._profile.mfaEnabled)&&(a.style(this.mfa_setting.parentNode,"display",""),a.style(this._enableMFA.domNode.parentNode,"display","none"));(!this._profile.accountId||""===this._profile.accountId||void 0!==esriGeowConfig.isMultiTenant&&!1===esriGeowConfig.isMultiTenant)&&a.style(a.byId("privacy_organization_span"),
"display","none");var b;this._profile.firstName&&a.attr("first_name","value",this._profile.firstName);this._profile.lastName&&a.attr("last_name","value",this._profile.lastName);this._isEnterpriseUser()&&this._isNotSet(this._profile.firstName)&&this._isNotSet(this._profile.lastName)?(b=this._profile.fullName.indexOf(" "),0<b?this._profile.culture&&"ja"===this._profile.culture?(a.attr("last_name","value",this._profile.fullName.substring(0,b)),a.attr("name_name","value",this._profile.fullName.substring(b+
1))):(a.attr("first_name","value",this._profile.fullName.substring(0,b)),a.attr("last_name","value",this._profile.fullName.substring(b+1))):a.attr("first_name","value",this._profile.fullName)):this._isNotSet(this._profile.firstName)&&this._isNotSet(this._profile.lastName)&&(b=this._profile.fullName.indexOf(" "),0<b?this._profile.culture&&"ja"===this._profile.culture?(a.attr("last_name","value",this._profile.fullName.substring(0,b)),a.attr("name_name","value",this._profile.fullName.substring(b+1))):
(a.attr("first_name","value",this._profile.fullName.substring(0,b)),a.attr("last_name","value",this._profile.fullName.substring(b+1))):a.attr("first_name","value",this._profile.fullName));!esriGeowConfig.useDefaultIdentityStore&&(!this._isArcGISUser()&&!this._isEnterpriseUser())&&!this._isSocialUser()&&(a.style(this._firstNameInput,"display","none"),a.style(this._lastNameInput,"display","none"),a.style(this._firstNameLabel,"display",""),a.style(this._lastNameLabel,"display",""));this.editConnects.push(a.connect(this.thumbnailImage,
"onclick",this,"_showThumbnailDialog"));this.editConnects.push(a.connect(a.byId("profile-thumbnail-close"),"onclick",this,"_thumbnailCancel"));this.editConnects.push(a.connect(a.byId("profile-thumbnail-ok"),"onclick",this,"_thumbnailOk"));this.editConnects.push(a.connect(a.byId("profile-thumbnail-cancel"),"onclick",this,"_thumbnailCancel"))},_isNotSet:function(a){return!a||0===a.length},_isArcGISUser:function(){return this._isOwner&&esri.isDefined(this._user.provider)&&this._user.provider===this.arcgisProvider||
!this._isOwner&&esri.isDefined(this._profile.provider)&&this._profile.provider===this.arcgisProvider},_isEnterpriseUser:function(){return this._isOwner&&esri.isDefined(this._user.provider)&&this._user.provider===this.enterpriseProvider||!this._isOwner&&esri.isDefined(this._profile.provider)&&this._profile.provider===this.enterpriseProvider},_isSocialUser:function(){return this._isOwner&&esri.isDefined(this._user.provider)&&a.indexOf(this.socialProviders,-1!==this._user.provider)||!this._isOwner&&
esri.isDefined(this._profile.provider)&&-1!==a.indexOf(this.socialProviders,this.enterpriseProvider)},_hasNewIdentityQuestion:function(){var a=this.questionAnswer.get("value"),c=this.questionSelect.get("item");return esri.isDefined(c)&&this.questionStore.getValue(c,"id")!==this._securityIdx&&a&&a.length},_hasNewIdentityQuestionInfo:function(){var a=this.questionAnswer.get("value"),c=this.questionSelect.get("item");return esri.isDefined(c)&&this.questionStore.getValue(c,"id")!==this._securityIdx||
a&&0<a.length},_validateNewIdentityQuestionInfo:function(){var a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c=this.questionAnswer.get("value");if(esri.isDefined(c)&&0<c.length)return 60<c.length?(a.show({title:this.i18n.errorLabel,message:this.i18n.error.answerTooLong}),this.questionAnswer.focus(),!1):!0;a.show({title:this.i18n.errorLabel,message:this.i18n.error.answerIsBlank});this.questionAnswer.focus();return!1},_containsAlphaNumeric:function(a){var c=/^[a-zA-Z0-9@_\.\-\s]+$/g;
return a&&!!c.test(a)},_hasNewEmail:function(){var a=this.newEmail.get("value"),c=this.verifyNewEmail.get("value");return esri.isDefined(a)&&0<a.length&&a!==this._profile.email||esri.isDefined(c)&&0<c.length},_validateNewEmail:function(){var a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c=this.newEmail.get("value"),d=this.verifyNewEmail.get("value");if(esri.isDefined(c)&&0<c.length)return!this._isValidEmail(c)?(a.show({title:this.i18n.errorLabel,message:this.i18n.error.emailInvalid}),
this.verifyNewEmail.focus(),!1):c!==d?(a.show({title:this.i18n.errorLabel,message:this.i18n.error.emailVerifyNoMatch}),this.verifyNewEmail.focus(),!1):!0;esri.isDefined(d)&&0<d.length&&(a.show({title:this.i18n.errorLabel,message:this.i18n.error.emailVerifyNoMatch}),this.newEmail.focus());return!1},_isValidEmail:function(a){if(window.RegExp){var c=/^.+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,20}|[0-9]{1,3})(\]?)$/;return!/(@.*@)|(\.\.)|(@\.)|(\.@)|(^\.)/.test(a)&&c.test(a)?!0:!1}return-1===a.indexOf("@")||
-1===a.indexOf(".")?!1:!0},_hasNewPassword:function(){var a=this.newPassword.get("value"),c=this.verifyNewPassword.get("value");return esri.isDefined(a)&&0<a.length||esri.isDefined(c)&&0<c.length},_validateNewPassword:function(){var a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c=this.newPassword.get("value"),d=this.verifyNewPassword.get("value");if(esri.isDefined(c)&&0<c.length)return!this._util.meetsPasswordStrength(c)?(a.show({title:this.i18n.errorLabel,message:this.i18n.passwordHintText}),
this.newPassword.focus(),!1):c!==d?(a.show({title:this.i18n.errorLabel,message:this.i18n.error.passwordVerifyNoMatch}),this.verifyNewPassword.focus(),!1):!0;esri.isDefined(d)&&0<d.length&&(a.show({title:this.i18n.errorLabel,message:this.i18n.error.passwordVerifyNoMatch}),this.newPassword.focus());return!1},_validateFirstName:function(){var a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c=this.firstName.get("value");if(esri.isDefined(c)&&0<c.length)return!0;a.show({title:this.i18n.errorLabel,
message:this.i18n.firstNameIsBlank});this.firstName.focus();return!1},_validateLastName:function(){var a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c=this.lastName.get("value");if(esri.isDefined(c)&&0<c.length)return!0;a.show({title:this.i18n.errorLabel,message:this.i18n.lastNameIsBlank});this.lastName.focus();return!1},_validates:function(){return!this._validateFirstName()||!this._validateLastName()?!1:this._util.isPortal()&&!esriGeowConfig.self.supportsOAuth&&this._hasNewPassword()&&
!this._validateNewPassword()?(this.newPassword&&this.newPassword.focus(),!1):this._hasNewIdentityQuestionInfo()&&!this._validateNewIdentityQuestionInfo()?(this.questionAnswer&&this.questionAnswer.focus(),!1):!0},_saveEdit:function(){if(this._validates()){var b=this.editForm;b.username.value=this._profile.username;esriGeowConfig.useDefaultIdentityStore||this._isArcGISUser()||this._isEnterpriseUser()||this._isSocialUser()?(b.firstName.value=a.attr("first_name","value"),b.lastName.value=a.attr("last_name",
"value"),this._isEnterpriseUser()&&(b.fullName.value="ja"===a.locale?b.lastName.value+" "+b.firstName.value:b.firstName.value+" "+b.lastName.value),this.reloadOnUpdate=this._isEnterpriseUser()?b.fullName.value!==this._profile.fullName:b.firstName.value!==this._profile.firstName||b.lastName.value!==this._profile.lastName):(b.firstName.value=this._profile.firstName,b.lastName.value=this._profile.lastName);b.email.value=this._profile.email;b.tags.value=this._profile.tags?this._profile.tags.toString():
"";b.description.value=this._util.stripHTML(this.descriptionTextArea.value);!0===e.byId("privacy_public").get("checked")?b.access.value="public":!0===e.byId("privacy_account").get("checked")?b.access.value="org":b.access.value="private";this.languageSelect.store.fetch({query:{displayName:this.languageSelect.get("displayedValue")},onItem:a.hitch(this,function(a){a&&(b.culture.value=this.languageSelect.store.getValue(a,"culture"))})});this.regionSelect.store.fetch({query:{localizedName:this.regionSelect.get("displayedValue")},
onItem:a.hitch(this,function(a){a&&(b.region.value=this.regionSelect.store.getValue(a,"region"))})});this.unitsSelect.store.fetch({query:{name:this.unitsSelect.get("displayedValue")},onItem:a.hitch(this,function(a){a&&(b.units.value=this.unitsSelect.store.getValue(a,"id"))})});var c=!1,d=!1,k=this._requireSecurity&&!this._hasNewIdentityQuestion(),f=a.byId("new-arcgis-question"),l=a.byId("new-arcgis-answer");if(this._isArcGISUser()||this._isSocialUser())if(this._hasNewEmail()&&(this._validateNewEmail()?
b.email.value=this.newEmail.get("value"):d=!0),this._util.isPortal()&&(!esriGeowConfig.self.supportsOAuth&&this._hasNewPassword()&&this._validateNewPassword())&&(c=!0,a.create("input",{id:"new-arcgis-password",type:"hidden",name:"password",value:this.newPassword.get("value")},b)),this._hasNewIdentityQuestionInfo()&&this._validateNewIdentityQuestionInfo()){var g=this.questionSelect.get("store"),p=this.questionSelect.get("displayedValue"),m=this.questionSelect.get("item"),h;if(m)h=g.getValue(m,"id");
else for(g=0;g<this.securityQuestionsArr.length;g++)if(p==this.securityQuestionsArr[g].name){h=this.securityQuestionsArr[g].id;break}this._securityIdx=h;f||(f=a.create("input",{id:"new-arcgis-question",type:"hidden",name:"securityQuestionIdx"},b));l||(l=a.create("input",{id:"new-arcgis-answer",type:"hidden",name:"securityAnswer"},b));a.attr(f,"value",h);a.attr(l,"value",this.questionAnswer.get("value"))}var n=a.hitch(this,function(d){if(d&&!0===d.success)if(a.byId("new-arcgis-email")&&a.destroy(a.byId("new-arcgis-email")),
this._util.isPortal()&&(!esriGeowConfig.self.supportsOAuth&&a.byId("new-arcgis-password"))&&a.destroy(a.byId("new-arcgis-password")),a.byId("new-arcgis-question")&&a.destroy(a.byId("new-arcgis-question")),a.byId("new-arcgis-answer")&&a.destroy(a.byId("new-arcgis-answer")),this._isOwner){var e=arcgisonline.sharing.util.getCookie("esri_auth");b.fullName.value!==this._profile.fullName&&(e.fullName=b.fullName.value);e.culture!==b.culture.value&&(e.culture=b.culture.value.toLowerCase(),this.reloadOnUpdate=
!0);e.region!==b.region.value&&(e.region=b.region.value);arcgisonline.sharing.geow.Geow.setAuthCookie(e);this._requireSecurity&&(this.reloadOnUpdate=!0);this._util.isPortal()&&!esriGeowConfig.self.supportsOAuth&&c?(d=arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.baseUrl)+esriGeowConfig.signin,arcgisonline.sharing.geow.Geow.signout(d)):this._handle_updateProfile(d)}else this._handle_updateProfile(d);else this._handle_updateProfile(d)});d||(k?arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.notice,
message:this.i18n.questionRequired}):this._util.isPortal()&&!esriGeowConfig.self.supportsOAuth?(d={title:this.i18n.newPwdLabel,message:this.i18n.changePwdWarning,choiceOneTitle:this.i18n.yesLabel,choiceTwoTitle:this.i18n.noLabel},d.choiceOneHandler=a.hitch(this,function(){this._updateProfile(b).then(n,a.hitch(this,this._handle_updateProfile))}),arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show(d)):this._updateProfile(b).then(n,a.hitch(this,this._handle_updateProfile)))}},
_updateProfile:function(a){var c;c=this._util.getUser();c=this._isAdmin||this._roleCanUpdate?a.username.value:c.email;c=this._util.getSecureUrl(esriGeowConfig.restBaseUrl)+"community/users/"+c+"/update";return this._util.postForm(a,c)},_cancelEdit:function(){this._stopEdit();this.editForm.reset()},_stopEdit:function(){a.style(a.byId("new_password_edit"),"display","none");a.style(a.byId("question_edit"),"display","none");a.style(a.byId("answer_edit"),"display","none");a.query(".editNonOrgOnly",this.domNode).style("display",
"none");a.query(".editOnly",this.domNode).style("display","none");a.query(".editOnlyBtn",this.domNode).style("display","none");a.query(".readOnly",this.domNode).style("display","");a.query(".editOrgOnly",this.domNode).style("display","");a.style(e.byId("profileEditButton").domNode,"display",a.isIE?"inline-block":"");this.thumbnailPath.value="";a.forEach(this.editConnects,function(b){a.disconnect(b)});this.editConnects=[];this.regionSelect.reset();this.languageSelect.reset();this.set("culture",this._profile.culture);
this.set("region",this._profile.region)},_showThumbnailDialog:function(b){var c=a.position(this._thumbnailDiv);a.style(a.byId("profile-thumbnail-dialog"),"top",Math.round(c.y)+"px");a.style(a.byId("profile-thumbnail-dialog"),"left",(esriGeowConfig.isRightToLeft?Math.round(c.x)+c.w-a.style("profile-thumbnail-dialog","width"):Math.round(c.x))+"px");a.style(a.byId("profile-thumbnail-dialog"),"display","block");b.stopPropagation()},_thumbnailOk:function(){var b=a.byId("profile-thumbnail-file").value,
c=b.lastIndexOf("."),b=b.substring(c+1,b.length).toLowerCase();"png"!=b&&"gif"!=b&&"jpg"!=b&&"jpeg"!=b?arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorLabel,message:this.i18n.error.imageTypeError}):(""!=a.byId("profile-thumbnail-file").value&&(this.thumbnailImage.src=this._util.relativeToExplicitUrl("images/item-thumbnail-update.png")),a.style(a.byId("profile-thumbnail-dialog"),"display","none"))},_thumbnailCancel:function(b){a.style(a.byId("profile-thumbnail-dialog"),
"display","none");a.forEach(this.editConnects,function(b){a.disconnect(b)});this.editConnects=[];a.byId("profile-thumbnail-dialog").innerHTML=a.byId("profile-thumbnail-dialog").innerHTML;this.editConnects.push(a.connect(this.thumbnailImage,"onclick",this,"_showThumbnailDialog"));this.editConnects.push(a.connect(a.byId("profile-thumbnail-close"),"onclick",this,"_thumbnailCancel"));this.editConnects.push(a.connect(a.byId("profile-thumbnail-ok"),"onclick",this,"_thumbnailOk"));this.editConnects.push(a.connect(a.byId("profile-thumbnail-cancel"),
"onclick",this,"_thumbnailCancel"))},_handle_updateProfile:function(b,c){var d=this._isOwner?this._user.email:this._showUser;if(b.success)this.reloadOnUpdate?this._requireSecurity?(this._requireSecurity=!1,window.location=window.location.href.split("?")[0]):window.location=this._showUser?esriGeowConfig.baseUrl+"user.html?user\x3d"+this._showUser:esriGeowConfig.baseUrl+"user.html":(this._community.getProfile(d,a.hitch(this,this._handle_getProfile)),this._stopEdit());else{var e=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
if(this._isInvalidSubscription(b))this._community.getProfile(d,a.hitch(this,this._handle_getProfile)),arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg.prototype.statics.getInstance().show(esriGeowConfig.self.subscriptionInfo);else if(this._isOtherInvalidSubscription(b))this._community.getProfile(d,a.hitch(this,this._handle_getProfile)),d=b&&b.error?b.error:b,arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg.prototype.statics.getInstance().showOther(d.messageCode);else if(b.error&&b.error.message&&
-1<b.error.message.indexOf("file exceeds the max size"))e.show({title:this.i18n.cannotAddThumbnail,message:b.error.message});else if(b&&b.messageCode&&"COM_1035"===b.messageCode)e.show({title:this.i18n.errorUpdatingProfile,message:this.i18n.errorUpdatingProfileMsg});else{var d=b&&b.error?b.error:b,f=d.message?d.message:d,f=f+(d.details?" "+d.details:"");e.show({title:this.i18n.errorUpdatingProfile,message:f})}this._stopEdit();this._profile.thumbnail&&0<this._profile.thumbnail.length&&(this.thumbnailImage.src=
this._community.getProfileThumbnailUrl(this._profile))}},_isInvalidSubscription:function(b){b=b&&b.error?b.error:b;var c=["SB_0001","SB_0002","SB_0003","SB_0004"];return b&&b.messageCode&&-1!==a.indexOf(c,b.messageCode)},_isOtherInvalidSubscription:function(b){b=b&&b.error?b.error:b;var c=["SB_0005","SB_0006","SB_0007"];return b&&b.messageCode&&-1!==a.indexOf(c,b.messageCode)},_changePassword:function(a){a=esriGeowConfig.baseUrl;!1!==esriGeowConfig.useSSL&&this._util.getSecureUrl(esriGeowConfig.restBaseUrl);
a+="password.html";this._showUser&&(a+="?user\x3d"+this._showUser);window.location=a},_handleError:function(a){console.log(a)},_setCultureAttr:function(b){b&&this.languageSelect.store.fetchItemByIdentity({identity:b,onItem:a.hitch(this,function(b){b&&(this.languageSelect.set("value",b.culture),a.attr(this.language_setting,"innerHTML",b.displayName))})})},_setRegionAttr:function(b){b&&this.regionSelect.store.fetchItemByIdentity({identity:b,onItem:a.hitch(this,function(b){b&&(this.regionSelect.set("value",
b.region),a.attr(this.region_setting,"innerHTML",b.localizedName))})})},_setUnitsAttr:function(b){esri.isDefined(b)||(b="english");this.unitsSelect.store.fetchItemByIdentity({identity:b,onItem:a.hitch(this,function(b){b&&(this.unitsSelect.set("value",b.id),a.attr(this.units_setting,"innerHTML",b.name))})})},onChangePassword:function(){this._oAuthInfo.redirectUri=encodeURIComponent(this._oAuthInfo.redirectUri+"?isPortal\x3d"+esriGeowConfig.self.isPortal);window.location=esri.substitute(this._oAuthInfo,
"${url}?client_id\x3d${clientId}\x26redirect_uri\x3d${redirectUri}\x26response_type\x3dtoken\x26expiration\x3d${expiration}\x26locale\x3d${locale}\x26resetPassword\x3dtrue")},onEnableMFA:function(){this._oAuthInfo.redirectUri=encodeURIComponent(esriGeowConfig.baseUrl+"postmfa.html");window.location=esri.substitute(this._oAuthInfo,"${url}?client_id\x3d${clientId}\x26redirect_uri\x3d${redirectUri}\x26response_type\x3dtoken\x26expiration\x3d${expiration}\x26locale\x3d${locale}\x26enableMfa\x3dtrue")},
onDisableMFA:function(){arcgisonline.sharing.dijit.dialog.DeleteWarningDlg.prototype.statics.getInstance().showMsgTitleButton(this.i18n.disableMultiFactorMsg,this.i18n.disable+" "+this.i18n.multiFactorAuth,this.i18n.disable,a.hitch(this,this.reallyDisableMFA,this._profile.username));a.removeClass(e.byId("button_delete-warning-submit").domNode,"orange");a.addClass(e.byId("button_delete-warning-submit").domNode,"caution")},reallyDisableMFA:function(b){var c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
d=this._util.getSecureUrl(esriGeowConfig.restBaseUrl)+"community/users/"+b+"/disableMfa";this._util.request({url:d},{usePost:!0}).then(a.hitch(this,function(b){c.show({title:this.i18n.notice,message:this.i18n.disableMultiFactorSuccess});this._profile.mfaEnabled=!1;a.attr(this.mfa_setting,"innerHTML",this.i18n.disabledLabel);a.style(this._disableMFA.domNode,"display","none");a.style(this._enableMFA.domNode,"display","");this._profile&&this._user.username!==this._profile.username&&(a.style(this.mfa_setting.parentNode,
"display",""),a.style(this._enableMFA.domNode.parentNode,"display","none"));a.removeClass(e.byId("button_delete-warning-submit").domNode,"caution");a.addClass(e.byId("button_delete-warning-submit").domNode,"orange")}),a.hitch(this,function(a){console.log("error disabling multi-factor authentication",a);a=esri.substitute({user:b},this.i18n.error.disableMultiFactor);c.show({title:this.i18n.noticeLabel,message:a})}))}})});