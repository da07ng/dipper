// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/dialog/PluginConfigurableApps","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/dom-class dojo/query ./_AppTemplateFiltersMixin dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),function(f,c,g,e,m,n,h,k){var d=f("arcgisonline.sharing.dijit.dialog.PluginConfigurableApps",null,{infoPanelTemplate:'\x3cdiv\x3e\x3cdiv class\x3d"template-info-showing"\x3e\x3cdiv class\x3d"thumbnail"\x3e\x3cimg src\x3d"${item:_formatInfoPanelImage}"\x3e\x3c/div\x3e\x3ch4\x3e${item.title}\x3c/h4\x3e\x3cdiv class\x3d"template-info"\x3e\x3cp class\x3d"quiet-scroll"\x3e${item.snippet}\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"panel-actions"\x3e\x3cbutton class\x3d"btn blue btn-main" id\x3d"create-app"\x3e${i18n.items.createApp}\x3c/button\x3e\x3cbutton class\x3d"btn btn-secondary btn-wide" id\x3d"download-app"\x3e${i18n.templatesGridWidget.download}\x3c/button\x3e\x3cbutton class\x3d"btn btn-cancel" id\x3d"close-panel"\x3e${i18n.common.close}\x3c/button\x3e\x3c/div\x3e\x3cdiv\x3e',
filters:h.rootNodes.app,filterStrings:k.appTemplateFilters,rowsPerPage:100,constructor:function(a){c.mixin(this,a);this.helpLinkUrl=esriGeowConfig.self?esriGeowConfig.self.helpBase+esriGeowConfig.self.helpMap.m["120001055"]:""},fetchData:function(){var a=[];this._portal=this.parent._portal;this._user=this._portal.getPortalUser();return this._fetchGroups().then(c.hitch(this,function(b){g.forEach(b||[],function(b){b&&b.id&&a.push('group:"'+b.id+'"')});return this._fetchGroupItems(a)}))},_fetchGroups:function(){var a=
this._portal.templatesGroupQuery||null;return a&&a.split("id:")[1]?this._fetchOrgConfigurableApps():this._fetchEsriConfigurableApps()},_fetchGroup:function(a,b){this._groups=this._groups||[];return this._groups[a]||this._portal.queryGroups(b,!0).then(c.hitch(this,function(b){b=b.total&&b.results&&b.results[0]||null;return(this._groups[a]=b)||{}}))},_fetchGroupItems:function(a){return this.parent._fetchItems({groups:a})},_fetchEsriConfigurableApps:function(){var a=this._user&&this._user.culture||this._portal&&
this._portal.culture||dojoConfig.locale||"en",b={q:'title:"Web Application Templates" AND owner:"esri_'+a.split("-")[0].toLowerCase()+'"'},l={q:'title:"Gallery Templates" AND owner:"esri_'+a.split("-")[0].toLowerCase()+'"'};return e([this._fetchGroup("esriGallery_"+a,b),this._fetchGroup("esriApps_"+a,l)]).then(c.hitch(this,function(a){return a||[]}))},_fetchOrgConfigurableApps:function(){var a={q:this._portal.templatesGroupQuery||null};this.filters=null;this.rowsPerPage=8;this.extraClasses=["wide"];
return e([this._fetchGroup("customGallery",a)]).then(c.hitch(this,function(a){this.parent.sortDescending=a[0].sortOrder&&"desc"===a[0].sortOrder||!1;this.parent.sortAttribute=a[0].sortField||"asc";return a&&a.length?[a[0]]:[]}))}});c.mixin(d,{add:function(a,b){if(!a.plugIn){var c=b||{};c.parent=a;a.plugIn=new d(c)}},remove:function(a){a.plugIn&&(a.plugIn.destroy(),delete a.plugIn)}});return d});