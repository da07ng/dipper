// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/geow/Group",["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/DeleteWarningDlg"],function(e,b,f){b.provide("arcgisonline.sharing.geow.Group");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.dialog.DeleteWarningDlg");arcgisonline.sharing.geow.Group={util:arcgisonline.sharing.util,i18n:function(){if(this._i18n)return this._i18n;this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;
b.mixin(this._i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").groupGeow);return this._i18n},getGroupContent:function(b,a,d){this.util.getJson(esriGeowConfig.restBaseUrl+"content/groups/"+b,a,d)},getGroupUsers:function(b,a,d){this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups/"+b+"/users",a,d)},usersToStore:function(c){var a=0,d=[];b.forEach(c.users,function(b,c){d[a]={fullname:b,id:a};a++});b.forEach(c.admins,function(b,c){d[a]={fullname:b,id:a};a++});return store=new b.data.ItemFileReadStore({data:{identifier:"id",
items:d}})},groupsToStore:function(c){var a=[];b.forEach(c,function(b,a){this[a]=b;b.userMembership?(this[a].userMembership_username=b.userMembership.username,this[a].userMembership_memberType=b.userMembership.memberType,this[a].userMembership_applications=b.userMembership.applications,this[a].userMembership=null):this[a].userMembership_memberType=""},a);return new b.data.ItemFileReadStore({data:{identifier:"id",label:"title",items:a}})},getUrl:function(c){if(window.location.search)var a=b.queryToObject(window.location.search.slice(1)).n;
window.location=c+"?n\x3d"+a},getApplications:function(b,a,d){this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups/"+b+"/applications",a,d)},acceptApplication:function(c,a){this.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+c+"/applications/"+a+"/accept",b.hitch(this,function(a,c){b.publish("onApplicationAccept",[""])}))},declineApplication:function(c,a){this.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+c+"/applications/"+a+"/decline",b.hitch(this,function(a,
c){b.publish("onApplicationDecline",[""])}))},acceptInvitation:function(c){var a=function(a,c){b.publish("onInvitationAccept",[""])},d=this.util.getUser();null!=d&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+d.email+"/invitations/"+c+"/accept",b.hitch(this,a))},declineInvitation:function(c){var a=function(a,c){b.publish("onInvitationDecline",[""])},d=this.util.getUser();null!=d&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+d.email+"/invitations/"+c+"/decline",
b.hitch(this,a))},acceptInvitationByUser:function(c,a){var d=function(a,c){b.publish("onInvitationAccept",[""])};null!=this.util.getUser()&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+a+"/invitations/"+c+"/accept",b.hitch(this,d))},declineInvitationByUser:function(c,a){var d=function(a,c){b.publish("onInvitationDecline",[""])};null!=this.util.getUser()&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+a+"/invitations/"+c+"/decline",b.hitch(this,d))},removeFromGroup:function(c,
a){arcgisonline.sharing.dijit.dialog.DeleteWarningDlg.prototype.statics.getInstance().showMsgTitleButton(b.string.substitute(this.i18n().removeUserMsg,{username:a}),this.i18n().removeAccess,this.i18n().remove,b.hitch(arcgisonline.sharing.geow.Group,"reallyRemoveFromGroup",c,a))},reallyRemoveFromGroup:function(c,a){this.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+c+"/removeUsers?users\x3d"+a,b.hitch(this,function(a,c){b.publish("onGroupLeave",[""])}))}}});