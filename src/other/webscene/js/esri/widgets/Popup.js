// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/widgets/Popup/templates/Popup.html":'\x3cdiv class\x3d"${css.root}" role\x3d"presentation"\x3e\r\n  \x3c!-- Popup Container --\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_containerNode" class\x3d"${css.container}"\x3e\r\n    \x3cdiv class\x3d"${css.shadow}"\x3e\r\n      \x3cdiv class\x3d"${css.main} ${css.background}"\x3e\r\n        \x3c!-- Popup Header --\x3e\r\n        \x3cdiv class\x3d"${css.header} ${css.clearfix}"\x3e\r\n          \x3ch1 data-dojo-attach-point\x3d"_titleNode" class\x3d"${css.title}"\x3e\x3c/h1\x3e\r\n          \x3cdiv class\x3d"${css.headerButtons}"\x3e\r\n            \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_dockNode" class\x3d"${css.btn} ${css.dockBtn}"\x3e\r\n              \x3cspan aria-hidden\x3d"true" data-dojo-attach-point\x3d"_dockIconNode" class\x3d"${css.icon} ${css.dockIcon} ${css.dockIconRight}" title\x3d"${_i18n.dock}"\x3e\x3c/span\x3e\r\n              \x3cspan class\x3d"${css.iconText} ${css.dockIconText}"\x3e${_i18n.dock}\x3c/span\x3e\r\n              \x3cspan aria-hidden\x3d"true" class\x3d"${css.icon} ${css.undockIcon}" title\x3d"${_i18n.undock}"\x3e\x3c/span\x3e\r\n              \x3cspan class\x3d"${css.iconText} ${css.undockIconText}"\x3e${_i18n.undock}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_closeNode" class\x3d"${css.btn} ${css.close}"\x3e\r\n              \x3cspan aria-hidden\x3d"true" class\x3d"${css.icon} ${css.closeIcon}" title\x3d"${_i18n.close}"\x3e\x3c/span\x3e\r\n              \x3cspan class\x3d"${css.iconText}"\x3e${_i18n.close}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- /Popup Header --\x3e\r\n        \x3c!-- Popup Content --\x3e\r\n        \x3cdiv class\x3d"${css.body}"\x3e\r\n          \x3cdiv class\x3d"${css.bodyContent}" data-dojo-attach-point\x3d"_bodyContentNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- /Popup Content --\x3e\r\n        \x3c!-- Popup Footer --\x3e\r\n        \x3cdiv class\x3d"${css.footer} ${css.clearfix}"\x3e\r\n          \x3c!-- Popup Actions --\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_actionsNode" class\x3d"${css.actions}"\x3e\x3c/div\x3e\r\n          \x3c!-- /Popup Actions --\x3e\r\n          \x3c!-- Popup Pagination --\x3e\r\n          \x3cdiv class\x3d"${css.pagination}"\x3e\r\n            \x3cdiv role\x3d"presentation" class\x3d"${css.loadingContainer}"\x3e\r\n              \x3cspan aria-hidden\x3d"true" class\x3d"${css.icon} ${css.loadingIcon}"\x3e\x3c/span\x3e\r\n              \x3cspan class\x3d"${css.iconText}"\x3e${_i18n.loading}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_previousNode" class\x3d"${css.btn} ${css.previous}"\x3e\r\n              \x3cspan aria-hidden\x3d"true" class\x3d"${css.icon} ${css.previousIcon}" title\x3d"${_i18n.previous}"\x3e\x3c/span\x3e\r\n              \x3cspan class\x3d"${css.iconText}"\x3e${_i18n.previous}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_pageTextNode" class\x3d"${css.pageText}"\x3e\x3c/div\x3e\r\n            \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_nextNode" class\x3d"${css.btn} ${css.next}"\x3e\r\n              \x3cspan aria-hidden\x3d"true" class\x3d"${css.icon} ${css.nextIcon}" title\x3d"${_i18n.next}"\x3e\x3c/span\x3e\r\n              \x3cspan class\x3d"${css.iconText}"\x3e${_i18n.next}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_pageMenuNode" class\x3d"${css.btn} ${css.pageMenuBtn}"\x3e\r\n              \x3cspan aria-hidden\x3d"true" class\x3d"${css.icon} ${css.pageMenuIcon}" title\x3d"${_i18n.menu}"\x3e\x3c/span\x3e\r\n              \x3cspan class\x3d"${css.iconText}"\x3e${_i18n.menu}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3c!-- /Popup Pagination --\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- /Popup Footer --\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- Popup Pointer --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_pointerNode" class\x3d"${css.pointer} ${css.background} ${css.shadow}"\x3e\x26nbsp;\x3c/div\x3e\r\n      \x3c!-- /Popup Pointer --\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Popup Menu --\x3e\r\n    \x3cdiv class\x3d"${css.pageMenu}"\x3e\r\n      \x3cdiv class\x3d"${css.pageMenuHeader} ${css.clearfix}"\x3e\r\n        \x3cp data-dojo-attach-point\x3d"_pageMenuInfoNode" class\x3d"${css.pageMenuInfo}"\x3e\x3c/p\x3e\r\n        \x3cdiv class\x3d"${css.pageMenuActions}"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_pageMenuCloseNode" aria-hidden\x3d"true" class\x3d"${css.icon} ${css.collapseIcon}" title\x3d"${_i18n.close}"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.pageMenuViewport}"\x3e\r\n        \x3ctable role\x3d"menu"\x3e\x3ctbody data-dojo-attach-point\x3d"_pageMenuItemsNode"\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.pageMenuPointer}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- /Popup Menu --\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- /Popup Container --\x3e\r\n\x3c/div\x3e'}});
define("./Widget ../core/declare ../core/watchUtils dojo/_base/lang dojo/_base/array dijit/a11yclick dijit/_TemplatedMixin dojo/on dojo/promise/all ../views/2d/viewpointUtils ../geometry/support/mathUtils ../geometry/support/webMercatorUtils dojo/i18n!../nls/jsapi dojo/text!./Popup/templates/Popup.html dojo/string dojo/dom-class dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/fx/easing ./Popup/PopupRenderer ./Ripple ./Spinner".split(" "),function(v,w,x,y,z,m,A,k,B,q,C,r,D,E,
s,f,l,h,p,t,F,u,G,H){return w([v,A],{declaredClass:"esri.widgets.Popup",templateString:E,_i18n:D.widgets.popup,css:{root:"esri-popup",container:"esri-container",visible:"esri-visible",showDock:"esri-show-dock",docked:"esri-docked",dockedLeft:"esri-docked-left",dockedRight:"esri-docked-right",dockedTop:"esri-docked-top",dockedBottom:"esri-docked-bottom",menuOpen:"esri-menu-open",background:"esri-background",shadow:"esri-shadow",main:"esri-main",header:"esri-header",headerButtons:"esri-header-buttons",
body:"esri-popup-body",bodyContent:"esri-popup-content",showContent:"esri-show-content",footer:"esri-footer",title:"esri-title",showTitle:"esri-show-title",btn:"esri-btn",icon:"esri-icon",iconText:"esri-icon-text",close:"esri-close",closeIcon:"esri-close-icon esri-icon-close",collapseIcon:"esri-down-icon esri-icon-down",dockBtn:"esri-dock",dockIcon:"esri-dock-icon",dockIconTop:"esri-icon-maximize",dockIconBottom:"esri-icon-dock-bottom",dockIconLeft:"esri-icon-dock-left",dockIconRight:"esri-icon-dock-right",
dockIconText:"esri-dock-text",undockIcon:"esri-undock-icon esri-icon-minimize",undockIconText:"esri-undock-text",actions:"esri-actions",action:"esri-action",pagination:"esri-pagination",showPagination:"esri-show-pagination",pointer:"esri-pointer",previous:"esri-previous",previousIcon:"esri-previous-icon esri-icon-left-triangle-arrow",next:"esri-next",nextIcon:"esri-next-icon esri-icon-right-triangle-arrow",pageMenu:"esri-page-menu",pageMenuViewport:"esri-page-menu-viewport",pageMenuHeader:"esri-page-menu-header",
pageMenuInfo:"esri-page-menu-info",pageMenuNote:"esri-page-menu-note",pageMenuActions:"esri-page-menu-actions",pageMenuPointer:"esri-page-menu-pointer",pageMenuSelected:"esri-selected",pageMenuBtn:"esri-page-menu-btn",pageMenuIcon:"esri-page-menu-icon esri-icon-layer-list",pageMenuNumber:"esri-page-menu-num",pageMenuTitle:"esri-page-menu-title",pageMenuCheckMark:"esri-page-menu-check-mark esri-icon-check-mark",pageText:"esri-page-text",zoomIcon:"esri-icon-zoom-in-magnifying-glass",top:"esri-top",
bottom:"esri-bottom",left:"esri-left",right:"esri-right",loading:"esri-loading",loadingContainer:"esri-loading-container",loadingIcon:"esri-loading-icon esri-icon-loading-indicator",clearfix:"esri-clearfix"},features:[],promises:[],actions:[],count:0,highlight:!0,visible:!1,selectedIndex:null,selectedFeature:null,zoomFactor:4,fillSymbol:null,markerSymbol:null,lineSymbol:null,pagination:!0,position:"top",padding:10,animation:{duration:300,easing:F.quadInOut},movePopupIntoView:!0,enableDock:!0,docked:!1,
dockPosition:{portrait:"bottom",landscape:"right"},title:null,content:null,location:null,autoClose:!1,autoDock:!0,autoUpdateLocation:!1,closestFirst:!1,dockAtSize:{width:480,height:640},finding:!1,spinner:!1,constructor:function(){this._events=[];this.set("actions",[{title:this._i18n.zoom,className:this.css.zoomIcon,action:this._zoomTo.bind(this)}])},postCreate:function(){var a=this;this.inherited(arguments);this.own(k(this._dockNode,m,this._toggleDock.bind(this)),k(this._closeNode,m,this._close.bind(this)),
k(this._previousNode,m,this.previous.bind(this)),k(this._nextNode,m,this.next.bind(this)),k(this._pageMenuNode,m,this._togglePageMenu.bind(this)),k(this._pageMenuCloseNode,m,this._togglePageMenu.bind(this)),k(this._pageMenuItemsNode,k.selector("tr:not(."+this.css.pageMenuSelected+")",m),function(){a._pageMenuItem(this)}));this._viewChange()},startup:function(){this.inherited(arguments);this.view?this.view.then(this._init.bind(this)):console.log(this.declaredClass+"::view required")},destroy:function(){this._ripple&&
this._ripple.destroy();this._spinner&&this._spinner.destroy();this.view=null;this._removeEvents();this.inherited(arguments)},reposition:function(){this._reposition()},next:function(){this.set("selectedIndex",this.selectedIndex+1)},previous:function(){this.set("selectedIndex",this.selectedIndex-1)},show:function(a){a&&this.set("location",a);this.set("visible",!0)},hide:function(){this.set("visible",!1)},setFeatures:function(a){a&&a[0]&&a[0].hasOwnProperty("then")?this.set("promises",a):this.set("features",
a)},clearFeatures:function(){this.set("features",[])},setContent:function(a){this.set("content",a)},setTitle:function(a){this.set("title",a)},resize:function(){},maximize:function(){this.set("docked",!0)},restore:function(){this.set("docked",!1)},getSelectedFeature:function(){return this.selectedFeature},select:function(a){this.set("selectedIndex",a)},selectNext:function(){this.next()},selectPrevious:function(){this.previous()},_init:function(){this._visibleChange();this._dockedChange();this._actionsChange();
this._setFeaturesChange();this.set("loaded",!0);this.emit("load")},_toggleDock:function(){this.set("docked",!this.docked)},_close:function(){this.set("visible",!1)},_getPoint:function(a){var b;if(a)switch(a.type){case "point":b=a;break;case "multipoint":case "polyline":case "polygon":b=a.getPoint(0,0)}return b},_navigateTo:function(a){var b=this.view&&this.view.get("state.extent");if(this.location&&b&&!b.contains(this.location))this.view.animateTo(this.location,this.animation);else if(!this.docked&&
a&&!this._animateVP&&this.movePopupIntoView){var d=b=0,c=p.position(this.view.surface,!0),g=c.h,c=c.w,e=this.view.padding;a.top<e.top?d=-a.top+this.padding+e.top:a.bottom>g-e.bottom&&(d=-(a.bottom-g+e.bottom)-this.padding);a.left<e.left?b=a.left-this.padding-e.left:a.right>c-e.right&&(b=a.right-c+e.right+this.padding);if(b||d)this._animateVP=q.translateBy(q.create(),this.view.viewpoint,[b,d]),this.view.animateTo(this._animateVP,this.animation).then(function(){this._animateVP=null}.bind(this))}},_setPosition:function(a){var b=
p.getContentBox(this._containerNode),d=p.position(this._pointerNode).h/2,c=b.h;if("top"===this.position||"bottom"===this.position)c+=d;var g=b.w;if("left"===this.position||"right"===this.position)g+=d;switch(this.position){case "bottom":b=a.y+d;d=a.x-g/2;c=a.y+c;g=d+g;break;case "left":b=a.y-c/2;d=a.x-g;c=b+c;g=d+g;break;case "right":b=a.y-c/2;d=a.x+d;c=b+c;g=a.x+g;break;default:b=a.y-c,d=a.x-g/2,c=b+c,g=d+g}var e=this.view.padding,n=this.css;f.remove(this._containerNode,[n.top,n.bottom,n.left,n.right]);
if(this.docked)a={left:"",top:"",right:"",bottom:""},e.left&&(a.marginLeft=e.left+"px"),e.top&&(a.marginTop=e.top+"px"),e.right&&(a.marginRight=e.right+"px"),e.bottom&&(a.marginBottom=e.bottom+"px"),t.set(this._containerNode,a);else{a={left:d+"px",top:b+"px",right:null,bottom:null,marginLeft:null,marginTop:null,marginRight:null,marginBottom:null};switch(this.position){case "bottom":e=n.bottom;break;case "right":e=n.right;break;case "left":e=n.left;break;default:e=n.top}f.add(this._containerNode,e)}t.set(this._containerNode,
a);return{top:b,left:d,bottom:c,right:g}},_zoomTo:function(){if(this.view&&this.location){var a={target:this.location};"point"===this.location.type&&(a.scale=this.view.scale/this.zoomFactor);this.view.animateTo(a,this.animation)}},_togglePageMenu:function(){this._containerNode&&f.toggle(this._containerNode,this.css.menuOpen)},_removeEvents:function(){if(this._events&&this._events.length)for(var a=0;a<this._events.length;a++)this._events[a]&&this._events[a].remove();this._events.length=0},_actionsChange:function(){if(this._actionsNode){h.empty(this._actionsNode);
this._removeEvents();var a=this.actions;if(a&&a.length)for(var b=0;b<a.length;b++){var d=a[b],c=h.create("div",{tabindex:"0",title:d.title,className:this.css.btn+" "+this.css.action});h.create("span",{"aria-hidden":!0,className:this.css.icon+" "+d.className},c);h.create("span",{textContent:d.title,className:this.css.iconText},c);h.place(c,this._actionsNode);this._events.push(k(c,m,d.action))}}},_dockPositionChange:function(){if(this._containerNode){var a=this.css;f.remove(this._containerNode,[a.dockedLeft,
a.dockedRight,a.dockedTop,a.dockedBottom]);f.remove(this._dockIconNode,[a.dockIconTop,a.dockIconBottom,a.dockIconLeft,a.dockIconRight]);var b;switch(this.view.cssTraits&&"portrait"===this.view.cssTraits.active.orientation?this.dockPosition.portrait:this.dockPosition.landscape){case "top":b=a.dockedTop;a=a.dockIconTop;break;case "bottom":b=a.dockedBottom;a=a.dockIconBottom;break;case "left":b=a.dockedLeft;a=a.dockIconLeft;break;default:b=a.dockedRight,a=a.dockIconRight}this.enableDock&&(f.add(this._dockIconNode,
a),this.docked&&f.add(this._containerNode,b))}},_dockedChange:function(){this._containerNode&&f.toggle(this._containerNode,this.css.docked,this.docked);this._dockPositionChange();this._locationChange()},_enableDockChange:function(){this._containerNode&&(this.enableDock?(f.toggle(this._containerNode,this.css.docked,this.docked),f.add(this._containerNode,this.css.showDock)):f.remove(this._containerNode,[this.css.docked,this.css.showDock]));this._dockPositionChange()},_visibleChange:function(){var a=
this.visible&&!this.spinner;this._containerNode&&f.toggle(this._containerNode,this.css.visible,a)},_locationChange:function(){var a=this._reposition();a&&a.then(function(a){this.spinner||this._navigateTo(a)}.bind(this))},_reposition:function(){if(this.location){var a=this._getPoint(this.location);if(a&&this.view)return this.view.then(function(){var b=this.view.toScreen(a.x,a.y);if(b)return this._setPosition(b)}.bind(this))}},_addContent:function(){this._contentChange();this._titleChange();this._pageText()},
_removeContent:function(){this._containerNode&&(l.set(this._bodyContentNode,"innerHTML",""),l.set(this._titleNode,"innerHTML",""),l.set(this._pageTextNode,"innerHTML",""),f.remove(this._containerNode,[this.css.showTitle,this.css.showContent]))},_titleChange:function(){if(this._containerNode){var a=this.title||"";l.set(this._titleNode,{textContent:a});f.toggle(this._containerNode,this.css.showTitle,a)}this._reposition()},_contentChange:function(){var a=this.content;a&&a.id&&h.place(a,this._bodyContentNode,
"only");this._containerNode&&f.toggle(this._containerNode,this.css.showContent,a);this._reposition()},_selectedFeatureChange:function(){this.selectedFeature&&(this._popupRenderer&&this._popupRenderer.destroy(),this._popupRenderer=new u({showTitle:!1,graphic:this.selectedFeature},h.create("div")),k(this._popupRenderer,"load",function(){this.set("title",this._popupRenderer.title);this.set("content",this._popupRenderer.domNode);this.autoUpdateLocation&&this.set("location",this.selectedFeature.geometry)}.bind(this)),
this._popupRenderer.startup())},_selectedIndexChange:function(){var a=null,b=this.features;b&&b.length&&(this.selectedIndex=(this.selectedIndex+this.features.length)%this.features.length,a=b[this.selectedIndex]);this.set("selectedFeature",a);this._pageText();this._pageMenuItems()},_setFeaturesChange:function(){this.finding||this.set("selectedIndex",null);var a=0;this.features&&this.features.length&&(this.finding||this.set("selectedIndex",0),a=this.features.length);this.set("count",a);this._paginationChange();
this.spinner||this._locationChange()},_pageMenuItem:function(a){var b=null;(a=l.get(a,"data-index"))&&(b=parseInt(a,10));null!==b&&this.set("selectedIndex",b);f.remove(this._containerNode,this.css.menuOpen)},_pageMenuItems:function(){var a=this.features;if(a){var b=a.length;this._pageMenuItemsNode&&l.set(this._pageMenuItemsNode,"innerHTML","");if(a&&b){var d=s.substitute(this._i18n.selectedFeatures,{total:b});l.set(this._pageMenuInfoNode,"textContent",d);for(d=0;d<b;d++){var c=a[d],g=this._i18n.untitled;
c&&(c=new u({showContent:!1,graphic:c}),c.startup(),g=c.title,c.destroy());c={};d===this.selectedIndex?c.className=this.css.pageMenuSelected:(c.role="menu-item",c.tabindex="0",c["data-index"]=d);c=h.create("tr",c,this._pageMenuItemsNode);h.create("th",{className:this.css.pageMenuNumber,textContent:d+1},c);g=h.create("td",{className:this.css.pageMenuTitle,textContent:g},c);d===this.selectedIndex&&h.create("span",{className:this.css.pageMenuCheckMark},g)}}}},_pageText:function(){var a="";this.pagination&&
(this.features&&1<this.features.length)&&(a=s.substitute(this._i18n.pageText,{index:this.selectedIndex+1,total:this.features.length}));this._pageTextNode&&l.set(this._pageTextNode,{textContent:a})},_paginationChange:function(){this._pageText();this._pageMenuItems();var a=this.pagination&&this.features&&1<this.features.length;this._containerNode&&f.toggle(this._containerNode,this.css.showPagination,a);this._reposition()},_autoCloseChange:function(){this._viewInteracting&&this._viewInteracting.remove();
this.autoClose&&(this._viewInteracting=this.view.watch("interacting",function(a){a&&this.visible&&this.set("visible",!1)}.bind(this)),this.own(this._viewInteracting))},_resized:function(){this._locationChange()},_viewSizeChange:function(){this.autoDock&&this.dockAtSize&&this.set("docked",this.view.ui.width<=this.dockAtSize.width||this.view.ui.height<=this.dockAtSize.height)},_viewChange:function(){this._viewPointEvent&&this._viewPointEvent.remove();this._viewPointEvent=this.view.watch("viewpoint",
this._reposition.bind(this));this.own(this._viewPointEvent);this._viewSizeEvent&&this._viewSizeEvent.remove();this._viewSizeEvent=this.view.watch("size",this._viewSizeChange.bind(this));this.own(this._viewSizeEvent);this._viewResizingEvent&&this._viewResizingEvent.remove();this._viewResizingEvent=x.whenFalse(this.view,"resizing",this._resized.bind(this));this.own(this._viewResizingEvent);this._autoCloseChange();h.place(this.domNode,this.view.root);this._ripple&&this._ripple.destroy();this._ripple=
new G({view:this.view});this._ripple.startup();this._spinner&&this._spinner.destroy();this._spinner=new H({view:this.view});this._spinner.startup();this._viewClick&&this._viewClick.remove();this._viewClick=k(this.view,"click",function(a){this._ripple.show(a.mapPoint)}.bind(this));this.own(this._viewClick)},_visibleChangeContent:function(){this.visible?this._addContent():this._removeContent();this.spinner||this._locationChange()},_updateFeatures:function(a,b){if(a&&this.promises){if(!this._unbind(a)||
b instanceof Error)return;if(b&&b.length){if(this.features){var d=b.filter(function(a){return-1===this.features.indexOf(a)}.bind(this));this.set("features",this.features.concat(d))}else this.set("features",b);null===this.selectedIndex&&this.set("selectedIndex",0);this.set("spinner",!1)}}this._created&&this._setFeaturesChange()},_findingChange:function(){this.finding?f.add(this._containerNode,this.css.loading):f.remove(this._containerNode,this.css.loading)},_spinnerChange:function(){this.spinner&&
this.location?this._spinner.show(this.location):this._spinner.hide();this._visibleChange()},_unbind:function(a){a=z.indexOf(this.promises,a);if(-1===a)return!1;this.promises.splice(a,1);return!0},_showClosestFirst:function(a,b){if(a&&a.length&&1<a.length){b=b.normalize();var d=Infinity,c=-1,g=C.getLength,e=b.spatialReference,f,h,k,m,l;for(k=a.length-1;0<=k;k--)if(h=a[k].geometry){m=h.spatialReference;f=0;try{l="point"===h.type?h:h.extent.center,l=l.normalize(),e&&(m&&!e.equals(m)&&e._canProject(m))&&
(l=e.isWebMercator()?r.geographicToWebMercator(l):r.webMercatorToGeographic(l)),f=g(b,l)}catch(p){}0<f&&f<d&&(d=f,c=k)}0<c&&a.splice(0,0,a.splice(c,1)[0])}return a},_setContentAttr:function(a){this._set("content",a);this._created&&this._contentChange()},_setLocationAttr:function(a){this._set("location",a);this._created&&(this._locationChange(),this._spinnerChange())},_setTitleAttr:function(a){this._set("title",a);this._created&&this._titleChange()},_setPaginationAttr:function(a){this._set("pagination",
a);this._created&&this._paginationChange()},_setSelectedIndexAttr:function(a){isNaN(a)&&(a=null);this._set("selectedIndex",a);this._created&&this._selectedIndexChange()},_setSelectedFeatureAttr:function(a){this._set("selectedFeature",a);this._created&&this._selectedFeatureChange()},_setPromisesAttr:function(a){this.set("features",[]);this.set("finding",!1);this.set("spinner",!1);this._set("promises",a);a&&a.length&&(this.set("spinner",!0),this.set("finding",!0),a=a.slice(0),a.forEach(function(a){a.always(function(d){this._updateFeatures(a,
d)}.bind(this))}.bind(this)),this._promisesAll&&this._promisesAll.cancel(),this._promisesAll=B(a).then(function(){this.set("finding",!1)}.bind(this)))},_setFeaturesAttr:function(a){this.closestFirst&&this.location&&(a=this._showClosestFirst(a,this.location));this._set("features",a);this._created&&this._setFeaturesChange()},_setSpinnerAttr:function(a){this._set("spinner",a);this._created&&this._spinnerChange()},_setDockPositionAttr:function(a){a=y.mixin({portrait:"bottom",landscape:"right"},this.dockPosition,
a);this._set("dockPosition",a);this._created&&this._dockPositionChange()},_setPositionAttr:function(a){this._set("position",a);this._created&&this._locationChange()},_setActionsAttr:function(a){this._set("actions",a);this._created&&this._actionsChange()},_setAutoCloseAttr:function(a){this._set("autoClose",a);this._created&&this._autoCloseChange()},_setDockedAttr:function(a){this._set("docked",a);this._created&&this._dockedChange()},_setEnableDockAttr:function(a){this._set("enableDock",a);this._created&&
this._enableDockChange()},_setFindingAttr:function(a){this._set("finding",a);this._created&&this._findingChange()},_setViewAttr:function(a){this._set("view",a);this._created&&this._viewChange()},_setVisibleAttr:function(a){this._set("visible",a);this._created&&(this._visibleChange(),this._visibleChangeContent())}})});