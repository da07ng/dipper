// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
define(["../../../../core/declare","../../webgl-engine/Stage","../../webgl-engine/lib/Util"],function(g,d,h){var k=h.assert;return g(null,{constructor:function(a,c,b,e){this.canvas3DSymbol=a;this.renderGeometries=c;this.uniqueMaterials=b;this.uniqueTextures=e;this.stage=null;this._visibilityFlags={};this._shown=!1},initialize:function(a,c){this.stage=c;var b;if(this.uniqueMaterials)for(b=0;b<this.uniqueMaterials.length;b++)c.add(d.ModelContentType.MATERIAL,this.uniqueMaterials[b]);if(this.uniqueTextures)for(b=
0;b<this.uniqueTextures.length;b++)c.add(d.ModelContentType.TEXTURE,this.uniqueTextures[b])},isDraped:function(){return!0},areVisibilityFlagsSet:function(a,c){for(var b=!0,e=Object.keys(this._visibilityFlags),d=0;d<e.length;d++){var f=e[d];if(f!==c){if(f===a)return this._visibilityFlags[f];b=b&&this._visibilityFlags[f]}}return b},setVisibilityFlag:function(a,c){this._visibilityFlags[a]=c;return this._calcAndSetVisibility()},_calcAndSetVisibility:function(){var a=this.areVisibilityFlagsSet();return this._shown!=
a?(this._shown=a,k(this.stage,"Canvas3DDrapedGraphic must be initialized first"),this._shown?this.stage.getTextureGraphicsRenderer().addRenderGeometries(this.renderGeometries):this.stage.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries),!0):!1},destroy:function(){if(this.stage){var a,c=this.stage;this._shown&&c.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries);this._shown=!1;if(this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)c.remove(d.ModelContentType.MATERIAL,
this.uniqueMaterials[a].getId());if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)c.remove(d.ModelContentType.TEXTURE,this.uniqueTextures[a].getId());this.stage=null}},mustAlignToTerrain:function(){return!1},alignWithElevation:function(){},setDrawOrder:function(a,c,b){this.uniqueMaterials&&this.uniqueMaterials.forEach(function(b){b.setRenderPriority(a);this._shown&&(c[b.getId()]=!0)}.bind(this))},getBSRadius:function(){var a=0;this.renderGeometries.forEach(function(c){a=Math.max(a,
c.bsRadius)});return a},getCenterObjectSpace:function(){return[0,0,0]}})});