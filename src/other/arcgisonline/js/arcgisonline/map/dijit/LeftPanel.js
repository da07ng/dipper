// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/map/dijit/LeftPanel",["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/layout/StackContainer,dijit/layout/BorderContainer,dijit/layout/ContentPane,arcgisonline/map/dijit/TOC,arcgisonline/map/dijit/About,arcgisonline/map/dijit/AddContent,arcgisonline/map/dijit/Directions,arcgisonline/map/dijit/Edit,arcgisonline/map/dijit/Geocode,arcgisonline/map/dijit/Legend,arcgisonline/map/dijit/MosaicRule,arcgisonline/map/dijit/RenderingRule,arcgisonline/map/dijit/MultidimensionalFilter,arcgisonline/map/dijit/PopupBuilder,arcgisonline/map/dijit/Renderer,arcgisonline/map/dijit/renderer/Gallery,arcgisonline/map/dijit/ManageTemplates,arcgisonline/map/dijit/RendererLabels,arcgisonline/map/dijit/VectorFieldRenderer"],
function(a,c,m){c.provide("arcgisonline.map.dijit.LeftPanel");c.require("dijit._Widget");c.require("dijit.layout.StackContainer");c.require("dijit.layout.BorderContainer");c.require("dijit.layout.ContentPane");c.require("arcgisonline.map.dijit.TOC");c.require("arcgisonline.map.dijit.About");c.require("arcgisonline.map.dijit.AddContent");c.require("arcgisonline.map.dijit.Directions");c.require("arcgisonline.map.dijit.Edit");c.require("arcgisonline.map.dijit.Geocode");c.require("arcgisonline.map.dijit.Legend");
c.require("arcgisonline.map.dijit.MosaicRule");c.require("arcgisonline.map.dijit.RenderingRule");c.require("arcgisonline.map.dijit.MultidimensionalFilter");c.require("arcgisonline.map.dijit.PopupBuilder");c.require("arcgisonline.map.dijit.Renderer");c.require("arcgisonline.map.dijit.renderer.Gallery");c.require("arcgisonline.map.dijit.ManageTemplates");c.require("arcgisonline.map.dijit.RendererLabels");c.require("arcgisonline.map.dijit.VectorFieldRenderer");c.declare("arcgisonline.map.dijit.LeftPanel",
[a._Widget],{contentStack:null,addContentStack:null,aboutStack:null,legendStack:null,mosaicRuleStack:null,renderingRuleStack:null,multidimensionalFilterStack:null,editStack:null,geocodeStack:null,popupStack:null,rendererStack:null,manageTemplatesStack:null,aboutPanel:null,tocPanel:null,editPanel:null,editParams:null,addContentPanel:null,directionsPanel:null,lastDetailsStackId:"aboutStack",visibleStack:"",currentAnalysisTool:null,sc:null,startupFlag:!1,i18n:null,startup:function(){this.startupFlag||
(this.startupFlag=!0,this.i18n={},c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").common),c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").analysisTool),this.buildStack())},buildStack:function(){this.sc=new a.layout.StackContainer({id:"leftContentStackContainer",style:"width:100%; border:none; height:100%; margin:0; padding:0;",region:"center"});stackContainer.addChild(this.sc);c.subscribe("leftContentStackContainer-selectChild",c.hitch(this,"onSelectChild"));
this.sc.startup();c.subscribe("onChangeLeftPanel",c.hitch(this,"onLeftPanelChange"))},onSelectChild:function(b){this.visibleStack=b.id;if("editStack"==b.id&&this.editPanel)setTimeout(c.hitch(this,function(){a.byId("editPanel").loadEditor(this.editParams)}),500);else if("addContentStack"==b.id&&this.addContentPanel)a.byId("addContentPanel").onSelected()},onLeftPanelChange:function(b,c){"geocodeStack"===b&&this.geocodePanel&&this.geocodePanel.clear();"directionsStack"===b&&"directionsStack"!==c&&this.directionsPanel&&
this.directionsPanel.clear();"toolStack"===b&&(leftPanel&&leftPanel.toolPanel)&&leftPanel.toolPanel.clear(leftPanel.currentAnalysisTool);"rendererStack"!==c&&a.byId("rendererPanel")&&a.byId("rendererPanel")&&a.byId("rendererPanel").hideLegendPopup()},showStack:function(b,a){arcgisonline.map.leftPanel.lastLeftPanel=arcgisonline.map.leftPanel.getLeftContentPanelStack();switch(b){case "contentStack":this.showStack_ContentStack(a);break;case "aboutStack":this.showStack_AboutStack(a);break;case "legendStack":this.showStack_LegendStack(a);
break;case "mosaicRuleStack":this.showStack_MosaicRuleStack(a);break;case "renderingRuleStack":this.showStack_RenderingRuleStack(a);break;case "multidimensionalFilterStack":this.showStack_MultidimensionalFilterStack(a);break;case "vectorFieldRendererStack":this.showStack_VectorFieldRendererStack(a);break;case "addContentStack":this.showStack_AddContentStack(a);break;case "editStack":this.showStack_EditStack(a);break;case "popupStack":this.showStack_PopupStack(a);break;case "rendererStack":case "rendererSimpleStack":case "rendererUniqueValuesStack":case "rendererColorStack":case "rendererSizeStack":case "rendererHeatMapStack":case "rendererMultiAttributesStack":var c=
this.showStack_RendererStack(a);if(!c)return;break;case "manageTemplatesStack":this.showStack_ManageTemplatesStack(a);break;case "directionsStack":this.showStack_DirectionsStack(a);break;case "geocodeStack":this.showStack_GeocodeStack(a);break;case "analysisStack":this.showStack_AnalysisStack(a);break;case "toolStack":c=this.showStack_ToolStack(a);if(!c)return;break;case "rendererLabelsStack":this.showStack_RendererLabelsStack(a)}this.visibleStack=b},showStack_ContentStack:function(b){this.contentStack?
(this.sc.selectChild(this.contentStack),arcgisonline.map.dijit.toc.scale.checkLayersInMapScale()):(this.contentStack=new a.layout.BorderContainer({id:"contentStack",region:"top",style:"margin:0; padding:0;"}),this.sc.addChild(this.contentStack),this.tocPanel=new arcgisonline.map.dijit.TOC({id:"tocPanel",containerNode:this.contentStack,region:"top"}),this.sc.startup(),this.sc.selectChild(this.contentStack),this.tocPanel.loadTOC());a.byId("tocPanel").adjustHeight();a.byId("webmap-edit").set("checked",
!1);a.byId("webmap-add").set("checked",!1);arcgisonline.map.leftPanel.checkLeftPanelButtonLabels();this.lastDetailsStackId="contentStack"},showStack_AboutStack:function(b){this.aboutStack?b&&b.showTakeATour?this.aboutPanel.showTakeATour():this.aboutPanel.showDefaultView():(this.aboutStack=new a.layout.BorderContainer({id:"aboutStack",region:"top",style:"margin:0; padding:0;"}),this.sc.addChild(this.aboutStack),this.aboutPanel=new arcgisonline.map.dijit.About({id:"aboutPanel",containerNode:this.aboutStack,
region:"top"}),this.sc.startup(),this.aboutPanel.loadContent(b&&b.showTakeATour));this.sc.selectChild(this.aboutStack);a.byId("aboutPanel").adjustHeight();a.byId("webmap-edit").set("checked",!1);a.byId("webmap-add").set("checked",!1);arcgisonline.map.leftPanel.checkLeftPanelButtonLabels();this.lastDetailsStackId="aboutStack"},showStack_LegendStack:function(b){this.legendStack||(this.legendStack=new a.layout.BorderContainer({id:"legendStack",region:"top",style:"margin:0; padding:0;"}),this.sc.addChild(this.legendStack),
b=new arcgisonline.map.dijit.Legend({id:"legendPanel",containerNode:this.legendStack,region:"top"}),this.sc.startup(),b.loadContent());this.sc.selectChild(this.legendStack);a.byId("legendPanel").needsRefresh&&a.byId("legendPanel").updateLegend();a.byId("legendPanel").adjustHeight();a.byId("webmap-edit").set("checked",!1);a.byId("webmap-add").set("checked",!1);arcgisonline.map.leftPanel.checkLeftPanelButtonLabels();this.lastDetailsStackId="legendStack"},showStack_MosaicRuleStack:function(b){this.mosaicRuleStack?
this.mosaicRulePanel.set("mapLayer",b.mapLayer):(this.mosaicRuleStack=new a.layout.BorderContainer({id:"mosaicRuleStack",region:"top",style:"margin:0; padding:0;"}),this.sc.addChild(this.mosaicRuleStack),this.mosaicRulePanel=new arcgisonline.map.dijit.MosaicRule({id:"mosaicRulePanel",mapLayer:b.mapLayer,containerNode:this.mosaicRuleStack,region:"top"}),this.sc.startup(),this.mosaicRulePanel.loadContent());this.sc.selectChild(this.mosaicRuleStack);a.byId("mosaicRulePanel").adjustHeight();a.byId("webmap-edit").set("checked",
!1);a.byId("webmap-add").set("checked",!1)},showStack_RenderingRuleStack:function(b){this.renderingRuleStack?this.renderingRulePanel.set("mapLayer",b.mapLayer):(this.renderingRuleStack=new a.layout.BorderContainer({id:"renderingRuleStack",region:"top",style:"margin:0; padding:0;",splitter:!1,gutters:!1}),this.sc.addChild(this.renderingRuleStack),this.renderingRulePanel=new arcgisonline.map.dijit.RenderingRule({id:"renderingRulePanel",mapLayer:b.mapLayer,containerNode:this.renderingRuleStack,region:"top"}),
this.sc.startup(),this.renderingRulePanel.loadContent());this.sc.selectChild(this.renderingRuleStack);a.byId("renderingRulePanel").adjustHeight();a.byId("webmap-edit").set("checked",!1);a.byId("webmap-add").set("checked",!1)},showStack_VectorFieldRendererStack:function(b){this.vectorFieldRendererStack?this.vectorFieldRendererPanel.set("mapLayer",b.mapLayer):(this.vectorFieldRendererStack=new a.layout.BorderContainer({id:"vectorFieldRendererStack",region:"top",style:"margin:0; padding:0;",splitter:!1,
gutters:!1}),this.sc.addChild(this.vectorFieldRendererStack),this.vectorFieldRendererPanel=new arcgisonline.map.dijit.VectorFieldRenderer({id:"vectorFieldRendererPanel",mapLayer:b.mapLayer,containerNode:this.vectorFieldRendererStack,region:"top"}),this.sc.startup(),this.vectorFieldRendererPanel.loadContent());this.sc.selectChild(this.vectorFieldRendererStack);a.byId("vectorFieldRendererPanel").adjustHeight();a.byId("webmap-edit").set("checked",!1);a.byId("webmap-add").set("checked",!1)},showStack_MultidimensionalFilterStack:function(b){this.multidimensionalFilterStack?
this.multidimensionalFilterPanel.set("mapLayer",b.mapLayer):(this.multidimensionalFilterStack=new a.layout.BorderContainer({id:"multidimensionalFilterStack",region:"top",style:"margin:0; padding:0;",splitter:!1,gutters:!1}),this.sc.addChild(this.multidimensionalFilterStack),this.multidimensionalFilterPanel=new arcgisonline.map.dijit.MultidimensionalFilter({id:"multidimensionalFilterPanel",mapLayer:b.mapLayer,containerNode:this.multidimensionalFilterStack,region:"top"}),this.sc.startup(),this.multidimensionalFilterPanel.loadContent());
this.sc.selectChild(this.multidimensionalFilterStack);a.byId("multidimensionalFilterPanel").adjustHeight();a.byId("webmap-edit").set("checked",!1);a.byId("webmap-add").set("checked",!1)},showStack_AddContentStack:function(b){this.addContentStack||(this.addContentStack=new a.layout.BorderContainer({id:"addContentStack",region:"top",style:"margin:0; padding:0;"}),this.sc.addChild(this.addContentStack),this.addContentPanel=new arcgisonline.map.dijit.AddContent({id:"addContentPanel",containerNode:this.addContentStack,
region:"top"}),this.sc.startup());this.sc.selectChild(this.addContentStack);a.byId("addContentPanel").adjustHeight();a.byId("webmap-edit").set("checked",!1);a.byId("webmap-details").set("checked",!1)},showStack_EditStack:function(b){this.editParams=b;this.editStack||(this.editStack=new a.layout.BorderContainer({id:"editStack",region:"top",style:"margin:0; padding:0;"}),this.editPanel=new arcgisonline.map.dijit.Edit({id:"editPanel",containerNode:this.editStack,region:"top"}),this.sc.addChild(this.editStack),
this.sc.startup());"editStack"===this.visibleStack?(this.sc.selectChild(this.editStack),this.onSelectChild(this.editStack)):this.sc.selectChild(this.editStack);a.byId("editPanel").adjustHeight();a.byId("webmap-details").set("checked",!1);a.byId("webmap-add").set("checked",!1)},showStack_PopupStack:function(b){this.popupStack||(this.popupStack=new a.layout.BorderContainer({id:"popupStack",region:"top",style:"margin:0; padding:0;",splitter:!1,gutters:!1}));this.popupPanel&&this.popupPanel.destroy();
this.popupPanel=new arcgisonline.map.dijit.PopupBuilder({id:"popupPanel",layerId:b.layerId,subLayerId:b.subLayerId,thematicGroupLayerIds:b.thematicGroupLayerIds,mapLayer:b.mapLayer,layerInfo:b.layerInfo,containerNode:this.popupStack,region:"top"});this.sc.addChild(this.popupStack);this.sc.startup();this.sc.selectChild(this.popupStack);a.byId("popupPanel").adjustHeight();a.byId("webmap-details").set("checked",!1);a.byId("webmap-add").set("checked",!1);a.byId("webmap-edit").set("checked",!1)},showStack_RendererStack:function(b){this.rendererStack||
(this.rendererStack=new a.layout.BorderContainer({id:"rendererStack",region:"top",style:"margin:0; padding:0;",splitter:!1,gutters:!1}));this.rendererPanel&&(this.rendererPanel.destroy(),a.byId("rendererColorMenu")&&a.byId("rendererColorMenu").destroyRecursive(),a.byId("rendererUniqueMenu")&&a.byId("rendererUniqueMenu").destroyRecursive());this.rendererPanel=b.selfServiceRenderer?new arcgisonline.map.dijit.renderer.Gallery({id:"rendererPanel",subLayerId:b.subLayerId,mapLayer:b.mapLayer,showGallery:b.showGallery,
noSimple:b.noSimple,showField:b.showField,style:b.style,containerNode:this.rendererStack,region:"top"}):new arcgisonline.map.dijit.Renderer({id:"rendererPanel",subLayerId:b.subLayerId,mapLayer:b.mapLayer,showGallery:b.showGallery,containerNode:this.rendererStack,region:"top"});this.sc.addChild(this.rendererStack);this.sc.startup();if(!b.selfServiceRenderer||b.showGallery&&!this.rendererPanel.isSL&&!this.rendererPanel.isGeoRSS)this.sc.selectChild(this.rendererStack),a.byId("rendererPanel").adjustHeight();
a.byId("webmap-details").set("checked",!1);a.byId("webmap-add").set("checked",!1);a.byId("webmap-edit").set("checked",!1);if(b.showGallery&&!this.rendererPanel.isSL&&!this.rendererPanel.isGeoRSS)return!0},showStack_RendererLabelsStack:function(b){this.rendererLabelsStack||(this.rendererLabelsStack=new a.layout.BorderContainer({id:"rendererLabelsStack",region:"top",style:"margin:0; padding:0;",splitter:!1,gutters:!1}));this.rendererLabelsPanel&&this.rendererLabelsPanel.destroy();this.rendererLabelsPanel=
new arcgisonline.map.dijit.RendererLabels({id:"rendererLabelsPanel",subLayerId:b.subLayerId,mapLayer:b.mapLayer,containerNode:this.rendererLabelsStack,region:"top"});this.sc.addChild(this.rendererLabelsStack);this.sc.startup();this.sc.selectChild(this.rendererLabelsStack);a.byId("rendererLabelsPanel").adjustHeight();a.byId("webmap-details").set("checked",!1);a.byId("webmap-add").set("checked",!1);a.byId("webmap-edit").set("checked",!1)},showStack_ManageTemplatesStack:function(b){this.manageTemplatesStack||
(this.manageTemplatesStack=new a.layout.BorderContainer({id:"manageTemplatesStack",region:"top",style:"margin:0; padding:0;",splitter:!1,gutters:!1}));this.manageTemplatesPanel&&(this.manageTemplatesPanel.destroy(),a.byId("typeMenu")&&a.byId("typeMenu").destroyRecursive(),a.byId("templateMenu")&&a.byId("templateMenu").destroyRecursive());this.manageTemplatesPanel=new arcgisonline.map.dijit.ManageTemplates({id:"manageTemplatesPanel",containerNode:this.manageTemplatesStack,region:"top"});this.sc.addChild(this.manageTemplatesStack);
this.sc.startup();this.manageTemplatesPanel.loadContent();this.sc.selectChild(this.manageTemplatesStack);a.byId("manageTemplatesPanel").adjustHeight();a.byId("webmap-details").set("checked",!1);a.byId("webmap-add").set("checked",!1);a.byId("webmap-edit").set("checked",!1)},showStack_DirectionsStack:function(b){this.directionsStack||(this.directionsStack=new a.layout.BorderContainer({id:"directionsStack",region:"top",style:"margin:0; padding:0;"}),this.sc.addChild(this.directionsStack));this.directionsPanel?
arcgisonline.map.main.map.activeDirectionsWidget&&arcgisonline.map.main.map.activeDirectionsWidget.activate():(this.directionsPanel=new arcgisonline.map.dijit.Directions({id:"directionsPanel",containerNode:this.directionsStack,region:"top"}),this.sc.startup());this.directionsPanel.loadDirections(b);this.sc.selectChild(this.directionsStack);a.byId("directionsPanel").adjustHeight()},showStack_GeocodeStack:function(b){this.geocodeStack||(this.geocodeStack=new a.layout.BorderContainer({id:"geocodeStack",
region:"top",style:"margin:0; padding:0;"}),this.sc.addChild(this.geocodeStack));this.geocodePanel?arcgisonline.map.geocodeReview.geocodeMatchWidget&&arcgisonline.map.geocodeReview.geocodeMatchWidget.resumeMapEvents():(this.geocodePanel=new arcgisonline.map.dijit.Geocode({id:"geocodePanel",containerNode:this.geocodeStack,region:"top"}),this.sc.startup());this.geocodePanel.loadGeocodeMatch(b);this.sc.selectChild(this.geocodeStack);a.byId("geocodePanel").adjustHeight()},showStack_AnalysisStack:function(b){arcgisonline.sharing.util.isLoggedIn()?
window.require(["arcgisonline/analysis"],c.hitch(this,function(){this.analysisStack||(this.analysisStack=new a.layout.BorderContainer({id:"analysisStack",region:"top",style:"margin:0; padding:0;",splitter:!1,gutters:!1}));this.analysisPanel&&(b.showSelectedCategory&&(this._prevSelectedCategory=this.analysisPanel.analysisTool.get("selectedCategory")),this.analysisPanel.destroy());var c={id:"analysisPanel",containerNode:this.analysisStack,analysisLayer:b.analysisLayer,featureLayers:b.featureLayers,
region:"top"};b.showSelectedCategory&&this._prevSelectedCategory&&(c.selectedCategory=this._prevSelectedCategory);b.analysisType&&(c.analysisType=b.analysisType);this.analysisPanel=new arcgisonline.map.dijit.AnalysisCategory(c);this.sc.addChild(this.analysisStack);this.sc.startup();this.sc.selectChild(this.analysisStack);this.analysisPanel.adjustHeight();a.byId("webmap-details").set("checked",!1);a.byId("webmap-add").set("checked",!1);a.byId("webmap-edit").set("checked",!1)})):arcgisonline.map.main.requireAuthentication()},
showStack_ToolStack:function(b){window.require(["arcgisonline/analysis"],c.hitch(this,function(){this.toolStack||(this.toolStack=new a.layout.BorderContainer({id:"toolStack",region:"top",style:"margin:0; padding:0;",splitter:!1,gutters:!1}));this.analysisPanel&&this.analysisPanel.clear();var d=[],g=[],k=0,l=[],f;c.forEach(b.featureLayers,function(a){var b=a.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer;a.layer instanceof esri.layers.ArcGISTiledMapServiceLayer||b?(a.flayers=c.map(a.flayers,
function(b){b.name&&-1===b.name.indexOf("-")&&(b.name=a.title+"-"+b.name);return b}),d=d.concat(a.flayers)):a.layers&&0<a.layers.length?(g=c.filter(a.layers,function(b){b.graphics&&0<b.graphics.length&&(b.name&&-1===b.name.indexOf("("))&&(b.name=a.title+" ("+b.name+")");b.timeInfo&&(a.serviceInfo&&a.serviceInfo.useStandardizedQueries)&&(b._useStandardizedQueries=a.serviceInfo.useStandardizedQueries);return b.graphics&&0<b.graphics.length}),d=d.concat(g)):a.layer instanceof esri.layers.GeoRSSLayer?
(b=a.layer.getFeatureLayers(),b=c.filter(b,function(b){if(b.graphics&&0<b.graphics.length&&(!b.name||b.name&&-1===b.name.indexOf("(")))b.name=a.title+" ("+(b.name?b.name:"esriGeometryPoint"===b.geometryType?this.i18n.points:"esriGeometryPolygon"===b.geometryType?this.i18n.areas:this.i18n.lines)+")";-1!==a.layer.capabilities.toLowerCase().indexOf("extract")&&(b.capabilities=0<b.capabilities.length?b.capabilities+",Extract":"Extract");return b.graphics&&0<b.graphics.length},this),d=d.concat(b)):(a.layer.name=
a.title,a.layer&&(a.layer.timeInfo&&a.serviceInfo&&a.serviceInfo.useStandardizedQueries)&&(a.layer._useStandardizedQueries=a.serviceInfo.useStandardizedQueries),d.push(a.layer))},this);if(esri.isDefined(b.analysisLayer))if(esri.isDefined(b.analysisLayer)&&b.analysisLayer.layer instanceof esri.layers.FeatureLayer)f=b.analysisLayer.layer;else if(esri.isDefined(b.analysisLayer)&&b.analysisLayer.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer||b.analysisLayer.layer instanceof esri.layers.ArcGISTiledMapServiceLayer)c.forEach(b.analysisLayer.flayers,
function(b){!0===b._isAnalysisSubLayer&&(f=b)});else if(esri.isDefined(b.analysisLayer)&&b.analysisLayer.layers||b.analysisLayer.layer instanceof esri.layers.GeoRSSLayer){var e=[];b.analysisLayer.layer?e=b.analysisLayer.layer.getFeatureLayers():b.analysisLayer.layers&&(e=b.analysisLayer.layers);c.forEach(e,function(a){0<a.graphics.length&&(l.push(a.geometryType),k++,b.analysisType&&b.analysisType===a.geometryType&&(a.name||(a.name=item.title),f=a))},this);b.toolName.charAt(0).toLowerCase();b.toolName.substring(1)}this.toolPanel||
(this.toolPanel=new arcgisonline.map.dijit.AnalysisTool({id:"toolPanel",containerNode:this.toolStack,region:"top",featureLayers:d}));this.toolPanel.get("currentTool")&&esri.hide(this.toolPanel.get("currentTool").domNode);var e={toolName:b.toolName,featureLayers:d,analysisLayer:f},h=arcgisonline.sharing.util.isPortal();b.analysisType&&(e.analysisType=b.analysisType);if((e&&e.analysisLayer&&!h||h)&&!this.toolPanel.isValidAnalysisLayer(e))return!1;this.toolPanel.set("currentTool",e);this.sc.addChild(this.toolStack);
this.sc.startup();this.sc.selectChild(this.toolStack);this.toolPanel.adjustHeight();this.currentAnalysisTool=this.toolPanel.get("currentTool");a.byId("webmap-details").set("checked",!1);a.byId("webmap-add").set("checked",!1);a.byId("webmap-edit").set("checked",!1);return!0}))},handleSelectTool:function(a,c){a.toolName=c.toolName;this.showStack("toolStack",a)},reloadVisibleTOC:function(){"contentStack"==this.visibleStack&&this.tocPanel.loadTOC()},checkAboutStack:function(){"aboutStack"==this.visibleStack?
this.recreateAboutStack():this.deleteAboutStack()},deleteAboutStack:function(){this.aboutStack&&(this.sc.removeChild(this.aboutStack),this.aboutStack.destroyRecursive(!1),this.aboutStack=null,"aboutStack"===this.visibleStack&&(this.visibleStack=""))},recreateAboutStack:function(){this.aboutStack&&(this.aboutPanel.isTakeATourVisible()?(this.deleteAboutStack(),this.showStack("aboutStack",{showTakeATour:!0})):(this.deleteAboutStack(),this.showStack("aboutStack")))},deleteContentStack:function(){this.contentStack&&
(this.sc.removeChild(this.contentStack),this.contentStack.destroyRecursive(!1),this.contentStack=null,a.byId("layerMenu")&&a.byId("layerMenu").destroyRecursive(),a.byId("subLayerMenu")&&a.byId("subLayerMenu").destroyRecursive())},deleteLegendStack:function(){this.legendStack&&(this.sc.removeChild(this.legendStack),this.legendStack.destroyRecursive(!1),this.legendStack=null)},recreateLegendStack:function(){this.legendStack&&(this.lastLegendUpdate&&1E3>(new Date).getTime()-this.lastLegendUpdate.getTime()?
(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(c.hitch(this,function(){this.recreateLegendStack()}),1E3)):(this.lastLegendUpdate=new Date,a.byId("legendPanel").needsRefresh=!0,this.showStack("legendStack")))},checkLegendStack:function(){arcgisonline.map.main.isMapFullyLoaded&&("legendStack"==this.visibleStack?this.recreateLegendStack():this.deleteLegendStack())},destroyDirectionsStack:function(){this.directionsStack&&(this.sc.removeChild(this.directionsStack),this.directionsStack.destroyRecursive(!1),
this.directionsPanel=this.directionsStack=null)},updateMosaicRuleStack:function(a){"mosaicRuleStack"==this.visibleStack&&this.mosaicRulePanel&&this.mosaicRulePanel.set("mapLayer",a.mapLayer)},switchToRendererStack:function(b){this.sc.selectChild(this.rendererStack);this.visibleStack="rendererStack";b&&(a.byId("rendererPanel").renderer=b);a.byId("rendererPanel").showLegendPopup();a.byId("rendererPanel").adjustHeight()},switchToMultiAttributesRendererStack:function(b){this.sc.selectChild(a.byId("rendererPanel").rendererMultiAttributesStack);
this.visibleStack="rendererMultiAttributesStack";b&&(a.byId("rendererMultiAttributesPanel").renderer=b);a.byId("rendererMultiAttributesPanel").showLegendPopup();a.byId("rendererMultiAttributesPanel").adjustHeight()},clearLists:function(){this.addContentPanel&&this.addContentPanel.clearLists()}})});