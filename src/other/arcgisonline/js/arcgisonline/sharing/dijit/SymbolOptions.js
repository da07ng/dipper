// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/SymbolOptions",["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/ColorPalette,dijit/form/HorizontalSlider,arcgisonline/sharing/dijit/dialog/ImgDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/util"],function(f,b,k){b.provide("arcgisonline.sharing.dijit.SymbolOptions");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.ColorPalette");b.require("dijit.form.HorizontalSlider");b.require("arcgisonline.sharing.dijit.dialog.ImgDlg");
b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.util");b.declare("arcgisonline.sharing.dijit.SymbolOptions",[f._Widget,f._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv\x3e\r\n  \x3ctable class\x3d"symbolDialogTable"\x3e\r\n   \x3ctbody\x3e\r\n    \x3ctr\x3e \r\n      \x3ctd valign\x3d"top"\x3e\r\n        \x3cdiv\x3e\x3clabel\x3e${i18n.previewLabel}\x3c/label\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd colspan\x3d"2" valign\x3d"middle" align\x3d"left"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolImage" style\x3d"height:100%; vertical-align:middle;"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e   \r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e \r\n      \x3ctd colspan\x3d"3" valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolSmallTemplatePicker" style\x3d"display:none;"\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"symbolSimpleMarkerTemplatePickerDiv" class\x3d"symbolTemplatePicker" style\x3d"height:50px; width:350px;"\x3e\r\n            \x3cdiv id\x3d"${id}_symbolSimpleMarkerTemplatePicker"\x3e\x3c/div\x3e  \r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolFullTemplatePicker" style\x3d"display:none;"\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"symbolClassesDiv" style\x3d"width:355px;line-height:normal;"\x3e\r\n            \x3cselect dojoAttachPoint\x3d"symbolColorClasses" style\x3d"width:355px;margin:0;" dojoType\x3d"arcgisonline.sharing.dijit.ComboBox"\x3e\r\n            \x3c/select\x3e       \r\n          \x3c/div\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"symbolClassesTemplatePickerDiv" class\x3d"symbolTemplatePicker" style\x3d"height:130px; width:350px;"\x3e\r\n            \x3cdiv id\x3d"${id}_symbolClassesTemplatePicker" \x3e\x3c/div\x3e  \r\n          \x3c/div\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"symbolAddImageDiv" class\x3d"esriItemLinks" style\x3d"line-height:20px;"\x3e\r\n            \x3cA dojoAttachPoint\x3d"symbolAddImage" href\x3d"JavaScript:void(0);"\x3e${i18n.addImage}\x3c/A\x3e  \r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e   \r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolSizeRow"\x3e \r\n      \x3ctd nowrap\x3e\x3clabel dojoAttachPoint\x3d"symbolSizeLabel"\x3e${i18n.symbolSizeLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\x3cdiv dojoAttachPoint\x3d"symbolSize" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" showbuttons\x3d"false" intermediatechanges\x3d"false" minimum\x3d"1" maximum\x3d"120" value\x3d"1" discretevalues\x3d"1" \x3e\x3c/div\x3e\x3c/td\x3e\r\n      \x3ctd valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolSizeInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e${i18n.shortForPixel}\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolEndSizeRow"\x3e \r\n      \x3ctd nowrap\x3e\x3clabel\x3e${i18n.symbolEndSizeLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\x3cdiv dojoAttachPoint\x3d"symbolEndSize" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" showbuttons\x3d"false" intermediatechanges\x3d"false" minimum\x3d"1" maximum\x3d"120" value\x3d"1" discretevalues\x3d"1" \x3e\x3c/div\x3e\x3c/td\x3e\r\n      \x3ctd valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolEndSizeInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e${i18n.shortForPixel}\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolBackgroundColorRow"\x3e\r\n      \x3ctd\x3e\x3clabel\x3e${i18n.colorLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\x3cdiv dojoAttachPoint\x3d"symbolBackgroundColor" class\x3d"symbolColorBox"\x3e\x3c/div\x3e\x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolLinePatternRow"\x3e\r\n      \x3ctd\x3e\x3clabel\x3e${i18n.patternLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3cdiv\x3e\r\n          \x3cselect dojoAttachPoint\x3d"symbolLinePatternSelect" id\x3d"symbolLinePatternSelect" dojoType\x3d"dijit.form.Select" class\x3d"symbolLinePatternSelect"\x3e\r\n          \x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolTransparencyRow"\x3e\r\n      \x3ctd\x3e\x3clabel\x3e${i18n.transparencyLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd width\x3d"125" valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolTransparency" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" style\x3d"line-height:normal;margin-top:7px;" showbuttons\x3d"false" intermediatechanges\x3d"true" minimum\x3d"0" maximum\x3d"1" value\x3d"0" discretevalues\x3d"0.01" \x3e\r\n          \x3cdiv dojoType\x3d"dijit.form.HorizontalRule" container\x3d"bottomDecoration" count\x3d"2" style\x3d"height:5px;"\x3e\x3c/div\x3e\r\n          \x3col dojoType\x3d"dijit.form.HorizontalRuleLabels" container\x3d"bottomDecoration" style\x3d"font-size:0.8em;"\x3e\r\n            \x3cli\x3e0\x3c/li\x3e\x3cli\x3e100%\x3c/li\x3e\r\n          \x3c/ol\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolTransparencyInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e%\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolOutlineColorRow"\x3e\r\n      \x3ctd\x3e\x3clabel\x3e${i18n.outlineColorLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\x3cdiv dojoAttachPoint\x3d"symbolOutlineColor" class\x3d"symbolColorBox"\x3e\x3c/div\x3e\x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolWidthRow"\x3e \r\n      \x3ctd\x3e\x3clabel dojoAttachPoint\x3d"symbolWidthLabel" \x3e${i18n.outlineWidthLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\x3cdiv dojoAttachPoint\x3d"symbolWidth" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" showbuttons\x3d"false" intermediatechanges\x3d"true" minimum\x3d"0" maximum\x3d"18" value\x3d"1" discretevalues\x3d"1" \x3e\x3c/div\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolWidthInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e${i18n.shortForPixel}\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolEndWidthRow"\x3e \r\n      \x3ctd nowrap\x3e\x3clabel\x3e${i18n.symbolEndWidthLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\x3cdiv dojoAttachPoint\x3d"symbolEndWidth" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" showbuttons\x3d"false" intermediatechanges\x3d"false" minimum\x3d"1" maximum\x3d"18" value\x3d"1" discretevalues\x3d"1" \x3e\x3c/div\x3e\x3c/td\x3e\r\n      \x3ctd valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolEndWidthInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e${i18n.shortForPixel}\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n   \x3c/tbody\x3e\r\n  \x3c/table\x3e                \r\n\r\n  \x3cimg id\x3d"${id}_testImage" style\x3d"position:absolute;top:0;left:-3000px"/\x3e\r\n\r\n  \x3cdiv dojoAttachPoint\x3d"symbolColorTooltip" dojotype\x3d"dijit.TooltipDialog" title\x3d"" style\x3d"display:none; width:265px;"\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing"\x3e\x3cA class\x3d"symbolColorPaletteClose" dojoAttachPoint\x3d"symbolColorTooltipClose" href\x3d"JavaScript:void(0);" title\x3d"${i18n.close}"\x3e\x3c/A\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"symbolColorPalette" style\x3d"margin-top: 7px;" dojotype\x3d"dijit.ColorPalette" palette\x3d"7x10" dojoAttachEvent\x3d"onChange:onColorSelection"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \r\n\x3c/div\x3e\r\n',
i18n:null,symbol:null,template:null,colorPicker:"",savedSimpleMarkerSymbol:null,savedPictureMarkerSymbol:null,eventHandlers:null,testImageHandler:null,symbolListItems:null,symbolClassesTemplatePicker:null,simpleMarkerTemplatePicker:null,templatePickerOnSelectionChangeHandler:null,simpleMarkerTemplatePickerOnSelectionChangeHandler:null,templatePickerSymbolClass:null,symbolClassStore:null,urlChangesNotApplied:!1,cachedImages:[],onImageChangeHandler:null,showEndSize:!1,showNoBgColor:!1,endSize:0,simpleMarkerSymbols:[{name:"Circle",
type:"esriSMS",style:"esriSMSCircle",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Square",type:"esriSMS",style:"esriSMSSquare",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Diamond",type:"esriSMS",style:"esriSMSDiamond",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Cross",type:"esriSMS",style:"esriSMSCross",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"X",type:"esriSMS",style:"esriSMSX",
color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}}],markerJson:{type:"esriPMS",url:"/Symbols/Basic/RedSphere.png",imageData:"iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQBQYWludC5ORVQgdjMuNS4xTuc4+QAAB3VJREFUeF7tmPlTlEcexnve94U5mANQbgQSbgiHXHINlxpRIBpRI6wHorLERUmIisKCQWM8cqigESVQS1Kx1piNi4mW2YpbcZONrilE140RCTcy3DDAcL/zbJP8CYPDL+9Ufau7uqb7eZ7P+/a8PS8hwkcgIBAQCAgEBAICAYGAQEAgIBAQCAgEBAICAYGAQEAgIBAQCDx/AoowKXFMUhD3lQrioZaQRVRS+fxl51eBTZUTdZ41U1Rox13/0JF9csGJ05Qv4jSz/YPWohtvLmSKN5iTGGqTm1+rc6weICOBRbZs1UVnrv87T1PUeovxyNsUP9P6n5cpHtCxu24cbrmwKLdj+osWiqrVKhI0xzbmZ7m1SpJ+1pFpvE2DPvGTomOxAoNLLKGLscZYvB10cbYYjrJCb7A5mrxleOBqim+cWJRakZY0JfnD/LieI9V1MrKtwokbrAtU4Vm0A3TJnphJD4B+RxD0u0LA7w7FTE4oprOCMbklEGNrfdGf4IqnQTb4wc0MFTYibZqM7JgjO8ZdJkpMln/sKu16pHZGb7IfptIWg389DPp9kcChWODoMuDdBOhL1JgpisbUvghM7AqFbtNiaFP80RLnhbuBdqi0N+1dbUpWGde9gWpuhFi95yL7sS7BA93JAb+Fn8mh4QujgPeTgb9kAZf3Apd2A+fXQ38yHjOHozB1IAJjOSEY2RSIwVUv4dd4X9wJccGHNrJ7CYQ4GGjLeNNfM+dyvgpzQstKf3pbB2A6m97uBRE0/Ergcxr8hyqg7hrwn0vAtRIKIRX6Y2pMl0RhIj8co9nBGFrvh55l3ngU7YObng7IVnFvGS+BYUpmHziY/Ls2zgP9SX50by/G9N5w6I+ogYvpwK1SoOlHQNsGfWcd9Peqof88B/rTyzF9hAIopAByQzC0JQB9ST5oVnvhnt+LOGsprvUhxNIwa0aY7cGR6Cp7tr8+whkjawIxkRWC6YJI6N+lAKq3Qf/Tx+B77oGfaQc/8hB8w2Xwtw9Bf3kzZspXY/JIDEbfpAB2BKLvVV90Jvjgoac9vpRxE8kciTVCBMMkNirJ7k/tRHyjtxwjKV4Yp3t/6s+R4E+/DH3N6+BrS8E314Dvvg2+/Sb4hxfBf5sP/up2TF3ZhonK1zD6dhwGdwail26DzqgX8MRKiq9ZBpkSkmeYOyPM3m9Jjl+1Z9D8AgNtlAq6bZ70qsZi+q+bwV/7I/hbB8D/dAr8Axq89iz474p/G5++koHJy1sx/lkGdBc2YjA3HF0rHNHuboomuQj/5DgclIvOGCGCYRKFFuTMV7YUAD3VDQaLMfyqBcZORGPy01QKYSNm/rYV/Nd/Av9NHvgbueBrsjDzRQamKKDxT9Kgq1iLkbIUDOSHoiNcgnYHgnYZi+9ZExSbiSoMc2eE2flKcuJLa4KGRQz6/U0wlGaP0feiMH4uFpMXEjBVlYjp6lWY+SSZtim0kulYMiYuJEJXuhTDJ9UYPByOvoIwdCxfgE4bAo0Jh39xLAoVpMwIEQyTyFCQvGpLon9sJ0K3J4OBDDcMH1dj9FQsxkrjMPFRPCbOx2GyfLal9VEcxstioTulxjAFNfROJPqLl6Bnfyg6V7ugz5yBhuHwrZjBdiU5YJg7I8wOpifAKoVIW7uQ3rpOBH2b3ekVjYT2WCRG3o+mIGKgO0OrlIaebU/HYOQDNbQnojB4NJyGD0NPfjA0bwTRE6Q7hsUcWhkWN8yZqSQlWWGECAZLmJfJmbrvVSI8taK37xpbdB/wQW8xPee/8xIGjvlj8IQ/hk4G0JbWcX8MHPVDX4kveoq8ocn3xLM33NCZRcPHOGJYZIKfpQyq7JjHS6yJjcHujLHADgkpuC7h8F8zEVqXSNC2awE69lqhs8AamkO26HrbDt2H7dBVQov2NcW26CiwQtu+BWjdY4n2nZboTbfCmKcCnRyDO/YmyLPnDlHvjDH8G6zhS9/wlEnYR7X00fWrFYuWdVI0ZpuhcbcczW/R2qdAcz6t/bRov4mONeaaoYl+p22rHF0bVNAmKtBvweIXGxNcfFH8eNlC4m6wMWMusEnKpn5hyo48pj9gLe4SNG9QoGGLAk8z5XiaJUd99u8122/IpBA2K9BGg2vWWKAvRYVeLzEa7E1R422m2+MsSTem97nSYnfKyN6/mzATv7AUgqcMrUnmaFlLX3ysM0fj+t/b5lQLtK22QEfyAmiSLKFZpUJ7kBRPXKW4HqCYynWVHKSG2LkyZex1uO1mZM9lKem9Tx9jjY5iNEYo0bKMhn7ZAu0r6H5PpLXCAq0rKJClSjSGynE/QIkrQYqBPe6S2X+AJsY2Ped6iWZk6RlL0c2r5szofRsO9R5S1IfQLRCpQL1aifoYFerpsbkuTImaUJXuXIDiH6/Ys8vm3Mg8L2i20YqsO7fItKLcSXyn0kXccclVqv3MS6at9JU/Ox+ouns+SF6Z4cSupz7l8+z1ucs7LF1AQjOdxfGZzmx8Iu1TRcfnrioICAQEAgIBgYBAQCAgEBAICAQEAgIBgYBAQCAgEBAICAQEAv8H44b/6ZiGvGAAAAAASUVORK5CYII\x3d",
contentType:"image/png",width:15,height:15},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.clone(b.i18n.getLocalization("arcgisonline","arcgisonline").common);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").generalDlg);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").imgDlg);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").symbolDlg)},postCreate:function(){this.symbolLinePatternSelect._getMenuItemForOption=
function(a){if(!a.value&&!a.label)return new f.MenuSeparator({ownerDocument:this.ownerDocument});var c=b.hitch(this,"_setValueAttr",a);a=new f.MenuItem({option:a,label:a.label||this.emptyLabel,onClick:c,ownerDocument:this.ownerDocument,dir:this.dir,disabled:a.disabled||!1,iconClass:a.iconClass});a.focusNode.setAttribute("role","option");return a};this.symbolLinePatternSelect.addOption({value:"solid",iconClass:"symbolLinePatternSolid"});this.symbolLinePatternSelect.addOption({value:"dot",iconClass:"symbolLinePatternDot"});
this.symbolLinePatternSelect.addOption({value:"dash",iconClass:"symbolLinePatternDash"});this.symbolLinePatternSelect.addOption({value:"dashdot",iconClass:"symbolLinePatternDashDot"});this.symbolLinePatternSelect.addOption({value:"dashdotdot",iconClass:"symbolLinePatternDashDotDot"});this._symbolCloseIcon&&b.attr(this._symbolCloseIcon,"src",arcgisonline.sharing.util.relativeToExplicitUrl("images/close.gif"));b.connect(this.symbolLinePatternSelect,"onChange",b.hitch(this,"onPatternChange"));this.loadConnections()},
init:function(a){this.savedPictureMarkerSymbol=this.savedSimpleMarkerSymbol=null;if(this.symbol){if(a&&("picturemarkersymbol"===this.symbol.type||"simplemarkersymbol"===this.symbol.type))b.style(this.symbolFullTemplatePicker,"display","none"),b.style(this.symbolSmallTemplatePicker,"display","block"),setTimeout(b.hitch(this,function(){this.createSimpleMarkerTemplatePicker()}),0);else if(a)b.style(this.symbolFullTemplatePicker,"display","none"),b.style(this.symbolSmallTemplatePicker,"display","none");
else if(b.style(this.symbolSmallTemplatePicker,"display","none"),b.style(this.symbolFullTemplatePicker,"display","block"),this.symbolListItems)if(this.templatePickerSymbolClass!==this.symbol.type&&(!("simplemarkersymbol"===this.templatePickerSymbolClass||"picturemarkersymbol"===this.templatePickerSymbolClass)||!("picturemarkersymbol"===this.symbol.type||"simplemarkersymbol"===this.symbol.type))){if("simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type)for(a=0;a<this.symbolListItems.length;a++){var c=
this.symbolListItems[a];if(-1<c.typeKeywordsString.indexOf("marker")&&-1<c.typeKeywordsString.indexOf("default")){this.symbolColorClasses.set("value",c.title);break}}this.getSymbolListData(!0)}else this.getSymbolListData();else this.getSymbolListGroup();this.updateUI();this.enableEvents();this.symbolClassesTemplatePicker&&this.symbolClassesTemplatePicker.clearSelection();this.simpleMarkerTemplatePicker&&this.simpleMarkerTemplatePicker.clearSelection()}},hide:function(){this.disableEvents();f.popup.close(this.symbolColorTooltip);
this.destroySymbolClassesTemplatePicker();this.destroySimpleMarkerTemplatePicker()},loadConnections:function(){b.query(".jevent").connect("onclick",function(a){a.preventDefault()});b.connect(this.symbolColorTooltipClose,"onclick",b.hitch(this,function(a){a.preventDefault();f.popup.close(this.symbolColorTooltip)}));b.connect(this.symbolBackgroundColor,"onclick",this,"onBackgroundColorClick");b.connect(this.symbolOutlineColor,"onclick",this,"onOutlineColorClick");b.connect(this.symbolAddImage,"onclick",
this,"onAddImage")},updateUI:function(){this.symbolImage.innerHTML="";"simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type?(b.style(this.symbolClassesDiv,"display","block"),b.style(this.symbolClassesTemplatePickerDiv,"display","block"),b.style(this.symbolSizeRow,"display",""),this.symbolSizeLabel.innerHTML=this.i18n.symbolSizeLabel,b.style(this.symbolEndSizeRow,"display","none"),b.style(this.symbolEndWidthRow,"display","none"),b.style(this.symbolAddImageDiv,"display",
""),"simplemarkersymbol"===this.symbol.type?(b.style(this.symbolBackgroundColorRow,"display",this.showNoBgColor?"none":""),b.style(this.symbolLinePatternRow,"display","none"),b.style(this.symbolOutlineColorRow,"display",""),b.style(this.symbolWidthRow,"display",""),this.symbolWidthLabel.innerHTML=this.i18n.outlineWidthLabel,b.style(this.symbolTransparencyRow,"display",""),this.symbolSize.set("value",this.symbol.size,!1),this.symbolSizeInput.set("value",Math.round(this.symbol.size),!1),this.showEndSize&&
(this.symbolSizeLabel.innerHTML=this.i18n.symbolStartSizeLabel,this.symbolEndSize.set("value",this.endSize,!1),this.symbolEndSizeInput.set("value",Math.round(this.endSize),!1),b.style(this.symbolEndSizeRow,"display","")),b.style(this.symbolBackgroundColor,"background",this.symbol.color.toHex()),this.symbolTransparency.set("value",1-this.symbol.color.toRgba()[3],!1),this.symbolTransparencyInput.set("value",Math.round(100*(1-this.symbol.color.toRgba()[3])),!1),b.style(this.symbolOutlineColor,"background",
this.symbol.outline.color.toHex()),this.symbolWidth.set("value",this.symbol.outline.width,!1),this.symbolWidthInput.set("value",Math.round(this.symbol.outline.width),!1)):"picturemarkersymbol"===this.symbol.type&&(b.style(this.symbolBackgroundColorRow,"display","none"),b.style(this.symbolLinePatternRow,"display","none"),b.style(this.symbolOutlineColorRow,"display","none"),b.style(this.symbolWidthRow,"display","none"),b.style(this.symbolTransparencyRow,"display","none"),this.symbolSize.set("value",
this.symbol.width,!1),this.symbolSizeInput.set("value",Math.round(this.symbol.width),!1),this.showEndSize&&(this.symbolSizeLabel.innerHTML=this.i18n.symbolStartSizeLabel,this.symbolEndSize.set("value",this.endSize,!1),this.symbolEndSizeInput.set("value",Math.round(this.endSize),!1),b.style(this.symbolEndSizeRow,"display","")))):"simplelinesymbol"===this.symbol.type||"cartographiclinesymbol"===this.symbol.type?(b.style(this.symbolBackgroundColorRow,"display",this.showNoBgColor?"none":""),b.style(this.symbolAddImageDiv,
"display","none"),b.style(this.symbolClassesDiv,"display","none"),b.style(this.symbolClassesTemplatePickerDiv,"display","block"),b.style(this.symbolSizeRow,"display","none"),b.style(this.symbolTransparencyRow,"display",""),b.style(this.symbolEndSizeRow,"display","none"),this.setLinePattern(),b.style(this.symbolLinePatternRow,"display",""),this.symbolTransparency.set("disabled",!1),this.symbolTransparencyInput.set("disabled",!1),b.style(this.symbolOutlineColorRow,"display","none"),b.style(this.symbolWidthRow,
"display",""),this.symbolWidthLabel.innerHTML=this.i18n.symbolWidthLabel,b.style(this.symbolEndWidthRow,"display","none"),b.style(this.symbolBackgroundColor,"background",this.symbol.color.toHex()),this.symbolTransparency.set("value",1-this.symbol.color.toRgba()[3],!1),this.symbolTransparencyInput.set("value",Math.round(100*(1-this.symbol.color.toRgba()[3])),!1),this.symbolWidth.set("value",this.symbol.width,!1),this.symbolWidthInput.set("value",Math.round(this.symbol.width),!1),this.showEndSize&&
(this.symbolWidthLabel.innerHTML=this.i18n.symbolStartWidthLabel,this.symbolEndWidth.set("value",this.endSize,!1),this.symbolEndWidthInput.set("value",Math.round(this.endSize),!1),b.style(this.symbolEndWidthRow,"display","")),this.onPatternChange()):"simplefillsymbol"===this.symbol.type||"picturefillsymbol"===this.symbol.type?(b.style(this.symbolBackgroundColorRow,"display",this.showNoBgColor?"none":""),b.style(this.symbolAddImageDiv,"display","none"),b.style(this.symbolClassesDiv,"display","none"),
b.style(this.symbolClassesTemplatePickerDiv,"display","block"),b.style(this.symbolSizeRow,"display","none"),b.style(this.symbolTransparencyRow,"display",""),b.style(this.symbolEndSizeRow,"display","none"),b.style(this.symbolEndWidthRow,"display","none"),b.style(this.symbolLinePatternRow,"display","none"),b.style(this.symbolOutlineColorRow,"display",""),b.style(this.symbolWidthRow,"display",""),b.style(this.symbolEndWidthRow,"display","none"),this.symbolWidthLabel.innerHTML=this.i18n.outlineWidthLabel,
this.symbolTransparency.set("disabled",!1),this.symbolTransparencyInput.set("disabled",!1),b.style(this.symbolBackgroundColor,"backgroundColor",this.symbol.color.toHex()),this.symbolTransparency.set("value",1-this.symbol.color.toRgba()[3],!1),this.symbolTransparencyInput.set("value",Math.round(100*(1-this.symbol.color.toRgba()[3])),!1),b.style(this.symbolOutlineColor,"backgroundColor",this.symbol.outline.color.toHex()),this.symbolWidth.set("value",this.symbol.outline.width,!1),this.symbolWidthInput.set("value",
Math.round(this.symbol.outline.width),!1)):"textsymbol"===this.symbol.type&&console.log("text symbols are not supported");this._drawSymbol()},enableEvents:function(){this.eventHandlers=[];this.eventHandlers.push(b.connect(this.symbolSize,"onChange",this,"onSizeChange"));this.eventHandlers.push(b.connect(this.symbolSize._movable,"onMoveStop",this,"onSizeChange"));this.eventHandlers.push(b.connect(this.symbolSizeInput,"onChange",this,"onSizeChangeByInput"));this.eventHandlers.push(b.connect(this.symbolEndSize,
"onChange",this,"onEndSizeChange"));this.eventHandlers.push(b.connect(this.symbolEndSize._movable,"onMoveStop",this,"onEndSizeChange"));this.eventHandlers.push(b.connect(this.symbolEndSizeInput,"onChange",this,"onEndSizeChangeByInput"));this.eventHandlers.push(b.connect(this.symbolTransparency,"onChange",this,"onTransparencyChange"));this.eventHandlers.push(b.connect(this.symbolTransparency._movable,"onMoveStop",this,"onTransparencyChange"));this.eventHandlers.push(b.connect(this.symbolTransparencyInput,
"onChange",this,"onTransparencyChangeByInput"));this.eventHandlers.push(b.connect(this.symbolWidth,"onChange",this,"onWidthChange"));this.eventHandlers.push(b.connect(this.symbolWidth._movable,"onMoveStop",this,"onWidthChange"));this.eventHandlers.push(b.connect(this.symbolWidthInput,"onChange",this,"onWidthChangeByInput"));this.eventHandlers.push(b.connect(this.symbolEndWidth,"onChange",this,"onEndWidthChange"));this.eventHandlers.push(b.connect(this.symbolEndWidth._movable,"onMoveStop",this,"onEndWidthChange"));
this.eventHandlers.push(b.connect(this.symbolEndWidthInput,"onChange",this,"onEndWidthChangeByInput"));this.eventHandlers.push(b.connect(this.symbolLinePatternSelect,"onChange",b.hitch(this,"onSymbolLinePatternChange")));this.eventHandlers.push(b.connect(this.symbolColorClasses,"onChange",this,"onSymbolListChange"))},disableEvents:function(){this.eventHandlers&&(b.forEach(this.eventHandlers,function(a){b.disconnect(a)}),this.eventHandlers=null)},onPatternChange:function(){b.removeClass(this.symbolLinePatternSelect.containerNode,
"symbolLinePatternSolid symbolLinePatternDot symbolLinePatternDash symbolLinePatternDashDot symbolLinePatternDashDotDot");"solid"==this.symbolLinePatternSelect.get("value")?b.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternSolid"):"dot"==this.symbolLinePatternSelect.get("value")?b.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternDot"):"dash"==this.symbolLinePatternSelect.get("value")?b.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternDash"):
"dashdot"==this.symbolLinePatternSelect.get("value")?b.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternDashDot"):"dashdotdot"==this.symbolLinePatternSelect.get("value")&&b.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternDashDotDot")},onBackgroundColorClick:function(a){this.colorPicker="background";f.popup.open({popup:this.symbolColorTooltip,around:a.target})},onOutlineColorClick:function(a){this.colorPicker="outline";f.popup.open({popup:this.symbolColorTooltip,
around:a.target})},onColorSelection:function(a){f.popup.close(this.symbolColorTooltip);a=(new b.Color(a)).toRgba();"background"===this.colorPicker||"simplelinesymbol"===this.symbol.type?(a[3]=this.symbol.color.toRgba()[3],this.symbol.color.setColor(a)):this.symbol.outline.color.setColor(a);this.updateUI()},onTransparencyChange:function(a){a=this.symbol.color.toRgba();var c=this.symbolTransparency.getValue(),c=b.number.round(c,2);a[3]=1-c;this.symbol.color.setColor(a);this.updateUI()},onTransparencyChangeByInput:function(a){isNaN(a)?
this.symbolTransparencyInput.set("value",Math.round(100*this.symbolTransparency.getValue()),!1):(a=Math.round(a),0>a||100<a?this.symbolTransparencyInput.set("value",Math.round(100*this.symbolTransparency.getValue()),!1):this.symbolTransparency.set("value",a/100,!1))},onWidthChange:function(a){if(!isNaN(a)){var b=this.symbolWidth.getValue(),b=Math.round(b);"simplefillsymbol"===this.symbol.type||"simplemarkersymbol"===this.symbol.type?this.symbol.outline.width!=a&&(this.symbol.outline.setWidth(b),this.symbol.outline.setStyle(esri.symbol.SimpleLineSymbol.STYLE_SOLID),
a=this.symbol.outline.color.toRgba(),a[3]=1,this.symbol.outline.color.setColor(a),this.updateUI()):this.symbol.width!=a&&(this.symbol.setWidth(b),this.updateUI())}},onWidthChangeByInput:function(a){isNaN(a)?this.symbolWidthInput.set("value",this.symbolWidth.getValue(),!1):(a=Math.round(a),0>a||18<a?this.symbolWidthInput.set("value",this.symbolWidth.getValue(),!1):this.symbolWidth.set("value",a,!0))},onEndWidthChange:function(a){isNaN(a)||(a=this.symbolEndWidth.getValue(),a=Math.round(a),a<this.symbolWidthInput.getValue()?
this.symbolEndWidth.set("value",this.symbolEndWidthInput.getValue(),!1):(this.symbolEndWidthInput.set("value",a,!1),this.endSize=a))},onEndWidthChangeByInput:function(a){isNaN(a)?this.symbolEndWidthInput.set("value",Math.round(this.symbolEndWidth.getValue()),!1):(a=Math.round(a),1>a||120<a||a<this.symbolWidth.getValue()?this.symbolEndWidthInput.set("value",Math.round(this.symbolEndWidth.getValue()),!1):(this.symbolEndWidth.set("value",a,!1),this.endSize=a))},onSizeChange:function(a){if(!isNaN(a)){a=
this.symbol.width;var b=this.symbolSize.getValue(),b=Math.round(b);if(a!=b)if(this.showEndSize&&b>this.symbolEndSizeInput.getValue())this.symbolSize.set("value",this.symbolSizeInput.getValue(),!1);else{if("picturemarkersymbol"===this.symbol.type){this.symbol.setHeight(this.symbol.height/this.symbol.width*b);this.symbol.setWidth(b);if(!this.symbol.url||"http://"===this.symbol.url||-1==this.symbol.url.indexOf("http://")&&-1==this.symbol.url.indexOf("data:"))return;if(this.symbol.xoffset||this.symbol.yoffset)b=
this.symbol.width,a=b/a,this.symbol.setOffset(Math.round(this.symbol.xoffset*a),Math.round(this.symbol.yoffset*a))}else this.symbol.setSize(b);this.updateUI()}}},onSizeChangeByInput:function(a){isNaN(a)?this.symbolSizeInput.set("value",Math.round(this.symbolSize.getValue()),!1):(a=Math.round(a),1>a||120<a||this.showEndSize&&a>this.symbolEndSize.getValue()?this.symbolSizeInput.set("value",Math.round(this.symbolSize.getValue()),!1):this.symbolSize.set("value",a,!0))},onEndSizeChange:function(a){isNaN(a)||
(a=this.symbolEndSize.getValue(),a=Math.round(a),a<this.symbolSizeInput.getValue()?this.symbolEndSize.set("value",this.symbolEndSizeInput.getValue(),!1):(this.symbolEndSizeInput.set("value",a,!1),this.endSize=a))},onEndSizeChangeByInput:function(a){isNaN(a)?this.symbolEndSizeInput.set("value",Math.round(this.symbolEndSize.getValue()),!1):(a=Math.round(a),1>a||120<a||a<this.symbolSize.getValue()?this.symbolEndSizeInput.set("value",Math.round(this.symbolEndSize.getValue()),!1):(this.symbolEndSize.set("value",
a,!1),this.endSize=a))},onUrlChange:function(a){if(a&&!(10>a.length||0!==a.indexOf("http"))){this.urlChangesNotApplied=!0;for(var c=function(c){clearTimeout(g);g=null;var d=b.style(b.byId(this.id+"_testImage"),"width"),e=b.style(b.byId(this.id+"_testImage"),"height");c.w&&c.h&&(d=c.w,e=c.h);1==d&&1==e?(this.urlChangesNotApplied=!1,this.updateUI(),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorDlgTitle,message:this.i18n.error.invalidUrl})):(0===
d&&(d=40),0===e&&(e=d),(!c.w||!c.h)&&this.cachedImages.push({url:a,w:d,h:e}),this.symbol=new esri.symbol.PictureMarkerSymbol,this.symbol.setWidth(Math.min(120,d)),this.symbolSize.set("value",this.symbol.width,!1),this.symbol.setHeight(e/d*this.symbol.width),this.symbol.setUrl(a),this.updateUI(),this.urlChangesNotApplied=!1)},d=0;d<this.cachedImages.length;d++){var e=this.cachedImages[d];if(e.url==a){b.hitch(this,c)(e);return}}this.testImageHandler&&b.disconnect(this.testImageHandler);this.testImageHandler=
b.connect(b.byId(this.id+"_testImage"),"onload",this,c,{});var g=setTimeout(b.hitch(this,function(){clearTimeout(g);g=null;this.urlChangesNotApplied=!1;arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorDlgTitle,message:this.i18n.error.invalidUrl})}),5E3);b.byId(this.id+"_testImage").src=a}},onAddImage:function(a){this.onImageChangeHandler&&b.unsubscribe(this.onImageChangeHandler);this.onImageChangeHandler=b.subscribe("onUrlChange",b.hitch(this,
"onUrlChange"));arcgisonline.sharing.dijit.dialog.ImgDlg.prototype.statics.getInstance().show()},onSymbolLinePatternChange:function(){if("simplelinesymbol"===this.symbol.type||"cartographiclinesymbol"===this.symbol.type){switch(this.symbolLinePatternSelect.getValue()){case "dot":this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_DOT);break;case "dash":this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_DASH);break;case "dashdot":this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_DASHDOT);
break;case "dashdotdot":this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_DASHDOTDOT);break;default:this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_SOLID)}this.updateUI()}},getSymbolListGroup:function(){var a=function(a,b){console.log("Error retrieving symbol list items.")};arcgisonline.sharing.geow.Community.searchGroups(esriGeowConfig.symbolSetsGroupQuery,b.hitch(this,function(b,d){b&&b.results&&0<b.results.length?this.getSymbolListItems(b.results[0].id):a(b,d)}),b.hitch(this,a))},
getSymbolListItems:function(a){a=esriGeowConfig.restBaseUrl+"search?num\x3d20\x26q\x3dgroup:"+a+' AND type:"Symbol Set"';a="vml"===k.gfx.renderer?a+' AND -typekeywords:"by value"':a+' AND ((typekeywords:"by value" AND typekeywords:"marker") OR typekeywords:"fill" OR typekeywords:"line")';var c=function(a,b){console.log("Error retrieving symbol list items.")};arcgisonline.sharing.util.getJson(a,b.hitch(this,function(a,e){a.results&&0<a.results.length?(this.symbolListItems=a.results,this.symbolListItems.sort(function(a,
b){return a.title==b.title?0:a.title<b.title?-1:1}),b.forEach(this.symbolListItems,function(a,b){a.typeKeywordsString=a.typeKeywords.toString();if(-1<a.typeKeywordsString.indexOf("default")&&-1<a.typeKeywordsString.indexOf("marker")){var c=this.symbolListItems.splice(b,1);0<c.length&&(this.symbolListItems.splice(0,0,c[0]),this.symbolColorClasses.set("value",a.title))}},this),this.symbolClassStore=new b.data.ItemFileWriteStore({data:{identifier:"id",items:[]}}),b.forEach(this.symbolListItems,function(a){-1<
a.typeKeywordsString.indexOf("marker")&&(this.symbolClassStore.newItem({name:a.title,id:a.id}),this.symbolColorClasses.set("store",this.symbolClassStore))},this),this.getSymbolListData(!0)):c(a,e)}),b.hitch(this,c))},getSymbolListData:function(a){this.destroySymbolClassesTemplatePicker();b.forEach(this.symbolListItems,function(c){if(("simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type)&&-1<c.typeKeywordsString.indexOf("marker")||("simplelinesymbol"===this.symbol.type||
"cartographiclinesymbol"===this.symbol.type)&&-1<c.typeKeywordsString.indexOf("line")||("simplefillsymbol"===this.symbol.type||"picturefillsymbol"===this.symbol.type)&&-1<c.typeKeywordsString.indexOf("fill"))if(c.data)"simplemarkersymbol"!==this.symbol.type&&"picturemarkersymbol"!==this.symbol.type?this.processSymbolListData(c):this.symbolColorClasses.get("value")==c.title&&this.processSymbolListData(c);else{var d=function(a,b){console.log("Error retrieving symbol lists data.")};arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+
"/content/items/"+c.id+"/data",b.hitch(this,function(b,c,h){c&&0<c.length?(b.data=c,"simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type?(a&&-1<b.typeKeywordsString.indexOf("default")||!a)&&this.processSymbolListData(b):this.processSymbolListData(b)):d(c,h)},c),b.hitch(this,d))}},this)},processSymbolListData:function(a){setTimeout(b.hitch(this,function(){this.createSymbolListTemplatePicker(a.data)}),0)},createSymbolListTemplatePicker:function(a){a=b.map(a,function(a){var b=
{};b.symbol=esri.symbol.fromJson(a);b.description=a.name;return b},this);this.symbolClassesTemplatePicker||(this.symbolClassesTemplatePicker=new esri.dijit.editing.TemplatePicker({items:a,rows:"auto",columns:"auto",_assumedCellWidth:40,grouping:!1,style:"position: relative; width: 100%; height: 120px;"},this.id+"_symbolClassesTemplatePicker"),this.symbolClassesTemplatePicker.startup(),this.templatePickerSymbolClass=this.symbol.type,this.templatePickerOnSelectionChangeHandler=b.connect(this.symbolClassesTemplatePicker,
"onSelectionChange",this,function(){var a=this.symbolClassesTemplatePicker.getSelected();if(a){var b=this.symbol;this.symbol=esri.symbol.fromJson(a.item.symbol.toJson());if("simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type)"simplemarkersymbol"===this.symbol.type?this.symbol.size="simplemarkersymbol"===b.type?b.size:b.width:"simplemarkersymbol"===b.type?(this.symbol.xoffset&&(this.symbol.xoffset=b.size/(this.symbol.width/this.symbol.xoffset)),this.symbol.yoffset&&(this.symbol.yoffset=
this.symbol.height/this.symbol.width*b.size/(this.symbol.height/this.symbol.yoffset)),this.symbol.height=this.symbol.height/this.symbol.width*b.size,this.symbol.width=b.size):(this.symbol.xoffset&&(this.symbol.xoffset=b.width/(this.symbol.width/this.symbol.xoffset)),this.symbol.yoffset&&(this.symbol.yoffset=this.symbol.height/this.symbol.width*b.width/(this.symbol.height/this.symbol.yoffset)),this.symbol.height=this.symbol.height/this.symbol.width*b.width,this.symbol.width=b.width);if((this.symbol.width||
this.symbol.size)>=this.endSize)this.endSize=(this.symbol.width?this.symbol.width:this.symbol.size)+("simplelinesymbol"==this.symbol.type?10:20),this.symbolEndSize.set("value",this.endSize,!1);this.updateUI()}}))},destroySymbolClassesTemplatePicker:function(){this.symbolClassesTemplatePicker&&(b.disconnect(this.templatePickerOnSelectionChangeHandler),this.symbolClassesTemplatePicker.destroy(),this.symbolClassesTemplatePicker=null,b.byId("symbolClassesTemplatePicker")||b.create("div",{id:this.id+"_symbolClassesTemplatePicker"},
this.symbolClassesTemplatePickerDiv))},onSymbolListChange:function(a){if(a){this.destroySymbolClassesTemplatePicker();for(var c=null,d=0;d<this.symbolListItems.length;d++)this.symbolListItems[d].title==a&&(c=this.symbolListItems[d]);c&&c.data&&setTimeout(b.hitch(this,function(){this.createSymbolListTemplatePicker(c.data)}),0)}},createSimpleMarkerTemplatePicker:function(){var a=b.map(this.simpleMarkerSymbols,function(a){var b={};b.symbol=esri.symbol.fromJson(a);b.description=a.name;return b},this);
this.simpleMarkerTemplatePicker||(this.simpleMarkerTemplatePicker=new esri.dijit.editing.TemplatePicker({items:a,rows:"auto",columns:"auto",_assumedCellWidth:40,grouping:!1,style:"position: relative; width: 100%; height: 45px;"},this.id+"_symbolSimpleMarkerTemplatePicker"),this.simpleMarkerTemplatePicker.startup(),this.simpleMarkerTemplatePickerOnSelectionChangeHandler=b.connect(this.simpleMarkerTemplatePicker,"onSelectionChange",this,function(){var a=this.simpleMarkerTemplatePicker.getSelected();
a&&(this.symbol=esri.symbol.fromJson(a.item.symbol.toJson()),this.updateUI())}))},destroySimpleMarkerTemplatePicker:function(){this.simpleMarkerTemplatePicker&&(b.disconnect(this.simpleMarkerTemplatePickerOnSelectionChangeHandler),this.simpleMarkerTemplatePicker.destroy(),this.simpleMarkerTemplatePicker=null,b.byId(this.id+"_symbolSimpleMarkerTemplatePicker")||b.create("div",{id:this.id+"_symbolSimpleMarkerTemplatePicker"},this.symbolSimpleMarkerTemplatePickerDiv))},getSymbolUrl:function(){var a=
this.symbol.url;0!==a.indexOf("http://")&&(this.symbol.imageData&&0<this.symbol.imageData.length)&&(a=this.symbol.imageData);return a},setLinePattern:function(){switch(this.symbol.style){case esri.symbol.SimpleLineSymbol.STYLE_DOT:this.symbolLinePatternSelect.set("value","dot",!1);break;case esri.symbol.SimpleLineSymbol.STYLE_DASH:this.symbolLinePatternSelect.set("value","dash",!1);break;case esri.symbol.SimpleLineSymbol.STYLE_DASHDOT:this.symbolLinePatternSelect.set("value","dashdot",!1);break;case esri.symbol.SimpleLineSymbol.STYLE_DASHDOTDOT:this.symbolLinePatternSelect.set("value",
"dashdotdot",!1);break;default:this.symbolLinePatternSelect.set("value","solid",!1)}},getMarkerJson:function(){var a=this.markerJson;a.url=arcgisonline.sharing.util.getRedSphereUrl();return a},_drawSymbol:function(){var a=this.symbolImage,c=this.symbol,d=this.template,e=80,g=30;if("simplemarkersymbol"===c.type)g=e=Math.min(c.size+12,125);else if("picturemarkersymbol"===c.type){if(!this.symbol.url||"http://"===c.url||-1==c.url.indexOf("http://")&&-1==c.url.indexOf("https://")&&-1==c.url.indexOf("data:"))return;
g=e=Math.min(Math.max(c.width,c.height),125)}else if("simplelinesymbol"===this.symbol.type||"cartographiclinesymbol"===this.symbol.type)e=190,g=20;a=k.gfx.createSurface(a,e,g);if("vml"===k.gfx.renderer){var h=a.getEventSource();b.style(h,"position","relative");b.style(h.parentNode,"position","relative")}var c=this._getDrawingToolShape(c,d)||esri.symbol.getShapeDescriptors(c),f;try{f=a.createShape(c.defaultShape).setFill(c.fill).setStroke(c.stroke)}catch(l){a.clear();a.destroy();return}c=a.getDimensions();
c={dx:c.width/2,dy:c.height/2};h=f.getBoundingBox();d=h.width;h=h.height;if(d>e||h>g)e=((e<g?e:g)-5)/(d>h?d:h),b.mixin(c,{xx:e,yy:e});f.applyTransform(c);return a},_getDrawingToolShape:function(a,b){if("simplelinesymbol"==a.type||"cartographiclinesymbol"==a.type)return d={type:"path",path:"M -90,0 L 90,0 E"},{defaultShape:d,fill:null,stroke:a.getStroke()};var d;switch(b?b.drawingTool||null:null){case "esriFeatureEditToolArrow":d={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};
break;case "esriFeatureEditToolTriangle":d={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":d={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":d={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":d={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:d,fill:a.getFill(),stroke:a.getStroke()}},_repaintItems:function(){b.forEach(this._surfaceItems,
function(a){this._repaint(a)},this)},_repaint:function(a){a.getStroke&&a.setStroke&&a.setStroke(a.getStroke());a.getFill&&a.setFill&&a.setFill(a.getFill());a.children&&b.isArray(a.children)&&b.forEach(a.children,this._repaint,this)}})});