// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
require({cache:{"url:arcgisonline/sharing/dijit/templates/Tags.html":'\x3cdiv class\x3d"${baseClass}" style\x3d"outline:none;"\x3e\x3c/div\x3e'}});
define("arcgisonline/sharing/dijit/Tags","dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/on dojo/dom dojo/dom-construct dojo/parser dojo/store/Memory dojo/Deferred dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_WidgetBase dijit/registry dijit/form/TextBox esri/lang arcgisonline/sharing/util arcgisonline/sharing/dijit/AutoComplete dojo/text!./templates/Tags.html dojo/domReady!".split(" "),function(d,c,h,t,u,g,v,k,l,m,w,n,x,p,q,f,r,s){return h("arcgisonline.sharing.dijit.Tags",
[n,m],{templateString:s,baseClass:"esriAGOTags",_minWidth:"auto",_maxWidth:"auto",postMixInProperties:function(){this.inherited(arguments);this.i18n=dojo.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,dojo.i18n.getLocalization("arcgisonline","arcgisonline").tagsWidget)},postCreate:function(){this._isIE8=9>dojo.isIE;this._user=f.getUser()},startup:function(){this.inherited(arguments)},loadTags:function(a){var b=new l;this._isIE8?(this._textTags||(this.tagsId="userTags-"+
(new Date).getTime(),g.create("div",{id:this.tagsId},this.domNode),this._textTags=new p({placeHolder:this.i18n.addTags,trim:!0,style:{minWidth:this._minWidth,maxWidth:this._maxWidth}},this.tagsId)),b.resolve()):(a=a||this._user)?f.request({url:esriGeowConfig.restBaseUrl+"community/users/"+(a.username?a.username:a.email)+"/tags",content:{ts:(new Date).getTime()}}).then(c.hitch(this,function(a){this._handleTags(a);b.resolve()}),c.hitch(this,function(a){this._handleTags(a);b.resolve()})):b.resolve();
return b},_handleTags:function(a){if(a){this._autoComplete&&this._autoComplete.clearTags();var b=[];a.tags&&d.forEach(a.tags,c.hitch(this,function(a){b.push(a)}));this._tagStore?(this._tagStore.query({}).forEach(dojo.hitch(this,function(a){this._tagStore.remove(a.tag)})),d.forEach(b,dojo.hitch(this,function(a){this._tagStore.add(a)}))):this._tagStore=new k({idProperty:"tag",data:b});this._autoComplete||(a=(new Date).getTime(),this.tagsId="userTags-"+a,this.gridId="grid-"+a,this.filterId="filter-"+
a,g.create("div",{id:this.tagsId,className:"grid_1"},this.domNode),this._autoComplete=new r({placeholder:this.i18n.addTags,noDataMsg:this.i18n.noTagsFound,idProperty:"tag",gridId:this.gridId,filterId:this.filterId,minWidth:this._minWidth,maxWidth:this._maxWidth,matchParam:"first",store:this._tagStore,style:{width:this._minWidth}},this.tagsId))}},_getUniqueTags:function(a){var b=[],e;d.forEach(a,c.hitch(this,function(a){e=f.stripHTML(a);q.isDefined(e)&&0<e.length&&b.push(e)}));return d.filter(b,c.hitch(this,
function(a,c){return d.indexOf(b,a)===c}))},_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},_setTagsAttr:function(a){a&&!(a instanceof Array)&&(a=a.split(","));this._isIE8?this._textTags&&this._textTags.set("value",this._getUniqueTags(a).join(",")):this._autoComplete&&(this._autoComplete.clearTags(),this._autoComplete.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):
"":this._autoComplete&&this._autoComplete.values?this._autoComplete.values.join(","):""},_setMinWidthAttr:function(a){this._minWidth=a},_setMaxWidthAttr:function(a){this._maxWidth=a}})});