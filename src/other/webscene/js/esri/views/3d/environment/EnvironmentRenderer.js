// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
define("../../../core/declare ../../../core/Accessor ./MixedPanoramicAtmosphere ./PanoramicAtmosphere ./RealisticAtmosphere ./SimpleAtmosphere ./Stars".split(" "),function(d,e,f,g,h,k,l){return d([e],{classMetadata:{properties:{view:{},planar:{setter:function(a){this._planar=!!a;this._switchAtmosphere()},getter:function(){return this._planar}},realistic:{setter:function(a){this._realistic=!!a;this._switchAtmosphere()},getter:function(){return this._realistic}},transparent:{setter:function(a){this._transparent=
!!a;this._switchAtmosphere()},getter:function(){return this._transparent}}}},constructor:function(){this._selectAtmosphere();this._STANDARD_SLOT=0;this._SPECIAL_SLOT=4;this.slots=[this._STANDARD_SLOT,this._SPECIAL_SLOT];this.gl=0;this._needsRender=!0;this._didRender=!1;this._Atmosphere=null;this.initialized=this._transparent=this._realistic=this._planar=!1},_switchAtmosphere:function(){this._selectAtmosphere();this.initialized&&(this._atmosphere=new this._Atmosphere(this.view),this._atmosphere.init(),
this._atmosphere.setContext(this.gl),this._atmosphere.loadShaders(this._snippets,this._shaderRep,this._programRep),this._transparent&&!this._planar?(this._atmosphere.slot=this._SPECIAL_SLOT,this._stars.slot=this._SPECIAL_SLOT):(this._atmosphere.slot=this._STANDARD_SLOT,this._stars.slot=this._STANDARD_SLOT),this._needsRender=!0)},_selectAtmosphere:function(){void 0!==this.needsDepthMap&&delete this.needsDepthMap;this._realistic&&!this._transparent?(this._Atmosphere=this._planar?f:h,this.needsDepthMap=
!0):this._Atmosphere=this._planar?g:k},setContext:function(a){this.gl=a;this._atmosphere.setContext(a);this._stars.setContext(a)},loadShaders:function(a,b,c){this._snippets=a;this._shaderRep=b;this._programRep=c;this._atmosphere.loadShaders(a,b,c);this._stars.loadShaders(a,b,c)},render:function(a){a.slot!==this.slots[0]&&a.slot!==this.slots[1]||"material"!==a.pass||(a.slot===this.slots[0]&&(this._planar||!this._transparent)?(this._stars.render(a),this._atmosphere.render(a)):(a.slot===this.slots[1]&&
(this._transparent&&this._stars.render(a),this._atmosphere.render(a)),this._didRender=this._stars._didRender&&this._atmosphere._didRender))},needsRender:function(){return this._needsRender},resetNeedsRender:function(){this._didRender&&(this._needsRender=!1)},init:function(){this._atmosphere=new this._Atmosphere(this.view);this._atmosphere.init();this._stars=new l(this.view);this._stars.init();this._transparent&&(this._atmosphere.slot=this._SPECIAL_SLOT,this._stars.slot=this._SPECIAL_SLOT);this.view._stage.addExternalRenderer(this.slots,
this);this.initialized=!0},destroy:function(){this._atmosphere&&this._atmosphere.destroy();this._stars&&this._stars.destroy();this.view._stage.removeExternalRenderer(this.slots,this)}})});