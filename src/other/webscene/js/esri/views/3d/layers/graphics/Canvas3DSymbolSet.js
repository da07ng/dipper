// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
define(["../../../../core/declare","../../support/PromiseLightweight","./Canvas3DSymbolFactory","./Canvas3DGraphicSet"],function(n,p,q,r){return n(p.Promise,{constructor:function(a,e,c){this.symbol=a;a=a.symbolLayers;var b=0;c&&(a=c.concat(a),b=c.length);c=a.length;this.childCanvas3DSymbols=Array(a.length);for(var d=e.layerOrder,h=0,k=0,l=!1,m=function(a,b){b&&(this.childCanvas3DSymbols[a]=b,k++);h--;l&&1>h&&(0<k?this.resolve():this.reject())},f=0;f<c;f++){var g=a[f];if(!1!==g.enable&&(e.layerOrder=
d+(1-(1+f)/c),g=q.make(g,e,f<b)))h++,g.then(m.bind(this,f,g),m.bind(this,f,null))}e.layerOrder=d;l=!0;!this.isFulfilled()&&1>h&&(0<k?this.resolve():this.reject())},createCanvas3DGraphic:function(a,e){for(var c=Array(this.childCanvas3DSymbols.length),b=0;b<this.childCanvas3DSymbols.length;b++){var d=this.childCanvas3DSymbols[b];d&&(c[b]=d.createCanvas3DGraphic(a,e))}return new r(a,this,c)},layerPropertyChanged:function(a,e){for(var c=this.childCanvas3DSymbols.length,b=0;b<c;b++){var d=this.childCanvas3DSymbols[b];
if(d&&!d.layerPropertyChanged(a,e,b))return!1}return!0},setDrawOrder:function(a,e){for(var c=this.childCanvas3DSymbols.length,b=0;b<c;b++){var d=this.childCanvas3DSymbols[b];d&&d.setDrawOrder(a+(1-(1+b)/c),e)}},destroy:function(){for(var a=0;a<this.childCanvas3DSymbols.length;a++)this.childCanvas3DSymbols[a]&&this.childCanvas3DSymbols[a].destroy()}})});