// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/dialog/JoinGroupDlg",["dijit","dojo","dojox","dojo/require!dijit/Dialog,arcgisonline/sharing/dijit/dialog/GeneralDlg,dijit/_Widget,dijit/_Templated"],function(d,a,f){a.provide("arcgisonline.sharing.dijit.dialog.JoinGroupDlg");a.require("dijit.Dialog");a.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");a.require("dijit._Widget");a.require("dijit._Templated");a.declare("arcgisonline.sharing.dijit.dialog.JoinGroupDlg",[d._Widget,d._Templated],{widgetsInTemplate:!0,
groupId:null,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n    \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"join_group-dialog" title\x3d"${i18n.joinGroupTitle}" execute\x3d""\x3e\r\n  \x3cdiv id\x3d"join_group-dialog-content"\x3e${i18n.yourRequestForReview}\x3cbr/\x3e${i18n.youCanCheckStatus}\x3c/div\x3e\r\n  \x3cbr /\x3e  \r\n  \x3cbutton id\x3d"button_join_group-submit" class\x3d"jevent primary" dojoType\x3d"dijit.form.Button"\x3e${i18n.submitRequest}\x3c/button\x3e\r\n  \x3cbutton id\x3d"button_join_group-close" class\x3d"jevent cancel" dojoType\x3d"dijit.form.Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n\x3c/div\x3e\r\n\x3c/div\x3e',
successHandler:null,i18n:null,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.JoinGroupDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=a.i18n.getLocalization("arcgisonline","arcgisonline").common;a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline","arcgisonline").joinGroupDlg)},postCreate:function(){this.loadConnections()},show:function(a,b){this.groupId=a;b&&(this.successHandler=
b);d.byId("join_group-dialog").show()},loadConnections:function(){a.query(".jevent").connect("onclick",function(a){a.preventDefault()});a.query("#button_join_group-close").connect("onclick",function(){d.byId("join_group-dialog").hide()});a.query("#button_join_group-submit").connect("onclick",a.hitch(this,"submitRequest"))},submitRequest:function(e){e.preventDefault();var b;b=arcgisonline.sharing.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+this.groupId+"/join",a.hitch(this,function(a,
b){d.byId("join_group-dialog").hide();this.successHandler&&this.successHandler(a,b)}),a.hitch(this,function(a,e){if(!b.canceled){var c=a.message;-1<c.indexOf("You have already applied to join this group.")?c=this.i18n.alreadyRequested+"\x3cBR/\x3e"+this.i18n.applicationConsidered:-1<c.indexOf("Unable to apply to join group:")?c=this.i18n.cannotAccept:-1<c.indexOf(" is by invitation only.")&&(c=this.i18n.byInviteOnly);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.joinGroupError,
message:c})}d.byId("join_group-dialog").hide()}))}})});