// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
require({cache:{"dojox/charting/plot2d/_PlotEvents":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect"],function(l,m,h,k){return h("dojox.charting.plot2d._PlotEvents",null,{constructor:function(){this._shapeEvents=[];this._eventSeries={}},destroy:function(){this.resetEvents();this.inherited(arguments)},plotEvent:function(g){},raiseEvent:function(g){this.plotEvent(g);var b=l.delegate(g);b.originalEvent=g.type;b.originalPlot=g.plot;b.type="onindirect";
m.forEach(this.chart.stack,function(d){d!==this&&d.plotEvent&&(b.plot=d,d.plotEvent(b))},this)},connect:function(g,b){this.dirty=!0;return k.connect(this,"plotEvent",g,b)},events:function(){return!!this.plotEvent.after},resetEvents:function(){this._shapeEvents.length&&(m.forEach(this._shapeEvents,function(g){g.shape.disconnect(g.handle)}),this._shapeEvents=[]);this.raiseEvent({type:"onplotreset",plot:this})},_connectSingleEvent:function(g,b){this._shapeEvents.push({shape:g.eventMask,handle:g.eventMask.connect(b,
this,function(d){g.type=b;g.event=d;this.raiseEvent(g);g.event=null})})},_connectEvents:function(g){g&&(g.chart=this.chart,g.plot=this,g.hAxis=this.hAxis||null,g.vAxis=this.vAxis||null,g.eventMask=g.eventMask||g.shape,this._connectSingleEvent(g,"onmouseover"),this._connectSingleEvent(g,"onmouseout"),this._connectSingleEvent(g,"onclick"))},_reconnectEvents:function(g){(g=this._eventSeries[g])&&m.forEach(g,this._connectEvents,this)},fireEvent:function(g,b,d,e){if((g=this._eventSeries[g])&&g.length&&
d<g.length)d=g[d],d.type=b,d.event=e||null,this.raiseEvent(d),d.event=null}})})},"dojox/charting/axis2d/Invisible":function(){define(["dojo/_base/lang","dojo/_base/declare","./Base","../scaler/linear","dojox/lang/utils"],function(l,m,h,k,g){return m("dojox.charting.axis2d.Invisible",h,{defaultParams:{vertical:!1,fixUpper:"none",fixLower:"none",natural:!1,leftBottom:!0,includeZero:!1,fixed:!0},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1},constructor:function(b,
d){this.opt=l.clone(this.defaultParams);g.updateWithObject(this.opt,d);g.updateWithPattern(this.opt,d,this.optionalParams)},dependOnData:function(){return!("min"in this.opt)||!("max"in this.opt)},clear:function(){delete this.scaler;delete this.ticks;this.dirty=!0;return this},initialized:function(){return"scaler"in this&&!(this.dirty&&this.dependOnData())},setWindow:function(b,d){this.scale=b;this.offset=d;return this.clear()},getWindowScale:function(){return"scale"in this?this.scale:1},getWindowOffset:function(){return"offset"in
this?this.offset:0},calculate:function(b,d,e){if(this.initialized())return this;var a=this.opt;this.labels=a.labels;this.scaler=k.buildScaler(b,d,e,a);var c=this.scaler.bounds;"scale"in this&&(a.from=c.lower+this.offset,a.to=(c.upper-c.lower)/this.scale+a.from,!isFinite(a.from)||isNaN(a.from)||!isFinite(a.to)||isNaN(a.to)||a.to-a.from>=c.upper-c.lower?(delete a.from,delete a.to,delete this.scale,delete this.offset):(a.from<c.lower?(a.to+=c.lower-a.from,a.from=c.lower):a.to>c.upper&&(a.from+=c.upper-
a.to,a.to=c.upper),this.offset=a.from-c.lower),this.scaler=k.buildScaler(b,d,e,a),1==this.scale&&0==this.offset&&(delete this.scale,delete this.offset));return this},getScaler:function(){return this.scaler},getTicks:function(){return this.ticks}})})},"dojox/lang/utils":function(){define(["..","dojo/_base/lang"],function(l,m){var h=m.getObject("lang.utils",!0,l),k={},g=Object.prototype.toString,b=function(b){if(b)switch(g.call(b)){case "[object Array]":return b.slice(0);case "[object Object]":return m.delegate(b)}return b};
m.mixin(h,{coerceType:function(b,e){switch(typeof b){case "number":return Number(eval("("+e+")"));case "string":return String(e);case "boolean":return Boolean(eval("("+e+")"))}return eval("("+e+")")},updateWithObject:function(d,e,a){if(!e)return d;for(var c in d)if(c in e&&!(c in k)){var f=d[c];f&&"object"==typeof f?h.updateWithObject(f,e[c],a):d[c]=a?h.coerceType(f,e[c]):b(e[c])}return d},updateWithPattern:function(d,e,a,c){if(!e||!a)return d;for(var f in a)f in e&&!(f in k)&&(d[f]=c?h.coerceType(a[f],
e[f]):b(e[f]));return d},merge:function(b,e){if(e){var a=g.call(b),c=g.call(e),f,n;switch(c){case "[object Array]":if(c==a){a=Array(Math.max(b.length,e.length));f=0;for(c=a.length;f<c;++f)a[f]=h.merge(b[f],e[f]);return a}return e.slice(0);case "[object Object]":if(c==a&&b){a=m.delegate(b);for(f in e)f in b?(c=b[f],n=e[f],n!==c&&(a[f]=h.merge(c,n))):a[f]=m.clone(e[f]);return a}return m.clone(e)}}return e}});return h})},"dojox/charting/plot2d/Pie":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare ./Base ./_PlotEvents ./common dojox/gfx dojox/gfx/matrix dojox/lang/functional dojox/lang/utils dojo/has".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f){return h("dojox.charting.plot2d.Pie",[k,g],{defaultParams:{labels:!0,ticks:!1,fixed:!0,precision:1,labelOffset:20,labelStyle:"default",htmlLabels:!0,radGrad:"native",fanSize:5,startAngle:0},optionalParams:{radius:0,omitLabels:!1,stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:"",labelWiring:{}},constructor:function(a,b){this.opt=l.clone(this.defaultParams);c.updateWithObject(this.opt,b);c.updateWithPattern(this.opt,b,this.optionalParams);
this.axes=[];this.run=null;this.dyn=[];this.runFilter=[]},clear:function(){this.inherited(arguments);this.dyn=[];this.run=null;return this},setAxis:function(a){return this},addSeries:function(a){this.run=a;return this},getSeriesStats:function(){return l.delegate(b.defaultStats)},getRequiredColors:function(){return this.run?this.run.data.length:0},render:function(c,b){if(!this.dirty)return this;this.resetEvents();this.dirty=!1;this._eventSeries={};this.cleanGroup();var q=this.group,p=this.chart.theme;
if(!this.run||!this.run.data.length)return this;var g=(c.width-b.l-b.r)/2,h=(c.height-b.t-b.b)/2,k=Math.min(g,h),M="font"in this.opt?this.opt.font:p.series.font,L,t=e._degToRad(this.opt.startAngle),A=t,s,B,y,u,E=this.events(),I=m.map(this.run.data,function(a,c){"number"!=typeof a&&a.hidden&&(this.runFilter.push(c),a.hidden=!1);return m.some(this.runFilter,function(a){return a==c})?"number"==typeof a?0:{y:0,text:a.text}:a},this);this.dyn=[];"radius"in this.opt&&(k=this.opt.radius,u=k-this.opt.labelOffset);
var z={cx:b.l+g,cy:b.t+h,r:k};if(this.opt.shadow||p.shadow){s=this.opt.shadow||p.shadow;var H=l.clone(z);H.cx+=s.dx;H.cy+=s.dy;q.createCircle(H).setFill(s.color).setStroke(s)}if(q.setFilter&&(this.opt.filter||p.filter))q.createCircle(z).setFill(p.series.stroke).setFilter(this.opt.filter||p.filter);if("number"==typeof I[0]){s=a.map(I,"x ? Math.max(x, 0) : 0");if(a.every(s,"\x3c\x3d 0"))return q.createCircle(z).setStroke(p.series.stroke),this.dyn=m.map(s,function(){return{}}),this;B=a.map(s,"/this",
a.foldl(s,"+",0));this.opt.labels&&(y=m.map(B,function(a){return 0<a?this._getLabel(100*a)+"%":""},this))}else{s=a.map(I,"x ? Math.max(x.y, 0) : 0");if(a.every(s,"\x3c\x3d 0"))return q.createCircle(z).setStroke(p.series.stroke),this.dyn=m.map(s,function(){return{}}),this;B=a.map(s,"/this",a.foldl(s,"+",0));this.opt.labels&&(y=m.map(B,function(a,c){if(0>a)return"";var b=I[c];return"text"in b?b.text:this._getLabel(100*a)+"%"},this))}var J=a.map(I,function(a,c){var b=[this.opt,this.run];null!==a&&"number"!=
typeof a&&b.push(a);this.opt.styleFunc&&b.push(this.opt.styleFunc(a));return p.next("slice",b,!0)},this);this.opt.labels&&(L=M?d.normalizedLength(d.splitFontString(M).size):0,s=a.foldl1(a.map(y,function(a,c){return d._base._getTextBox(a,{font:J[c].series.font}).w},this),"Math.max(a, b)")/2,0>this.opt.labelOffset&&(k=Math.min(g-2*s,h-L)+this.opt.labelOffset),u=k-this.opt.labelOffset);var G=Array(B.length);m.some(B,function(a,f){if(0>a)return!1;var d=I[f],s=J[f],p;if(0==a)return this.dyn.push({fill:s.series.fill,
stroke:s.series.stroke}),!1;if(1<=a){p=this._plotFill(s.series.fill,c,b);p=this._shapeFill(p,{x:z.cx-z.r,y:z.cy-z.r,width:2*z.r,height:2*z.r});p=this._pseudoRadialFill(p,{x:z.cx,y:z.cy},z.r);var g=q.createCircle(z).setFill(p).setStroke(s.series.stroke);this.dyn.push({fill:p,stroke:s.series.stroke});E&&(d={element:"slice",index:f,run:this.run,shape:g,x:f,y:"number"==typeof d?d:d.y,cx:z.cx,cy:z.cy,cr:k},this._connectEvents(d),G[f]=d);return!1}var v=A+2*a*Math.PI;f+1==B.length&&(v=t+2*Math.PI);var g=
v-A,h=z.cx+k*Math.cos(A),x=z.cy+k*Math.sin(A),M=z.cx+k*Math.cos(v),y=z.cy+k*Math.sin(v);p=e._degToRad(this.opt.fanSize);if(s.series.fill&&"radial"===s.series.fill.type&&"fan"===this.opt.radGrad&&g>p){var H=q.createGroup(),l=Math.ceil(g/p),u=g/l;p=this._shapeFill(s.series.fill,{x:z.cx-z.r,y:z.cy-z.r,width:2*z.r,height:2*z.r});for(var m=0;m<l;++m){var L=0==m?h:z.cx+k*Math.cos(A+(m-0.2)*u),Z=0==m?x:z.cy+k*Math.sin(A+(m-0.2)*u),F=m==l-1?M:z.cx+k*Math.cos(A+(m+1+0.2)*u),ea=m==l-1?y:z.cy+k*Math.sin(A+(m+
1+0.2)*u);H.createPath().moveTo(z.cx,z.cy).lineTo(L,Z).arcTo(k,k,0,u>Math.PI,!0,F,ea).lineTo(z.cx,z.cy).closePath().setFill(this._pseudoRadialFill(p,{x:z.cx,y:z.cy},k,A+(m+0.5)*u,A+(m+0.5)*u))}H.createPath().moveTo(z.cx,z.cy).lineTo(h,x).arcTo(k,k,0,g>Math.PI,!0,M,y).lineTo(z.cx,z.cy).closePath().setStroke(s.series.stroke);g=H}else g=q.createPath().moveTo(z.cx,z.cy).lineTo(h,x).arcTo(k,k,0,g>Math.PI,!0,M,y).lineTo(z.cx,z.cy).closePath().setStroke(s.series.stroke),(p=s.series.fill)&&"radial"===p.type?
(p=this._shapeFill(p,{x:z.cx-z.r,y:z.cy-z.r,width:2*z.r,height:2*z.r}),"linear"===this.opt.radGrad&&(p=this._pseudoRadialFill(p,{x:z.cx,y:z.cy},k,A,v))):p&&"linear"===p.type&&(p=this._plotFill(p,c,b),p=this._shapeFill(p,g.getBoundingBox())),g.setFill(p);this.dyn.push({fill:p,stroke:s.series.stroke});E&&(d={element:"slice",index:f,run:this.run,shape:g,x:f,y:"number"==typeof d?d:d.y,cx:z.cx,cy:z.cy,cr:k},this._connectEvents(d),G[f]=d);A=v;return!1},this);if(this.opt.labels){var F=f("dojo-bidi")&&this.chart.isRightToLeft();
if("default"==this.opt.labelStyle)A=t,m.some(B,function(a,b){if(0>=a)return!1;var f=J[b];if(1<=a)return this.renderLabel(q,z.cx,z.cy+L/2,y[b],f,0<this.opt.labelOffset),!0;var d=A+2*a*Math.PI;b+1==B.length&&(d=t+2*Math.PI);if(this.opt.omitLabels&&0.0010>d-A)return!1;var e=(A+d)/2,s=z.cx+u*Math.cos(e),e=z.cy+u*Math.sin(e)+L/2;this.renderLabel(q,F?c.width-s:s,e,y[b],f,0<this.opt.labelOffset);A=d;return!1},this);else if("columns"==this.opt.labelStyle){var A=t,K=this.opt.omitLabels,D=[];m.forEach(B,function(a,
c){var b=A+2*a*Math.PI;c+1==B.length&&(b=t+2*Math.PI);var f=(A+b)/2;D.push({angle:f,left:0>Math.cos(f),theme:J[c],index:c,omit:K?0.0010>b-A:!1});A=b});g=d._base._getTextBox("a",{font:M}).h;this._getProperLabelRadius(D,g,1.1*z.r);m.forEach(D,function(a,b){if(!a.omit){var f=z.cx-2*z.r,e=z.cx+2*z.r,s=d._base._getTextBox(y[b],{font:a.theme.series.font}).w,p=z.cx+a.labelR*Math.cos(a.angle),r=z.cy+a.labelR*Math.sin(a.angle),e=a.left?f+s:e-s,f=a.left?f:e,g=q.createPath().moveTo(z.cx+z.r*Math.cos(a.angle),
z.cy+z.r*Math.sin(a.angle));Math.abs(a.labelR*Math.cos(a.angle))<2*z.r-s&&g.lineTo(p,r);g.lineTo(e,r).setStroke(a.theme.series.labelWiring);this.renderLabel(q,F?c.width-s-f:f,r,y[b],a.theme,!1,"left")}},this)}}var N=0;this._eventSeries[this.run.name]=a.map(I,function(a){return 0>=a?null:G[N++]});f("dojo-bidi")&&this._checkOrientation(this.group,c,b);return this},_getProperLabelRadius:function(a,c,b){var f,d,e=1,g=1;if(1==a.length)a[0].labelR=b;else{for(var h=0;h<a.length;h++){var k=Math.abs(Math.sin(a[h].angle));
a[h].left?e>=k&&(e=k,f=a[h]):g>=k&&(g=k,d=a[h])}f.labelR=d.labelR=b;this._calculateLabelR(f,a,c);this._calculateLabelR(d,a,c)}},_calculateLabelR:function(a,c,b){for(var f=a.index,d=c.length,e=a.labelR;!(c[f%d].left^c[(f+1)%d].left);)c[(f+1)%d].omit||(e=(Math.sin(c[f%d].angle)*e+(c[f%d].left?-b:b))/Math.sin(c[(f+1)%d].angle),e=e<a.labelR?a.labelR:e,c[(f+1)%d].labelR=e),f++;f=a.index;for(d=0==f?d-1:f-1;!(c[f].left^c[d].left);)c[d].omit||(e=(Math.sin(c[f].angle)*e+(c[f].left?b:-b))/Math.sin(c[d].angle),
e=e<a.labelR?a.labelR:e,c[d].labelR=e),f--,d--,f=0>f?f+c.length:f,d=0>d?d+c.length:d}})})},"esri/widgets/PopupLegacy/InfoWindowBase":function(){define("../../core/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/dom-construct dijit/registry ../../core/lang ../../geometry/ScreenPoint".split(" "),function(l,m,h,k,g,b,d,e){return l(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var a=m.hitch;this.__set_title=a(this,this.__set_title);this.__err_title=a(this,this.__err_title);
this.__set_content=a(this,this.__set_content);this.__err_content=a(this,this.__err_content)},setMap:function(a){this.map=a},unsetMap:function(a){delete this.map},setTitle:function(){},setContent:function(){},show:function(){this.emit("show")},hide:function(){this.emit("hide")},resize:function(){},place:function(a,c){d.isDefined(a)?m.isObject(a)?g.place(a,c,"only"):c.innerHTML=a:c.innerHTML=""},startupDijits:function(a){this._processDijits(a)},destroyDijits:function(a){this._processDijits(a,!0)},_processDijits:function(a,
c){if(a&&1===a.children.length){var f=a.children[0];if(f){var d=b.byNode(f),f=d?[d]:b.findWidgets(f);h.forEach(f,function(a){if(c){if(a._started&&!a._destroyed)try{a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy()}catch(b){console.debug("An error occurred when destroying a widget embedded within InfoWindow: "+b.message)}}else if(!a._started)try{a.startup()}catch(f){console.debug("An error occurred when starting a widget embedded within InfoWindow: "+f.message)}})}}},__registerMapListeners:function(){this.__unregisterMapListeners();
var a=this.map;this.__handles=[a.on("pan",this.__onMapPan.bind(this)),a.on("zoom-start",this.__onMapZmStart.bind(this)),a.on("extent-change",this.__onMapExtChg.bind(this))]},__unregisterMapListeners:function(){var a=this.__handles;a&&(h.forEach(a,function(a){a.remove()}),this.__handles=null)},__onMapPan:function(a,c){this.move(c,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new e(this.coords));this.hide(null,!0)},__onMapExtChg:function(a,c,b){a=this.map;var d=this.mapCoords;
d?this.show(d,null,!0):(c=b?a.toScreen(this.__mcoords):this.coords.offset(c&&c.x||0,c&&c.y||0),this.show(c,null,!0))},__setValue:function(a,c){this[a].innerHTML="";var b="_dfd"+a,e=this[b];e&&-1===e.fired&&(e.cancel(),this[b]=null);d.isDefined(c)&&(c instanceof k?(this[b]=c,c.then(this["__set"+a],this["__err"+a])):this.__render(a,c))},__set_title:function(a){this._dfd_title=null;this.__render("_title",a)},__err_title:function(a){this._dfd_title=null},__set_content:function(a){this._dfd_content=null;
this.__render("_content",a)},__err_content:function(a){this._dfd_content=null},__render:function(a,c){var b=this[a];this.place(c,b);this.isShowing&&(this.startupDijits(b),"_title"===a&&this._adjustContentArea&&this._adjustContentArea())}})})},"dojox/lang/functional/lambda":function(){define(["../..","dojo/_base/lang","dojo/_base/array"],function(l,m,h){var k=m.getObject("lang.functional",!0,l),g={},b=1<"ab".split(/a*/).length?String.prototype.split:function(a){var c=this.split.call(this,a);(a=a.exec(this))&&
0==a.index&&c.unshift("");return c},d=function(a){var c=[],f=b.call(a,/\s*->\s*/m);if(1<f.length)for(;f.length;)a=f.pop(),c=f.pop().split(/\s*,\s*|\s+/m),f.length&&f.push("(function("+c.join(", ")+"){ return ("+a+"); })");else if(a.match(/\b_\b/))c=["_"];else{var f=a.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),d=a.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(f||d)f&&(c.push("$1"),a="$1"+a),d&&(c.push("$2"),a+="$2");else{var f=a.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,
"").match(/([a-z_$][a-z_$\d]*)/gi)||[],e={};h.forEach(f,function(a){e.hasOwnProperty(a)||(c.push(a),e[a]=1)})}}return{args:c,body:a}},e=function(a){return a.length?function(){var c=a.length-1,b=k.lambda(a[c]).apply(this,arguments);for(--c;0<=c;--c)b=k.lambda(a[c]).call(this,b);return b}:function(a){return a}};m.mixin(k,{rawLambda:function(a){return d(a)},buildLambda:function(a){a=d(a);return"function("+a.args.join(",")+"){return ("+a.body+");}"},lambda:function(a){if("function"==typeof a)return a;
if(a instanceof Array)return e(a);if(g.hasOwnProperty(a))return g[a];var c=d(a);return g[a]=new Function(c.args,"return ("+c.body+");")},clearLambdaCache:function(){g={}}});return k})},"dojox/lang/functional/reversed":function(){define(["dojo/_base/lang","dojo/_base/kernel","./lambda"],function(l,m,h){l.mixin(h,{filterRev:function(k,g,b){"string"==typeof k&&(k=k.split(""));b=b||m.global;g=h.lambda(g);for(var d=[],e,a=k.length-1;0<=a;--a)e=k[a],g.call(b,e,a,k)&&d.push(e);return d},forEachRev:function(k,
g,b){"string"==typeof k&&(k=k.split(""));b=b||m.global;g=h.lambda(g);for(var d=k.length-1;0<=d;g.call(b,k[d],d,k),--d);},mapRev:function(k,g,b){"string"==typeof k&&(k=k.split(""));b=b||m.global;g=h.lambda(g);for(var d=k.length,e=Array(d),d=d-1,a=0;0<=d;e[a++]=g.call(b,k[d],d,k),--d);return e},everyRev:function(k,g,b){"string"==typeof k&&(k=k.split(""));b=b||m.global;g=h.lambda(g);for(var d=k.length-1;0<=d;--d)if(!g.call(b,k[d],d,k))return!1;return!0},someRev:function(k,g,b){"string"==typeof k&&(k=
k.split(""));b=b||m.global;g=h.lambda(g);for(var d=k.length-1;0<=d;--d)if(g.call(b,k[d],d,k))return!0;return!1}});return h})},"dojox/charting/scaler/primitive":function(){define(["dojo/_base/lang"],function(l){var m=l.getObject("dojox.charting.scaler.primitive",!0);return l.mixin(m,{buildScaler:function(h,k,g,b){h==k&&(h-=0.5,k+=0.5);return{bounds:{lower:h,upper:k,from:h,to:k,scale:g/(k-h),span:g},scaler:m}},buildTicks:function(h,k){return{major:[],minor:[],micro:[]}},getTransformerFromModel:function(h){var k=
h.bounds.from,g=h.bounds.scale;return function(b){return(b-k)*g}},getTransformerFromPlot:function(h){var k=h.bounds.from,g=h.bounds.scale;return function(b){return b/g+k}}})})},"dojox/charting/plot2d/Candlesticks":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/functional/reversed dojox/lang/utils dojox/gfx/fx".split(" "),function(l,m,h,k,g,b,d,e,a,c,f){var n=a.lambda("item.purgeGroup()");return m("dojox.charting.plot2d.Candlesticks",
[g,b],{defaultParams:{gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(a,b){this.opt=l.clone(this.defaultParams);c.updateWithObject(this.opt,b);c.updateWithPattern(this.opt,b,this.optionalParams);this.animate=this.opt.animate},collectStats:function(a){for(var c=l.delegate(d.defaultStats),b=0;b<a.length;b++){var f=a[b];if(f.data.length){var e=c.vmin,n=c.vmax;(!("ymin"in f)||!("ymax"in f))&&h.forEach(f.data,
function(a,b){if(null!==a){var f=a.x||b+1;c.hmin=Math.min(c.hmin,f);c.hmax=Math.max(c.hmax,f);c.vmin=Math.min(c.vmin,a.open,a.close,a.high,a.low);c.vmax=Math.max(c.vmax,a.open,a.close,a.high,a.low)}});"ymin"in f&&(c.vmin=Math.min(e,f.ymin));"ymax"in f&&(c.vmax=Math.max(n,f.ymax))}}return c},getSeriesStats:function(){var a=this.collectStats(this.series);a.hmin-=0.5;a.hmax+=0.5;return a},render:function(a,c){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,c);this.resetEvents();this.dirty=
this.isDirty();var b;this.dirty&&(h.forEach(this.series,n),this._eventSeries={},this.cleanGroup(),b=this.getGroup(),e.forEachRev(this.series,function(a){a.cleanGroup(b)}));var f=this.chart.theme,g,C,l=this._hScaler.scaler.getTransformerFromModel(this._hScaler),m=this._vScaler.scaler.getTransformerFromModel(this._vScaler),t=this.events();g=d.calculateBarSize(this._hScaler.bounds.scale,this.opt);C=g.gap;g=g.size;for(var A=this.series.length-1;0<=A;--A){var s=this.series[A];if(!this.dirty&&!s.dirty)f.skip(),
this._reconnectEvents(s.name);else{s.cleanGroup();var B=f.next("candlestick",[this.opt,s]),y=Array(s.data.length);if(s.hidden)s.dyn.fill=B.series.fill,s.dyn.stroke=B.series.stroke;else{b=s.group;for(var u=0;u<s.data.length;++u){var E=s.data[u];if(null!==E){var I=f.addMixin(B,"candlestick",E,!0),z=l(E.x||u+0.5)+c.l+C,H=a.height-c.b,J=m(E.open),G=m(E.close),F=m(E.high),K=m(E.low);if("mid"in E)var D=m(E.mid);if(K>F)var N=F,F=K,K=N;if(1<=g){var N=J>G,w={x1:g/2,x2:g/2,y1:H-F,y2:H-K},O={x:0,y:H-Math.max(J,
G),width:g,height:Math.max(N?J-G:G-J,1)},P=b.createGroup();P.setTransform({dx:z,dy:0});var V=P.createGroup();V.createLine(w).setStroke(I.series.stroke);V.createRect(O).setStroke(I.series.stroke).setFill(N?I.series.fill:"white");"mid"in E&&V.createLine({x1:I.series.stroke.width||1,x2:g-(I.series.stroke.width||1),y1:H-D,y2:H-D}).setStroke(N?"white":I.series.stroke);s.dyn.fill=I.series.fill;s.dyn.stroke=I.series.stroke;t&&(E={element:"candlestick",index:u,run:s,shape:V,x:z,y:H-Math.max(J,G),cx:g/2,cy:H-
Math.max(J,G)+Math.max(N?J-G:G-J,1)/2,width:g,height:Math.max(N?J-G:G-J,1),data:E},this._connectEvents(E),y[u]=E)}this.animate&&this._animateCandlesticks(P,H-K,F-K)}}this._eventSeries[s.name]=y;s.dirty=!1}}}this.dirty=!1;k("dojo-bidi")&&this._checkOrientation(this.group,a,c);return this},tooltipFunc:function(a){return'\x3ctable cellpadding\x3d"1" cellspacing\x3d"0" border\x3d"0" style\x3d"font-size:0.9em;"\x3e\x3ctr\x3e\x3ctd\x3eOpen:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+a.data.open+
'\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3eHigh:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+a.data.high+'\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3eLow:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+a.data.low+'\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3eClose:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+a.data.close+"\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e"+(void 0!==a.data.mid?'\x3ctr\x3e\x3ctd\x3eMid:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+
a.data.mid+"\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e":"")+"\x3c/table\x3e"},_animateCandlesticks:function(a,c,b){f.animateTransform(l.delegate({shape:a,duration:1200,transform:[{name:"translate",start:[0,c-c/b],end:[0,0]},{name:"scale",start:[1,1/b],end:[1,1]},{name:"original"}]},this.animate)).play()}})})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(l,m){var h=l.matrix={},k={};h._degToRad=function(g){return k[g]||(k[g]=Math.PI*g/180)};h._radToDeg=function(g){return 180*
(g/Math.PI)};h.Matrix2D=function(g){if(g)if("number"==typeof g)this.xx=this.yy=g;else if(g instanceof Array){if(0<g.length){for(var b=h.normalize(g[0]),d=1;d<g.length;++d){var e=b,a=h.normalize(g[d]),b=new h.Matrix2D;b.xx=e.xx*a.xx+e.xy*a.yx;b.xy=e.xx*a.xy+e.xy*a.yy;b.yx=e.yx*a.xx+e.yy*a.yx;b.yy=e.yx*a.xy+e.yy*a.yy;b.dx=e.xx*a.dx+e.xy*a.dy+e.dx;b.dy=e.yx*a.dx+e.yy*a.dy+e.dy}m.mixin(this,b)}}else m.mixin(this,g)};m.extend(h.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});m.mixin(h,{identity:new h.Matrix2D,
flipX:new h.Matrix2D({xx:-1}),flipY:new h.Matrix2D({yy:-1}),flipXY:new h.Matrix2D({xx:-1,yy:-1}),translate:function(g,b){return 1<arguments.length?new h.Matrix2D({dx:g,dy:b}):new h.Matrix2D({dx:g.x,dy:g.y})},scale:function(g,b){return 1<arguments.length?new h.Matrix2D({xx:g,yy:b}):"number"==typeof g?new h.Matrix2D({xx:g,yy:g}):new h.Matrix2D({xx:g.x,yy:g.y})},rotate:function(g){var b=Math.cos(g);g=Math.sin(g);return new h.Matrix2D({xx:b,xy:-g,yx:g,yy:b})},rotateg:function(g){return h.rotate(h._degToRad(g))},
skewX:function(g){return new h.Matrix2D({xy:Math.tan(g)})},skewXg:function(g){return h.skewX(h._degToRad(g))},skewY:function(g){return new h.Matrix2D({yx:Math.tan(g)})},skewYg:function(g){return h.skewY(h._degToRad(g))},reflect:function(g,b){1==arguments.length&&(b=g.y,g=g.x);var d=g*g,e=b*b,a=d+e,c=2*g*b/a;return new h.Matrix2D({xx:2*d/a-1,xy:c,yx:c,yy:2*e/a-1})},project:function(g,b){1==arguments.length&&(b=g.y,g=g.x);var d=g*g,e=b*b,a=d+e,c=g*b/a;return new h.Matrix2D({xx:d/a,xy:c,yx:c,yy:e/a})},
normalize:function(g){return g instanceof h.Matrix2D?g:new h.Matrix2D(g)},isIdentity:function(g){return 1==g.xx&&0==g.xy&&0==g.yx&&1==g.yy&&0==g.dx&&0==g.dy},clone:function(g){var b=new h.Matrix2D,d;for(d in g)"number"==typeof g[d]&&("number"==typeof b[d]&&b[d]!=g[d])&&(b[d]=g[d]);return b},invert:function(g){g=h.normalize(g);var b=g.xx*g.yy-g.xy*g.yx;return g=new h.Matrix2D({xx:g.yy/b,xy:-g.xy/b,yx:-g.yx/b,yy:g.xx/b,dx:(g.xy*g.dy-g.yy*g.dx)/b,dy:(g.yx*g.dx-g.xx*g.dy)/b})},_multiplyPoint:function(g,
b,d){return{x:g.xx*b+g.xy*d+g.dx,y:g.yx*b+g.yy*d+g.dy}},multiplyPoint:function(g,b,d){g=h.normalize(g);return"number"==typeof b&&"number"==typeof d?h._multiplyPoint(g,b,d):h._multiplyPoint(g,b.x,b.y)},multiplyRectangle:function(g,b){var d=h.normalize(g);b=b||{x:0,y:0,width:0,height:0};if(h.isIdentity(d))return{x:b.x,y:b.y,width:b.width,height:b.height};var e=h.multiplyPoint(d,b.x,b.y),a=h.multiplyPoint(d,b.x,b.y+b.height),c=h.multiplyPoint(d,b.x+b.width,b.y),f=h.multiplyPoint(d,b.x+b.width,b.y+b.height),
d=Math.min(e.x,a.x,c.x,f.x),n=Math.min(e.y,a.y,c.y,f.y),r=Math.max(e.x,a.x,c.x,f.x),e=Math.max(e.y,a.y,c.y,f.y);return{x:d,y:n,width:r-d,height:e-n}},multiply:function(g){for(var b=h.normalize(g),d=1;d<arguments.length;++d){var e=b,a=h.normalize(arguments[d]),b=new h.Matrix2D;b.xx=e.xx*a.xx+e.xy*a.yx;b.xy=e.xx*a.xy+e.xy*a.yy;b.yx=e.yx*a.xx+e.yy*a.yx;b.yy=e.yx*a.xy+e.yy*a.yy;b.dx=e.xx*a.dx+e.xy*a.dy+e.dx;b.dy=e.yx*a.dx+e.yy*a.dy+e.dy}return b},_sandwich:function(g,b,d){return h.multiply(h.translate(b,
d),g,h.translate(-b,-d))},scaleAt:function(g,b,d,e){switch(arguments.length){case 4:return h._sandwich(h.scale(g,b),d,e);case 3:return"number"==typeof d?h._sandwich(h.scale(g),b,d):h._sandwich(h.scale(g,b),d.x,d.y)}return h._sandwich(h.scale(g),b.x,b.y)},rotateAt:function(g,b,d){return 2<arguments.length?h._sandwich(h.rotate(g),b,d):h._sandwich(h.rotate(g),b.x,b.y)},rotategAt:function(g,b,d){return 2<arguments.length?h._sandwich(h.rotateg(g),b,d):h._sandwich(h.rotateg(g),b.x,b.y)},skewXAt:function(g,
b,d){return 2<arguments.length?h._sandwich(h.skewX(g),b,d):h._sandwich(h.skewX(g),b.x,b.y)},skewXgAt:function(g,b,d){return 2<arguments.length?h._sandwich(h.skewXg(g),b,d):h._sandwich(h.skewXg(g),b.x,b.y)},skewYAt:function(g,b,d){return 2<arguments.length?h._sandwich(h.skewY(g),b,d):h._sandwich(h.skewY(g),b.x,b.y)},skewYgAt:function(g,b,d){return 2<arguments.length?h._sandwich(h.skewYg(g),b,d):h._sandwich(h.skewYg(g),b.x,b.y)}});l.Matrix2D=h.Matrix2D;return h})},"dojox/charting/plot2d/Scatter":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/functional/reversed dojox/lang/utils dojox/gfx/fx dojox/gfx/gradutils".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n){var r=a.lambda("item.purgeGroup()");return h("dojox.charting.plot2d.Scatter",[g,b],{defaultParams:{shadows:null,animate:null},optionalParams:{markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerFont:"",markerFontColor:"",styleFunc:null},constructor:function(a,b){this.opt=l.clone(l.mixin(this.opt,this.defaultParams));c.updateWithObject(this.opt,b);c.updateWithPattern(this.opt,b,this.optionalParams);this.animate=this.opt.animate},render:function(a,
c){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,c);this.resetEvents();this.dirty=this.isDirty();var b;this.dirty&&(m.forEach(this.series,r),this._eventSeries={},this.cleanGroup(),b=this.getGroup(),e.forEachRev(this.series,function(a){a.cleanGroup(b)}));for(var f=this.chart.theme,g=this.events(),h=this.series.length-1;0<=h;--h){var l=this.series[h];if(!this.dirty&&!l.dirty)f.skip(),this._reconnectEvents(l.name);else if(l.cleanGroup(),l.data.length){var t=f.next("marker",[this.opt,l]),
A,s=this._hScaler.scaler.getTransformerFromModel(this._hScaler),B=this._vScaler.scaler.getTransformerFromModel(this._vScaler);if(l.hidden)l.dyn.marker=t.symbol,l.dyn.markerFill=t.marker.fill,l.dyn.markerStroke=t.marker.stroke;else{b=l.group;A="number"==typeof l.data[0]?m.map(l.data,function(b,f){return{x:s(f+1)+c.l,y:a.height-c.b-B(b)}},this):m.map(l.data,function(b,f){return{x:s(b.x)+c.l,y:a.height-c.b-B(b.y)}},this);var y=Array(A.length),u=Array(A.length),E=Array(A.length);m.forEach(A,function(e,
s){var g=l.data[s],r;this.opt.styleFunc||"number"!=typeof g?(r="number"!=typeof g?[g]:[],this.opt.styleFunc&&r.push(this.opt.styleFunc(g)),r=f.addMixin(t,"marker",r,!0)):r=f.post(t,"marker");var h="M"+e.x+" "+e.y+" "+r.symbol;r.marker.shadow&&(y[s]=b.createPath("M"+(e.x+r.marker.shadow.dx)+" "+(e.y+r.marker.shadow.dy)+" "+r.symbol).setStroke(r.marker.shadow).setFill(r.marker.shadow.color),this.animate&&this._animateScatter(y[s],a.height-c.b));if(r.marker.outline){var B=d.makeStroke(r.marker.outline);
B.width=2*B.width+r.marker.stroke.width;E[s]=b.createPath(h).setStroke(B);this.animate&&this._animateScatter(E[s],a.height-c.b)}var B=d.makeStroke(r.marker.stroke),k=this._plotFill(r.marker.fill,a,c);if(k&&("linear"===k.type||"radial"==k.type))k=n.getColor(k,{x:e.x,y:e.y}),B&&(B.color=k);u[s]=b.createPath(h).setStroke(B).setFill(k);this.opt.labels&&(h=u[s].getBoundingBox(),this.createLabel(b,g,h,r));this.animate&&this._animateScatter(u[s],a.height-c.b)},this);u.length&&(l.dyn.marker=t.symbol,l.dyn.markerStroke=
u[u.length-1].getStroke(),l.dyn.markerFill=u[u.length-1].getFill());if(g){var I=Array(u.length);m.forEach(u,function(a,c){var b={element:"marker",index:c,run:l,shape:a,outline:E&&E[c]||null,shadow:y&&y[c]||null,cx:A[c].x,cy:A[c].y};"number"==typeof l.data[0]?(b.x=c+1,b.y=l.data[c]):(b.x=l.data[c].x,b.y=l.data[c].y);this._connectEvents(b);I[c]=b},this);this._eventSeries[l.name]=I}else delete this._eventSeries[l.name];l.dirty=!1}}else l.dirty=!1,f.skip()}this.dirty=!1;k("dojo-bidi")&&this._checkOrientation(this.group,
a,c);return this},_animateScatter:function(a,c){f.animateTransform(l.delegate({shape:a,duration:1200,transform:[{name:"translate",start:[0,c],end:[0,0]},{name:"scale",start:[0,0],end:[1,1]},{name:"original"}]},this.animate)).play()}})})},"dojox/lang/functional/scan":function(){define(["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(l,m,h){var k={};m.mixin(h,{scanl:function(g,b,d,e){"string"==typeof g&&(g=g.split(""));e=e||l.global;b=h.lambda(b);var a,c,f;if(m.isArray(g)){a=Array((c=g.length)+
1);a[0]=d;for(f=0;f<c;d=b.call(e,d,g[f],f,g),a[++f]=d);}else if("function"==typeof g.hasNext&&"function"==typeof g.next){a=[d];for(f=0;g.hasNext();a.push(d=b.call(e,d,g.next(),f++,g)));}else for(f in a=[d],g)f in k||a.push(d=b.call(e,d,g[f],f,g));return a},scanl1:function(g,b,d){"string"==typeof g&&(g=g.split(""));d=d||l.global;b=h.lambda(b);var e,a,c;a=!0;if(m.isArray(g)){e=Array(a=g.length);e[0]=c=g[0];for(var f=1;f<a;e[f]=c=b.call(d,c,g[f],f,g),++f);}else if("function"==typeof g.hasNext&&"function"==
typeof g.next){if(g.hasNext()){e=[c=g.next()];for(f=1;g.hasNext();e.push(c=b.call(d,c,g.next(),f++,g)));}}else for(f in g)f in k||(a?(e=[c=g[f]],a=!1):e.push(c=b.call(d,c,g[f],f,g)));return e},scanr:function(g,b,d,e){"string"==typeof g&&(g=g.split(""));e=e||l.global;b=h.lambda(b);var a=g.length,c=Array(a+1),f=a;for(c[a]=d;0<f;--f,d=b.call(e,d,g[f],f,g),c[f]=d);return c},scanr1:function(g,b,d){"string"==typeof g&&(g=g.split(""));d=d||l.global;b=h.lambda(b);var e=g.length,a=Array(e),c=g[e-1],e=e-1;
for(a[e]=c;0<e;--e,c=b.call(d,c,g[e],e,g),a[e]=c);return a}})})},"dojox/charting/plot2d/OHLC":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/functional/reversed dojox/lang/utils dojox/gfx/fx".split(" "),function(l,m,h,k,g,b,d,e,a,c,f){var n=a.lambda("item.purgeGroup()");return h("dojox.charting.plot2d.OHLC",[g,b],{defaultParams:{gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},
outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(a,b){this.opt=l.clone(this.defaultParams);c.updateWithObject(this.opt,b);c.updateWithPattern(this.opt,b,this.optionalParams);this.animate=this.opt.animate},collectStats:function(a){for(var c=l.delegate(d.defaultStats),b=0;b<a.length;b++){var f=a[b];if(f.data.length){var e=c.vmin,n=c.vmax;(!("ymin"in f)||!("ymax"in f))&&m.forEach(f.data,function(a,b){if(null!==a){var f=a.x||b+1;c.hmin=Math.min(c.hmin,f);c.hmax=Math.max(c.hmax,
f);c.vmin=Math.min(c.vmin,a.open,a.close,a.high,a.low);c.vmax=Math.max(c.vmax,a.open,a.close,a.high,a.low)}});"ymin"in f&&(c.vmin=Math.min(e,f.ymin));"ymax"in f&&(c.vmax=Math.max(n,f.ymax))}}return c},getSeriesStats:function(){var a=this.collectStats(this.series);a.hmin-=0.5;a.hmax+=0.5;return a},render:function(a,c){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,c);this.resetEvents();if(this.dirty=this.isDirty()){m.forEach(this.series,n);this._eventSeries={};this.cleanGroup();var b=
this.getGroup();e.forEachRev(this.series,function(a){a.cleanGroup(b)})}var f=this.chart.theme,g,h,l=this._hScaler.scaler.getTransformerFromModel(this._hScaler),L=this._vScaler.scaler.getTransformerFromModel(this._vScaler),t=this.events();g=d.calculateBarSize(this._hScaler.bounds.scale,this.opt);h=g.gap;g=g.size;for(var A=this.series.length-1;0<=A;--A){var s=this.series[A];if(!this.dirty&&!s.dirty)f.skip(),this._reconnectEvents(s.name);else{s.cleanGroup();for(var B=f.next("candlestick",[this.opt,s]),
b=s.group,y=Array(s.data.length),u=0;u<s.data.length;++u){var E=s.data[u];if(null!==E){var I=f.addMixin(B,"candlestick",E,!0),z=l(E.x||u+0.5)+c.l+h,H=a.height-c.b,J=L(E.open),G=L(E.close),F=L(E.high),K=L(E.low);if(K>F)var D=F,F=K,K=D;if(1<=g){var D={x1:g/2,x2:g/2,y1:H-F,y2:H-K},N={x1:0,x2:g/2+(I.series.stroke.width||1)/2,y1:H-J,y2:H-J},w={x1:g/2-(I.series.stroke.width||1)/2,x2:g,y1:H-G,y2:H-G},O=b.createGroup();O.setTransform({dx:z,dy:0});var P=O.createGroup();P.createLine(D).setStroke(I.series.stroke);
P.createLine(N).setStroke(I.series.stroke);P.createLine(w).setStroke(I.series.stroke);s.dyn.stroke=I.series.stroke;t&&(E={element:"candlestick",index:u,run:s,shape:P,x:z,y:H-Math.max(J,G),cx:g/2,cy:H-Math.max(J,G)+Math.max(J>G?J-G:G-J,1)/2,width:g,height:Math.max(J>G?J-G:G-J,1),data:E},this._connectEvents(E),y[u]=E)}this.animate&&this._animateOHLC(O,H-K,F-K)}}this._eventSeries[s.name]=y;s.dirty=!1}}this.dirty=!1;k("dojo-bidi")&&this._checkOrientation(this.group,a,c);return this},_animateOHLC:function(a,
c,b){f.animateTransform(l.delegate({shape:a,duration:1200,transform:[{name:"translate",start:[0,c-c/b],end:[0,0]},{name:"scale",start:[1,1/b],end:[1,1]},{name:"original"}]},this.animate)).play()}})})},"webSceneViewer/widgets/MessageListWidget/MessageListWidget":function(){define(["esri/core/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/MessageListWidget.html","./MessageWidget"],function(l,m,h,k,g){return new (l([m,h],{declaredClass:"MessageListWidget",templateString:k,
MessageTypes:{INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error"},direction:"b2t",constructor:function(b){},postCreate:function(){},show:function(b){"string"===typeof b&&(b={message:b});b=new g(b);"t2b"===this.direction?b.placeAt(this.MessageListContentNode,0):b.placeAt(this.MessageListContentNode)}}))})},"webSceneViewer/environmentUtils":function(){define(["esri/views/3d/SceneViewEnvironment","esri/core/watchUtils","./spatialReferenceUtils"],function(l,m,h){function k(b,d){b.lighting&&
null!=b.lighting.displayUTCOffset&&(d.lighting||(d.lighting={}),d.lighting.displayUTCOffset=b.lighting.displayUTCOffset);return d}var g={fromJSON:function(b){return k(b,l.fromJSON(b))},toJSON:function(b){return k(b,b.toJSON())},clone:function(b){return k(b,b.clone())},applyToView:function(b,d){if(b&&b.lighting){var e=b.lighting,a=d.environment.lighting;null!=e.date&&(a.date=e.date);null!=e.displayUTCOffset&&(a.displayUTCOffset=e.displayUTCOffset);a.directShadows=e.directShadows;a.ambientOcclusion=
e.ambientOcclusion}},adjustLightDateForLatitude:function(b,d){h.getLatitudeOfPoint(d).then(function(d){var a=b.date.getMonth(),c;66<d&&(4>a||6<a)?c=5:-66>d&&(10>a&&0<a)&&(c=11);c&&(d=new Date(b.date),d.setMonth(c),b.date=d)})},adjustLightForLayer:function(b,d){d.then(function(){var e=d.fullExtent;e&&m.whenTrueOnce(b.environment.lighting,"ready",function(){g.adjustLightDateForLatitude(b.environment.lighting,e.center)})})}};return g})},"esri/widgets/PopupLegacy":function(){define("../core/declare dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/has dojo/on dojo/window dojo/Stateful dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../core/lang ../core/domUtils ../geometry/Polyline ../geometry/Polygon ./PopupLegacy/InfoWindowBase ./PopupLegacy/PopupBase dojo/i18n!./PopupLegacy/nls/PopupLegacy dojo/NodeList-dom require require".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n,r,q,p,v,x,C,M,L,t,A){return l([L,t,e],{declaredClass:"esri.widgets.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(d,e){this.initialize();m.mixin(this,d);this.domNode=a.byId(e);var n=this._nls=m.mixin({},A.widgets.popup),p=this.domNode;f.add(p,"esri-popup");(this._isRTL=
!r.isBodyLtr())&&q.set(p,"direction","rtl");c.set(p,"innerHTML","\x3cdiv class\x3d'esri-popup-wrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'title-pane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+n.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'title-button prev hidden' title\x3d'"+n.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'title-button next hidden' title\x3d'"+n.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'title-button maximize' title\x3d'"+
n.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'title-button close' title\x3d'"+n.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'content-pane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actions-pane'\x3e\x3cdiv class\x3d'action-list hidden'\x3e\x3ca title\x3d"+n.NLS_zoomTo+" class\x3d'action zoom-to' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+n.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outer-pointer hidden'\x3e\x3c/div\x3e");
this._sizers=k.query(".sizer",p);n=k.query(".title-pane",p)[0];a.setSelectable(n,!1);this._title=k.query(".title",n)[0];this._prevFeatureButton=k.query(".prev",n)[0];this._nextFeatureButton=k.query(".next",n)[0];this._maxButton=k.query(".maximize",n)[0];this._spinner=k.query(".spinner",n)[0];this._contentPane=k.query(".content-pane",p)[0];this._positioner=k.query(".esri-popup-wrapper",p)[0];this._pointer=k.query(".pointer",p)[0];this._outerPointer=k.query(".outer-pointer",p)[0];this._actionList=k.query(".actions-pane .action-list",
p)[0];this._eventConnections=[b(k.query(".close",n)[0],"click",this.hide.bind(this)),b(this._prevFeatureButton,"click",this.selectPrevious.bind(this)),b(this._nextFeatureButton,"click",this.selectNext.bind(this)),b(this._maxButton,"click",this._toggleSize.bind(this)),b(k.query(".zoom-to",this._actionList)[0],"click",this._zoomToFeature.bind(this)),this.on("clear-features",this._featuresCleared.bind(this)),this.on("selection-change",this._featureSelected.bind(this)),this.on("dfd-complete",this._updateUI.bind(this))];
g("esri-touch")&&(p=x.setScrollable(this._contentPane),this._eventConnections.push(p[0],p[1]));this._toggleVisibility(!1)},getTitle:function(a){return this._readTemplate(a,"title",!0)},getContent:function(a){return this._readTemplate(a,"content",!0)},_readTemplate:function(a,c,b){var f=a.getEffectivePopupTemplate();c=f&&f[c];var d=typeof c;"function"===d?c=c.call(f,a):"string"===d&&(d=(f=a.layer)&&f._getDateOpts,c=v.substitute(a.attributes,c,{first:b,dateFormat:d&&d.call(f)}));return c},setMap:function(a){this.inherited(arguments);
n.place(this.domNode,this.view.root);this.highlight&&this.enableHighlight(a);this._maxHeight=q.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a){if(this.popupWindow){if(!v.isDefined(a)||""===a)a="\x26nbsp;";this.destroyDijits(this._title);this.place(a,this._title);this.isShowing&&(this.startupDijits(this._title),this.reposition())}},setContent:function(a){if(this.popupWindow){if(!v.isDefined(a)||""===a)a="\x26nbsp;";
this.destroyDijits(this._contentPane);this.place(a,this._contentPane);this.isShowing&&(this.startupDijits(this._contentPane),this.reposition())}},show:function(a,c){if(this.popupWindow)if(this._delayHide=!1,a){var b=this.map,f=this.view||b.view;a.spatialReference?(this.location=a,b=f.toScreen(a)):(this.location=f.toMap(a),b=a);var d=f._getFrameWidth?f._getFrameWidth():-1;if(-1!==d&&(b.x%=d,0>b.x&&(b.x+=d),f.width>d))for(f=(f.width-d)/2;b.x<f;)b.x+=d;this._maximized?this.restore():this._setPosition(b);
c&&c.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this.startupDijits(this._contentPane),this.reposition(),this.showHighlight(),this.inherited(arguments))}else this._toggleVisibility(!0)},hide:function(){this.isShowing&&(this._toggleVisibility(!1),this._unfollowMap(),this.keepHighlightOnHide||this.hideHighlight(),this.inherited(arguments))},resize:function(a,c){this.popupWindow&&(this._sizers.style({width:a+
"px"}),q.set(this._contentPane,"maxHeight",c+"px"),this._maxHeight=c,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.view&&(this.location&&!this._maximized&&this.isShowing)&&this._setPosition(this.view.toScreen(this.location))},maximize:function(){var a=this.view;if(a&&!this._maximized&&this.popupWindow){this._maximized=!0;var b=this._maxButton;f.remove(b,"maximize");f.add(b,"restore");c.set(b,"title",this._nls.NLS_restore);var b=this.marginLeft,d=this.marginTop,e=
a.width-2*b,a=a.height-2*d;q.set(this.domNode,{left:this._isRTL?null:b+"px",right:this._isRTL?b+"px":null,top:d+"px",bottom:null});q.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=q.get(this._sizers[0],"width");this._savedHeight=q.get(this._contentPane,"maxHeight");this._sizers.style({width:e+"px"});q.set(this._contentPane,{maxHeight:a-65+"px",height:a-65+"px"});this._showPointer("");this._unfollowMap();f.add(this.domNode,"esri-popup-maximized");this.emit("maximize")}},
restore:function(){if(this.view&&this._maximized&&this.popupWindow){this._maximized=!1;var a=this._maxButton;f.remove(a,"restore");f.add(a,"maximize");c.set(a,"title",this._nls.NLS_maximize);q.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();f.remove(this.domNode,"esri-popup-maximized");this.emit("restore")}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();
this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._content);h.forEach(this._eventConnections,function(a){a.remove()});n.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-
1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},postscript:null,_highlightSetter:function(a){var c=this.highlight,b=this.map;this.highlight=a;if(b&&a!==c)if(a){if(this.enableHighlight(b),a=this.features&&this.features[this.selectedIndex])this.updateHighlight(b,a),this.showHighlight()}else this.disableHighlight(b)},_pagingControlsSetter:function(a){var c=this.pagingControls,b=this.map;this.pagingControls=a;b&&a!==c&&this._updatePagingControls()},_pagingInfoSetter:function(a){var c=
this.pagingInfo,b=this.map;this.pagingInfo=a;b&&(a!==c&&this.features&&this.features.length)&&this._updatePagingInfo()},_popupWindowSetter:function(a){var c=this.popupWindow,b=this.map;this.popupWindow=a;b&&a!==c&&(a?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(a){var c=this.anchor;this.anchor=a;this.map&&a!==c&&this.reposition()},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);
this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var a=this.selectedIndex;if(0<=a){var c=this.getContent(this.features[a]),b;!this.titleInBody&&c&&m.isString(c.id)&&(b=p.byId(c.id))&&(b.set&&/_PopupRenderer/.test(b.declaredClass))&&b.set("showTitle",!1);this.setContent(c);this.updateHighlight(this.map,this.features[a]);this.showHighlight()}},_toggleVisibility:function(a){this._setVisibility(a);this.isShowing=a},_setVisibility:function(a){q.set(this.domNode,
"visibility",a?"visible":"hidden");f.toggle(this.domNode,"esri-popup-visible",a)},_waitAndHide:function(a){var c=this;this._delayHide=!0;setTimeout(function(){c._delayHide&&(c._delayHide=!1,c.hide())},a)},_followMap:function(){this._unfollowMap();this._handles=[this.view.watch("viewpoint",this._viewChangeHandler.bind(this))]},_unfollowMap:function(){var a=this._handles;a&&(h.forEach(a,function(a){a.remove()}),this._handles=null)},_viewChangeHandler:function(a){this.show(this._targetLocation||this.location)},
_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,c){var b=this._panOrigin,f=c.x,d=c.y,e=b.left,n=b.top,p=b.right,b=b.bottom;e&&(e=parseFloat(e)+f+"px");n&&(n=parseFloat(n)+d+"px");p&&(p=parseFloat(p)-f+"px");b&&(b=parseFloat(b)-d+"px");q.set(this.domNode,{left:e,top:n,right:p,bottom:b})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(a,c,b){b&&(this._setVisibility(!0),this.show(this._targetLocation||
this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_setPosition:function(a){var c=a.x,b=a.y;a=this.offsetX||0;var f=this.offsetY||0,e=0,n=0,p=r.position(this.view.surface,!0),g=p.w,h=p.h,v="left",k="bottom",x=r.getContentBox(this._positioner),l=x.w/2,C=x.h/2,t=q.get(this._sizers[0],"height")+this._maxHeight+q.get(this._sizers[2],"height"),M=t/2,m=0,A=0,L=c,T=b,R=this.anchor.toLowerCase();if("auto"===R){if(R=d.getBox)R=R(),m=Math.max(R.l,
p.x),g=Math.min(R.l+R.w,p.x+p.w),A=Math.max(R.t,p.y),h=Math.min(R.t+R.h,p.y+p.h),L+=p.x,T+=p.y;p=T-A>=t;t=h-T>=t;R=g-L>=x.w;x=L-m>=x.w;T-A>M&&h-T>=M&&(R?(k="",v="left"):x&&(k="",v="right"));v&&k&&(L-m>l&&g-L>=l)&&(p?(v="",k="bottom"):t&&(v="",k="top"));v&&k&&(R&&p?(v="left",k="bottom"):R&&t?(v="left",k="top"):x&&t?(v="right",k="top"):x&&p&&(v="right",k="bottom"))}else k=v="",-1!==R.indexOf("top")?k="bottom":-1!==R.indexOf("bottom")&&(k="top"),-1!==R.indexOf("left")?v="right":-1!==R.indexOf("right")&&
(v="left");M=k&&v?k+"-"+v:k||v;switch(M){case "top":case "bottom":n=14;break;case "left":case "right":e=13;break;case "top-left":case "top-right":case "bottom-left":case "bottom-right":n=14,e=-16}q.set(this.domNode,{left:c+"px",top:b+"px",right:null,bottom:null});c={left:null,right:null,top:null,bottom:null};v?c[v]=e+a+"px":c.left=-l+"px";k?c[k]=n+f+"px":c.top=-C+"px";q.set(this._positioner,c);this._showPointer(M)},_showPointer:function(a){f.remove(this._pointer,"top bottom right left top-left top-right bottom-right bottom-left hidden".split(" "));
f.remove(this._outerPointer,["right","left","hidden"]);"right"===a||"left"===a?f.add(this._outerPointer,a):f.add(this._pointer,a)},_setPagerCallbacks:function(a,c,f){if(this.pagingControls&&!(a===this&&(!this._pagerScope||this._pagerScope===this))&&a!==this._pagerScope){this._pagerScope=a;a===this&&(c=this.selectPrevious,f=this.selectNext);var d=this._eventConnections;d[1].remove();d[2].remove();c&&(d[1]=b(this._prevFeatureButton,"click",c.bind(a)));f&&(d[2]=b(this._nextFeatureButton,"click",f.bind(a)))}},
_getLocation:function(a){var c=this.view.map,b,f,d=0,e;if(a=a&&a.geometry)switch(a.type){case "point":b=a;break;case "multipoint":b=a.getPoint(0);f=a.getExtent();break;case "polyline":b=a.getPoint(0,0);f=a.getExtent();h.forEach(a.paths,function(a){a=(new C({paths:[a,c.spatialReference]})).getExtent();var b=Math.abs(a.ymax-a.ymin),f=Math.abs(a.xmax-a.xmin),b=f>b?f:b;b>d&&(d=b,e=a)});e.spatialReference=f.spatialReference;f=e;break;case "polygon":b=a.getPoint(0,0),f=a.getExtent(),h.forEach(a.rings,function(a){a=
(new M({rings:[a,c.spatialReference]})).getExtent();var b=Math.abs(a.ymax-a.ymin),f=Math.abs(a.xmax-a.xmin),b=f>b?f:b;b>d&&(d=b,e=a)}),e.spatialReference=f.spatialReference,f=e}return[b,f]},_zoomToFeature:function(a){a.preventDefault();var c=this.features,b=this.selectedIndex;a=this.view;var f=this.zoomFactor||4;if(c){var c=this._getLocation(c[b]),d=c[0],c=c[1];d||(d=this.location);if(!c||!c.intersects(this.location))this.location=d;a&&(c&&d?a.animateTo({target:c}).then(function(){this.show(d)}.bind(this)):
d&&a.animateTo({target:d,scale:a.scale/f}).then(function(){this.show(d)}.bind(this)))}},_updatePagingControls:function(){var a=this._prevFeatureButton,c=this._nextFeatureButton,b=this.selectedIndex,d=this.features?this.features.length:0;this.pagingControls&&1<d?(0===b?f.add(a,"hidden"):f.remove(a,"hidden"),b===d-1?f.add(c,"hidden"):f.remove(c,"hidden")):(f.add(a,"hidden"),f.add(c,"hidden"))},_updatePagingInfo:function(){var a=this.features?this.features.length:0,c=this._nls,b="\x26nbsp;";this.pagingInfo&&
(1<a&&c.NLS_pagingInfo)&&(b=v.substitute({index:this.selectedIndex+1,total:a},c.NLS_pagingInfo));if(a&&(c=this.getSelectedFeature(),a=c.getEffectivePopupTemplate(),c=this.getTitle(c),(!a||/esri\.InfoTemplate/.test(a.declaredClass)||!this.titleInBody)&&c))b=c+("\x26nbsp;"===b?"":" "+b);this.setTitle(b)},_updateUI:function(){if(this.popupWindow){var a=this.features,c=this.promises,b=a?a.length:0,d=this._spinner,e=this._actionList,n=this._nls;this._updatePagingControls();this._updatePagingInfo();b?f.remove(e,
"hidden"):f.add(e,"hidden");c&&c.length?a?f.remove(d,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+n.NLS_searching+"...\x3c/div\x3e"):(f.add(d,"hidden"),b||(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+n.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay)))}}})})},"dojox/charting/plot2d/ClusteredColumns":function(){define(["dojo/_base/declare","dojo/_base/array","./Columns","./common"],function(l,m,h,k){return l("dojox.charting.plot2d.ClusteredColumns",
h,{getBarProperties:function(){var g=this.series.length;m.forEach(this.series,function(b){b.hidden&&g--});var b=k.calculateBarSize(this._hScaler.bounds.scale,this.opt,g);return{gap:b.gap,width:b.size,thickness:b.size,clusterSize:g}}})})},"dojox/charting/Chart":function(){define("../main dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/dom-style dojo/dom dojo/dom-geometry dojo/dom-construct dojo/_base/Color dojo/sniff ./Element ./SimpleTheme ./Series ./axis2d/common dojox/gfx/shape dojox/gfx dojo/has!dojo-bidi?./bidi/Chart dojox/lang/functional dojox/lang/functional/fold dojox/lang/functional/reversed".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n,r,q,p,v,x,C){function M(a,c){a&&c&&(a.min=Math.min(a.min,c.min),a.max=Math.max(a.max,c.max));return a||c}function L(a,c){var b={},f={};h.forEach(a,function(a){var c=b[a.name]=a.getSeriesStats();a.hAxis&&(f[a.hAxis]=M(f[a.hAxis],{min:c.hmin,max:c.hmax}));a.vAxis&&(f[a.vAxis]=M(f[a.vAxis],{min:c.vmin,max:c.vmax}))});h.forEach(a,function(a){var d=b[a.name];if(a.hAxis){var e=f[a.hAxis];d.hmin=e.min;d.hmax=e.max}a.vAxis&&(e=f[a.vAxis],d.vmin=e.min,d.vmax=e.max);a.initializeScalers(c,
d)})}var t=m.getObject("charting",!0,l),A=C.lambda("item.clear()"),s=C.lambda("item.purgeGroup()"),B=C.lambda("item.destroy()"),y=C.lambda("item.dirty \x3d false"),u=C.lambda("item.dirty \x3d true"),E=C.lambda("item.name");l=k(c("dojo-bidi")?"dojox.charting.NonBidiChart":"dojox.charting.Chart",null,{constructor:function(a,c){c||(c={});this.margins=c.margins?c.margins:{l:10,t:10,r:10,b:10};this.stroke=c.stroke;this.fill=c.fill;this.delayInMs=c.delayInMs||200;this.title=c.title;this.titleGap=c.titleGap;
this.titlePos=c.titlePos;this.titleFont=c.titleFont;this.titleFontColor=c.titleFontColor;this.chartTitle=null;this.htmlLabels=!0;"htmlLabels"in c&&(this.htmlLabels=c.htmlLabels);this.theme=null;this.axes={};this.stack=[];this.plots={};this.series=[];this.runs={};this.dirty=!0;this.node=b.byId(a);var f=d.getMarginBox(a);this.surface=v.createSurface(this.node,f.w||400,f.h||300);-1==this.surface.declaredClass.indexOf("vml")&&(this._nativeClip=!0)},destroy:function(){h.forEach(this.series,B);h.forEach(this.stack,
B);C.forIn(this.axes,B);this.surface.destroy();this.chartTitle&&this.chartTitle.tagName&&e.destroy(this.chartTitle)},getCoords:function(){var a=this.node,c=g.getComputedStyle(a),c=d.getMarginBox(a,c),a=d.position(a,!0);c.x=a.x;c.y=a.y;return c},setTheme:function(a){this.theme=a.clone();this.dirty=!0;return this},addAxis:function(a,c){var b;b=c&&c.type||"Default";if("string"==typeof b){if(!t.axis2d||!t.axis2d[b])throw Error("Can't find axis: "+b+" - Check require() dependencies.");b=new t.axis2d[b](this,
c)}else b=new b(this,c);b.name=a;b.dirty=!0;a in this.axes&&this.axes[a].destroy();this.axes[a]=b;this.dirty=!0;return this},getAxis:function(a){return this.axes[a]},removeAxis:function(a){a in this.axes&&(this.axes[a].destroy(),delete this.axes[a],this.dirty=!0);return this},addPlot:function(a,c){var b;b=c&&c.type||"Default";if("string"==typeof b){if(!t.plot2d||!t.plot2d[b])throw Error("Can't find plot: "+b+" - didn't you forget to dojo.require() it?");b=new t.plot2d[b](this,c)}else b=new b(this,
c);b.name=a;b.dirty=!0;a in this.plots?(this.stack[this.plots[a]].destroy(),this.stack[this.plots[a]]=b):(this.plots[a]=this.stack.length,this.stack.push(b));this.dirty=!0;return this},getPlot:function(a){return this.stack[this.plots[a]]},removePlot:function(a){if(a in this.plots){var c=this.plots[a];delete this.plots[a];this.stack[c].destroy();this.stack.splice(c,1);C.forIn(this.plots,function(a,b,f){a>c&&(f[b]=a-1)});var b=h.filter(this.series,function(c){return c.plot!=a});b.length<this.series.length&&
(h.forEach(this.series,function(c){c.plot==a&&c.destroy()}),this.runs={},h.forEach(b,function(a,c){this.runs[a.plot]=c},this),this.series=b);this.dirty=!0}return this},getPlotOrder:function(){return C.map(this.stack,E)},setPlotOrder:function(a){var c={},b=C.filter(a,function(a){if(!(a in this.plots)||a in c)return!1;c[a]=1;return!0},this);b.length<this.stack.length&&C.forEach(this.stack,function(a){a=a.name;a in c||b.push(a)});a=C.map(b,function(a){return this.stack[this.plots[a]]},this);C.forEach(a,
function(a,c){this.plots[a.name]=c},this);this.stack=a;this.dirty=!0;return this},movePlotToFront:function(a){if(a in this.plots){var c=this.plots[a];if(c){var b=this.getPlotOrder();b.splice(c,1);b.unshift(a);return this.setPlotOrder(b)}}return this},movePlotToBack:function(a){if(a in this.plots){var c=this.plots[a];if(c<this.stack.length-1){var b=this.getPlotOrder();b.splice(c,1);b.push(a);return this.setPlotOrder(b)}}return this},addSeries:function(a,c,b){c=new r(this,c,b);c.name=a;a in this.runs?
(this.series[this.runs[a]].destroy(),this.series[this.runs[a]]=c):(this.runs[a]=this.series.length,this.series.push(c));this.dirty=!0;!("ymin"in c)&&"min"in c&&(c.ymin=c.min);!("ymax"in c)&&"max"in c&&(c.ymax=c.max);return this},getSeries:function(a){return this.series[this.runs[a]]},removeSeries:function(a){if(a in this.runs){var c=this.runs[a];delete this.runs[a];this.series[c].destroy();this.series.splice(c,1);C.forIn(this.runs,function(a,b,f){a>c&&(f[b]=a-1)});this.dirty=!0}return this},updateSeries:function(a,
c,b){a in this.runs&&(a=this.series[this.runs[a]],a.update(c),b?this.dirty=!0:(this._invalidateDependentPlots(a.plot,!1),this._invalidateDependentPlots(a.plot,!0)));return this},getSeriesOrder:function(a){return C.map(C.filter(this.series,function(c){return c.plot==a}),E)},setSeriesOrder:function(a){var c,b={},f=C.filter(a,function(a){if(!(a in this.runs)||a in b)return!1;var f=this.series[this.runs[a]];if(c){if(f.plot!=c)return!1}else c=f.plot;b[a]=1;return!0},this);C.forEach(this.series,function(a){var d=
a.name;!(d in b)&&a.plot==c&&f.push(d)});this.series=C.map(f,function(a){return this.series[this.runs[a]]},this).concat(C.filter(this.series,function(a){return a.plot!=c}));C.forEach(this.series,function(a,c){this.runs[a.name]=c},this);this.dirty=!0;return this},moveSeriesToFront:function(a){if(a in this.runs){var c=this.runs[a],b=this.getSeriesOrder(this.series[c].plot);if(a!=b[0])return b.splice(c,1),b.unshift(a),this.setSeriesOrder(b)}return this},moveSeriesToBack:function(a){if(a in this.runs){var c=
this.runs[a],b=this.getSeriesOrder(this.series[c].plot);if(a!=b[b.length-1])return b.splice(c,1),b.push(a),this.setSeriesOrder(b)}return this},resize:function(a,c){switch(arguments.length){case 1:d.setMarginBox(this.node,a);break;case 2:d.setMarginBox(this.node,{w:a,h:c})}var b=d.getMarginBox(this.node),f=this.surface.getDimensions();return f.width!=b.w||f.height!=b.h?(this.surface.setDimensions(b.w,b.h),this.dirty=!0,this.render()):this},getGeometry:function(){var a={};C.forIn(this.axes,function(c){c.initialized()&&
(a[c.name]={name:c.name,vertical:c.vertical,scaler:c.scaler,ticks:c.ticks})});return a},setAxisWindow:function(a,c,b,f){var d=this.axes[a];d&&(d.setWindow(c,b),h.forEach(this.stack,function(c){if(c.hAxis==a||c.vAxis==a)c.zoom=f}));return this},setWindow:function(a,c,b,f,d){"plotArea"in this||this.calculateGeometry();C.forIn(this.axes,function(d){var e,n;e=d.getScaler().bounds;n=e.span/(e.upper-e.lower);d.vertical?(e=c,n=f/n/e):(e=a,n=b/n/e);d.setWindow(e,n)});h.forEach(this.stack,function(a){a.zoom=
d});return this},zoomIn:function(a,c,b){var f=this.axes[a];if(f){var f=f.getScaler().bounds,d=Math.min(c[0],c[1]),e=Math.max(c[0],c[1]),d=c[0]<f.lower?f.lower:d,e=c[1]>f.upper?f.upper:e;this.setAxisWindow(a,(f.upper-f.lower)/(e-d),d-f.lower);b?this.delayedRender():this.render()}},calculateGeometry:function(){if(this.dirty)return this.fullGeometry();var a=h.filter(this.stack,function(a){return a.dirty||a.hAxis&&this.axes[a.hAxis].dirty||a.vAxis&&this.axes[a.vAxis].dirty},this);L(a,this.plotArea);return this},
fullGeometry:function(){this._makeDirty();h.forEach(this.stack,A);this.theme||this.setTheme(new n);h.forEach(this.series,function(a){if(!(a.plot in this.plots)){if(!t.plot2d||!t.plot2d.Default)throw Error("Can't find plot: Default - didn't you forget to dojo.require() it?");var c=new t.plot2d.Default(this,{});c.name=a.plot;this.plots[a.plot]=this.stack.length;this.stack.push(c)}this.stack[this.plots[a.plot]].addSeries(a)},this);h.forEach(this.stack,function(a){a.assignAxes&&a.assignAxes(this.axes)},
this);var a=this.dim=this.surface.getDimensions();a.width=v.normalizedLength(a.width);a.height=v.normalizedLength(a.height);C.forIn(this.axes,A);L(this.stack,a);var b=this.offsets={l:0,r:0,t:0,b:0},f=this;C.forIn(this.axes,function(a){c("dojo-bidi")&&f._resetLeftBottom(a);C.forIn(a.getOffsets(),function(a,c){b[c]=Math.max(a,b[c])})});if(this.title){this.titleGap=0==this.titleGap?0:this.titleGap||this.theme.chart.titleGap||20;this.titlePos=this.titlePos||this.theme.chart.titlePos||"top";this.titleFont=
this.titleFont||this.theme.chart.titleFont;this.titleFontColor=this.titleFontColor||this.theme.chart.titleFontColor||"black";var d=v.normalizedLength(v.splitFontString(this.titleFont).size);b["top"==this.titlePos?"t":"b"]+=d+this.titleGap}C.forIn(this.margins,function(a,c){b[c]+=a});this.plotArea={width:a.width-b.l-b.r,height:a.height-b.t-b.b};C.forIn(this.axes,A);L(this.stack,this.plotArea);return this},render:function(){this._delayedRenderHandle&&(clearTimeout(this._delayedRenderHandle),this._delayedRenderHandle=
null);this.theme&&this.theme.clear();if(this.dirty)return this.fullRender();this.calculateGeometry();C.forEachRev(this.stack,function(a){a.render(this.dim,this.offsets)},this);C.forIn(this.axes,function(a){a.render(this.dim,this.offsets)},this);this._makeClean();return this},fullRender:function(){this.fullGeometry();var a=this.offsets,b=this.dim,f=Math.max(0,b.width-a.l-a.r),d=Math.max(0,b.height-a.t-a.b);h.forEach(this.series,s);C.forIn(this.axes,s);h.forEach(this.stack,s);var n=this.surface.children;
if(p.dispose)for(var g=0;g<n.length;++g)p.dispose(n[g]);this.chartTitle&&this.chartTitle.tagName&&e.destroy(this.chartTitle);this.surface.clear();this.chartTitle=null;this._renderChartBackground(b,a);this._renderPlotBackground(b,a,f,d);C.foldr(this.stack,function(c,f){return f.render(b,a),0},0);this._nativeClip||this._renderChartBackground(b,a);this.title&&(f="canvas"==v.renderer&&this.htmlLabels||!c("ie")&&!c("opera")&&this.htmlLabels?"html":"gfx",d=v.normalizedLength(v.splitFontString(this.titleFont).size),
this.chartTitle=q.createText[f](this,this.surface,b.width/2,"top"==this.titlePos?d+this.margins.t:b.height-this.margins.b,"middle",this.title,this.titleFont,this.titleFontColor));C.forIn(this.axes,function(c){c.render(b,a)});this._makeClean();return this},_renderChartBackground:function(c,b){var d=this.theme,e,n=void 0!==this.fill?this.fill:d.chart&&d.chart.fill,d=void 0!==this.stroke?this.stroke:d.chart&&d.chart.stroke;if("inherit"==n){e=this.node;for(n=new a(g.get(e,"backgroundColor"));0==n.a&&
e!=document.documentElement;)n=new a(g.get(e,"backgroundColor")),e=e.parentNode}n&&(this._nativeClip?(n=f.prototype._shapeFill(f.prototype._plotFill(n,c),{x:0,y:0,width:c.width+1,height:c.height+1}),this.surface.createRect({width:c.width+1,height:c.height+1}).setFill(n)):(n=f.prototype._plotFill(n,c,b),b.l&&(e={x:0,y:0,width:b.l,height:c.height+1},this.surface.createRect(e).setFill(f.prototype._shapeFill(n,e))),b.r&&(e={x:c.width-b.r,y:0,width:b.r+1,height:c.height+2},this.surface.createRect(e).setFill(f.prototype._shapeFill(n,
e))),b.t&&(e={x:0,y:0,width:c.width+1,height:b.t},this.surface.createRect(e).setFill(f.prototype._shapeFill(n,e))),b.b&&(e={x:0,y:c.height-b.b,width:c.width+1,height:b.b+2},this.surface.createRect(e).setFill(f.prototype._shapeFill(n,e)))));d&&this.surface.createRect({width:c.width-1,height:c.height-1}).setStroke(d)},_renderPlotBackground:function(a,c,b,d){var e=this.theme,n=e.plotarea&&e.plotarea.fill,e=e.plotarea&&e.plotarea.stroke,q={x:c.l-1,y:c.t-1,width:b+2,height:d+2};n&&(n=f.prototype._shapeFill(f.prototype._plotFill(n,
a,c),q),this.surface.createRect(q).setFill(n));e&&this.surface.createRect({x:c.l,y:c.t,width:b+1,height:d+1}).setStroke(e)},delayedRender:function(){this._delayedRenderHandle||(this._delayedRenderHandle=setTimeout(m.hitch(this,function(){this.render()}),this.delayInMs));return this},connectToPlot:function(a,c,b){return a in this.plots?this.stack[this.plots[a]].connect(c,b):null},fireEvent:function(a,c,b){if(a in this.runs){var f=this.series[this.runs[a]].plot;f in this.plots&&(f=this.stack[this.plots[f]])&&
f.fireEvent(a,c,b)}return this},_makeClean:function(){h.forEach(this.axes,y);h.forEach(this.stack,y);h.forEach(this.series,y);this.dirty=!1},_makeDirty:function(){h.forEach(this.axes,u);h.forEach(this.stack,u);h.forEach(this.series,u);this.dirty=!0},_invalidateDependentPlots:function(a,c){if(a in this.plots){var b=this.stack[this.plots[a]],f,d=c?"vAxis":"hAxis";if(b[d]){if((f=this.axes[b[d]])&&f.dependOnData())f.dirty=!0,h.forEach(this.stack,function(a){a[d]&&a[d]==b[d]&&(a.dirty=!0)})}else b.dirty=
!0}},setDir:function(a){return this},_resetLeftBottom:function(a){},formatTruncatedLabel:function(a,c,b){}});return c("dojo-bidi")?k("dojox.charting.Chart",[l,x]):l})},"dojox/charting/plot2d/MarkersOnly":function(){define(["dojo/_base/declare","./Default"],function(l,m){return l("dojox.charting.plot2d.MarkersOnly",m,{constructor:function(){this.opt.lines=!1;this.opt.markers=!0}})})},"webSceneViewer/widgets/Header/Header":function(){define("esri/core/declare dojo/io-query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Header.html ./Role dojo/dom dojo/dom-class dojo/dom-attr dojo/dom-style dojo/dom-construct dojo/_base/event dojo/on dojo/query dojo/_base/window dojo/i18n!../nls/widgets".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n,r,q,p,v){function x(a){var c=e.contains(a,"is-active");q(".dropdown").removeClass("is-active");A&&A.remove();c||(e.add(a,"is-active"),A=r(document.body,"click",C.bind(null,a)))}function C(a,c){var b=q(".dropdown-menu",a)[0];d.isDescendant(c.target||c.srcElement,b)||(e.remove(a,"is-active"),A.remove())}function M(a){var c=a=a&&a.fullName||"";-1<a.indexOf("_")?c=a.split("_")[0]:-1<a.indexOf(",")?c=a.split(",").slice(1).join(" "):-1<a.indexOf(" ")&&(c=a.split(" ")[0]);
return c.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")}function L(){return"undefined"!==typeof esriGeowConfig}function t(a){if(a)return String(a).replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#039;").replace(/\//g,"\x26#x2F;")}var A;return l([h,k],{name:"Header",templateString:g,userProceedsToLogout:!0,websceneId:null,loggedIn:!1,viewingMode:null,sceneSR:null,_setLoggedInAttr:function(a){this._set("loggedIn",a);
this._started&&this._setupHeaderLinks()},portal:null,_setPortalAttr:function(a){this._set("portal",a);a?(this.baseUrl=L()?esriGeowConfig.baseUrl:"../",this.portal.isPortal&&(this.helpUrl=a.helpBase,this.helpAdminUrl=this.helpUrl.replace("/website/","/admin/")),this._updateSignedInStatus(),this.own(r(a,"sign-in",function(){this.set("loggedIn",!0)}.bind(this))),this.own(r(a,"sign-out",function(){this.set("loggedIn",!1)}.bind(this))),this._showPortalUI()):this._hidePortalUI();this._setupHeaderLinkUrls()},
map:null,title:null,_setTitleAttr:function(c){this._set("title",c);null==c&&(c="");a.set("webmap-title-text","textContent",c);a.set("webmap-title-text","title",c);this.portal?this.portal.isPortal?p.doc.title=this.portal.name+" - "+c:this.portal.isOrg()?p.doc.title=c:p.doc.title="ArcGIS - "+c:p.doc.title=c},_setViewingModeAttr:function(c){this._set("viewingMode",c);"global"===c?a.set("sceneType","class",""):a.set("sceneType","class","local");this._updateSceneIconTooltip()},_setSceneSRAttr:function(a){this._set("sceneSR",
a);this._updateSceneIconTooltip()},_updateSceneIconTooltip:function(){var c="";this.sceneSR&&(c=" ("+v.header.spatialRef+" "+this.sceneSR+")");"global"===this.viewingMode?(a.set("webmap-title-text","title",v.header.globalScene+c),a.set("sceneType","title",v.header.globalScene+c)):(a.set("webmap-title-text","title",v.header.localScene+c),a.set("sceneType","title",v.header.localScene+c))},_setWebsceneIdAttr:function(c){this._set("websceneId",c);if(void 0===c||-1!==c.indexOf(".json"))a.set("webmap-title-text",
"class","disableLink");else{e.remove("webmap-title-text","disableLink");var b="",b="undefined"!==typeof esriGeowConfig?esriGeowConfig.baseUrl+"item.html?id\x3d"+c:this.portal.url+"/home/item.html?id\x3d"+c;a.set("webmap-title-text","href",b)}},constructor:function(a,c){},destroy:function(){this.inherited(arguments);f.empty(d.byId("webscene-header"))},postCreate:function(){this._hidePortalUI();q(".homeHome",this.domNode)[0].innerHTML=v.header.home_link;q(".homeFeatures",this.domNode)[0].innerHTML=
v.header.features;q(".homePlans",this.domNode)[0].innerHTML=v.header.plans;q(".homeGallery",this.domNode)[0].innerHTML=v.header.gallery;q(".homeGroups",this.domNode)[0].innerHTML=v.header.groups;q(".homeMyContent",this.domNode)[0].innerHTML=v.header.myContent;q(".homeMyOrg",this.domNode)[0].innerHTML=v.header.myAccount;q(".homeHelp",this.domNode)[0].innerHTML=v.header.support;q(".homeMap",this.domNode)[0].innerHTML=v.header.map;a.set("newMapLabel","innerHTML",v.header.newScene);a.set("global-scene-link",
"innerHTML",'\x3cdiv id\x3d"globe-img"\x3e\x3c/div\x3e'+v.header.newGlobal);a.set("local-scene-link","innerHTML",'\x3cdiv id\x3d"local-img"\x3e\x3c/div\x3e'+v.header.newLocal);a.set("modifyMapLabel","innerHTML",v.header.modifyMap);a.set("login-link","innerHTML",v.header.signIn);a.set("logged-in-signOut","innerHTML",v.header.signOut);a.set("logged-in-help","innerHTML",v.header.help);a.set("logged-in-adminhelp","innerHTML",v.header.adminGuide);a.set("esri-community-link","innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+
v.header.esriCommunity);a.set("my-esri-link","innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+v.header.myEsri+"\x26nbsp;\x26nbsp;");a.set("esri-training-link","innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+v.header.training+"\x26nbsp;\x26nbsp;");a.set("trial-download-link","innerHTML",v.header.trialDownloads+"\x26nbsp;\x26nbsp;");r(this.homeTitle,"click",function(a){n.stop(a);x(this.navDropdown)}.bind(this));
r(this.userProfile,"click",function(a){n.stop(a);x(this.userDropdown)}.bind(this));r(this.newScene,"click",function(a){n.stop(a);x(this.newSceneDropdown)}.bind(this))},_showPortalUI:function(){c.set("header_map_home","display","")},_hidePortalUI:function(){c.set("header_map_home","display","none")},_setupHeaderLinks:function(){var c=this.portal.isPortal,f=this.portal.isSignedIn(),d=this.portal.isOrg(),n=this.portal.getPortalUser(),n=f&&n;!c&&(this.portal.user&&this.portal.user.role)&&(this.portal.userRole=
new b({id:this.portal.user.roleId?this.portal.user.roleId:this.portal.user.role,role:this.portal.user.role}),this.portal.user.privileges&&this.portal.userRole.setPrivileges(this.portal.user.privileges));if(f){a.set("username","textContent",M(n));a.set("username","title",t(n.fullName));a.set("logged-in-myProfile","innerHTML",v.header.myProfile+"\x3cbr/\x3e"+t(n.username));a.set("logged-in-myProfile","title",t(n.fullName));var p;p=null!==n.thumbnail&&null!==n.thumbnailUrl?n.thumbnailUrl:"../arcgisonline/js/arcgisonline/css/images/no-user-thumb.jpg";
a.set("dropdown-image","src",p);a.set("profileImgSmall","src",p)}c||d?(e.remove("homeTitle","site_logo top-nav-title"),e.add("homeTitle","top-nav-link"),a.set("homeTitle","innerHTML",v.header.simpleHome)):(e.add("homeTitle","site_logo top-nav-title"),e.remove("homeTitle","top-nav-link"),a.set("homeTitle","innerHTML","Arc\x3cspan\x3eGIS\x3c/span\x3e"));c||d?q(".homeFeatures",this.domNode).addClass("hide"):q(".homeFeatures",this.domNode).removeClass("hide");c||d?q(".homePlans",this.domNode).addClass("hide"):
q(".homePlans",this.domNode).removeClass("hide");f?q(".homeHelp",this.domNode).addClass("hide"):q(".homeHelp",this.domNode).removeClass("hide");f&&this.portal.userHasEditingPrivileges()?q(".homeMyContent",this.domNode).removeClass("hide"):q(".homeMyContent",this.domNode).addClass("hide");f?q(".homeGroups",this.domNode).removeClass("hide"):q(".homeGroups",this.domNode).addClass("hide");f&&(d||c)?L()&&esriGeowConfig.restrictOrganizationPageToAdmin&&n.role&&"account_admin"!==n.role?q(".homeMyOrg",this.domNode).addClass("hide"):
q(".homeMyOrg",this.domNode).removeClass("hide"):q(".homeMyOrg",this.domNode).addClass("hide");f?q("#header_map_newMap").removeClass("hide"):q("#header_map_newMap").addClass("hide");f?e.add("logged-out-navigation","hide"):e.remove("logged-out-navigation","hide");f?e.remove("logged-in-navigation","hide"):e.add("logged-in-navigation","hide");c&&"org_admin"===n.role?e.remove("logged-in-adminhelp","hide"):e.add("logged-in-adminhelp","hide");!c&&f&&("both"===n.userType&&(e.remove("esri-community-link",
"hide"),e.remove("my-esri-link","hide")),e.remove("esri-training-link","hide"),this.portal.subscriptionInfo&&"Trial"===this.portal.subscriptionInfo.type&&e.remove("trial-download-link","hide"));this._setupHeaderLinkUrls()},_setupHeaderLinkUrls:function(){q(".homeHome",this.domNode)[0].href=this.portal.getHomeLink();q(".homeFeatures",this.domNode)[0].href=this.portal.getFeaturesLink();q(".homePlans",this.domNode)[0].href=this.portal.getPlansLink();q(".homeGallery",this.domNode)[0].href=this.portal.getGalleryLink();
q(".homeMap",this.domNode)[0].href=this._homeMapLink();q(".homeGroups",this.domNode)[0].href=this.portal.getGroupsLink();q(".homeMyContent",this.domNode)[0].href=this.portal.getMyContentLink();q(".homeMyOrg",this.domNode)[0].href=this.portal.getMyOrgLink();q(".homeHelp",this.domNode)[0].href=this._loggedInHelpLink();q(".loggedInHelp",this.domNode)[0].href=this._loggedInHelpLink();q("#profileLink",this.domNode)[0].href=this.portal.getProfileLink()},_disableEvent:function(a){a.preventDefault();return!1},
_signInLinkClickHandler:function(a){a.preventDefault();this.portal.signIn()},_signOutLinkClickHandler:function(a){this.emit("before-sign-out");this.userProceedsToLogout?(a.preventDefault(),this.portal.signOut().then(function(){L()&&(document.location.href=esriGeowConfig.baseUrl)})):this.userProceedsToLogout=!0},_homeMapLink:function(){var a=window.location.href.replace("/webscene/","/webmap/"),c=a.indexOf("?"),c=-1===c?a.length:c;return a.substr(0,c)},_communityLinkClickHandler:function(a){a.preventDefault();
a=L()&&esriGeowConfig.esriCommunityLink;window.open(a,"_blank")},_myEsriLinkClickHandler:function(a){a.preventDefault();a=L()&&esriGeowConfig.myEsriLink;window.open(a,"_blank")},_trainingLinkClickHandler:function(a){a.preventDefault();a=this.portal.userRole;var c;a?a.isAdmin()||a.isBasedOnAdmin()?c="//www.esri.com/training/main/arcgis-online-training/administrators":a.isPublisher()||a.isBasedOnPublisher()?c="//www.esri.com/training/main/arcgis-online-training/publishers":a.isUser()||a.isBasedOnUser()?
c="//www.esri.com/training/main/arcgis-online-training/users":a.isCustom()&&(c="//www.esri.com/training/main/arcgis-online-training"):c="//www.esri.com/training/main/arcgis-online-training";window.open(c,"_blank")},_trialLinkClickHandler:function(a){a.preventDefault();a=this.portal.user&&this.portal.user.culture||this.portal&&this.portal.culture||dojoConfig.locale||"en";var c=a.split("-")[0].toLowerCase();"pt"==c?c="pt-br"==a.toLowerCase()?"pt-BR":"pt-PT":"zh"==c&&(c="zh-CN");window.open("https://learn.arcgis.com/"+
c+"/trial","_blank")},_loggedInHelpLink:function(a){return this.portal&&!this.portal.isPortal?this.portal.helpBase:this.helpUrl},_loggedInAdminHelpLinkClickHandler:function(a){a.preventDefault();a=this.portal.getloggedInAdminHelpLink();window.open(a,"_blank")},_modifyMapClickHandler:function(a){a.preventDefault();c.set("header_map_modifyMap","display","none");this.emit("modify-scene",{})},_newSceneClickHandler:function(a){a.preventDefault();a=m.queryToObject(window.location.search.replace(/^\?/,""));
delete a.webscene;delete a.url;delete a.layers;a=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+decodeURIComponent(m.objectToQuery(a));window.location=a},_newGlobalSceneClickHandler:function(a){a.preventDefault();a=m.queryToObject(window.location.search.replace(/^\?/,""));delete a.webscene;delete a.url;delete a.layers;delete a.viewingmode;delete a.viewpoint;a=decodeURIComponent(m.objectToQuery(a));window.location=window.location.protocol+"//"+window.location.host+
window.location.pathname+"?"+a+(""===a?"":"\x26")+"viewingmode\x3dglobal"},_newLocalSceneClickHandler:function(a){a.preventDefault();a=m.queryToObject(window.location.search.replace(/^\?/,""));delete a.webscene;delete a.url;delete a.layers;delete a.viewingmode;delete a.viewpoint;a=decodeURIComponent(m.objectToQuery(a));window.location=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+a+(""===a?"":"\x26")+"viewingmode\x3dlocal"},_updateSignedInStatus:function(){null!=
this.portal&&this.portal.isSignedIn()?this.set("loggedIn",!0):this.set("loggedIn",!1)}})})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(l,m,h,k,g,b,d,e){return l("dijit.form.Form",[g,b,d,e],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",
postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(a){m.set(this.domNode,"encType",a);k("ie")&&(this.domNode.encoding=a);this._set("encType",a)},reset:function(a){var c={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(c)&&c.returnValue&&
this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(a){var c=this.constructor.prototype;if(this.execute!=c.execute||this.onExecute!=c.onExecute)h.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(a)&&(a.stopPropagation(),a.preventDefault())},onSubmit:function(){return this.isValid()},
submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dojox/charting/action2d/Base":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/Evented"],function(l,m,h){return m("dojox.charting.action2d.Base",h,{constructor:function(h,g){this.chart=h;this.plot=g?l.isString(g)?this.chart.getPlot(g):g:this.chart.getPlot("default")},connect:function(){},disconnect:function(){},destroy:function(){this.disconnect()}})})},"dojox/charting/plot2d/Areas":function(){define(["dojo/_base/declare",
"./Default"],function(l,m){return l("dojox.charting.plot2d.Areas",m,{constructor:function(){this.opt.lines=!0;this.opt.areas=!0}})})},"webSceneViewer/widgets/Dialog/Dialog":function(){define("esri/core/declare dojo/_base/lang dijit/_WidgetBase dojo/dom-construct dijit/Dialog dijit/form/Button dojo/i18n".split(" "),function(l,m,h,k,g,b,d){function e(a){var b;a&&a.length&&(a=a[0]);a&&a&&a.message&&1<a.message.length?(b=a.message,a=b.search("resource: http://"),0<a?(b=b.substring(0,a+8),a=b.substring(a+
8)):a=""):(b="Details:",a=JSON.stringify(a));return{content:b,details:a}}var a=l([g],{postMixInProperties:function(){var a=d.getLocalization("dijit","common");m.mixin(this,a)}});return l([h],{name:"Dialog",baseClass:"Dialog",title:void 0,content:void 0,details:void 0,execute:function(){},result:void 0,_dialog:void 0,constructor:function(a){},destroy:function(){},postMixInProperties:function(){"undefined"!==typeof this.content&&"string"!==typeof this.content&&m.mixin(this,e(this.content))},postCreate:function(){var c=
k.create("div",{innerHTML:this.content||""}),f=k.create("div",{"class":"details",innerHTML:this.details||""},c);this.watch("details",function(a,c,b){f.innerHTML=b});var d=k.create("div",{"class":"ButtonContainer"},c),d=k.create("div",{},d);new b({label:"OK","class":"DialogOKButton",onClick:dojo.hitch(this,function(){this.execute(this.result);this._dialog.destroy();this.emit("close")})},d);this._dialog=new a({title:this.title,content:c,"class":"WebSceneViewerDialog"});this._dialog.show();this.startup()}})})},
"webSceneViewer/widgets/MapControls/MapControls":function(){define("esri/core/declare dojo/dom-construct dojo/on dojo/dom-class esri/core/watchUtils esri/Viewpoint esri/views/3d/navigation/EventController esri/widgets/Zoom dojo/Evented dojo/i18n!../nls/widgets".split(" "),function(l,m,h,k,g,b,d,e,a,c){return l(a,{constructor:function(a){function n(c){c?(k.add(v.navRotate,"active"),k.add(v.tumbleContainerRotate,"active"),k.remove(v.navPan,"active"),k.remove(v.tumbleContainerPan,"active")):(k.add(v.navPan,
"active"),k.add(v.tumbleContainerPan,"active"),k.remove(v.navRotate,"active"),k.remove(v.tumbleContainerRotate,"active"));var b=a.navigationController.getControls();g.whenOnce(a,"navigationController",function(a){b===d.PRO_PAN||b===d.PRO_TUMBLE?a.setControls(c?d.PRO_TUMBLE:d.PRO_PAN):a.setControls(c?d.TUMBLE:d.PAN)})}var r=m.create("div",{className:"mapControlsContainer"},a.container);this._domNode=r;var q=m.create("div",{className:"iconContainer"},r);this.homeBtn=m.create("div",{className:"home",
title:c.mapControls.home},q);var p=m.create("div",{className:"iconContainer"},r);(new e({view:a},p)).startup();var p=[],v=this;this.tumbleContainerPan=m.create("div",{className:"iconContainer active",title:c.mapControls.panRotateToggle},r);this.navPan=m.create("div",{className:"navPan active"},this.tumbleContainerPan);this.tumbleContainerRotate=m.create("div",{className:"iconContainer",title:c.mapControls.panRotateToggle},r);this.navRotate=m.create("div",{className:"navTumble"},this.tumbleContainerRotate);
h(this.tumbleContainerPan,"click",function(){var a=k.contains(this.navPan,"active");n(a);this.emit("pan-tumble-change",{tumble:a})}.bind(this));h(this.tumbleContainerRotate,"click",function(){var a=k.contains(this.navPan,"active");n(a);this.emit("pan-tumble-change",{tumble:a})}.bind(this));p.push(this.navPan);p.push(this.navRotate);g.whenOnce(a,"navigationController",function(a){a.setControls(d.PAN)});var x=b.fromJSON({camera:{position:{x:0,y:0,z:2.1591669419719264E7,spatialReference:{wkid:102100}},
heading:0,tilt:0}});this.homeBtn.viewpoint=x;g.whenOnce(a,"ready",function(){this.homeBtn.viewpoint===x&&(this.homeBtn.viewpoint=a.viewpoint.clone())}.bind(this));h(q,"click",function(){this.homeBtn.viewpoint.camera.fov=a.camera.fov;a.animateTo(this.homeBtn.viewpoint)}.bind(this))},addStyleClass:function(a){k.add(this._domNode,a)},removeStyleClass:function(a){k.remove(this._domNode,a)},setHomeViewpoint:function(a){this.homeBtn.viewpoint=a.clone()},setHomeExtent:function(a){this._homeWidget.extent=
a.clone()}})})},"webSceneViewer/urlUtils":function(){define("dojo/io/script dojo/io-query esri/geometry/Point esri/Viewpoint esri/Camera esri/geometry/SpatialReference".split(" "),function(l,m,h,k,g,b){var d={viewpointFromUrlParameter:function(d){var a=d.split(";"),c=null;if(0<a.length){var f="";d="";for(var n=0;n<a.length;n++)-1!==a[n].indexOf("cam:")?f=a[n]:d=a[n];if(""!==f&&(f=f.substr(4,f.length-4),a=f.split(","),3<=a.length)){var n=f=c=0,c=parseFloat(a[0]),f=parseFloat(a[1]),n=parseFloat(a[2]),
r=b.WGS84;4===a.length&&(r=new b(parseInt(a[3],10)));a=new h(c,f,n,r);f=c=0;""!==d&&(d=d.split(","),0<=d.length&&(c=parseFloat(d[0]),1<d.length&&(f=parseFloat(d[1]))));c=new k({targetGeometry:void 0,scale:void 0,rotation:void 0,camera:new g({position:a,heading:c,tilt:f})})}}return c},viewpointToUrlParameter:function(b,a,c){var f=b;c=c?c:!1;b=-1===b.indexOf("?")?"?":"\x26";f+=b+"viewpoint\x3dcam:";b=a.position.spatialReference.isWebMercator()&&!c?a.position.longitude:a.position.x;b=Math.round(1E8*
b)/1E8;var d=a.position.spatialReference.isWebMercator()&&!c?a.position.latitude:a.position.y,d=Math.round(1E8*d)/1E8,g=Math.round(1E3*a.position.z)/1E3,q=Math.round(1E3*a.heading)/1E3,p=Math.round(1E3*a.tilt)/1E3;a=a.position.spatialReference.isWebMercator()&&!c?"":","+a.position.spatialReference.wkid;return f+(b+","+d+","+g+a+";"+q+","+p)},shortenUrl:function(b,a,c){if("undefined"===typeof esriGeowConfig)c&&c(b);else{var f=esriGeowConfig.bitlyUrl;"https:"==location.protocol&&(f=esriGeowConfig.bitlyUrlSSL);
f+="\x26longUrl\x3d"+encodeURIComponent(b)+"\x26format\x3djson";l.get({url:f,callbackParamName:"callback",load:function(f){f&&200==f.status_code&&f.data&&f.data.url&&0<f.data.url.length?a(f.data.url,b):c&&c(b)},error:function(a){c&&c(b)}})}},urlParams:function(){var b=m.queryToObject(window.location.search.replace(/^\?/,"")),b=b||{},a;for(a in b)b.hasOwnProperty(a)&&(b[a]=b[a].replace(/(&lt;|&gt;|<|>|%3C|%3E)/g,""));return b},cleanUrl:function(){var b=m.queryToObject(window.location.search.replace(/^\?/,
"")),b=b||{},a=d.urlParams();if(a.hasOwnProperty("viewingmode")&&(a.hasOwnProperty("layers")||a.hasOwnProperty("url")||a.hasOwnProperty("webscene")))delete b.viewingmode,b=decodeURIComponent(m.objectToQuery(b)),window.history.pushState(null,null,location.pathname+"?"+b)}};return d})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),function(l,m,h,k,g,b,d,e,a,c,f){h.isAsync||c(0,function(){f(["./fx/Toggler"])});
h=h.fx={};c={_fire:function(a,c){this[a]&&this[a].apply(this,c||[]);return this}};var n=function(a){this._index=-1;this._animations=a||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;k.forEach(this._animations,function(a){this.duration+=a.duration;a.delay&&(this.duration+=a.delay)},this)};n.prototype=new m;l.extend(n,{_onAnimate:function(){this._fire("onAnimate",arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=
null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=g.after(this._current,"onAnimate",l.hitch(this,"_onAnimate"),!0),this._onEndCtx=g.after(this._current,"onEnd",l.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,c){this._current||(this._current=this._animations[this._index=0]);if(!c&&"playing"==this._current.status())return this;var b=g.after(this._current,"beforeBegin",l.hitch(this,function(){this._fire("beforeBegin")}),
!0),f=g.after(this._current,"onBegin",l.hitch(this,function(a){this._fire("onBegin",arguments)}),!0),d=g.after(this._current,"onPlay",l.hitch(this,function(a){this._fire("onPlay",arguments);b.remove();f.remove();d.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=g.after(this._current,"onAnimate",l.hitch(this,"_onAnimate"),!0);this._onEndCtx&&this._onEndCtx.remove();this._onEndCtx=g.after(this._current,"onEnd",l.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,
arguments);return this},pause:function(){if(this._current){var a=g.after(this._current,"onPause",l.hitch(this,function(c){this._fire("onPause",arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(a,c){this.pause();var b=this.duration*a;this._current=null;k.some(this._animations,function(a,c){if(b<=a.duration)return this._current=a,this._index=c,!0;b-=a.duration;return!1},this);this._current&&this._current.gotoPercent(b/this._current.duration);c&&this.play();return this},
stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=this._animations[this._index]}var c=g.after(this._current,"onStop",l.hitch(this,function(a){this._fire("onStop",arguments);c.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});
l.extend(n,c);h.chain=function(a){return new n(a)};var r=function(a){this._animations=a||[];this._connects=[];this.duration=this._finished=0;k.forEach(a,function(a){var c=a.duration;a.delay&&(c+=a.delay);this.duration<c&&(this.duration=c);this._connects.push(g.after(a,"onEnd",l.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=new b.Animation({curve:[0,1],duration:this.duration});var c=this;k.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(a){c._connects.push(g.after(c._pseudoAnimation,
a,function(){c._fire(a,arguments)},!0))})};l.extend(r,{_doAction:function(a,c){k.forEach(this._animations,function(b){b[a].apply(b,c)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,c){var b=this._pseudoAnimation;b[a].apply(b,c)},play:function(a,c){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(a,
c){var b=this.duration*a;k.forEach(this._animations,function(a){a.gotoPercent(a.duration<b?1:b/a.duration,c)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},destroy:function(){this.stop();k.forEach(this._connects,function(a){a.remove()})}});l.extend(r,c);h.combine=function(a){return new r(a)};h.wipeIn=function(a){var c=a.node=d.byId(a.node),f=c.style,
n;a=b.animateProperty(l.mixin({properties:{height:{start:function(){n=f.overflow;f.overflow="hidden";if("hidden"==f.visibility||"none"==f.display)return f.height="1px",f.display="",f.visibility="",1;var a=e.get(c,"height");return Math.max(a,1)},end:function(){return c.scrollHeight}}}},a));var r=function(){f.height="auto";f.overflow=n};g.after(a,"onStop",r,!0);g.after(a,"onEnd",r,!0);return a};h.wipeOut=function(a){var c=(a.node=d.byId(a.node)).style,f;a=b.animateProperty(l.mixin({properties:{height:{end:1}}},
a));g.after(a,"beforeBegin",function(){f=c.overflow;c.overflow="hidden";c.display=""},!0);var e=function(){c.overflow=f;c.height="auto";c.display="none"};g.after(a,"onStop",e,!0);g.after(a,"onEnd",e,!0);return a};h.slideTo=function(c){var f=null,n=null,r=function(c){return function(){var b=e.getComputedStyle(c),d=b.position;f="absolute"==d?c.offsetTop:parseInt(b.top)||0;n="absolute"==d?c.offsetLeft:parseInt(b.left)||0;"absolute"!=d&&"relative"!=d&&(b=a.position(c,!0),f=b.y,n=b.x,c.style.position=
"absolute",c.style.top=f+"px",c.style.left=n+"px")}}(c.node=d.byId(c.node));r();c=b.animateProperty(l.mixin({properties:{top:c.top||0,left:c.left||0}},c));g.after(c,"beforeBegin",r,!0);return c};return h})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(l,m,h){var k=l.NodeList;m.extend(k,{_buildArrayFromCallback:function(g){for(var b=[],d=0;d<this.length;d++){var e=g.call(this[d],this[d],b);e&&(b=b.concat(e))}return b},_getUniqueAsNodeList:function(g){for(var b=
[],d=0,e;e=g[d];d++)1==e.nodeType&&-1==h.indexOf(b,e)&&b.push(e);return this._wrap(b,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(g,b){var d=this._getUniqueAsNodeList(g),d=b?l._filterResult(d,b):d;return d._stash(this)},_getRelatedUniqueNodes:function(g,b){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(b),g)},children:function(g){return this._getRelatedUniqueNodes(g,function(b,d){return m._toArray(b.childNodes)})},closest:function(g,b){return this._getRelatedUniqueNodes(null,
function(d,e){do if(l._filterResult([d],g,b).length)return d;while(d!=b&&(d=d.parentNode)&&1==d.nodeType);return null})},parent:function(g){return this._getRelatedUniqueNodes(g,function(b,d){return b.parentNode})},parents:function(g){return this._getRelatedUniqueNodes(g,function(b,d){for(var e=[];b.parentNode;)b=b.parentNode,e.push(b);return e})},siblings:function(g){return this._getRelatedUniqueNodes(g,function(b,d){for(var e=[],a=b.parentNode&&b.parentNode.childNodes,c=0;c<a.length;c++)a[c]!=b&&
e.push(a[c]);return e})},next:function(g){return this._getRelatedUniqueNodes(g,function(b,d){for(var e=b.nextSibling;e&&1!=e.nodeType;)e=e.nextSibling;return e})},nextAll:function(g){return this._getRelatedUniqueNodes(g,function(b,d){for(var e=[],a=b;a=a.nextSibling;)1==a.nodeType&&e.push(a);return e})},prev:function(g){return this._getRelatedUniqueNodes(g,function(b,d){for(var e=b.previousSibling;e&&1!=e.nodeType;)e=e.previousSibling;return e})},prevAll:function(g){return this._getRelatedUniqueNodes(g,
function(b,d){for(var e=[],a=b;a=a.previousSibling;)1==a.nodeType&&e.push(a);return e})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(g,b){return 0!=b%2})},odd:function(){return this.filter(function(g,b){return 0==b%2})}});return k})},"webSceneViewer/PortalExtended":function(){define("esri/core/declare dojo/_base/lang dojo/Deferred dojo/cookie dojo/on esri/kernel esri/portal/Portal esri/portal/PortalItem esri/identity/IdentityManager".split(" "),
function(l,m,h,k,g,b,d,e,a){function c(a,c){a.then(function(a){c.resolve(a)},function(a){c.reject(a)},function(a){c.progress(a)})}l=l([d],{_baseUrl:void 0,constructor:function(){this._baseUrl="undefined"!==typeof esriGeowConfig?esriGeowConfig.baseUrl:"../";g.once(this,"ready",function(){b.id.checkSignInStatus(this.portalUrl).then(function(a){this.signIn()}.bind(this)).otherwise(function(a){this.signOutAfterFailedSignIn(a)}.bind(this))}.bind(this))},addItem:function(a,c){var b=m.mixin({},a);if(c&&
c.data){var d=new FormData;d.append(c.identifier||"file",c.data,c.name);b.form=d}return this.portalUtil.request(this.portalUrl+"content/users/"+this.getPortalUser().username+"/addItem",b,{usePost:!0})},getItem:function(a){var b=new h;this._getItemAnonymous(a).then(function(a){a=e(m.mixin(a,{portal:this}));b.resolve(a)}.bind(this),function(d){d=this._getItemSignedIn(a);c(d,b)}.bind(this));return b.promise},getRelatedItems:function(a,c,b){return this.portalUtil.request(this.portalUrl+"content/items/"+
a+"/relatedItems",{relationshipType:c||"Service2Data",relationshipDirection:b||"forward",f:"json"})},_getItemAnonymous:function(a){return this.portalUtil.request(this.portalUrl+"content/items/"+a)},_getItemSignedIn:function(a){var b=this.getPortalUser();if(null==b){var d=new h;this.signIn().then(function(){var b=this._getItemSignedIn(a);c(b,d)}.bind(this));return d.promise}return b.getItem(a)},getItemData:function(a){return this.portalUtil.request(this.portalUrl+"content/items/"+a+"/data")},updateItem:function(a,
c,b,d,e){c=m.mixin({},c);if(d&&d.data){var g=new FormData;g.append(d.identifier||"file",d.data,d.name);c.form=g}d=e?e:this.getPortalUser().username;return this.portalUtil.request(this.portalUrl+"content/users/"+d+(b?"/"+b:"")+"/items/"+a+"/update",c,{usePost:!0})},signIn:function(){return this._signingInDfd?this._signingInDfd:this._signingInDfd=this.inherited(arguments).then(function(a){this._signingInDfd=void 0;this.emit("sign-in",a)}.bind(this),function(a){this._signingInDfd=void 0;this.signOutAfterFailedSignIn(a)}.bind(this))},
signOutAfterFailedSignIn:function(c){var b=a.credentials;b&&0<b.length&&a.destroyCredentials();this.deleteCookie("esri_auth");this.init(this.url).then(function(){this.emit("sign-in-error",{msg:c})}.bind(this)).otherwise(function(a){this.emit("sign-in-error",{msg:a})}.bind(this))},signOut:function(){return this.inherited(arguments).then(function(){this.deleteCookie("esri_auth");this.emit("sign-out")}.bind(this))},deleteCookie:function(a){if(k.isSupported()){k(a,null,{expires:-1,path:"/",domain:document.domain});
for(var c=document.domain.split(".");2<c.length;)c.shift(1),k(a,null,{expires:-1,path:"/",domain:c.join(".")})}},isSignedIn:function(){return null!=this.getPortalUser()},isOrg:function(){if(this.isSignedIn()){var a=this.getPortalUser();return void 0!==a.accountId||void 0!==a.orgId}return this.isPortal||this.urlKey},queryItems:function(a,c){var b=this.getPortalUser();null!=b&&b.credential&&m.mixin(a,{token:b.credential.token});return this.inherited(arguments)},queryGroupItems:function(a,c,b){c=this.portalUtil.formatQueryParams({},
c,b);c.q="group:"+a+(c.q?" "+c.q:"");return this._queryPortal(this.portalUrl+"search",this.portalUtil.formatQueryParams({},c,b),e)},getBaseUrl:function(){return this._baseUrl},getSceneViewerUrl:function(a){return a?document.location.protocol+"//"+this.portalHostname+"/home/webscene/viewer.html":this._baseUrl+"webscene/viewer.html"},getProfileLink:function(){return this._baseUrl+"user.html"},getHomeLink:function(){return!this.isPortal&&!this.isSignedIn()?this._baseUrl+"../features/":this._baseUrl+
"index.html"},getFeaturesLink:function(){return this._baseUrl.replace("/home/","/features/")+"features.html"},getPlansLink:function(){return this._baseUrl.replace("/home/","/features/")+"plans/pricing.html"},getGalleryLink:function(){return this._baseUrl+"gallery.html"},getScenesGalleryLink:function(){return this._baseUrl+"gallery.html#f\x3dscenes"},getGroupsLink:function(){return this._baseUrl+"groups.html"},getMyContentLink:function(){return this._baseUrl+"content.html"},getMyOrgLink:function(){return this._baseUrl+
"organization.html"},getloggedInAdminHelpLink:function(){if(this.isPortal)var a=this.helpBase.replace("/website/","/admin/");return a||this._baseUrl+"support.html"},getTrialLink:function(){return this._baseUrl.replace("/home/","/features/")+"free-trial.html"},userHasSharingPrivileges:function(){var a=this.getPortalUser();if(!this.isOrg())return!0;if(a&&void 0!==a.privileges)for(var c=0;c<a.privileges.length;c++)if("portal:user:shareToPublic"===a.privileges[c]||"portal:user:shareToOrg"===a.privileges[c]||
"portal:user:shareToGroup"===a.privileges[c])return!0},userCanShareWithPublic:function(){var a=this.getPortalUser();if(!this.isOrg())return!0;if(this.canSharePublic&&a&&void 0!==a.privileges)for(var c=0;c<a.privileges.length;c++)if("portal:user:shareToPublic"===a.privileges[c])return!0;return!1},userHasEditingPrivileges:function(a){var c=this.getPortalUser();if(!this.isOrg())return!0;if(c&&void 0!==c.privileges)for(var b=0;b<c.privileges.length;b++)if("portal:user:createItem"===c.privileges[b])return!0;
return a?a.portalItemProperties?this._canEditScene(a.portalItemProperties.itemControl):!1:!1},_canEditScene:function(a){return"update"===a||"admin"===a}});d.Portal=l;return d})},"webSceneViewer/webScene/WebScene":function(){define("esri/core/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/on dojo/string dojo/when esri/core/Accessor esri/core/Evented esri/core/watchUtils esri/request esri/core/lang esri/portal/support/PortalUtil esri/geometry/Extent esri/geometry/support/webMercatorUtils esri/geometry/SpatialReference webSceneViewer/spatialReferenceUtils esri/layers/GroupLayer esri/layers/FeatureLayer esri/layers/SceneLayer esri/layers/Layer esri/layers/support/TileInfo esri/layers/support/LayerDrawingOptions esri/Viewpoint esri/widgets/PopupLegacy/PopupTemplate esri/views/3d/support/cameraUtils esri/views/3d/support/viewpointUtils ../environmentUtils ../basemapUtils ../urlUtils ./WebSceneLayers ./Presentation ./LayerTemplates webSceneViewer/widgets/MessageListWidget/MessageListWidget webSceneViewer/widgets/Dialog/ConfirmDialog dojo/i18n!webSceneViewer/nls/viewer".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n,r,q,p,v,x,C,M,L,t,A,s,B,y,u,E,I,z,H,J,G,F,K,D,N,w){function O(a){if(a.renderer){var c=a.get("renderer");a._websceneEditorProperties.originalRenderer=new c.constructor(c.toJSON())}else a.then(function(c){c=a.get("renderer");a._websceneEditorProperties.originalRenderer=a.renderer?new c.constructor(c.toJSON()):null})}function P(a){if(!(!0===a.disablePopup||null!=a.popupTemplate))if(a.isInstanceOf(L)||a.isInstanceOf(t)&&null!=a._companionFeatureLayer){var c=a.popupTemplate||
new u({title:a.title,fieldInfos:a.fields&&a.fields.map(function(a){var c={fieldName:a.name,label:a.alias,visible:!0};"esriFieldTypeDate"===a.type&&(c.format={dateFormat:"longMonthDayYear"});return c})});a.set("disablePopup",!1);a.set("popupTemplate",c)}}function V(a,c,b){var d;if(c.layerDefinition&&c.layerDefinition.drawingInfo){var f=c.layerDefinition.drawingInfo,e=new B(m.clone(f));K.hasContentByReference(f.renderer)?d=K.createRenderer(f.renderer,b).then(function(c){a.renderer=c;a.showLegend=!1},
function(c){console.warn("Failed to create renderer by reference for "+a.title+": "+(c.message||c));D.show({message:'"'+a.title+'" '+w.messages.byReferenceRendererUnsupported,details:w.messages.layerDisplaysWithServiceSymbology+"\x3cbr\x3e"+a.url,type:D.MessageTypes.WARNING})}):e.renderer?(b=a instanceof t,(a instanceof L||b)&&!G.isFeatureServiceRendererSupported(f.renderer.type)?D.show({message:'"'+a.title+'" '+w.messages.featureServiceNotSupportedRendererType+" "+f.renderer.type,details:w.messages.layerDisplaysWithServiceSymbology+
"\x3cbr\x3e"+a.url,type:D.MessageTypes.WARNING}):a.renderer=e.renderer):c.layerDefinition.drawingInfo.renderer&&D.show({message:'"'+a.title+'" '+w.messages.featureServiceNotSupportedRendererType+" "+f.renderer.type,details:w.messages.layerDisplaysWithServiceSymbology+"\x3cbr\x3e"+a.url,type:D.MessageTypes.WARNING});e.hasOwnProperty("labelingInfo")&&a.set("labelingInfo",e.labelingInfo)}null!=c.minScale?a.minScale=c.minScale:c.layerDefinition&&null!=c.layerDefinition.minScale&&(a.minScale=c.layerDefinition.minScale);
null!=c.maxScale?a.maxScale=c.maxScale:c.layerDefinition&&null!=c.layerDefinition.maxScale&&(a.maxScale=c.layerDefinition.maxScale);c.layerDefinition&&(c.layerDefinition.elevationInfo&&0<Object.keys(c.layerDefinition.elevationInfo).length)&&a.set("elevationInfo",m.clone(c.layerDefinition.elevationInfo));c.visibilityMode&&a.set("visibilityMode",c.visibilityMode);c.listMode&&a.set("listMode",c.listMode);c.popupInfo&&(0===Object.keys(c.popupInfo).length?a.set("popupTemplate",null):a.set("popupTemplate",
new u(c.popupInfo)));c.hasOwnProperty("disablePopup")&&a.set("disablePopup",c.disablePopup);c.showLabels&&a.set("showLabels",c.showLabels);return d}function Y(a){return m.exists("spatialReference.wkid",a)?(a=a.spatialReference,a=a instanceof x?a.clone():x.fromJSON(a)):x.WGS84}function T(a,c,f,e){var n=[],g=G.create(a);if(void 0===g)return console.log("cannot apply layer to map "+a.id+" ",a.url),!1;var p=window._webSceneViewerView;switch(e){case 1:H._resetView(c,Y(a.serviceInfo),g.fullExtent);z.adjustLightForLayer(p,
g);break;case 2:var q=Y(a.serviceInfo);H._resetView(c,q,g.fullExtent);z.adjustLightForLayer(p,g);D.show({message:w.messages.BasemapDropWarningTitle,type:D.MessageTypes.WARNING,details:w.messages.BasemapDropWarning});q.isWebMercator()||(p.globeMode="planar")}g.on("graphics-controller-create",function(a){if(!m.exists("graphicsSource.layerDefinition.advancedQueryCapabilities.supportsPagination",g)||!1===g.graphicsSource.layerDefinition.advancedQueryCapabilities.supportsPagination)b.once(a.graphicsController,
"query-limit-exceeded",function(){var a={message:'"'+g.title+'" '+d.substitute(w.messages.layerDidNotDrawCompletely,{limit:g.maxRecordCount}),type:D.MessageTypes.WARNING,details:g.url};D.show(a)})});g._websceneEditorProperties={editedFlags:{renderer:!1,labelingInfo:!1,elevationInfo:!1,listMode:!1,visibilityMode:!1,popupInfo:!1,showLabels:!1,showLegend:!1}};a.thumbnailUrl&&(g._websceneEditorProperties.thumbnailUrl=a.thumbnailUrl);a.portalLayerItem&&(g._websceneEditorProperties.portalLayerItem=a.portalLayerItem);
a.originalOperationalLayer&&(g._websceneEditorProperties.originalOperationalLayer=a.originalOperationalLayer);g instanceof M&&a.layers.forEach(function(a,c){a.layerIndex=c;var b;a.itemId&&f?b=U.addContentByItemId(g,f,a.itemId,a):(a.itemId&&console.warn("Found item id in layer but no portal to query. Fallback to add by url.",a),b=U.addLayerToMapByUrl(g,a,f));n.push(b)});var r=J.urlParams();n.push(R(c,g,a).then(function(){0<e&&(C.pingGeometryService(g.fullExtent),p.viewpoint=r.viewpoint&&2===e?J.viewpointFromUrlParameter(r.viewpoint):
p.createViewpoint({target:g.fullExtent,heading:0,tilt:0.5}));return V(g,a,f)}).then(function(){O(g);P(g)}).then(function(){return g}));return n}function R(a,c,b){c._websceneIndex=b.layerIndex;a:{b=b.layerIndex;for(var d=a.layers.getAll(),f=0;f<d.length;f++){var e=d[f];if(b<e._websceneIndex){b=f;break a}else if(b>e._websceneIndex&&(e=d[f+1]?d[f+1]._websceneIndex:null,!e||b<e)){b=f+1;break a}}b=void 0}a.add(c,b);return c}function W(a){for(var c=0;c<G.layerHandlers.length;c++)if(G.layerHandlers[c].condition(a))return!0;
return!1}function $(a){a instanceof x||(a=x.fromJSON(a));return a.isWebMercator()}function aa(a){return 4326===a.wkid||$(a)}var X={title:w.defaultWebSceneName,type:"Web Scene",typeKeywords:"Web Scene, 3D, Map, Scene, Web, Streaming"},U=l([a,c],{normalizeCtorArgs:function(a){a&&a.spatialReference&&(1.3<=a.version?a.spatialReference=x.fromJSON(a.spatialReference):delete a.spatialReference);a&&a.clippingArea&&(a.clippingArea.geometry=p.fromJSON(a.clippingArea.geometry));a=m.mixin({},a);a.baseMap&&null==
a.baseMap.elevationLayers&&(a.baseMap.elevationLayers=H.DefaultBasemapJson.elevationLayers);return a},getDefaults:function(){return{baseMap:H.DefaultBasemapJson,operationalLayers:[],portalItemProperties:X,presentation:new F,spatialReference:x.WebMercator,viewingMode:"global"}},initialize:function(){this._validate()},authoringApp:void 0,authoringAppVersion:void 0,baseMap:void 0,_initialStateSetter:function(a){a&&(a.environment&&!a.environment.declaredClass)&&(a.environment=z.fromJSON(a.environment));
return a},operationalLayers:void 0,portalItemProperties:void 0,presentation:void 0,_presentationSetter:function(a){if(!a)return a;a.declaredClass||(a=F.fromJSON(a));return a},_snippetGetter:function(){return this.portalItemProperties.snippet},_snippetSetter:function(a){this.portalItemProperties.snippet=a},_tagsGetter:function(){return this.portalItemProperties.tags},_tagsSetter:function(a){this.portalItemProperties.tags=a},_titleGetter:function(){return this.portalItemProperties.title},_titleSetter:function(a){this.portalItemProperties.title=
a},toc:void 0,version:void 0,addOperationalLayer:function(a){this.operationalLayers.push(a);return this.operationalLayers},removeOperationalLayer:function(a){for(var c=-1,b=0;b<this.operationalLayers.length;b++)if(this.operationalLayers[b].id===a){c=b;break}return this.operationalLayers.splice(c,1)},_updateLayerFromMap:function(a){var c=function(a,c){if(-1===a.indexOf("."))return c[a];var b=a.split(".");if(2==b.length)return c[b[0]][b[1]];if(3==b.length)return c[b[0]][b[1]][b[2]];if(4==b.length)return c[b[0]][b[1]][b[2]][b[3]];
if(5==b.length)return c[b[0]][b[1]][b[2]][b[3]][b[4]];if(5<b.length)throw Error("propName.length \x3e 5 is not implemented");},b=function(a,b){if(2<arguments.length)throw Error("get value if exists called with too many parameters");return m.exists(a,b)?c(a,b):void 0},d=function(a,c,b){return m.exists(a,c)?b:void 0},f=function(a,b,d){return m.exists(a,b)&&!0===c(a,b)?d:void 0},e=function(a){return a.elevationInfo&&0<Object.keys(a.elevationInfo).length?r.fixJson(a.elevationInfo):void 0},n=function(a){if(a.popupTemplate)return{title:a.popupTemplate.info.title,
fieldInfos:m.clone(a.popupTemplate.info.fieldInfos),description:a.popupTemplate.info.description,showAttachments:a.popupTemplate.info.showAttachments,mediaInfos:m.clone(a.popupTemplate.info.mediaInfos)}},g=function(a){if(a._websceneEditorProperties&&!1===a._websceneEditorProperties.editedFlags.labelingInfo)return b("originalOperationalLayer.layerDefinition.drawingInfo.labelingInfo",a._websceneEditorProperties);if(a._websceneEditorProperties&&!0===a._websceneEditorProperties.editedFlags.labelingInfo){var c=
new B;c.labelingInfo=a.labelingInfo;return(a=c.toJSON())&&a.labelingInfo}return null},p=function(a){if(a._websceneEditorProperties&&!1===a._websceneEditorProperties.editedFlags.renderer)return b("originalOperationalLayer.layerDefinition.drawingInfo.renderer",a._websceneEditorProperties);if(a._websceneEditorProperties&&!0===a._websceneEditorProperties.editedFlags.renderer){var c=new B;c.renderer=a.renderer;return(a=c.toJSON())&&a.renderer}return null},q={url:a.url,title:a.title,id:a.id,layerType:G.extrapolateTypeFromLayerInstance(a),
visibility:a.visible,opacity:a.opacity||1-a.transparency,layerDefinition:{drawingInfo:{}}},s=a._websceneEditorProperties&&a._websceneEditorProperties.originalOperationalLayer;q.itemId=b("portalLayerItem.item.id",a._websceneEditorProperties)||b("itemId",s);null!=s?(q.minScale=d("minScale",s,a.minScale),void 0===q.minScale&&(q.layerDefinition.minScale=d("layerDefinition.minScale",s,a.minScale)),q.maxScale=d("maxScale",s,a.maxScale),void 0===q.maxScale&&(q.layerDefinition.maxScale=d("layerDefinition.maxScale",
s,a.maxScale)),q.layerDefinition.definitionExpression=d("layerDefinition.definitionExpression",s,"string"===typeof a.definitionExpression&&0<a.definitionExpression.length?a.definitionExpression:void 0),q.layerDefinition.drawingInfo.labelingInfo=d("layerDefinition.drawingInfo.labelingInfo",s,g(a)),q.visibilityMode=f("_websceneEditorProperties.editedFlags.visibilityMode",a,a.visibilityMode)||b("visibilityMode",s),q.listMode=f("_websceneEditorProperties.editedFlags.listMode",a,a.listMode)||b("listMode",
s),q.popupInfo=f("_websceneEditorProperties.editedFlags.popupInfo",a,n(a))||b("popupInfo",s),q.showLabels=f("_websceneEditorProperties.editedFlags.showLabels",a,a.showLabels),q.showLegend=f("_websceneEditorProperties.editedFlags.showLegend",a,a.showLegend),void 0===q.showLabels&&(q.showLabels=b("showLabels",s)),void 0===q.showLegend&&(q.showLegend=b("showLegend",s)),q.layerDefinition.elevationInfo=f("_websceneEditorProperties.editedFlags.elevationInfo",a,e(a))||b("elevationInfo",s.layerDefinition),
q.layerDefinition.drawingInfo.renderer=p(a),q.disablePopup=f("_websceneEditorProperties.editedFlags.popupDisable",a,a.disablePopup),void 0===q.disablePopup&&(q.disablePopup=b("disablePopup",s))):(q.visibilityMode=f("_websceneEditorProperties.editedFlags.visibilityMode",a,a.visibilityMode),q.listMode=f("_websceneEditorProperties.editedFlags.listMode",a,a.listMode),q.popupInfo=f("_websceneEditorProperties.editedFlags.popupInfo",a,n(a)),q.showLabels=f("_websceneEditorProperties.editedFlags.showLabels",
a,a.showLabels),q.showLegend=f("_websceneEditorProperties.editedFlags.showLegend",a,a.showLegend),q.layerDefinition.elevationInfo=f("_websceneEditorProperties.editedFlags.elevationInfo",a,e(a)),q.layerDefinition.drawingInfo.renderer=p(a),q.disablePopup=f("_websceneEditorProperties.editedFlags.popupDisable",a,a.disablePopup));a instanceof M&&(delete q.url,q.layers=[],h.forEach(a.layers.getAll(),function(a){q.layers.push(this._updateLayerFromMap(a))}.bind(this)));a.url&&(0<a.url.indexOf("s3-eu-west-1.amazonaws.com")&&
a.resourceInfo)&&(q.resourceInfo=JSON.parse(a.resourceInfo));q=r.fixJson(q,!0);q.layerDefinition&&(q.layerDefinition.elevationInfo&&0===Object.keys(q.layerDefinition.elevationInfo).length)&&delete q.layerDefinition.elevationInfo;q.layerDefinition&&(q.layerDefinition.drawingInfo&&0===Object.keys(q.layerDefinition.drawingInfo).length)&&delete q.layerDefinition.drawingInfo;q.layerDefinition&&0===Object.keys(q.layerDefinition).length&&delete q.layerDefinition;return q},updateFromView:function(a,c){var b=
a.map;a.map.spatialReference&&(this.spatialReference=a.map.spatialReference.clone());this.viewingMode="spherical"===a.globeMode?"global":"local";var d=function(a,c){for(var b,d=0;d<c.length;d++)c[d].id===a&&(b=c[d]);return b},f=function(a,c){var b=d(a.id,c);b&&a.visibility!==b.visibility&&(console.debug("keeping visibility for layer "+b.id+" as "+b.visibility),a.visibility=b.visibility);b&&"GroupLayer"===a.layerType&&a.layers.forEach(function(a){f(a,b.layers)})},e=function(a){return"number"!==typeof a||
isNaN(a)?a:Math.round(1E6*a)/1E6};!1!==c&&(this.baseMap=H.toJSON(a,b.basemap));var n,g=[];n=this.calculateWebsceneExtent(b,c);b.layers.forEach(function(a){"SilentContentLayer"===a.id||"__basemapErrorFallbackLayer__"===a.id||(a=this._updateLayerFromMap(a),g.push(a))}.bind(this));if(!1===c&&this.operationalLayers&&0<this.operationalLayers.length)for(b=0;b<g.length;b++)f(g[b],this.operationalLayers);this.set("operationalLayers",g);n&&(n=v.webMercatorToGeographic(n),this.portalItemProperties.extent=e(n.xmin)+
", "+e(n.ymin)+", "+e(n.xmax)+", "+e(n.ymax))},calculateWebsceneExtent:function(a,c){var b=null;if(this.clippingArea&&this.clippingArea.clip&&this.clippingArea.geometry)b=this.clippingArea.geometry;else if(0<a.layers.length)a.layers.forEach(function(a){if(!("SilentContentLayer"===a.id||"__basemapErrorFallbackLayer__"===a.id))try{var c=a.get("fullExtent");c&&(c.spatialReference.isWebMercator()||(c=v.geographicToWebMercator(c)),b=null==b?c.clone():b.union(c))}catch(d){}}.bind(this));else if(c||!m.exists("portalItemProperties.extent",
this))b=E.toExtent(view,I.toCamera(view,y.fromJSON(this.initialState.viewpoint)));return b},toJSON:function(a){var c={operationalLayers:this.operationalLayers,baseMap:this.baseMap,version:(1).toString()+"."+(3).toString(),authoringApp:this.currentAuthoringApp,authoringAppVersion:this.currentAuthoringAppVersion,spatialReference:this.spatialReference.toJSON(),viewingMode:this.viewingMode};this.clippingArea&&(c.clippingArea={clip:this.clippingArea.clip,geometry:this.clippingArea.geometry.toJSON()});
this.initialState&&(c.initialState={viewpoint:this.initialState.viewpoint},this.initialState.environment&&(c.initialState.environment=z.toJSON(this.initialState.environment)));this.presentation&&(c.presentation=this.presentation.toJSON());return JSON.stringify(c,null,a)},_applyInitialState:function(a,c){var b=null,d=null;if(a){var e=window.location.hash;if(""!==e){var e=parseInt(e.substr(1),10)-1,n=this.presentation.slides.getAll();if((e=0>e||e>=n.length?null:n[e])&&e.viewpoint)d=y.fromJSON(e.viewpoint).camera}else if(c.viewpoint&&
(e=J.viewpointFromUrlParameter(c.viewpoint)))d=e.camera;this.initialState&&this.initialState.viewpoint&&(b=y.fromJSON(this.initialState.viewpoint).camera);if(b&&(this.initialState.environment||a.setInitialExtent(null,3)))a.camera=b;f.whenOnce(a,"ready",function(){d&&(a.camera=d);f.whenTrueOnce(a.environment.lighting,"ready",function(){this.get("initialState.environment.lighting")?z.applyToView(this.initialState.environment,a):z.adjustLightDateForLatitude(a.environment.lighting,a.camera.position)}.bind(this))}.bind(this))}},
applyToMap:function(a,c,b,d,f){var n=[];a.spatialReference=this.spatialReference||x.WebMercator;"local"===this.viewingMode&&(-1===this.portalItemProperties.typeKeywords.indexOf("viewingmode-local")&&(this.portalItemProperties.typeKeywords+=", ViewingMode-Local"),c.globeMode="planar",c.clippingArea=this.clippingArea&&this.clippingArea.clip?this.clippingArea.geometry:c.clippingArea);var q=[];if(!d||!0===d.basemap){var p=new g;e(H.setFromJSON(c,this.baseMap),function(){p.resolve()},function(a){p.reject({msg:a})});
n.push(p.promise)}(!d||!0===d.initialState)&&this._applyInitialState(c,f);this.operationalLayers.forEach(function(c,d){if(W(c))if(c.layerIndex=d,c.originalOperationalLayer=m.clone(c),"GroupLayer"===c.layerType){c.originalOperationalLayer.layers=null;for(var f=[],e=0;e<c.layers.length;e++)if(W(c.layers[e])){var g=c.layers[e];g.originalOperationalLayer=m.clone(c.layers[e]);f.push(g)}else D.show({message:w.messages.addLayerFailed+(""!==c.layers[e].title?": \x3ci\x3e"+c.layers[e].title+"\x3c/i\x3e":""),
type:D.MessageTypes.ERROR,details:w.messages.layerTypeNotSupported+" "+c.layers[e].layerType,collapsed:!1});c.layers=f;(f=T(c,a,b))&&(n=n.concat(f))}else c.itemId&&b?f=U.addContentByItemId(a,b,c.itemId,c):(c.itemId&&console.warn("Found item id in layer but no portal to query. Fallback to add by url.",c),f=U.addLayerToMapByUrl(a,c,b)),f&&n.push(f);else D.show({message:w.messages.addLayerFailed+(""!==c.title?": \x3ci\x3e"+c.title+"\x3c/i\x3e":""),type:D.MessageTypes.ERROR,details:w.messages.layerTypeNotSupported+
" "+c.layerType,collapsed:!1})}.bind(this));var r=new g,s=setTimeout(function(){r.reject("webscene not resolved on time")},2E4);if(0===n.length)return r.isResolved()||r.resolve({layers:q,slides:this.presentation.slides}),r;var h=n.length;for(c=0;c<n.length;c++)n[c].always(function(a,c){h--;a.isResolved()?c instanceof A?q.push(c):c&&c.layers&&(q=q.concat(c.layers)):D.show({message:w.messages.addLayerFailed,type:D.MessageTypes.ERROR,details:c.msg||c.message,collapsed:!1});0===h&&(clearTimeout(s),r.resolve({layers:q,
slides:this.presentation.slides}))}.bind(this,n[c]));r.then(function(c){a.layers.forEach(function(a){void 0!==a._websceneIndex&&delete a._websceneIndex})});return r},_validate:function(){if("global"===this.viewingMode){if(!$(this.spatialReference))throw Error(w.messages.websceneGlobalSR);var a=[];this.initialState&&this.initialState.viewpoint&&(this.initialState.viewpoint.camera&&a.push(this.initialState.viewpoint.camera.position.spatialReference),this.initialState.viewpoint.targetGeometry&&a.push(this.initialState.viewpoint.targetGeometry.spatialReference));
this.presentation&&this.presentation.slides&&this.presentation.slides.forEach(function(c){c.viewpoint&&(c.viewpoint.camera&&a.push(c.viewpoint.camera.position.spatialReference),c.viewpoint.targetGeometry&&a.push(c.viewpoint.targetGeometry.spatialReference))});if(!a.every(aa))throw Error(w.messages.websceneGlobalEmbeddedSR);}else if(C.isGeographicCRS(this.spatialReference))throw Error(w.messages.websceneLocalSRGCS);}});m.mixin(U,{getFromUrl:function(a,c){var b=new g,d=new q(a);n({url:d.useSSL(window.location.protocol,
c)}).then(function(a){var c=U.checkVersion(a.version);if(c.isCompatible)try{var d=new U(a);b.resolve(d)}catch(f){b.reject(f.message)}else b.reject(c.message)},function(a){b.reject(a)});return b},getFromPortalItem:function(a,c){var d=new g,f=a.getItem(c).then(function(e){f=e;a.getItemData(c).then(function(e){var n=U.checkVersion(e.version);if(n.isCompatible)try{var g=new U(e);g.set("portalItemProperties",f);d.resolve(g);a.isSignedIn()||b(a,"sign-in",function(){a.getItem(c).then(function(a){g.set("portalItemProperties",
a)})})}catch(q){d.reject(q.message)}else d.reject(n.message)})},function(a){d.reject(a)});return d},addLayerHandlers:function(a){for(var c=0;c<a.length;c++)G.addHandler(a[c])},_getLayerHandlers:function(){return G.getHandlers()},addLayerByItemId:function(a,c,b,d,f){var e=new g;this.addContentByItemId(a,c,b,d,f).then(function(c){a.layers.forEach(function(a){void 0!==a._websceneIndex&&delete a._websceneIndex});e.resolve(c)},function(a){e.reject(a)});return e},addContentByItemId:function(a,c,b,d,f,e){var n=
this,q=new g;c.getItem(b).then(function(g){c.getItemData(b).then(function(p){p&&p.hasOwnProperty("_ssl")&&delete p._ssl;"Scene Service"===g.type?n._addSceneServiceItem(a,c,g,b,p,d,e).then(q.resolve,q.reject):"Web Scene"==g.type?n._importWebSceneItem(a,c,f,g,p).then(q.resolve,q.reject):n._doAddLayerByItemId(a,c,b,g,p,d,e).then(q.resolve,q.reject)},function(a){q.reject(a)})},function(a){q.reject(a)});q.then(function(a){if(a&&0<a.length)for(var c=0;c<a.length;c++)a[c][0]&&a[c][0].warning&&D.show({message:a[c].warning,
type:D.MessageTypes.WARNING,details:w.messages.itemId+" "+b+"\x3cbr\x3e"+w.messages.itemType+" "+a[c].type});console.log("layer added by item id: "+b)},function(a){D.show({message:a.itemType&&"WebScene"===a.itemType?w.messages.sceneRejectTitle:w.messages.addLayerFailed,type:D.MessageTypes.ERROR,details:(a.msg?a.msg+"\x3cbr\x3e"||"":"")+w.messages.itemId+" "+b,collapsed:!1})});return q.promise},_doAddLayerByItemId:function(a,c,b,d,f,n,q){var p=this,r=[];q=q?q:this.spatialReferenceLocked?0:1;if(!f||
0===Object.keys(f).length){var s=m.mixin({url:d.url,itemId:b,title:d.title,opacity:d.opacity,visibility:d.visibility,thumbnailUrl:d.thumbnailUrl},n);s.portalLayerItem={item:d,itemData:f};for(var h in s)null==s[h]&&delete s[h];h=p.addLayerToMapByUrl(a,s,c,q);r.push(h)}else if(("Feature Service"===d.type||"Scene Service"===d.type)&&f){var k=function(e,q,g,r){g=n&&n.url||d.url;null==g.match(/\/\d+\/?$/)&&null!=e.id&&("Scene Service"===d.type&&(g+="/layers"),g=g+"/"+e.id);delete e.id;g=m.mixin(e,{url:g,
itemId:b,opacity:d.opacity,visibility:d.visibility,thumbnailUrl:d.thumbnailUrl});g=U.mixLayerItemWithWebSceneOverrides(g,n);g.portalLayerItem={item:d,itemData:f};g.layerIndex=void 0!==e.layerIndex?e.layerIndex:q;for(var h in g)null==g[h]&&delete g[h];return p.addLayerToMapByUrl(a,g,c,r)};if(f.layers)if(n&&n.url&&null!=n.url.match(/\/\d+\/?$/)&&0<n.url.match(/\/\d+\/?$/).length){h=n.url.match(/\/\d+\/?$/)[0];h=Number(h.replace(/\//g,""));for(s=0;s<f.layers.length;s++)if(f.layers[s]&&f.layers[s].id==
h){r.push(k(f.layers[s],h,f.layers,q));break}}else{if("Scene Service"===d.type&&q){var v=q,l=e(null),x=[];f.layers.forEach(function(a,c,b){l=l.then(function(){return k(a,c,b,v)}).then(function(a){a instanceof A?x.push(a):x=x.concat(a.layers);0<x.length&&(v=0)}).otherwise(function(a){this._showLayerAddError(a.msg)}.bind(this))}.bind(this));return l=l.then(function(){return{layers:x}})}f.layers.forEach(function(a,c,b){r.push(k(a,c,b,q))})}else r.push(k({},null,[],q))}else if("Map Service"===d.type){h=
m.mixin({url:d.url,itemId:b,title:d.title,opacity:d.opacity,visibility:d.visibility,thumbnailUrl:d.thumbnailUrl},n);f&&(h.layerDefinition={minScale:f.minScale,maxScale:f.maxScale});h.portalLayerItem={item:d,itemData:f};for(s in h)null==h[s]&&delete h[s];var t=new g;r.push(t);p.addLayerToMapByUrl(a,h,c,q).then(function(a){t.resolve(a);D.show({message:w.messages.layerItemPropertiesFromMapServer,type:D.MessageTypes.WARNING})},function(a){t.reject(a)})}else if("Image Service"===d.type){h=m.mixin(f,{url:d.url,
itemId:b,title:d.title,opacity:d.opacity,visibility:d.visibility,thumbnailUrl:d.thumbnailUrl});h=U.mixLayerItemWithWebSceneOverrides(h,n);h.portalLayerItem={item:d,itemData:f};for(var C in h)null==h[C]&&delete h[C];h=p.addLayerToMapByUrl(a,h,c,q);r.push(h)}else{var B=new g;r.push(B);setTimeout(function(){B.reject({msg:w.messages.layerItemTypeNotSupported+" "+d.type})},0)}var M=r;if(1<M.length){var E=[],M=new g;for(h=0;h<r.length;h++)r[h].always(function(a,c){r.splice(r.indexOf(a),1);a.isResolved()?
c instanceof A?E.push(c):E=E.concat(c.layers):this._showLayerAddError(c.msg);0===r.length&&(0<E.length?M.resolve({layers:E}):M.reject())}.bind(this,r[h]))}else M=r[0];return M},_showLayerAddError:function(a){D.show({message:w.messages.addLayerFailed,type:D.MessageTypes.ERROR,details:a,collapsed:!1})},_addSceneServiceItem:function(a,c,b,d,f,e,n){var q=new g,p=this,r=new g;c.getRelatedItems(d).then(function(a){if(a&&1===a.total&&a.relatedItems&&0<a.relatedItems.length){for(var b=!1,d=0;!b&&d<a.relatedItems.length;)"Feature Service"===
a.relatedItems[d].type&&(b=!0,c.getItemData(a.relatedItems[d].id).then(function(a){a&&(a.layers&&1===a.layers.length)&&(null==e&&(e={}),e.popupInfo=a.layers[0].popupInfo,e.disablePopup=a.layers[0].disablePopup);r.resolve()},r.reject.bind(r))),d++;b||r.resolve()}else r.resolve()},r.reject.bind(r));r.promise.always(function(){p._doAddLayerByItemId(a,c,d,b,f,e,n).then(function(a){q.resolve(a)},function(a){q.reject(a)})});return q},_uniqueLayersIds:function(a,c,b){for(var d=0;d<a.length;d++){var f=a[d];
"GroupLayer"===f.layerType&&f.layers&&this._uniqueLayersIds(f.layers,c,b);var e=b[f.id];if(void 0!==e)f.id=e;else if(c.getLayer(f.id)){var e=f.id,n=e.match(/(.*-layer)(\d+)$/),g;n?(g=n[1],n=parseInt(n[2],10)):(g=e+"-",n=0);for(;c.getLayer(e);)n++,e=g+n.toString();e!==f.id&&(b[f.id]=e,f.id=e)}}},updateUniqueLayerIds:function(a,c){var b={};this._uniqueLayersIds(a.operationalLayers,c,b);a.presentation.slides.forEach(function(a){for(var c=0;c<a.visibleLayers.length;c++){var d=a.visibleLayers[c],f=b[d.id];
void 0!==f&&(d.id=f)}})},_importWebSceneItem:function(a,c,b,d,f){var e=new g,n=U.checkVersion(f.version);if(n.isCompatible)try{var q=new U(f),p=window._webSceneViewerView;if("spherical"===p.globeMode&&"local"===q.viewingMode)e.reject({itemType:"WebScene",msg:w.messages.sceneRejectL2G});else if("planar"===p.globeMode&&"global"===q.viewingMode)e.reject({itemType:"WebScene",msg:w.messages.sceneRejectG2L});else{if(q.spatialReference.equals(a.spatialReference))return U.updateUniqueLayerIds(q,a),q.set("portalItemProperties",
d),q.presentation.updateUniqueSlideIds(b.presentation.slides),q.presentation&&q.presentation.slides&&(q.presentation.slides.getAll().forEach(function(a){b.presentation.slides.addItem(a)}),b.set("presentation",b.presentation.toJSON())),q.applyToMap(a,null,c,{basemap:!1,initialState:!1});e.reject({itemType:"WebScene",msg:w.messages.sceneRejectSRTS})}}catch(r){e.reject({msg:r.message})}else e.reject({msg:n.message});return e},_updateDfd:function(a,c,b,d){if(0<c){if(a.resolve({layers:b}),0<d.length)for(c=
0;c<d.length;c++)this._showLayerAddError(d[c].msg)}else if(0<d.length){for(c=1;c<d.length;c++)this._showLayerAddError(d[c].msg);a.reject(d[0])}return a},_showBasemapDropConfirmDialog:function(a,c){var b=U._dropBasemapDialog.on("confirm",function(){d.remove();b.remove();a.resolve({dropBasemap:c})}.bind(this)),d=U._dropBasemapDialog.on("cancel",function(){d.remove();b.remove();a.resolve({dropBasemap:0})}.bind(this));U._dropBasemapDialog.show()},_checkForBasemapDropMapOrImageLayer:function(a,c,b,d,f,
e){d?(a=a instanceof x?a.clone():x.fromJSON(a),!a.equals(b)||c.basemapTerrain&&!c.basemapTerrain.tilingScheme.compatibleWith(d)?1===e&&"planar"===c.globeMode?this._showBasemapDropConfirmDialog(f,e):2===e?f.resolve({dropBasemap:e}):f.resolve({dropBasemap:0}):f.resolve({dropBasemap:0})):f.resolve({dropBasemap:0})},_checkForBasemapDropSceneLayer:function(a,c,b,d,f){a=Y(a);b=a.equals(b)?!0:b.isWebMercator()&&4326===a.wkid?!0:!1;b?d.resolve({dropBasemap:0}):1===f&&"planar"===c.globeMode?this._showBasemapDropConfirmDialog(d,
f):2===f?d.resolve({dropBasemap:f}):d.resolve({dropBasemap:0})},_checkForBasemapDrop:function(a,c){var b=new g;0!==a&&0<c.length?G.prepareOpLayerFromService(c[0],a).then(function(d){d=d.serviceInfo;var f=d.tileInfo instanceof s?d.tileInfo:s.fromJSON(d.tileInfo),e=c[0].serviceDetails.serviceType,n=window._webSceneViewerView,q=n.map.spatialReference,g=d.spatialReference;"MapServer"===e?this._checkForBasemapDropMapOrImageLayer(g,n,q,f,b,a):"ImageServer"===e?this._checkForBasemapDropMapOrImageLayer(g,
n,q,f,b,a):"FeatureServer"===e?b.resolve({dropBasemap:0}):("SceneServerLocal"===e||"SceneServer"===e)&&this._checkForBasemapDropSceneLayer(d,n,q,b,a)}.bind(this),function(a){b.resolve({dropBasemap:0,error:a})}):b.resolve({dropBasemap:0});return b.promise},addLayerToMapByUrl:function(a,c,b,d){c.url=G.useSSLIfRequired(c.url,b);var f=new g,e=[],n=[],q=[],p=0;G.prepareFromServiceUrl(c.url,c).then(function(g,r){var h=[];this._checkForBasemapDrop(d,r.services).then(function(d,f){for(var s=0;s<r.services.length;s++)h.push(G.prepareOpLayerFromService(r.services[s],
f.dropBasemap));var v=r.services.length;if(0===h.length)return g.resolve(),g.promise;for(var l=h.slice(0),x=0;x<h.length;x++)h[x].promise.always(function(d,r){var s=h.indexOf(d);h.splice(s,1);var t;if(d.isResolved())p++,s=c.layerIndex,void 0===s&&(s=l.length-l.indexOf(d)),r.layerIndex=s,r.id=c.id,r.visibility=c.visibility,r.opacity=c.opacity,r.layerDefinition=c.layerDefinition,r.minScale=c.minScale,r.maxScale=c.maxScale,r.visibilityMode=c.visibilityMode,r.listMode=c.listMode,r.popupInfo=c.popupInfo,
r.showLabels=c.showLabels,r.showLegend=void 0===c.showLegend?!0:c.showLegend,r.portalLayerItem=c.portalLayerItem,r.originalOperationalLayer=c.originalOperationalLayer,r.thumbnailUrl=c.thumbnailUrl,r.disablePopup=c.disablePopup,t=T(r,a,b,f.dropBasemap),e.push(t);else if(d.isRejected()&&(0===s&&f.error?q.push(f.error):q.push(r)),v--,0===v)return g=this._updateDfd(g,p,n,q),g.promise;if(t){var C=0;k(t).always(function(a,c){e.splice(e.indexOf(e[x]),1);for(var b=0;b<a.length;b++){var d=a[b],f=c[b];d.isResolved()?
(f instanceof A?n.push(f):n=n.concat(f.layers),C++):d.isRejected()&&(null==f&&(!Array.isArray(c)&&c.hasOwnProperty("error"))&&(console.error(w.messages.layerCreationErrorGeneric+" "+c.error),f={msg:w.messages.layerCreationErrorGeneric}),q.push(f))}v--;0===v&&(g=this._updateDfd(g,C,n,q))}.bind(this,t))}}.bind(this,h[x]),function(a,c){a.reject(c)}.bind(this,g))}.bind(this,f),function(a){g.reject(a)})}.bind(this,f),function(a,c){a.reject(c)}.bind(this,f));return f.promise},mixLayerItemWithWebSceneOverrides:function(a,
c){if(null==c)return a;if(null==a)return c;for(var b=Object.keys(a).concat(Object.keys(c)).concat(),d=0;d<b.length;++d)for(var f=d+1;f<b.length;++f)b[d]===b[f]&&b.splice(f--,1);for(d=0;d<b.length;d++)f=b[d],"layerDefinition"===f&&a.hasOwnProperty(f)&&c.hasOwnProperty(f)?a[f]=m.mixin(a[f],c[f]):c.hasOwnProperty(f)&&(a[f]=c[f]);return a},checkVersion:function(a){if(null==a)return{isCompatible:!1,version:{major:null,minor:null},message:w.messages.websceneLoadFail+"\x3cbr\x3e"+w.messages.websceneLoadFailNoVersion};
var c="string"===typeof a?a.split("."):[],b=2===c.length?parseInt(c[0],10):null,c=2===c.length?parseInt(c[1],10):null;return null===b||null===c?{isCompatible:!1,version:{major:null,minor:null},message:w.messages.websceneLoadFail+"\x3cbr\x3e"+d.substitute(w.messages.websceneLoadFailBadVersion,{websceneVersion:a})}:1>b&&!(0===b&&94===c)?{isCompatible:!1,version:{major:b,minor:c},message:w.messages.websceneLoadFail+"\x3cbr\x3e"+d.substitute(w.messages.websceneLoadFailIncompatVersion,{websceneVersion:a})+
" "+d.substitute(w.messages.websceneVersionRequires,{websceneRequiredVersion:"1.x"})}:1<b?{isCompatible:!1,version:{major:b,minor:c},message:w.messages.websceneLoadFail+"\x3cbr\x3e"+d.substitute(w.messages.websceneLoadFailIncompatVersion,{websceneVersion:a})+" (1.3)"}:{isCompatible:!0,version:{major:b,minor:c},message:""}}});U.spatialReferenceLocked=!1;U._dropBasemapDialog=new N({title:w.messages.basemapDropTitle,message:w.messages.basemapDrop,confirm:w.messages.basemapDropConfirm});return U})},"dojox/charting/action2d/PlotAction":function(){define(["dojo/_base/connect",
"dojo/_base/declare","./Base","dojo/fx/easing","dojox/lang/functional"],function(l,m,h,k,g){var b=k.backOut;return m("dojox.charting.action2d.PlotAction",h,{overOutEvents:{onmouseover:1,onmouseout:1},constructor:function(d,e,a){this.anim={};a||(a={});this.duration=a.duration?a.duration:400;this.easing=a.easing?a.easing:b},connect:function(){this.handle=this.chart.connectToPlot(this.plot.name,this,"process")},disconnect:function(){this.handle&&(l.disconnect(this.handle),this.handle=null)},reset:function(){},
destroy:function(){this.inherited(arguments);g.forIn(this.anim,function(b){g.forIn(b,function(b){b.action.stop(!0)})});this.anim={}}})})},"dojox/charting/plot2d/commonStacked":function(){define(["dojo/_base/lang","./common"],function(l,m){var h=l.getObject("dojox.charting.plot2d.commonStacked",!0);return l.mixin(h,{collectStats:function(k){for(var g=l.delegate(m.defaultStats),b=0;b<k.length;++b)for(var d=k[b],e=0;e<d.data.length;e++){var a,c;null!==d.data[e]&&("number"==typeof d.data[e]||!d.data[e].hasOwnProperty("x")?
(c=h.getIndexValue(k,b,e)[0],a=e+1):(a=d.data[e].x,null!==a&&(c=h.getValue(k,b,a)[0],c=null!=c&&c.y?c.y:null)),g.hmin=Math.min(g.hmin,a),g.hmax=Math.max(g.hmax,a),g.vmin=Math.min(g.vmin,c),g.vmax=Math.max(g.vmax,c))}return g},getIndexValue:function(h,g,b){var d=0,e,a,c;for(a=0;a<=g;++a)h[a].hidden||(c=d,e=h[a].data[b],null!=e&&(isNaN(e)&&(e=e.y||0),d+=e));return[d,c]},getValue:function(h,g,b){var d=null,e,a,c,f;for(e=0;e<=g;++e)if(!h[e].hidden)for(a=0;a<h[e].data.length;a++)if(f=d,c=h[e].data[a],
null!==c)if(c.x==b){d||(d={x:b});null!=c.y&&(null==d.y&&(d.y=0),d.y+=c.y);break}else if(c.x>b)break;return[d,f]}})})},"dojox/gfx/fx":function(){define("dojo/_base/lang ./_base ./matrix dojo/_base/Color dojo/_base/array dojo/_base/fx dojo/_base/connect dojo/sniff".split(" "),function(l,m,h,k,g,b,d,e){function a(a,c){this.start=a;this.end=c}function c(a,c,b){this.start=a;this.end=c;this.units=b}function f(a,c){this.start=a;this.end=c;this.temp=new k}function n(a){this.values=a;this.length=a.length}
function r(a,c){this.values=a;this.def=c?c:{}}function q(a,c){this.stack=a;this.original=c}function p(a,c,b,d){if(a.values)return new n(a.values);var e,q;q=a.start?m.normalizeColor(a.start):e=c?b?c[b]:c:d;a.end?a=m.normalizeColor(a.end):(e||(e=c?b?c[b]:c:d),a=e);return new f(q,a)}var v=m.fx={};a.prototype.getValue=function(a){return(this.end-this.start)*a+this.start};c.prototype.getValue=function(a){return(this.end-this.start)*a+this.start+this.units};f.prototype.getValue=function(a){return k.blendColors(this.start,
this.end,a,this.temp)};n.prototype.getValue=function(a){return this.values[Math.min(Math.floor(a*this.length),this.length-1)]};r.prototype.getValue=function(a){var c=l.clone(this.def),b;for(b in this.values)c[b]=this.values[b].getValue(a);return c};q.prototype.getValue=function(a){var c=[];g.forEach(this.stack,function(b){if(b instanceof h.Matrix2D)c.push(b);else if("original"==b.name&&this.original)c.push(this.original);else if("matrix"==b.name){if(b.start instanceof h.Matrix2D&&b.end instanceof
h.Matrix2D){var d=new h.Matrix2D,f;for(f in b.start)d[f]=(b.end[f]-b.start[f])*a+b.start[f];c.push(d)}}else b.name in h&&(d=h[b.name],"function"!=typeof d?c.push(d):(f=g.map(b.start,function(c,d){return(b.end[d]-c)*a+c}),d=d.apply(h,f),d instanceof h.Matrix2D&&c.push(d)))},this);return c};var x=new k(0,0,0,0);v.animateStroke=function(c){c.easing||(c.easing=b._defaultEasing);var f=new b.Animation(c),e=c.shape,q;d.connect(f,"beforeBegin",f,function(){q=e.getStroke();var b=c.color,d={},f;b&&(d.color=
p(b,q,"color",x));if((b=c.style)&&b.values)d.style=new n(b.values);if(b=c.width){var g=b;g.values?f=new n(g.values):(b=g.start?g.start:f=q?q.width:1,g.end?f=g.end:"number"!=typeof f&&(f=q?q.width:1),f=new a(b,f));d.width=f}if((b=c.cap)&&b.values)d.cap=new n(b.values);if(b=c.join)b.values?d.join=new n(b.values):(f=b.start?b.start:q&&q.join||0,b=b.end?b.end:q&&q.join||0,"number"==typeof f&&"number"==typeof b&&(d.join=new a(f,b)));this.curve=new r(d,q)});d.connect(f,"onAnimate",e,"setStroke");return f};
v.animateFill=function(a){a.easing||(a.easing=b._defaultEasing);var c=new b.Animation(a),f=a.shape,e;d.connect(c,"beforeBegin",c,function(){e=f.getFill();var c=a.color;c&&(this.curve=p(c,e,"",x))});d.connect(c,"onAnimate",f,"setFill");return c};v.animateFont=function(a){a.easing||(a.easing=b._defaultEasing);var f=new b.Animation(a),e=a.shape,q;d.connect(f,"beforeBegin",f,function(){q=e.getFont();var b=a.style,d={},f,g;b&&b.values&&(d.style=new n(b.values));if((b=a.variant)&&b.values)d.variant=new n(b.values);
if((b=a.weight)&&b.values)d.weight=new n(b.values);if((b=a.family)&&b.values)d.family=new n(b.values);if((b=a.size)&&b.units)f=parseFloat(b.start?b.start:e.font&&e.font.size||"0"),g=parseFloat(b.end?b.end:e.font&&e.font.size||"0"),d.size=new c(f,g,b.units);this.curve=new r(d,q)});d.connect(f,"onAnimate",e,"setFont");return f};v.animateTransform=function(a){a.easing||(a.easing=b._defaultEasing);var c=new b.Animation(a),f=a.shape,n;d.connect(c,"beforeBegin",c,function(){n=f.getTransform();this.curve=
new q(a.transform,n)});d.connect(c,"onAnimate",f,"setTransform");if("svg"===m.renderer&&10<=e("ie"))var p=[d.connect(c,"onBegin",c,function(){for(var a=f.getParent();a&&a.getParent;)a=a.getParent();a&&(f.__svgContainer=a.rawNode.parentNode)}),d.connect(c,"onAnimate",c,function(){try{if(f.__svgContainer){var a=f.__svgContainer.style.visibility;f.__svgContainer.style.visibility="visible";f.__svgContainer.style.visibility=a}}catch(c){}}),d.connect(c,"onEnd",c,function(){g.forEach(p,d.disconnect);if(f.__svgContainer){var a=
f.__svgContainer.style.visibility,c=f.__svgContainer;f.__svgContainer.style.visibility="visible";setTimeout(function(){try{c.style.visibility=a,c=null}catch(b){}},100)}delete f.__svgContainer})];return c};return v})},"webSceneViewer/assertUtils":function(){define([],function(){function l(l){this.message=l}l.prototype.toString=function(){return"AssertException: "+this.message};return{AssertException:l,assert:function(m,h){if(!m){var k=Error("dummy");k.stack&&console.log(k.stack);throw new l(h);}}}})},
"webSceneViewer/UIUtils":function(){define(["dojo/dom-class","dojo/_base/window","dojo/NodeList-traverse","dojo/query"],function(l,m,h,k){var g={fadeIn:function(b){l.add(b,"navFadeIn");l.remove(b,"navFadeOut")},fadeOut:function(b){l.add(b,"navFadeOut");l.remove(b,"navFadeIn")},autoHide:function(b,d,e,a){function c(){f();L=setTimeout(function(){L=void 0;r()},s?M:C)}function f(){L&&(clearTimeout(L),L=void 0)}function n(){f();a&&a();b.forEach(function(a,c){a?g.fadeIn(a):0<k("."+a.id).length&&k("."+a.id).forEach(function(a){g.fadeIn(a)})})}
function r(){f();e&&e();b.forEach(function(a){a?g.fadeOut(a):0<k("."+a.id).length&&k("."+a.id).forEach(function(a){g.fadeOut(a)})})}function q(a){var f=A-a.clientY;if(0!==t-a.clientX||0!==f||"mousedown"===a.type){t=a.clientX;A=a.clientY;var e=document.elementFromPoint(t,A),q=!1;(s=e&&(e.id==d.id||1==k(e).parents("#"+d.id).length))&&n();e&&b.forEach(function(a){q=q||e.id==a.id&&""!==e.id||l.contains(e,"navFadeIn")||l.contains(e,"navFadeOut")||0<k(e).parents(".navFadeOut").length||0<k(e).parents(".navFadeIn").length});
q||c()}}function p(a){null==a.toElement&&null==a.relatedTarget&&(s=!1,c())}function h(a){n();c()}b=b||[];var x=/Firefox/i.test(navigator.userAgent),C=100,M=2500,L,t=-100,A=-100,s=!1;return{start:function(){this.stop();m.doc.addEventListener("mousedown",q);m.doc.addEventListener("mousemove",q);m.doc.addEventListener("mouseout",p);d.addEventListener(x?"DOMMouseScroll":"mousewheel",h)},stop:function(){m.doc.removeEventListener("mousedown",q);m.doc.removeEventListener("mousemove",q);m.doc.removeEventListener("mouseout",
p);d.removeEventListener(x?"DOMMouseScroll":"mousewheel",h);n()},forceHide:function(){r()},show:function(){n()}}},toggleFullScreen:function(b){!document.fullscreenElement&&!document.msFullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement?(b.msRequestFullscreen?b.msRequestFullscreen():b.requestFullscreen&&b.requestFullscreen(),b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen&&b.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)):(document.msExitFullscreen?
document.msExitFullscreen():document.exitFullscreen&&document.exitFullscreen(),document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())},isFullScreenEnabled:function(){return document.msFullscreenEnabled||document.mozFullScreenEnabled||document.mozFullscreenEnabled||document.webkitFullscreenEnabled?!0:!1}};return g})},"webSceneViewer/webScene/WebSceneLayers":function(){define("dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/request/xhr esri/request esri/config esri/geometry/Extent esri/geometry/SpatialReference webSceneViewer/spatialReferenceUtils esri/layers/SceneLayer esri/layers/FeatureLayer esri/layers/ArcGISTiledLayer esri/layers/ArcGISDynamicLayer esri/layers/ArcGISElevationLayer esri/layers/GroupLayer esri/layers/OpenStreetMapLayer esri/layers/support/TileInfo esri/views/3d/terrain/TilingScheme esri/views/3d/terrain/TerrainSurface dojo/i18n!webSceneViewer/nls/viewer".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n,r,q,p,v,x,C,M,L,t){function A(c){d.geometryService&&require(["dojo/on","esri/geometry/support/webMercatorUtils"],function(b,f){b.once(c,"load",function(){var b=c.fullExtent;b&&(102100===b.spatialReference.wkid||(3857===b.spatialReference.wkid||4326===b.spatialReference.wkid)||require(["esri/tasks/GeometryService","esri/tasks/support/ProjectParameters"],function(f,e){var n=d.geometryService,q=new e;q.geometries=[b];q.outSR=a.WebMercator;n.project(q).then(function(a){a&&
0<a.length&&c.set("fullExtent",a[0])})}))})})}function s(a){var c=null,b=a.search(/\/rest\/services\//i);0<b&&(c=a.substring(0,b+6));return c}function B(a){var c=document.createElement("a");c.href=a;a=c.hostname;for(var c=[".arcgis.com",".arcgisonline.com"],b=0;b<c.length;b++){var d=c[b];if(-1!==a.indexOf(d,a.length-d.length))return!0}return!1}function y(a){a instanceof C||(a=C.fromJSON(a));return M.WebMercatorAuxiliarySphere.compatibleWith(a)}function u(a,c){a instanceof C||(a=C.fromJSON(a));var b=
c.basemapTerrain&&c.basemapTerrain.tilingScheme;return b?b.compatibleWith(a):!0}function E(a,c){var b=L.checkUnsupported(a.tileInfo,a.fullExtent);if(b)return c.reject({msg:I(b)+H(a)}),!0}function I(a){switch(a.name){case "tilingscheme:gaps":return t.messages.tilingSchemeGaps;case "tilingscheme:power-of-two":return t.messages.tilingSchemePowerOfTwo;case "tilingscheme:tile-size":return t.messages.tilingSchemeTileSize;case "terrainsurface:num-root-tiles":return a.message;default:return t.messages.tilingSchemeGeneric}}
function z(b,d,f,e,n){if(d.tileInfo){b=B(b);if(!b&&10.22>f.currentVersion)return e.reject({msg:t.messages.tiledMapServicesMinVersion+H(d)}),!1;if(!b&&10.22===f.currentVersion&&!f._isCorsPatchDetected)return e.reject({msg:t.messages.tiledMapServicesMinVersionPatch+" "+t.messages.patchRequired+"\x3cbr\x3eArcGIS 10.2.2 for Server Patch - View Map and Image Services in the ArcGIS Online Scene Viewer"}),!1;f=window._webSceneViewerView;b=d.spatialReference instanceof a?d.spatialReference.clone():a.fromJSON(d.spatialReference);
var q=f.map.spatialReference,g="planar"===f.globeMode&&1===n;n=2===n;if(!n&&(!g||"spherical"===f.globeMode)&&!b.equals(q))return n=q.isWebMercator()?t.messages.tiledMapServicesSR+" Create a new local scene to add this layer.":t.messages.tiledMapServicesSRGeneric+" ("+q.wkid+")",e.reject({msg:n+H(d)}),!1;if(c.isGeographicCRS(b))return e.reject({msg:t.messages.tiledMapServiceSRGCS+H(d)}),!1;if("spherical"===f.globeMode){if(!n&&!y(d.tileInfo))return e.reject({msg:t.messages.tiledMapServicesTilingScheme+
H(d)}),!1}else if(!n&&!g&&!u(d.tileInfo,f))return e.reject({msg:t.messages.tiledMapServicesSRGeneric+H(d)}),!1;return E(d,e)?!1:"ArcGISTiledMapServiceLayer"}return"ArcGISMapServiceLayer"}function H(a){return a.name&&""!==a.name?"\x3cbr\x3e"+t.messages.serviceName+": "+a.name:""}function J(b,d,f){if(b.tileInfo){var e=b.spatialReference instanceof a?b.spatialReference.clone():a.fromJSON(b.spatialReference),n="LERC"===b.tileInfo.format,q=window._webSceneViewerView,g=q.map.spatialReference,p="planar"===
q.globeMode&&1===f;f=2===f;if(!f&&(!p||"spherical"===q.globeMode)&&!e.equals(g))return e=n?"spherical"===q.globeMode?t.messages.elevationImageServicesSR+" Create a new local scene to add this layer.":t.messages.tiledElevationServicesSRGeneric+" ("+g.wkid+")":"spherical"===q.globeMode?t.messages.imageServicesSR+" Create a new local scene to add this layer.":t.messages.tiledImageServicesSRGeneric+" ("+g.wkid+")",d.reject({msg:e+H(b)}),!1;if(c.isGeographicCRS(e))return d.reject({msg:t.messages.tiledMapServiceSRGCS+
H(b)}),!1;if("spherical"===q.globeMode){if(!f&&!y(b.tileInfo))return e=n?t.messages.elevationImageServicesTilingScheme:t.messages.tiledImageServicesTilingScheme,d.reject({msg:e+H(b)}),!1}else if(!p&&!f&&!u(b.tileInfo,q))return e=n?t.messages.tiledElevationServicesSRGeneric+H(b):t.messages.tiledImageServicesSRGeneric+H(b),d.reject({msg:e}),!1;return E(b,d)?!1:n?"ArcGISTiledElevationServiceLayer":"ArcGISTiledImageServiceLayer"}e=n?t.messages.elevationImageServicesCached:t.messages.imageServicesCached;
d.reject({msg:e+H(b)});return!1}function G(b,d,f){if(b){var e;e=l.exists("spatialReference.wkid",b)?new a(b.spatialReference.wkid):new a(4326);var n=window._webSceneViewerView,q=n.map.spatialReference,g="planar"===n.globeMode&&1===f;if(f=2!==f){if(g=!g||"spherical"===n.globeMode)g=e.equals(q)?!0:q.isWebMercator()&&4326===e.wkid?!0:!1,g=!g;f=g}return f?(e="spherical"===n.globeMode?t.messages.sceneLayerSRWM+" Create a new local scene to add this layer.":t.messages.sceneLayerSR+" ("+q.wkid+")",d.reject({msg:e+
H(b)}),!1):"planar"===n.globeMode&&c.isGeographicCRS(e)?(d.reject({msg:t.messages.sceneLayerSRGCS+H(b)}),!1):(e=b.drawingInfo&&b.drawingInfo.renderer&&b.drawingInfo.renderer.type)&&!w.isFeatureServiceRendererSupported(e)?(d.reject({msg:t.messages.featureServiceNotSupportedRendererType+" "+e+H(b)}),!1):!0}}function F(a,c,b){if(a.type&&"Table"===a.type)return b.reject({msg:t.messages.featureServiceNotSupportedTable+H(a)}),!1;if(a.geometryType&&"esriGeometryMultiPatch"===a.geometryType)return b.reject({msg:t.messages.featureServiceNotSupportedMultipatch+
H(a)}),!1;if(a.geometryType&&"esriGeometryMultipoint"===a.geometryType)return b.reject({msg:"Multipoint Feature Services are not supported"+H(a)}),!1;var d=a.drawingInfo&&a.drawingInfo.renderer&&a.drawingInfo.renderer.type;if(!d)return b.reject({msg:t.messages.featureServiceNotSupportedNoRenderer+H(a)}),!1;if(!w.isFeatureServiceRendererSupported(d))return b.reject({msg:t.messages.featureServiceNotSupportedRendererType+" "+d+H(a)}),!1;if(c.count>D)b.reject({msg:t.messages.featureServiceNotSupportedMaxFeatures+
" "+c.count+"/"+D+H(a)});else return!0}function K(a){return a&&a.replace(/_/g," ").replace(/\/$/,"")}var D=2E3,N=["simple","classBreaks","uniqueValue"],w={create:function(a){for(var c,b=0;b<w.layerHandlers.length;b++)if(w.layerHandlers[b].condition(a)){c=w.layerHandlers[b].create(a);break}return c},addHandler:function(a){w.layerHandlers.push(a)},getHandlers:function(){return w.layerHandlers},layerHandlers:[{name:"ArcGISSceneServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&
"ArcGISSceneServiceLayer"===a.layerType},create:function(a){return new f(a.url,w.evalOptions(a))}},{name:"ArcGISFeatureLayer",condition:function(a){return a.hasOwnProperty("layerType")&&"ArcGISFeatureLayer"===a.layerType},create:function(a){var b=w.evalOptions(a);b.mode=n.MODE_SNAPSHOT;b.returnZ=!0;b.outFields=["*"];a=new n(a.url,b);"spherical"===window._webSceneViewerView.globeMode?A(a):c.projectLayerExtentToSceneSR(a);return a}},{name:"ArcGISMapServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&
"ArcGISMapServiceLayer"===a.layerType},create:function(a){return new q(a.url,w.evalOptions(a))}},{name:"ArcGISTiledMapServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&"ArcGISTiledMapServiceLayer"===a.layerType},create:function(a){return new r(a.url,w.evalOptions(a))}},{name:"ArcGISTiledImageServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&"ArcGISTiledImageServiceLayer"===a.layerType},create:function(a){return new r(a.url,w.evalOptions(a))}},{name:"GroupLayer",
condition:function(a){return a.hasOwnProperty("layerType")&&"GroupLayer"===a.layerType},create:function(a){a=w.evalOptions(a);return new v(a)}},{name:"ArcGISTiledElevationServiceLayer",condition:function(a){return a.hasOwnProperty("layerType")&&"ArcGISTiledElevationServiceLayer"===a.layerType},create:function(c){var b=w.evalOptions(c);0<c.url.indexOf("s3-eu-west-1.amazonaws.com")&&(void 0===c.resourceInfo&&(console.warn("missing s3 elevation info"),c.resourceInfo={}),b.resourceInfo=c.resourceInfo,
void 0===c.resourceInfo.tileInfo&&(b.resourceInfo.tileInfo={lods:O}),b.resourceInfo.fullExtent=void 0===c.resourceInfo||void 0===c.resourceInfo.fullExtent?new e(-2.103750722959434E7,-2.197186888040859E7,2.103750722959434E7,2.1971868880408563E7,a.WebMercator):new e(c.resourceInfo.fullExtent));return new p(c.url,b)}}],evalOptions:function(a){var c={visible:void 0===a.visibility?!0:a.visibility,title:a.title};a.id&&(c.id=a.id);void 0!==a.opacity&&(c.opacity=a.opacity);void 0!==a.visibilityMode&&(c.visibilityMode=
a.visibilityMode);c.showLegend=void 0===a.showLegend?!0:a.showLegend;void 0!==a.listMode&&(c.listMode=a.listMode);a.layerDefinition&&a.layerDefinition.definitionExpression&&(c.definitionExpression=a.layerDefinition.definitionExpression);return c},isFeatureServiceRendererSupported:function(a){return-1!==N.indexOf(a)},prepareFromServiceUrl:function(a,c){var d=new k;if(!a)return d.reject({msg:t.messages.invalidUrl}),d.promise;var f=w.validateServerUrl(a),e=f.serviceType,n=f.hasLayer;if(!f.isValidUrl)return d.reject({msg:t.messages.invalidUrl+
" "+a}),d.promise;if("MapServer"===e&&n)f.serviceType="FeatureServer";else if("ImageServer"===e&&n)return d.reject({msg:t.messages.unsupportedUrl+" "+a}),d.promise;var q={url:a,params:c,serviceDetails:f};f.needsGetLayer?b({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a,b){if("SceneServer"===e){var n;(n=b.serviceVersion)?(n=n.split("."),n=!n||1>n.length?!1:"1"===n[0]):n=!1;if(!n){d.reject({msg:t.messages.sceneLayerVersion});return}}n=a.url;for(var q=[],g=0;g<
b.layers.length;g++){var p="SceneServer"===e?n+"/layers/"+b.layers[g].id:n+("/"===n.substr(n.length-1,1)?"":"/")+b.layers[g].id;q.push({url:p,params:c,serviceDetails:f})}d.resolve({services:q})}.bind(this,q),function(a){console.log("serviceInfo query on "+q.serviceType+" failed");d.reject(a)}):d.resolve({services:[q]});return d.promise},prepareOpLayerFromService:function(a,c){c=void 0===c?0:c;var f=new k,e=a.serviceDetails,n=e.serviceType,q=a.params,p=a.url,r=[],v=p;if("SceneServer"!==n)if("SceneServerLocal"===
n)n=document.createElement("a"),n.href=p,n=n.host,0>d.request.corsEnabledServers.indexOf(n)&&d.request.corsEnabledServers.push(n),e.hasLayer||(v=p+"/nodes/0/");else if("FeatureServer"===n)e=b({url:p+"/query",content:{f:"json",where:q&&q.layerDefinition&&q.layerDefinition.definitionExpression||"1\x3d1",returnCountOnly:!0},handleAs:"json",callbackParamName:"callback"}),r.push(e);else if("MapServer"===n&&!1===B(p)){var l=s(p);if(l){var x=new k;b({url:l+"services/",content:{f:"json"},handleAs:"json",
callbackParamName:"callback"}).then(function(a){10.22===a.currentVersion?g(l+"self?f\x3djson",{headers:{"X-Requested-With":null},timeout:1E4,handleAs:"json"}).then(function(c){a._isCorsPatchDetected=!c||c.error?!1:!0;x.resolve(a)},function(c){a._isCorsPatchDetected=!1;x.resolve(a)}):x.resolve(a)},x.reject.bind(x));r.push(x)}}a.layer?r.unshift(a.layer.then(function(){return a.layer})):(v=b({url:v,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),r.unshift(v));h(r).then(function(a,b,
d){var e,n=a.serviceDetails.serviceType,g=d[0],p;if("MapServer"===n){if(d=z(b,g,d[1],f,c))e=d,p=a.params.title||w.parseTitleFromLayerUrl(q.url)}else if("ImageServer"===n){if(d=J(g,f,c))e=d,p=a.params.title||K(g.name)}else"FeatureServer"===n?F(g,d[1],f)&&(e="ArcGISFeatureLayer",p=a.serviceDetails.needsGetLayer?(a.params.title||K(a.serviceDetails.serverName))+" - "+K(d[0].name):a.params.title||K(a.serviceDetails.serverName)+" - "+K(d[0].name)):"SceneServer"===n?G(g,f,c)&&(e="ArcGISSceneServiceLayer",
p=d[0].alias||d[0].name,p=a.serviceDetails.needsGetLayer?(a.params.title||K(a.serviceDetails.serverName))+" - "+K(p):a.params.title||K(a.serviceDetails.serverName)+" - "+K(p)):"SceneServerLocal"===n&&(p=e="ArcGISSceneServiceLayer");e?f.resolve({layerType:e,title:p,url:b,serviceInfo:g}):setTimeout(function(){f.reject({msg:"Unsupported service "+b})},50)}.bind(this,a,p),function(a,c){f.reject({msg:c.message,details:a})}.bind(this,p));return f},validateServerUrl:function(a){a=a.replace(/\/$/,"");a=a.split("?")[0];
var c=a.replace(/http.+\/(arcgis\/rest\/services|arcgis\/services)\/?/ig,"").match(/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|WMServer|SceneServer|SceneServerLocal)).*/ig);if(null==c)return{isValidUrl:!1};var b;c&&c[0]&&(b=a.split(c)[0].split("/").pop(),c=c[0].substr(1));c=c&&c.length?c.split("/"):!1;a=c[0];var c=c.splice(1),d=!1,f=!1,e=!1;"SceneServerLocal"===a&&(d=0===c.length||2===c.length&&"layers"===c[0]&&!isNaN(c[1]),
f=2===c.length,e=!f);if("SceneServer"===a)d=0===c.length||2===c.length&&"layers"===c[0]&&!isNaN(c[1]),f=2===c.length,e=!f;else if("FeatureServer"===a)d=0===c.length||1===c.length&&!isNaN(c[0]),f=1===c.length,e=!f;else if("MapServer"===a||"ImageServer"===a)d=0===c.length||1===c.length&&!isNaN(c[0]),f=1===c.length,e=!1;return{serviceType:a,hasLayer:f,isValidUrl:d,needsGetLayer:e,serverName:b}},extrapolateTypeFromLayerInstance:function(a){if(a instanceof f)return"ArcGISSceneServiceLayer";if(a instanceof
n)return"ArcGISFeatureLayer";if(a instanceof r)return a.capabilities?-1!==a.capabilities.split(",").indexOf("Map")?"ArcGISTiledMapServiceLayer":"ArcGISTiledImageServiceLayer":a.url?"ImageServer"===w.validateServerUrl(a.url).serviceType?"ArcGISTiledImageServiceLayer":"ArcGISTiledMapServiceLayer":"ArcGISTiledMapServiceLayer";if(a instanceof q)return"ArcGISMapServiceLayer";if(a instanceof p)return"ArcGISTiledElevationServiceLayer";if(a instanceof v)return"GroupLayer";if(a instanceof x)return"OpenStreetMap"},
URL_REGEXP:"^https?://[^/]+/([^/]+/)*(((SceneServer|MapServer|FeatureServer|ImageServer)((/layers)?/[0-9]+)?/?)|(SceneServerLocal(/([^/]+/?)*)?))$",parseTitleFromLayerUrl:function(a){var c=RegExp(w.URL_REGEXP);a=c.test(a)?K(a.replace(c,"$1")):w.parseIdFromLayerUrl(a);return a.charAt(0).toUpperCase()+a.slice(1)},parseIdFromLayerUrl:function(a,c){var b;b=RegExp(w.URL_REGEXP);b.test(a)?b=c?a.replace(b,"$2__")+c.replace(" ","_").toLowerCase():a.replace(b,"$2__$1"):(b=new URL(a),b=b.pathname.length<b.hostname.length?
b.pathname.replace("/","_"):b.hostname.replace(".","_"));return b},useSSLIfRequired:function(a,c){(function(a){if(!a||!c)return!1;var b=!1;m.forEach(("undefined"===typeof window.esriGeowConfig?{httpsDomains:["arcgis.com","arcgisonline.com"]}:window.esriGeowConfig).httpsDomains,function(c){if(-1<a.indexOf("."+c+"/")||-1<a.indexOf("/"+c+"/"))b=!0});!b&&-1<a.indexOf(c.portalHostname)&&(b=!0);return b})(a)&&(a=c.portalUtil.useSSL(window.location.protocol,a));return a}},O=[{level:0,resolution:156543.03392800014,
scale:5.91657527591555E8},{level:1,resolution:78271.51696399994,scale:2.95828763795777E8},{level:2,resolution:39135.75848200009,scale:1.47914381897889E8},{level:3,resolution:19567.87924099992,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.992452562495,scale:4622324.434309},{level:8,resolution:611.4962262813797,scale:2311162.217155},
{level:9,resolution:305.74811314055756,scale:1155581.108577},{level:10,resolution:152.87405657041106,scale:577790.554289},{level:11,resolution:76.43702828507324,scale:288895.277144},{level:12,resolution:38.21851414253662,scale:144447.638572},{level:13,resolution:19.10925707126831,scale:72223.819286},{level:14,resolution:9.554628535634155,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.388657133974685,scale:9027.977411},{level:17,resolution:1.1943285668550503,
scale:4513.988705},{level:18,resolution:0.5971642835598172,scale:2256.994353},{level:19,resolution:0.29858214164761665,scale:1128.497176}];return w})},"webSceneViewer/widgets/FPSView/FPSView":function(){define(["esri/core/declare","dojo/dom-construct","dojo/on"],function(l,m,h){return l(null,{constructor:function(k){var g=m.create("div",{id:"fpsView",className:"fpsView",act:"false"},k.container);this._domNode=g;var b=function(b,e){g.textContent=b+" "+(e||"")};h(g,"click",function(){var d="false"===
g.getAttribute("act")?!0:!1;g.setAttribute("act",d);d?(k._stage.addFPSListener(b),g.innerHTML="\x26#8734;"):(k._stage.removeFPSListener(b),g.innerHTML="")}.bind(this))}})})},"webSceneViewer/mapUtils":function(){define(["esri/Map","esri/layers/GroupLayer"],function(l,m){var h={setVisibleLayerList:function(k,g){for(var b=k.layers.getAll(),d=void 0!==b.get?b.get("length"):b.length,e=0;e<d;e++){var a=void 0!==b.getItemAt?b.getItemAt(e):b[e];k.basemap&&k.basemap._mapGroupLayer===a||(0<=g.indexOf(a.get("id"))?
a.set("visible",!0):a.set("visible",!1),a instanceof m&&h.setVisibleLayerList(a,g))}},getVisibleLayersList:function(h){function g(d){var e=[];d instanceof l&&(e=d.layers);d instanceof m&&(e=d.layers.getAll());d=void 0!==e.get?e.get("length"):e.length;for(var a=0;a<d;a++){var c=void 0!==e.getItemAt?e.getItemAt(a):e[a];h.basemap&&h.basemap._mapGroupLayer===c||(c instanceof m?(c.get("visible")&&b.push(c),g(c)):c.get("visible")&&b.push(c))}}var b=[];g(h);return b}};return h})},"dojo/hash":function(){define("./_base/kernel require ./_base/config ./aspect ./_base/lang ./topic ./domReady ./sniff".split(" "),
function(l,m,h,k,g,b,d,e){function a(a,c){var b=a.indexOf(c);return 0<=b?a.substring(b+1):""}function c(){return a(location.href,"#")}function f(){b.publish("/dojo/hashchange",c())}function n(){c()!==p&&(p=c(),f())}function r(a){if(v)if(v.isTransitioning())setTimeout(g.hitch(null,r,a),C);else{var c=v.iframe.location.href,b=c.indexOf("?");v.iframe.location.replace(c.substring(0,b)+"?"+a)}else location.replace("#"+a),!x&&n()}function q(){function b(){p=c();n=v?p:a(x.href,"?");q=!1;r=null}var d=document.createElement("iframe"),
e=h.dojoBlankHtmlUrl||m.toUrl("./resources/blank.html");h.useXDomain&&!h.dojoBlankHtmlUrl&&console.warn("dojo/hash: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl to the path on your domain to blank.html");d.id="dojo-hash-iframe";d.src=e+"?"+c();d.style.display="none";document.body.appendChild(d);this.iframe=l.global["dojo-hash-iframe"];var n,q,r,k,v,x=this.iframe.location;this.isTransitioning=function(){return q};this.pollLocation=
function(){if(!v)try{var h=a(x.href,"?");document.title!=k&&(k=this.iframe.document.title=document.title)}catch(l){v=!0,console.error("dojo/hash: Error adding history entry. Server unreachable.")}var m=c();if(q&&p===m)if(v||h===r)b(),f();else{setTimeout(g.hitch(this,this.pollLocation),0);return}else if(!(p===m&&(v||n===h))){if(p!==m){p=m;q=!0;r=m;d.src=e+"?"+r;v=!1;setTimeout(g.hitch(this,this.pollLocation),0);return}v||(location.href="#"+x.search.substring(1),b(),f())}setTimeout(g.hitch(this,this.pollLocation),
C)};b();setTimeout(g.hitch(this,this.pollLocation),C)}l.hash=function(a,b){if(!arguments.length)return c();"#"==a.charAt(0)&&(a=a.substring(1));b?r(a):location.href="#"+a;return a};var p,v,x,C=h.hashPollFrequency||100;d(function(){"onhashchange"in l.global&&(!e("ie")||8<=e("ie")&&"BackCompat"!=document.compatMode)?x=k.after(l.global,"onhashchange",f,!0):document.addEventListener?(p=c(),setInterval(n,C)):document.attachEvent&&(v=new q)});return l.hash})},"dojox/charting/plot2d/Markers":function(){define(["dojo/_base/declare",
"./Default"],function(l,m){return l("dojox.charting.plot2d.Markers",m,{constructor:function(){this.opt.markers=!0}})})},"dojox/charting/plot2d/Bubble":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/functional/reversed dojox/lang/utils dojox/gfx/fx".split(" "),function(l,m,h,k,g,b,d,e,a,c,f){var n=a.lambda("item.purgeGroup()");return m("dojox.charting.plot2d.Bubble",[g,b],{defaultParams:{animate:null},
optionalParams:{stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:"",labelFunc:null},constructor:function(a,b){this.opt=l.clone(l.mixin(this.opt,this.defaultParams));c.updateWithObject(this.opt,b);c.updateWithPattern(this.opt,b,this.optionalParams);this.opt.labelFunc||(this.opt.labelFunc=function(a,c,b){return this._getLabel(a.size,c,b)});this.animate=this.opt.animate},render:function(a,c){var b;if(this.zoom&&!this.isDataDirty())return this.performZoom(a,c);this.resetEvents();
if(this.dirty=this.isDirty())h.forEach(this.series,n),this._eventSeries={},this.cleanGroup(),b=this.getGroup(),e.forEachRev(this.series,function(a){a.cleanGroup(b)});for(var f=this.chart.theme,g=this._hScaler.scaler.getTransformerFromModel(this._hScaler),l=this._vScaler.scaler.getTransformerFromModel(this._vScaler),m=this.events(),L=this.series.length-1;0<=L;--L){var t=this.series[L];if(!this.dirty&&!t.dirty)f.skip(),this._reconnectEvents(t.name);else if(t.cleanGroup(),t.data.length)if("number"==
typeof t.data[0])console.warn("dojox.charting.plot2d.Bubble: the data in the following series cannot be rendered as a bubble chart; ",t);else{var A=f.next("circle",[this.opt,t]),s=h.map(t.data,function(b){return b?{x:g(b.x)+c.l,y:a.height-c.b-l(b.y),radius:this._vScaler.bounds.scale*(b.size/2)}:null},this);if(t.hidden)t.dyn.fill=A.series.fill,t.dyn.stroke=A.series.stroke;else{b=t.group;var B=null,y=null,u=null,E=this.opt.styleFunc,I=function(a){return E?f.addMixin(A,"circle",[a,E(a)],!0):f.addMixin(A,
"circle",a,!0)};A.series.shadow&&(u=h.map(s,function(d,f){if(null!==d){var e=I(t.data[f]).series.shadow,e=b.createCircle({cx:d.x+e.dx,cy:d.y+e.dy,r:d.radius}).setStroke(e).setFill(e.color);this.animate&&this._animateBubble(e,a.height-c.b,d.radius);return e}return null},this),u.length&&(t.dyn.shadow=u[u.length-1].getStroke()));A.series.outline&&(y=h.map(s,function(f,e){if(null!==f){var n=I(t.data[e]),n=d.makeStroke(n.series.outline);n.width=2*n.width+A.series.stroke.width;n=b.createCircle({cx:f.x,
cy:f.y,r:f.radius}).setStroke(n);this.animate&&this._animateBubble(n,a.height-c.b,f.radius);return n}return null},this),y.length&&(t.dyn.outline=y[y.length-1].getStroke()));B=h.map(s,function(d,f){if(null!==d){var e=I(t.data[f]),n={x:d.x-d.radius,y:d.y-d.radius,width:2*d.radius,height:2*d.radius},g=this._plotFill(e.series.fill,a,c),g=this._shapeFill(g,n),g=b.createCircle({cx:d.x,cy:d.y,r:d.radius}).setFill(g).setStroke(e.series.stroke);g.setFilter&&e.series.filter&&g.setFilter(e.series.filter);this.animate&&
this._animateBubble(g,a.height-c.b,d.radius);this.createLabel(b,t.data[f],n,e);return g}return null},this);B.length&&(t.dyn.fill=B[B.length-1].getFill(),t.dyn.stroke=B[B.length-1].getStroke());if(m){var z=Array(B.length);h.forEach(B,function(a,c){if(null!==a){var b={element:"circle",index:c,run:t,shape:a,outline:y&&y[c]||null,shadow:u&&u[c]||null,x:t.data[c].x,y:t.data[c].y,r:t.data[c].size/2,cx:s[c].x,cy:s[c].y,cr:s[c].radius};this._connectEvents(b);z[c]=b}},this);this._eventSeries[t.name]=z}else delete this._eventSeries[t.name];
t.dirty=!1}}else t.dirty=!1,f.skip()}this.dirty=!1;k("dojo-bidi")&&this._checkOrientation(this.group,a,c);return this},_animateBubble:function(a,c,b){f.animateTransform(l.delegate({shape:a,duration:1200,transform:[{name:"translate",start:[0,c],end:[0,0]},{name:"scale",start:[0,1/b],end:[1,1]},{name:"original"}]},this.animate)).play()}})})},"esri/widgets/PopupLegacy/PopupBase":function(){define("../../core/declare dojo/_base/lang dojo/_base/array dojo/_base/Color ../../Graphic ../../geometry/Point ../../geometry/support/jsonUtils ../../geometry/support/mathUtils ../../geometry/support/webMercatorUtils ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleLineSymbol ../../symbols/CartographicLineSymbol ../../symbols/SimpleFillSymbol ../../tasks/support/Query ../../core/Evented require".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n,r,q,p){function v(a){return"sizeInfo"===a.type}return l(p,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},emitSetFeatures:function(){this.emit("set-features")},emitSelectionChange:function(){this.emit("selection-change")},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",m.hitch(this,this._resetUpdateEndListeners));this.on("dfd-complete",
m.hitch(this,this._processFeatures));this.on("set-features",m.hitch(this,this._processFeatures))},cleanup:function(){this.features=this.promises=null;this._resetUpdateEndListeners()},setFeatures:function(a){if(a&&a.length){this.clearFeatures();var c,b;a[0]&&"function"===typeof a[0].then?b=a:c=a;c?this._updateFeatures(null,c):(this.promises=b,b=b.slice(0),h.forEach(b,function(a){a.always(m.hitch(this,this._updateFeatures,a))},this))}},clearFeatures:function(){this.features=this.promises=this._marked=
null;this.count=0;var a=this.selectedIndex;this.selectedIndex=-1;-1<a&&this.emitSelectionChange();this.emit("clear-features")},getSelectedFeature:function(){var a=this.features;if(a)return a[this.selectedIndex]},select:function(a){0>a||a>=this.count||(this.selectedIndex=a,this.emitSelectionChange())},enableHighlight:function(a){this._highlighted=a.graphics.add(new g(new b(0,0,a.spatialReference)));this._highlighted.hide();this.markerSymbol||(a=this.markerSymbol=new c,a.setStyle(c.STYLE_TARGET),a._setDim(16,
16,0),a.setOutline(new n(f.STYLE_SOLID,new k([0,255,255]),2,n.CAP_ROUND,n.JOIN_ROUND)),a.setColor(new k([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new f(f.STYLE_SOLID,new k([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new r(r.STYLE_NULL,new f(f.STYLE_SOLID,new k([0,255,255]),2),new k([0,0,0,0])))},disableHighlight:function(a){var c=this._highlighted;c&&(c.hide(),a.graphics.remove(c),delete this._highlighted);this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var a=
this.features&&this.features[this.selectedIndex];this._highlighted&&(a&&a.geometry)&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},updateHighlight:function(a,c){var b=c.geometry,f=this._highlighted;if(!b||!f)f&&f.hide();else{f.hide();!f._graphicsLayer&&a&&a.graphics.add(f);f.setGeometry(d.fromJSON(b.toJSON()));var e;switch(b.type){case "point":case "multipoint":e=this.markerSymbol;e.setOffset(0,0);e.setAngle(0);var n=c.getLayer();if(n){var b=n._getSymbol(c),
g,q,p=0,r=0,h=0;if(b){n=!c.symbol?n._getRenderer(c):null;if(p=this._getSizeInfo(n))g=q=n.getSize(c,{sizeInfo:p,shape:b.style,resolution:a&&a.getResolutionInMeters&&a.getResolutionInMeters()});else switch(b.type){case "simplemarkersymbol":g=q=b.size||0;break;case "picturemarkersymbol":g=b.width||0,q=b.height||0}p=b.xoffset||0;r=b.yoffset||0;h=b.angle||0}g&&q&&e._setDim(g+1,q+1,0);e.setOffset(p,r);e.setAngle(h)}break;case "polyline":e=this.lineSymbol;break;case "polygon":e=this.fillSymbol}f.setSymbol(e)}},
showClosestFirst:function(c){var b=this.features;if(b&&b.length){if(1<b.length){var d,f=Infinity,n=-1,g,q=e.getLength,p,r=c.spatialReference,h,k;c=c.normalize();for(d=b.length-1;0<=d;d--)if(g=b[d].geometry){h=g.spatialReference;p=0;try{k="point"===g.type?g:g.get("extent").get("center"),k=k.normalize(),r&&(h&&!r.equals(h)&&r._canProject(h))&&(k=r.isWebMercator()?a.geographicToWebMercator(k):a.webMercatorToGeographic(k)),p=q(c,k)}catch(v){}0<p&&p<f&&(f=p,n=d)}0<n&&(b.splice(0,0,b.splice(n,1)[0]),this.select(0))}}else this.promises&&
(this._marked=c)},_unbind:function(a){a=h.indexOf(this.promises,a);if(-1!==a)return this.promises.splice(a,1),!this.promises.length?(this.promises=null,2):1},_fireComplete:function(a){var c=this._marked;c&&(this._marked=null,this.showClosestFirst(c));a?this.emit("dfd-complete",{features:a}):this.emit("dfd-complete")},_updateFeatures:function(a,c){if(a){if(this.promises){var b=this._unbind(a);if(b)if(c&&c instanceof Error)this._fireComplete(c),2===b&&this.emitSetFeatures();else if(c&&c.length)if(this.features){var d=
h.filter(c,function(a){return-1===h.indexOf(this.features,a)},this);this.features=this.features.concat(d);this.count=this.features.length;this._fireComplete();2===b&&this.emitSetFeatures()}else this.features=c,this.count=c.length,this.selectedIndex=0,this._fireComplete(),2===b&&this.emitSetFeatures(),this.select(0);else this._fireComplete(),2===b&&this.emitSetFeatures()}}else this.features=c,this.count=c.length,this.selectedIndex=0,this.emitSetFeatures(),this.select(0)},_getSizeInfo:function(a){return a?
a.sizeInfo||h.filter(a.visualVariables,v)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers={};h.forEach(this._updateEndHandles,function(a){a.remove()});this._updateEndHandles=[]},_processFeatures:function(){h.forEach(this.features,function(a){if((a=a.layer)&&!this._featureLayers[a.id]&&1===a.currentMode&&a.objectIdField&&a.hasXYFootprint&&a.queryFeatures&&("esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType||a.hasXYFootprint()))this._featureLayers[a.id]=
a,a=a.on("update-end",m.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(a)},this)},_fLyrUpdateEndHandler:function(a){if(!a.error){var c=this,b=a.target,d={},f=[];h.forEach(this.features,function(a){if(a.getLayer()===b){var c=a.attributes[b.objectIdField];d[c]=a;f.push(c)}});f.length&&(a=new q,a.objectIds=f,b.queryFeatures(a,function(a){h.forEach(a.features,function(a){var c=d[a.attributes[b.objectIdField]];c.geometry!==a.geometry&&(c.setGeometry(a.geometry),this._highlighted&&
c===this.getSelectedFeature()&&this._highlighted.setGeometry(a.geometry))},c)}))}}})})},"dojox/gfx/gradutils":function(){define(["./_base","dojo/_base/lang","./matrix","dojo/_base/Color"],function(l,m,h,k){function g(b,d){if(0>=b)return d[0].color;var e=d.length;if(1<=b)return d[e-1].color;for(var a=0;a<e;++a){var c=d[a];if(c.offset>=b)return a?(e=d[a-1],k.blendColors(new k(e.color),new k(c.color),(b-e.offset)/(c.offset-e.offset))):c.color}return d[e-1].color}l=l.gradutils={};l.getColor=function(b,
d){var e;if(b){switch(b.type){case "linear":e=Math.atan2(b.y2-b.y1,b.x2-b.x1);e=h.rotate(-e);var a=h.project(b.x2-b.x1,b.y2-b.y1),c=h.multiplyPoint(a,d),f=h.multiplyPoint(a,b.x1,b.y1),a=h.multiplyPoint(a,b.x2,b.y2),a=h.multiplyPoint(e,a.x-f.x,a.y-f.y).x;e=h.multiplyPoint(e,c.x-f.x,c.y-f.y).x/a;break;case "radial":e=d.x-b.cx,c=d.y-b.cy,e=Math.sqrt(e*e+c*c)/b.r}return g(e,b.colors)}return new k(b||[0,0,0,0])};l.reverse=function(b){if(b)switch(b.type){case "linear":case "radial":if(b=m.delegate(b),b.colors){for(var d=
b.colors,e=d.length,a=0,c,f=b.colors=Array(d.length);a<e;++a)c=d[a],f[a]={offset:1-c.offset,color:c.color};f.sort(function(a,c){return a.offset-c.offset})}}return b};return l})},"dojox/charting/themes/PlotKit/base":function(){define(["dojo/_base/lang","dojo/_base/Color","../../Theme","../common"],function(l,m,h,k){l=l.getObject("PlotKit",!0,k);l.base=new h({chart:{stroke:null,fill:"yellow"},plotarea:{stroke:null,fill:"yellow"},axis:{stroke:{color:"#fff",width:1},line:{color:"#fff",width:0.5},majorTick:{color:"#fff",
width:0.5,length:6},minorTick:{color:"#fff",width:0.5,length:3},tick:{font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#999"}},series:{stroke:{width:2.5,color:"#fff"},fill:"#666",font:"normal normal normal 7.5pt Helvetica,Arial,sans-serif",fontColor:"#666"},marker:{stroke:{width:2},fill:"#333",font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#666"},colors:["red","green","blue"]});l.base.next=function(g,b,d){var e=h.prototype.next.apply(this,arguments);"line"==
g?(e.marker.outline={width:2,color:"#fff"},e.series.stroke.width=3.5,e.marker.stroke.width=2):"candlestick"==g?e.series.stroke.width=1:e.series.stroke.color&&e.series.stroke.color.toString()==(new m(this.colors[(this._current-1)%this.colors.length])).toString()&&(e.series.stroke.color="#fff");return e};return l})},"dojox/charting/plot2d/Lines":function(){define(["dojo/_base/declare","./Default"],function(l,m){return l("dojox.charting.plot2d.Lines",m,{constructor:function(){this.opt.lines=!0}})})},
"dojox/charting/plot2d/StackedAreas":function(){define(["dojo/_base/declare","./Stacked"],function(l,m){return l("dojox.charting.plot2d.StackedAreas",m,{constructor:function(){this.opt.lines=!0;this.opt.areas=!0}})})},"webSceneViewer/widgets/Dialog/ConfirmDialog":function(){define("esri/core/declare dojo/dom-class dijit/Dialog dijit/_WidgetsInTemplateMixin dojo/text!./templates/ConfirmDialog.html dojo/i18n!../../editor/nls/editor dijit/form/Form dijit/form/TextBox dijit/form/ValidationTextBox dijit/form/Button dijit/form/CheckBox dijit/form/Textarea".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n){return l([h,k],{templateString:g,message:"",confirm:"",cancel:"",title:"",constructor:function(a,c){},show:function(a){this.inherited(arguments);this._smoothBlendInOut(!0)},postCreate:function(){this.buttonConfirm.set("label",""!==this.confirm?this.confirm:b.confirmDialog.confirm);this.buttonCancel.set("label",""!==this.cancel?this.cancel:b.confirmDialog.cancelButton);this.Message.innerHTML=""!==this.message?this.message:"";this.titleNode.innerHTML=""!==this.title?
this.title:"";this.inherited(arguments)},_confirmButtonClickHandler:function(){this.emit("confirm",{});this._smoothBlendInOut(!1)},onCancel:function(){this.inherited(arguments);this.emit("cancel",{});this._smoothBlendInOut(!1)},_smoothBlendInOut:function(a){var c=document.getElementsByClassName("dijitDialogUnderlay _underlay");0!==c.length&&(c=c[0],a?m.add(c,"on"):m.remove(c,"on"))}})})},"dojox/charting/plot2d/Stacked":function(){define(["dojo/_base/declare","./Default","./commonStacked"],function(l,
m,h){return l("dojox.charting.plot2d.Stacked",m,{getSeriesStats:function(){return h.collectStats(this.series)},buildSegments:function(k,g){for(var b=this.series[k],d=g?Math.max(0,Math.floor(this._hScaler.bounds.from-1)):0,e=g?Math.min(b.data.length-1,Math.ceil(this._hScaler.bounds.to)):b.data.length-1,a=null,c=[];d<=e;d++){var f=g?h.getIndexValue(this.series,k,d):h.getValue(this.series,k,b.data[d]?b.data[d].x:null);if(null!=f[0]&&(g||null!=f[0].y))a||(a=[],c.push({index:d,rseg:a})),a.push(f[0]);else if(!this.opt.interpolate||
g)a=null}return c}})})},"dojox/charting/axis2d/Base":function(){define(["dojo/_base/declare","../Element"],function(l,m){return l("dojox.charting.axis2d.Base",m,{constructor:function(h,k){this.vertical=k&&k.vertical;this.opt={};this.opt.min=k&&k.min;this.opt.max=k&&k.max},clear:function(){return this},initialized:function(){return!1},calculate:function(h,k,g){return this},getScaler:function(){return null},getTicks:function(){return null},getOffsets:function(){return{l:0,r:0,t:0,b:0}},render:function(h,
k){this.dirty=!1;return this}})})},"dojox/charting/plot2d/Grid":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/sniff ./CartesianBase ./common dojox/lang/utils dojox/gfx/fx".split(" "),function(l,m,h,k,g,b,d,e){var a=function(a,b){return a.value-b.value};return m("dojox.charting.plot2d.Grid",g,{defaultParams:{hMajorLines:!0,hMinorLines:!1,vMajorLines:!0,vMinorLines:!1,hStripes:!1,vStripes:!1,animate:null,enableCache:!1,renderOnAxis:!0},optionalParams:{majorHLine:{},minorHLine:{},
majorVLine:{},minorVLine:{},hFill:{},vFill:{},hAlternateFill:{},vAlternateFill:{}},constructor:function(a,b){this.opt=l.clone(this.defaultParams);d.updateWithObject(this.opt,b);d.updateWithPattern(this.opt,b,this.optionalParams);this.animate=this.opt.animate;this.opt.enableCache&&(this._lineFreePool=[],this._lineUsePool=[],this._rectFreePool=[],this._rectUsePool=[])},addSeries:function(a){return this},getSeriesStats:function(){return l.delegate(b.defaultStats)},cleanGroup:function(){this.inherited(arguments);
this.opt.enableCache&&(this._lineFreePool=this._lineFreePool.concat(this._lineUsePool),this._lineUsePool=[],this._rectFreePool=this._rectFreePool.concat(this._rectUsePool),this._rectUsePool=[])},createLine:function(a,b){var d;this.opt.enableCache&&0<this._lineFreePool.length?(d=this._lineFreePool.pop(),d.setShape(b),a.add(d)):d=a.createLine(b);this.opt.enableCache&&this._lineUsePool.push(d);return d},createRect:function(a,b){var d;this.opt.enableCache&&0<this._rectFreePool.length?(d=this._rectFreePool.pop(),
d.setShape(b),a.add(d)):d=a.createRect(b);this.opt.enableCache&&this._rectUsePool.push(d);return d},render:function(a,b){if(this.zoom)return this.performZoom(a,b);this.dirty=this.isDirty();if(!this.dirty)return this;this.cleanGroup();var d=this.getGroup(),e=this.chart.theme,g;if(k("ios")&&6>k("ios")||k("android")||k("safari")&&!k("ios")){g=Math.max(0,a.width-b.l-b.r);var p=Math.max(0,a.height-b.t-b.b);d.createRect({x:b.l,y:b.t,width:g,height:p})}if(this._vAxis&&(g=this._vAxis.getTicks(),p=this._vAxis.getScaler(),
null!=g&&null!=p)){var h=p.scaler.getTransformerFromModel(p);this.opt.hStripes&&this._renderHRect(g,e.grid,a,b,p,h);this.opt.hMinorLines&&(d=this.opt.minorHLine||e.grid&&e.grid.minorLine||e.axis.minorTick,this._renderHLines(g.minor,d,a,b,p,h));this.opt.hMajorLines&&(d=this.opt.majorHLine||e.grid&&e.grid.majorLine||e.axis.majorTick,this._renderHLines(g.major,d,a,b,p,h))}this._hAxis&&(g=this._hAxis.getTicks(),p=this._hAxis.getScaler(),null!=g&&null!=p&&(h=p.scaler.getTransformerFromModel(p),this.opt.vStripes&&
this._renderVRect(g,e.grid,a,b,p,h),g&&this.opt.vMinorLines&&(d=this.opt.minorVLine||e.grid&&e.grid.minorLine||e.axis.minorTick,this._renderVLines(g.minor,d,a,b,p,h)),g&&this.opt.vMajorLines&&(d=this.opt.majorVLine||e.grid&&e.grid.majorLine||e.axis.majorTick,this._renderVLines(g.major,d,a,b,p,h))));this.dirty=!1;return this},_renderHLines:function(a,b,d,e,g,p){var k=this.getGroup();h.forEach(a,function(a){if(this.opt.renderOnAxis||a.value!=(this._vAxis.opt.leftBottom?g.bounds.from:g.bounds.to))a=
d.height-e.b-p(a.value),a=this.createLine(k,{x1:e.l,y1:a,x2:d.width-e.r,y2:a}).setStroke(b),this.animate&&this._animateGrid(a,"h",e.l,e.r+e.l-d.width)},this)},_renderVLines:function(a,b,d,e,g,p){var k=this.getGroup();h.forEach(a,function(a){if(this.opt.renderOnAxis||a.value!=(this._hAxis.opt.leftBottom?g.bounds.from:g.bounds.to))a=e.l+p(a.value),a=this.createLine(k,{x1:a,y1:e.t,x2:a,y2:d.height-e.b}).setStroke(b),this.animate&&this._animateGrid(a,"v",d.height-e.b,d.height-e.b-e.t)},this)},_renderHRect:function(c,
b,d,e,g,p){var h,k,l;c=c.major.concat(c.minor);c.sort(a);c[0].value>g.bounds.from&&c.splice(0,0,{value:g.bounds.from});c[c.length-1].value<g.bounds.to&&c.push({value:g.bounds.to});g=this.getGroup();for(var m=0;m<c.length-1;m++)if(h=c[m],k=d.height-e.b-p(h.value),l=d.height-e.b-p(c[m+1].value),h=0==m%2?this.opt.hAlternateFill||b&&b.alternateFill:this.opt.hFill||b&&b.fill)h=this.createRect(g,{x:e.l,y:k,width:d.width-e.r,height:k-l}).setFill(h),this.animate&&this._animateGrid(h,"h",e.l,e.r+e.l-d.width)},
_renderVRect:function(c,b,d,e,g,p){var h,k,l;c=c.major.concat(c.minor);c.sort(a);c[0].value>g.bounds.from&&c.splice(0,0,{value:g.bounds.from});c[c.length-1].value<g.bounds.to&&c.push({value:g.bounds.to});g=this.getGroup();for(var m=0;m<c.length-1;m++)if(h=c[m],k=e.l+p(h.value),l=e.l+p(c[m+1].value),h=0==m%2?this.opt.vAlternateFill||b&&b.alternateFill:this.opt.vFill||b&&b.fill)h=this.createRect(g,{x:k,y:e.t,width:l-k,height:d.width-e.r}).setFill(h),this.animate&&this._animateGrid(h,"v",d.height-e.b,
d.height-e.b-e.t)},_animateGrid:function(a,b,d,g){e.animateTransform(l.delegate({shape:a,duration:1200,transform:[{name:"translate",start:"h"==b?[d,0]:[0,d],end:[0,0]},{name:"scale",start:"h"==b?[1/g,1]:[1,1/g],end:[1,1]},{name:"original"}]},this.animate)).play()}})})},"dojox/color/Palette":function(){define(["dojo/_base/lang","dojo/_base/array","./_base"],function(l,m,h){function k(a,c,b){var d=new h.Palette;d.colors=[];m.forEach(a.colors,function(a){var e="dg"==c?a.g+b:a.g,g="db"==c?a.b+b:a.b,k=
"da"==c?a.a+b:a.a;d.colors.push(new h.Color({r:Math.min(255,Math.max(0,"dr"==c?a.r+b:a.r)),g:Math.min(255,Math.max(0,e)),b:Math.min(255,Math.max(0,g)),a:Math.min(1,Math.max(0,k))}))});return d}function g(a,c,b){var d=new h.Palette;d.colors=[];m.forEach(a.colors,function(a){a=a.toCmy();var e="dm"==c?a.m+b:a.m,g="dy"==c?a.y+b:a.y;d.colors.push(h.fromCmy(Math.min(100,Math.max(0,"dc"==c?a.c+b:a.c)),Math.min(100,Math.max(0,e)),Math.min(100,Math.max(0,g))))});return d}function b(a,c,b){var d=new h.Palette;
d.colors=[];m.forEach(a.colors,function(a){a=a.toCmyk();var e="dm"==c?a.m+b:a.m,g="dy"==c?a.y+b:a.y,k="dk"==c?a.b+b:a.b;d.colors.push(h.fromCmyk(Math.min(100,Math.max(0,"dc"==c?a.c+b:a.c)),Math.min(100,Math.max(0,e)),Math.min(100,Math.max(0,g)),Math.min(100,Math.max(0,k))))});return d}function d(a,c,b){var d=new h.Palette;d.colors=[];m.forEach(a.colors,function(a){a=a.toHsl();var e="dl"==c?a.l+b:a.l;d.colors.push(h.fromHsl(("dh"==c?a.h+b:a.h)%360,Math.min(100,Math.max(0,"ds"==c?a.s+b:a.s)),Math.min(100,
Math.max(0,e))))});return d}function e(a,c,b){var d=new h.Palette;d.colors=[];m.forEach(a.colors,function(a){a=a.toHsv();var e="dv"==c?a.v+b:a.v;d.colors.push(h.fromHsv(("dh"==c?a.h+b:a.h)%360,Math.min(100,Math.max(0,"ds"==c?a.s+b:a.s)),Math.min(100,Math.max(0,e))))});return d}h.Palette=function(a){this.colors=[];a instanceof h.Palette?this.colors=a.colors.slice(0):a instanceof h.Color?this.colors=[null,null,a,null,null]:l.isArray(a)?this.colors=m.map(a.slice(0),function(a){return l.isString(a)?new h.Color(a):
a}):l.isString(a)&&(this.colors=[null,null,new h.Color(a),null,null])};l.extend(h.Palette,{transform:function(a){var c=k;if(a.use){var f=a.use.toLowerCase();0==f.indexOf("hs")?c="l"==f.charAt(2)?d:e:0==f.indexOf("cmy")&&(c="k"==f.charAt(3)?b:g)}else if("dc"in a||"dm"in a||"dy"in a)c="dk"in a?b:g;else if("dh"in a||"ds"in a)c="dv"in a?e:d;var f=this,n;for(n in a)"use"!=n&&(f=c(f,n,a[n]));return f},clone:function(){return new h.Palette(this)}});l.mixin(h.Palette,{generators:{analogous:function(a){var c=
a.high||60,b=a.low||18;a=(l.isString(a.base)?new h.Color(a.base):a.base).toHsv();var c=[(a.h+b+360)%360,(a.h+Math.round(b/2)+360)%360,a.h,(a.h-Math.round(c/2)+360)%360,(a.h-c+360)%360],b=Math.max(10,95>=a.s?a.s+5:100-(a.s-95)),d=1<a.s?a.s-1:21-a.s,e=92<=a.v?a.v-9:Math.max(a.v+9,20),g=90>=a.v?Math.max(a.v+5,20):95+Math.ceil((a.v-90)/2),p=[b,d,a.s,b,b],k=[e,g,a.v,e,g];return new h.Palette(m.map(c,function(a,c){return h.fromHsv(a,p[c],k[c])}))},monochromatic:function(a){a=l.isString(a.base)?new h.Color(a.base):
a.base;var c=a.toHsv(),b=9<c.s-30?c.s-30:c.s+30,d=c.s,e=20<c.v-20?c.v-20:c.v+60,g=20<c.v-50?c.v-50:c.v+30;return new h.Palette([h.fromHsv(c.h,b,100-0.8*(100-c.v)),h.fromHsv(c.h,d,g),a,h.fromHsv(c.h,b,g),h.fromHsv(c.h,d,e)])},triadic:function(a){a=l.isString(a.base)?new h.Color(a.base):a.base;var c=a.toHsv(),b=(c.h-157+360)%360,d=90<c.s?c.s-10:c.s+10,e=95<c.s?c.s-5:c.s+5,g=20<c.v-20?c.v-20:c.v+20,p=20<c.v-30?c.v-30:c.v+30,k=70<c.v-30?c.v-30:c.v+30;return new h.Palette([h.fromHsv((c.h+57+360)%360,20<
c.s?c.s-10:c.s+10,c.v),h.fromHsv(c.h,d,p),a,h.fromHsv(b,d,g),h.fromHsv(b,e,k)])},complementary:function(a){a=l.isString(a.base)?new h.Color(a.base):a.base;var c=a.toHsv(),b=360>2*c.h+137?2*c.h+137:Math.floor(c.h/2)-137,d=Math.max(c.s-10,0),e=100-0.9*(100-c.s),g=Math.min(100,c.s+20),p=Math.min(100,c.v+30),k=20<c.v?c.v-30:c.v+30;return new h.Palette([h.fromHsv(c.h,d,p),h.fromHsv(c.h,e,k),a,h.fromHsv(b,g,k),h.fromHsv(b,c.s,c.v)])},splitComplementary:function(a){var c=l.isString(a.base)?new h.Color(a.base):
a.base,b=a.da||30;a=c.toHsv();var d=360>2*a.h+137?2*a.h+137:Math.floor(a.h/2)-137,e=(d-b+360)%360,b=(d+b)%360,d=Math.max(a.s-10,0),g=100-0.9*(100-a.s),p=Math.min(100,a.s+20),k=Math.min(100,a.v+30),m=20<a.v?a.v-30:a.v+30;return new h.Palette([h.fromHsv(e,d,k),h.fromHsv(e,g,m),c,h.fromHsv(b,p,m),h.fromHsv(b,a.s,a.v)])},compound:function(a){a=l.isString(a.base)?new h.Color(a.base):a.base;var c=a.toHsv(),b=360>2*c.h+18?2*c.h+18:Math.floor(c.h/2)-18,d=360>2*c.h+120?2*c.h+120:Math.floor(c.h/2)-120,e=360>
2*c.h+99?2*c.h+99:Math.floor(c.h/2)-99,g=10<c.s-40?c.s-40:c.s+40,p=80<c.s-10?c.s-10:c.s+10,k=10<c.s-25?c.s-25:c.s+25,m=10<c.v-40?c.v-40:c.v+40,C=80<c.v-20?c.v-20:c.v+20,c=Math.max(c.v,20);return new h.Palette([h.fromHsv(b,g,m),h.fromHsv(b,p,C),a,h.fromHsv(d,k,c),h.fromHsv(e,p,C)])},shades:function(a){a=l.isString(a.base)?new h.Color(a.base):a.base;var c=a.toHsv(),b=100==c.s&&0==c.v?0:c.s,d=20<c.v-50?c.v-50:c.v+30,e=20<=c.v-25?c.v-25:c.v+55,g=20<=c.v-75?c.v-75:c.v+5,p=Math.max(c.v-10,20);return new h.Palette([new h.fromHsv(c.h,
b,d),new h.fromHsv(c.h,b,e),a,new h.fromHsv(c.h,b,g),new h.fromHsv(c.h,b,p)])}},generate:function(a,c){if(l.isFunction(c))return c({base:a});if(h.Palette.generators[c])return h.Palette.generators[c]({base:a});throw Error("dojox.color.Palette.generate: the specified generator ('"+c+"') does not exist.");}});return h.Palette})},"webSceneViewer/webScene/Presentation":function(){define("esri/core/declare esri/core/lang esri/Viewpoint esri/core/Collection esri/views/3d/lib/glMatrix webSceneViewer/basemapUtils webSceneViewer/environmentUtils webSceneViewer/mapUtils webSceneViewer/assertUtils".split(" "),
function(l,m,h,k,g,b,d,e,a){var c=a.assert,f=g.vec3d,n=l(null,{declaredClass:"webScene.Presentation",slides:void 0,constructor:function(){this.slides=new k},toJSON:function(){for(var a={slides:[]},c=this.slides.getAll(),b=0;b<c.length;b++)a.slides[b]=n.slideToJson(c[b]);return m.fixJson(a)},addSlide:function(a){this.slides.addItem(a)},removeSlide:function(a){return"number"===typeof a?(c(a<this.slides.get("length")),this.slides.removeItemAt(a)):"object"===typeof a?this.slides.removeItem(a):null},removeSlideById:function(a){for(var c=
0;c<this.slides.items.length;c++)if(this.slides.items[c].id===a)return this.removeSlide(c);return null},getNewSlideId:function(){for(var a=1,c="slide_"+a.toString(),b=[],d=0;d<this.slides.items.length;d++)b[this.slides.items[d].id]=1;for(;b[c];)a++,c="slide_"+a.toString();return c},updateUniqueSlideIds:function(a){if(0!==a.length){for(var c=[],b=[],d=0;d<a.items.length;d++)b[a.items[d].id]=1;for(a=0;a<this.slides.length;a++){var d=this.slides.items[a],e=d.id,f=e.match(/(slide_)(\d+)$/),g;f?(g=f[1],
f=parseInt(f[2],10)):(g=e+"_",f=0);for(;b[e]||c[e];)f++,e=g+f.toString();c[e]=1;e!==d.id&&(d.id=e)}}},updateSlideDetails:function(a,c){var b=this.slides.getItemAt(a);c.title={text:b.title.text};c.description.text=b.description.text;c.id=b.id;this.slides.removeItemAt(a);this.slides.addItem(c,a)},moveSlide:function(a,c){var b;this.slides.getAll().forEach(function(c,d){c.id===a&&(b=c)});b&&this.slides.moveItem(b,c)}}),r=null;n.applySlideToView=function(a,c){var g=h.fromJSON(a.viewpoint).camera;g.fov=
c.get("camera").fov;if(a.environment&&a.environment.lighting&&null!=a.environment.lighting.date){var n=new Date(c.environment.lighting.date),k=n.getTime(),l=60*(60*n.getUTCHours()+n.getUTCMinutes())+n.getUTCSeconds(),m=a.environment.lighting.date,t=m.getTime(),A=60*(60*m.getUTCHours()+m.getUTCMinutes())+m.getUTCSeconds(),s=new Date,B=c.renderCoordsHelper,y=[0,0,0];B.toRenderCoords(c.camera.position,y);var u=[0,0,0];B.toRenderCoords(g.position,u);var E=[0,0,0],I=c.watch("camera",function(a){B.toRenderCoords(a.position,
E);var b=f.dist2(y,E),d=f.dist2(u,E);a=0;0!==b+d&&(a=b/(b+d));b=l+(A-l)*a;s.setTime(k+(t-k)*a);s.setUTCHours(b/3600);s.setUTCMinutes(b%3600/60);s.setUTCSeconds(b%3600%60);c.environment.lighting.date=s});r&&(r.stop(),r=null);c.environmentManager.autoAdjustTimezone=!1;c.environment.lighting=d.clone(a.environment).lighting;c.environment.lighting.date=n;r=c.animateTo(g);r.then(function(b){I.remove();"finished"===b.state&&(c.environment.lighting=d.clone(a.environment).lighting);r===b&&(c.environmentManager.autoAdjustTimezone=
!0)})}else d.applyToView(a.environment,c),c.animateTo(g);if(a.visibleLayers){g=[];for(n=0;n<a.visibleLayers.length;n++)g.push(a.visibleLayers[n].id);e.setVisibleLayerList(c.map,g)}a.baseMap&&b.setFromJSON(c,a.baseMap,!0)};n.fromJSON=function(a){var c=new n;if(a&&a.slides&&a.slides.length)for(var b=0;b<a.slides.length;b++){var e=a.slides[b];e.environment&&(e.environment=d.fromJSON(e.environment));e.baseMap&&e.baseMap.elevationLayers&&delete e.baseMap.elevationLayers;e.visibleLayers||(e.visibleLayers=
[]);c.addSlide(e)}return c};n.slideToJson=function(a){var c={id:a.id,title:a.title,thumbnail:a.thumbnail,description:a.description,baseMap:a.baseMap,viewpoint:a.viewpoint,visibleLayers:a.visibleLayers};a.environment&&(c.environment=d.toJSON(a.environment));return m.fixJson(c)};return n})},"dojox/lang/functional/fold":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/kernel","./lambda"],function(l,m,h,k){var g={};l.mixin(k,{foldl:function(b,d,e,a){"string"==typeof b&&(b=b.split(""));
a=a||h.global;d=k.lambda(d);var c,f;if(l.isArray(b)){c=0;for(f=b.length;c<f;e=d.call(a,e,b[c],c,b),++c);}else if("function"==typeof b.hasNext&&"function"==typeof b.next)for(c=0;b.hasNext();e=d.call(a,e,b.next(),c++,b));else for(c in b)c in g||(e=d.call(a,e,b[c],c,b));return e},foldl1:function(b,d,e){"string"==typeof b&&(b=b.split(""));e=e||h.global;d=k.lambda(d);var a,c,f;if(l.isArray(b)){a=b[0];c=1;for(f=b.length;c<f;a=d.call(e,a,b[c],c,b),++c);}else if("function"==typeof b.hasNext&&"function"==
typeof b.next){if(b.hasNext()){a=b.next();for(c=1;b.hasNext();a=d.call(e,a,b.next(),c++,b));}}else for(c in f=!0,b)c in g||(f?(a=b[c],f=!1):a=d.call(e,a,b[c],c,b));return a},foldr:function(b,d,e,a){"string"==typeof b&&(b=b.split(""));a=a||h.global;d=k.lambda(d);for(var c=b.length;0<c;--c,e=d.call(a,e,b[c],c,b));return e},foldr1:function(b,d,e){"string"==typeof b&&(b=b.split(""));e=e||h.global;d=k.lambda(d);for(var a=b.length,c=b[a-1],a=a-1;0<a;--a,c=d.call(e,c,b[a],a,b));return c},reduce:function(b,
d,e){return 3>arguments.length?k.foldl1(b,d):k.foldl(b,d,e)},reduceRight:function(b,d,e){return 3>arguments.length?k.foldr1(b,d):k.foldr(b,d,e)},unfold:function(b,d,e,a,c){c=c||h.global;d=k.lambda(d);e=k.lambda(e);b=k.lambda(b);for(var f=[];!b.call(c,a);f.push(d.call(c,a)),a=e.call(c,a));return f}})})},"webSceneViewer/widgets/Header/EmbedHeader":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin ./Header dojo/text!./templates/EmbedHeader.html dojo/dom-class dojo/i18n!../nls/widgets".split(" "),
function(l,m,h,k,g,b,d){return l([m,h,k],{name:"EmbedHeader",templateString:g,portal:null,_setPortalAttr:function(b){this._set("portal",b);this._updateTitleUrl()},_updateTitleUrl:function(){if(void 0!==this.websceneId)if(-1!==this.websceneId.indexOf(".json")||!this.portal)b.add(this.WebSceneTitle,"disableLink");else{b.remove(this.WebSceneTitle,"disableLink");var d="",d="undefined"!==typeof esriGeowConfig?esriGeowConfig.baseUrl+"item.html?id\x3d"+this.websceneId:this.portal.url+"/home/item.html?id\x3d"+
this.websceneId;this.WebSceneTitle.href=d}else b.add(this.WebSceneTitle,"disableLink")},_setTitleAttr:function(b){this._set("title",b);this.WebSceneTitle.innerHTML=b;this.WebSceneTitle.title=b;this._updateTitleUrl()},_setWebsceneIdAttr:function(b){this._set("websceneId",b)},_setSceneSRAttr:function(b){this._set("sceneSR",b)},_setViewingModeAttr:function(b){this._set("viewingMode",b)},constructor:function(b,a){},postCreate:function(){this.FullScreenLink.innerHTML=d.header.fullScreen;this.FullScreenLink.href=
window.location.href.replace("\x26ui\x3dmin","");this._updateTitleUrl()}})})},"dojox/gfx/svg":function(){define("dojo/_base/lang dojo/_base/sniff dojo/_base/window dojo/dom dojo/_base/declare dojo/_base/array dojo/dom-geometry dojo/dom-attr dojo/_base/Color ./_base ./shape ./path".split(" "),function(l,m,h,k,g,b,d,e,a,c,f,n){function r(a,c){return h.doc.createElementNS?h.doc.createElementNS(a,c):h.doc.createElement(c)}function q(a){return p.useSvgWeb?h.doc.createTextNode(a,!0):h.doc.createTextNode(a)}
var p=c.svg={};p.useSvgWeb="undefined"!=typeof window.svgweb;var v=navigator.userAgent,x=m("ios"),C=m("android"),M=m("chrome")||C&&4<=C?"auto":"optimizeLegibility";p.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};p.getRef=function(a){return!a||"none"==a?null:a.match(/^url\(#.+\)$/)?k.byId(a.slice(5,-1)):a.match(/^#dojoUnique\d+$/)?k.byId(a.slice(1)):null};p.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,
3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};var L=0;p.Shape=g("dojox.gfx.svg.Shape",f.Shape,{destroy:function(){if(this.fillStyle&&"type"in this.fillStyle){var a=this.rawNode.getAttribute("fill");(a=p.getRef(a))&&a.parentNode.removeChild(a)}if(this.clip&&(a=this.rawNode.getAttribute("clip-path")))(a=k.byId(a.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);f.Shape.prototype.destroy.apply(this,arguments)},setFill:function(a){if(!a)return this.fillStyle=
null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var d,f=function(a){this.setAttribute(a,d[a].toFixed(8))};if("object"==typeof a&&"type"in a){switch(a.type){case "linear":d=c.makeParameters(c.defaultLinearGradient,a);a=this._setFillObject(d,"linearGradient");b.forEach(["x1","y1","x2","y2"],f,a);break;case "radial":d=c.makeParameters(c.defaultRadialGradient,a);a=this._setFillObject(d,"radialGradient");b.forEach(["cx","cy","r"],f,a);break;case "pattern":d=
c.makeParameters(c.defaultPattern,a),a=this._setFillObject(d,"pattern"),b.forEach(["x","y","width","height"],f,a)}this.fillStyle=d;return this}this.fillStyle=d=c.normalizeColor(a);this.rawNode.setAttribute("fill",d.toCss());this.rawNode.setAttribute("fill-opacity",d.a);this.rawNode.setAttribute("fill-rule","evenodd");return this},setStroke:function(b){var d=this.rawNode;if(!b)return this.strokeStyle=null,d.setAttribute("stroke","none"),d.setAttribute("stroke-opacity",0),this;if("string"==typeof b||
l.isArray(b)||b instanceof a)b={color:b};b=this.strokeStyle=c.makeParameters(c.defaultStroke,b);b.color=c.normalizeColor(b.color);if(b){d.setAttribute("stroke",b.color.toCss());d.setAttribute("stroke-opacity",b.color.a);d.setAttribute("stroke-width",b.width);d.setAttribute("stroke-linecap",b.cap);"number"==typeof b.join?(d.setAttribute("stroke-linejoin","miter"),d.setAttribute("stroke-miterlimit",b.join)):d.setAttribute("stroke-linejoin",b.join);var f=b.style.toLowerCase();f in p.dasharray&&(f=p.dasharray[f]);
if(f instanceof Array){var f=l._toArray(f),e;for(e=0;e<f.length;++e)f[e]*=b.width;if("butt"!=b.cap){for(e=0;e<f.length;e+=2)f[e]-=b.width,1>f[e]&&(f[e]=1);for(e=1;e<f.length;e+=2)f[e]+=b.width}f=f.join(",")}d.setAttribute("stroke-dasharray",f);d.setAttribute("dojoGfxStrokeStyle",b.style)}return this},_getParentSurface:function(){for(var a=this.parent;a&&!(a instanceof c.Surface);a=a.parent);return a},_setFillObject:function(a,b){var d=p.xmlns.svg;this.fillStyle=a;var f=this._getParentSurface().defNode,
e=this.rawNode.getAttribute("fill");if(e=p.getRef(e))if(e.tagName.toLowerCase()!=b.toLowerCase()){var g=e.id;e.parentNode.removeChild(e);e=r(d,b);e.setAttribute("id",g);f.appendChild(e)}else for(;e.childNodes.length;)e.removeChild(e.lastChild);else e=r(d,b),e.setAttribute("id",c._base._getUniqueId()),f.appendChild(e);if("pattern"==b)e.setAttribute("patternUnits","userSpaceOnUse"),d=r(d,"image"),d.setAttribute("x",0),d.setAttribute("y",0),d.setAttribute("width",a.width.toFixed(8)),d.setAttribute("height",
a.height.toFixed(8)),d.setAttributeNS?d.setAttributeNS(p.xmlns.xlink,"xlink:href",a.src):d.setAttribute("xlink:href",a.src),e.appendChild(d);else{e.setAttribute("gradientUnits","userSpaceOnUse");for(f=0;f<a.colors.length;++f){var g=a.colors[f],n=r(d,"stop"),q=g.color=c.normalizeColor(g.color);n.setAttribute("offset",g.offset.toFixed(8));n.setAttribute("stop-color",q.toCss());n.setAttribute("stop-opacity",q.a);e.appendChild(n)}}this.rawNode.setAttribute("fill","url(#"+e.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");
this.rawNode.setAttribute("fill-rule","evenodd");return e},_applyTransform:function(){if(this.matrix){var a=this.matrix;this.rawNode.setAttribute("transform","matrix("+a.xx.toFixed(8)+","+a.yx.toFixed(8)+","+a.xy.toFixed(8)+","+a.yy.toFixed(8)+","+a.dx.toFixed(8)+","+a.dy.toFixed(8)+")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(a){a=this.rawNode=a;"image"!=this.shape.type&&a.setAttribute("fill","none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke",
"none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",4);a.__gfxObject__=this},setShape:function(a){this.shape=c.makeParameters(this.shape,a);for(var b in this.shape)"type"!=b&&this.rawNode.setAttribute(b,this.shape[b]);this.bbox=null;return this},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,
this.rawNode.parentNode.firstChild);return this},setClip:function(a){this.inherited(arguments);var c=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!c)return this;"polyline"===c&&(a=l.clone(a),a.points=a.points.join(","));var b,d=e.get(this.rawNode,"clip-path");d&&(b=k.byId(d.match(/gfx_clip[\d]+/)[0]))&&b.removeChild(b.childNodes[0]);a?(b?(c=r(p.xmlns.svg,c),b.appendChild(c)):(d="gfx_clip"+ ++L,this.rawNode.setAttribute("clip-path","url(#"+d+")"),b=
r(p.xmlns.svg,"clipPath"),c=r(p.xmlns.svg,c),b.appendChild(c),this.rawNode.parentNode.insertBefore(b,this.rawNode),e.set(b,"id",d)),e.set(c,a)):(this.rawNode.removeAttribute("clip-path"),b&&b.parentNode.removeChild(b));return this},_removeClipNode:function(){var a,c=e.get(this.rawNode,"clip-path");c&&(a=k.byId(c.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);return a}});p.Group=g("dojox.gfx.svg.Group",p.Shape,{constructor:function(){f.Container._init.call(this)},setRawNode:function(a){this.rawNode=
a;this.rawNode.__gfxObject__=this},destroy:function(){this.clear(!0);p.Shape.prototype.destroy.apply(this,arguments)}});p.Group.nodeType="g";p.Rect=g("dojox.gfx.svg.Rect",[p.Shape,f.Rect],{setShape:function(a){this.shape=c.makeParameters(this.shape,a);this.bbox=null;for(var b in this.shape)"type"!=b&&"r"!=b&&this.rawNode.setAttribute(b,this.shape[b]);null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r));return this}});p.Rect.nodeType="rect";
p.Ellipse=g("dojox.gfx.svg.Ellipse",[p.Shape,f.Ellipse],{});p.Ellipse.nodeType="ellipse";p.Circle=g("dojox.gfx.svg.Circle",[p.Shape,f.Circle],{});p.Circle.nodeType="circle";p.Line=g("dojox.gfx.svg.Line",[p.Shape,f.Line],{});p.Line.nodeType="line";p.Polyline=g("dojox.gfx.svg.Polyline",[p.Shape,f.Polyline],{setShape:function(a,b){a&&a instanceof Array?(this.shape=c.makeParameters(this.shape,{points:a}),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=c.makeParameters(this.shape,
a);this.bbox=null;this._normalizePoints();for(var d=[],e=this.shape.points,f=0;f<e.length;++f)d.push(e[f].x.toFixed(8),e[f].y.toFixed(8));this.rawNode.setAttribute("points",d.join(" "));return this}});p.Polyline.nodeType="polyline";p.Image=g("dojox.gfx.svg.Image",[p.Shape,f.Image],{setShape:function(a){this.shape=c.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;for(var b in this.shape)"type"!=b&&"src"!=b&&a.setAttribute(b,this.shape[b]);a.setAttribute("preserveAspectRatio","none");a.setAttributeNS?
a.setAttributeNS(p.xmlns.xlink,"xlink:href",this.shape.src):a.setAttribute("xlink:href",this.shape.src);a.__gfxObject__=this;return this}});p.Image.nodeType="image";p.Text=g("dojox.gfx.svg.Text",[p.Shape,f.Text],{setShape:function(a){this.shape=c.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;var b=this.shape;a.setAttribute("x",b.x);a.setAttribute("y",b.y);a.setAttribute("text-anchor",b.align);a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",b.rotated?90:0);a.setAttribute("kerning",
b.kerning?"auto":0);a.setAttribute("text-rendering",M);a.firstChild?a.firstChild.nodeValue=b.text:a.appendChild(q(b.text));return this},getTextWidth:function(){var a=this.rawNode,c=a.parentNode,a=a.cloneNode(!0);a.style.visibility="hidden";var b=0,d=a.firstChild.nodeValue;c.appendChild(a);if(""!=d)for(;!b;)b=a.getBBox?parseInt(a.getBBox().width):68;c.removeChild(a);return b},getBoundingBox:function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(c){a={x:0,y:0,width:0,height:0}}return a}});
p.Text.nodeType="text";p.Path=g("dojox.gfx.svg.Path",[p.Shape,n.Path],{_updateWithSegment:function(a){this.inherited(arguments);"string"==typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)},setShape:function(a){this.inherited(arguments);this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");return this}});p.Path.nodeType="path";p.TextPath=g("dojox.gfx.svg.TextPath",[p.Shape,n.TextPath],{_updateWithSegment:function(a){this.inherited(arguments);
this._setTextPath()},setShape:function(a){this.inherited(arguments);this._setTextPath();return this},_setTextPath:function(){if("string"==typeof this.shape.path){var a=this.rawNode;if(!a.firstChild){var b=r(p.xmlns.svg,"textPath"),d=q("");b.appendChild(d);a.appendChild(b)}b=(b=a.firstChild.getAttributeNS(p.xmlns.xlink,"href"))&&p.getRef(b);if(!b&&(d=this._getParentSurface())){var d=d.defNode,b=r(p.xmlns.svg,"path"),e=c._base._getUniqueId();b.setAttribute("id",e);d.appendChild(b);a.firstChild.setAttributeNS?
a.firstChild.setAttributeNS(p.xmlns.xlink,"xlink:href","#"+e):a.firstChild.setAttribute("xlink:href","#"+e)}b&&b.setAttribute("d",this.shape.path)}},_setText:function(){var a=this.rawNode;if(!a.firstChild){var c=r(p.xmlns.svg,"textPath"),b=q("");c.appendChild(b);a.appendChild(c)}a=a.firstChild;c=this.text;a.setAttribute("alignment-baseline","middle");switch(c.align){case "middle":a.setAttribute("text-anchor","middle");a.setAttribute("startOffset","50%");break;case "end":a.setAttribute("text-anchor",
"end");a.setAttribute("startOffset","100%");break;default:a.setAttribute("text-anchor","start"),a.setAttribute("startOffset","0%")}a.setAttribute("baseline-shift","0.5ex");a.setAttribute("text-decoration",c.decoration);a.setAttribute("rotate",c.rotated?90:0);a.setAttribute("kerning",c.kerning?"auto":0);a.firstChild.data=c.text}});p.TextPath.nodeType="text";var t=534<function(){var a=/WebKit\/(\d*)/.exec(v);return a?a[1]:0}();p.Surface=g("dojox.gfx.svg.Surface",f.Surface,{constructor:function(){f.Container._init.call(this)},
destroy:function(){f.Container.clear.call(this,!0);this.defNode=null;this.inherited(arguments)},setDimensions:function(a,c){if(!this.rawNode)return this;this.rawNode.setAttribute("width",a);this.rawNode.setAttribute("height",c);t&&(this.rawNode.style.width=a,this.rawNode.style.height=c);return this},getDimensions:function(){return this.rawNode?{width:c.normalizedLength(this.rawNode.getAttribute("width")),height:c.normalizedLength(this.rawNode.getAttribute("height"))}:null}});p.createSurface=function(a,
b,d){var e=new p.Surface;e.rawNode=r(p.xmlns.svg,"svg");e.rawNode.setAttribute("overflow","hidden");b&&e.rawNode.setAttribute("width",b);d&&e.rawNode.setAttribute("height",d);b=r(p.xmlns.svg,"defs");e.rawNode.appendChild(b);e.defNode=b;e._parent=k.byId(a);e._parent.appendChild(e.rawNode);c._base._fixMsTouchAction(e);return e};m={_setFont:function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);this.rawNode.setAttribute("font-variant",a.variant);this.rawNode.setAttribute("font-weight",
a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)}};var A=f.Container;g=p.Container={openBatch:function(){if(!this._batch){var a;a=p.useSvgWeb?h.doc.createDocumentFragment(!0):h.doc.createDocumentFragment();this.fragment=a}++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),delete this.fragment);return this},add:function(a){this!=a.getParent()&&
(this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode),A.add.apply(this,arguments),a.setClip(a.clip));return this},remove:function(a,c){this==a.getParent()&&(this.rawNode==a.rawNode.parentNode&&this.rawNode.removeChild(a.rawNode),this.fragment&&this.fragment==a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode),a._removeClipNode(),A.remove.apply(this,arguments));return this},clear:function(){for(var a=this.rawNode;a.lastChild;)a.removeChild(a.lastChild);var c=
this.defNode;if(c){for(;c.lastChild;)c.removeChild(c.lastChild);a.appendChild(c)}return A.clear.apply(this,arguments)},getBoundingBox:A.getBoundingBox,_moveChildToFront:A._moveChildToFront,_moveChildToBack:A._moveChildToBack};n=p.Creator={createObject:function(a,c){if(!this.rawNode)return null;var b=new a,d=r(p.xmlns.svg,a.nodeType);b.setRawNode(d);b.setShape(c);this.add(b);return b}};l.extend(p.Text,m);l.extend(p.TextPath,m);l.extend(p.Group,g);l.extend(p.Group,f.Creator);l.extend(p.Group,n);l.extend(p.Surface,
g);l.extend(p.Surface,f.Creator);l.extend(p.Surface,n);p.fixTarget=function(a,c){a.gfxTarget||(a.gfxTarget=x&&a.target.wholeText?a.target.parentElement.__gfxObject__:a.target.__gfxObject__);return!0};p.useSvgWeb&&(p.createSurface=function(a,b,e){var f=new p.Surface;if(!b||!e){var g=d.position(a);b=b||g.w;e=e||g.h}a=k.byId(a);var g=a.id?a.id+"_svgweb":c._base._getUniqueId(),n=r(p.xmlns.svg,"svg");n.id=g;n.setAttribute("width",b);n.setAttribute("height",e);svgweb.appendChild(n,a);n.addEventListener("SVGLoad",
function(){f.rawNode=this;f.isLoaded=!0;var a=r(p.xmlns.svg,"defs");f.rawNode.appendChild(a);f.defNode=a;if(f.onLoad)f.onLoad(f)},!1);f.isLoaded=!1;return f},p.Surface.extend({destroy:function(){var a=this.rawNode;svgweb.removeChild(a,a.parentNode)}}),m={connect:function(a,c,b){"on"===a.substring(0,2)&&(a=a.substring(2));b=2==arguments.length?c:l.hitch(c,b);this.getEventSource().addEventListener(a,b,!1);return[this,a,b]},disconnect:function(a){this.getEventSource().removeEventListener(a[1],a[2],!1);
delete a[0]}},l.extend(p.Shape,m),l.extend(p.Surface,m));return p})},"dojox/charting/plot2d/Spider":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/dom-geometry dojo/_base/fx dojo/fx dojo/sniff ./Base ./_PlotEvents ./common ../axis2d/common dojox/gfx dojox/gfx/matrix dojox/gfx/fx dojox/lang/functional dojox/lang/utils dojo/fx/easing".split(" "),function(l,m,h,k,g,b,d,e,a,c,f,n,r,q,p,v,x,C){return m("dojox.charting.plot2d.Spider",[a,c],{defaultParams:{labels:!0,
ticks:!1,fixed:!0,precision:1,labelOffset:-10,labelStyle:"default",htmlLabels:!0,startAngle:-90,divisions:3,axisColor:"",axisWidth:0,spiderColor:"",spiderWidth:0,seriesWidth:0,seriesFillAlpha:0.2,spiderOrigin:0.16,markerSize:3,spiderType:"polygon",animationType:C.backOut,animate:null,axisTickFont:"",axisTickFontColor:"",axisFont:"",axisFontColor:""},optionalParams:{radius:0,font:"",fontColor:""},constructor:function(a,c){this.opt=l.clone(this.defaultParams);x.updateWithObject(this.opt,c);x.updateWithPattern(this.opt,
c,this.optionalParams);this.dyn=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animate=null===this.opt.animate?{}:this.opt.animate;this.animations={}},clear:function(){this.inherited(arguments);this.dyn=[];this.axes=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};return this},setAxis:function(a){a&&(void 0!=a.opt.min&&(this.datas[a.name].min=a.opt.min),void 0!=a.opt.max&&(this.datas[a.name].max=a.opt.max));return this},addSeries:function(a){this.series.push(a);
for(var c in a.data){var b=a.data[c],d=this.datas[c];d?(d.vlist.push(b),d.min=Math.min(d.min,b),d.max=Math.max(d.max,b)):(d="__"+c,this.axes.push(d),this[d]=c,this.datas[c]={min:b,max:b,vlist:[b]})}if(0>=this.labelKey.length)for(c in a.data)this.labelKey.push(c);return this},getSeriesStats:function(){return f.collectSimpleStats(this.series)},render:function(a,c){if(!this.dirty)return this;this.dirty=!1;this.cleanGroup();var b=this.group,d=this.chart.theme;this.resetEvents();if(!this.series||!this.series.length)return this;
var e=this.opt,f=d.axis,p=(a.width-c.l-c.r)/2,h=(a.height-c.t-c.b)/2,l=Math.min(p,h),m=e.font||f.majorTick&&f.majorTick.font||f.tick&&f.tick.font||"normal normal normal 7pt Tahoma",x=e.axisFont||f.tick&&f.tick.titleFont||"normal normal normal 11pt Tahoma",C=e.axisTickFontColor||f.majorTick&&f.majorTick.fontColor||f.tick&&f.tick.fontColor||"silver",J=e.axisFontColor||f.tick&&f.tick.titleFontColor||"black",G=e.axisColor||f.tick&&f.tick.axisColor||"silver",F=e.spiderColor||f.tick&&f.tick.spiderColor||
"silver",K=e.axisWidth||f.stroke&&f.stroke.width||2,D=e.spiderWidth||f.stroke&&f.stroke.width||2,f=e.seriesWidth||f.stroke&&f.stroke.width||2,N=r.normalizedLength(r.splitFontString(x).size),w=q._degToRad(e.startAngle),O,P,V,Y,T,R,W=e.spiderOrigin,$=3<=e.divisions?e.divisions:3,aa=e.markerSize,X=e.spiderType,U=e.animationType,Q=-10>e.labelOffset?e.labelOffset:-10,S;e.labels&&(l=k.map(this.series,function(a){return a.name},this),l=v.foldl1(v.map(l,function(a){return r._base._getTextBox(a,{font:d.series.font}).w},
this),"Math.max(a, b)")/2,l=Math.min(p-2*l,h-N)+Q,O=l-Q);"radius"in e&&(l=e.radius,O=l-Q);l/=1.2;p={cx:c.l+p,cy:c.t+h,r:l};for(h=this.series.length-1;0<=h;h--)if(S=this.series[h],!this.dirty&&!S.dirty)d.skip();else if(S.cleanGroup(),Q=S.data,null!==Q&&(N=this._getObjectLength(Q),!P||0>=P.length))if(P=[],V=[],R=[],this._buildPoints(P,N,p,l,w,!0,a),this._buildPoints(V,N,p,l*W,w,!0,a),this._buildPoints(R,N,p,O,w,!1,a),2<$){Y=[];T=[];for(Q=0;Q<$-2;Q++)Y[Q]=[],this._buildPoints(Y[Q],N,p,l*(W+(1-W)*(Q+
1)/($-1)),w,!0,a),T[Q]=l*(W+(1-W)*(Q+1)/($-1))}N=b.createGroup();G={color:G,width:K};h={color:F,width:D};for(Q=P.length-1;0<=Q;--Q)F=P[Q],D={x:F.x+0.2*(F.x-p.cx),y:F.y+0.2*(F.y-p.cy)},F={x:F.x+0.2*(F.x-p.cx)/2,y:F.y+0.2*(F.y-p.cy)/2},N.createLine({x1:p.cx,y1:p.cy,x2:D.x,y2:D.y}).setStroke(G),this._drawArrow(N,D,F,G);N=b.createGroup();for(Q=R.length-1;0<=Q;--Q)F=R[Q],D=r._base._getTextBox(this.labelKey[Q],{font:x}).w||0,G=this.opt.htmlLabels&&"vml"!=r.renderer?"html":"gfx",F=n.createText[G](this.chart,
N,!g.isBodyLtr()&&"html"==G?F.x+D-a.width:F.x,F.y,"middle",this.labelKey[Q],x,J),this.opt.htmlLabels&&this.htmlElements.push(F);x=b.createGroup();if("polygon"==X){if(x.createPolyline(P).setStroke(h),x.createPolyline(V).setStroke(h),0<Y.length)for(Q=Y.length-1;0<=Q;--Q)x.createPolyline(Y[Q]).setStroke(h)}else if(x.createCircle({cx:p.cx,cy:p.cy,r:l}).setStroke(h),x.createCircle({cx:p.cx,cy:p.cy,r:l*W}).setStroke(h),0<T.length)for(Q=T.length-1;0<=Q;--Q)x.createCircle({cx:p.cx,cy:p.cy,r:T[Q]}).setStroke(h);
N=this._getObjectLength(this.datas);J=b.createGroup();Y=0;for(var da in this.datas){T=this.datas[da];P=T.min;T=T.max;T-=P;x=w+2*Math.PI*Y/N;for(h=0;h<$;h++)R=P+T*h/($-1),F=this._getCoordinate(p,l*(W+(1-W)*h/($-1)),x,a),R=this._getLabel(R),D=r._base._getTextBox(R,{font:m}).w||0,G=this.opt.htmlLabels&&"vml"!=r.renderer?"html":"gfx",this.opt.htmlLabels&&this.htmlElements.push(n.createText[G](this.chart,J,!g.isBodyLtr()&&"html"==G?F.x+D-a.width:F.x,F.y,"start",R,m,C));Y++}this.chart.seriesShapes={};for(h=
this.series.length-1;0<=h;h--)if(S=this.series[h],Q=S.data,null!==Q){var m=d.next("spider",[e,S]),ba=r.normalizeColor(m.series.fill),m={color:m.series.fill,width:f};ba.a=e.seriesFillAlpha;S.dyn={fill:ba,stroke:m};if(!S.hidden){var Z=[],ca=[];Y=0;for(da in Q)T=this.datas[da],P=T.min,T=T.max,T-=P,C=Q[da],x=w+2*Math.PI*Y/N,F=this._getCoordinate(p,l*(W+(1-W)*(C-P)/T),x,a),Z.push(F),ca.push({sname:S.name,key:da,data:C}),Y++;Z[Z.length]=Z[0];ca[ca.length]=ca[0];var C=this._getBoundary(Z),ea=S.group,m=this._createSeriesEntry(ea,
this.oldSeriePoints[S.name]||V,Z,ba,m,l,W,aa,U);this.chart.seriesShapes[S.name]=m;this.oldSeriePoints[S.name]=Z;this._connectEvents({element:"spider_poly",index:h,id:"spider_poly_"+S.name,run:S,plot:this,shape:m.poly,parent:ea,brect:C,cx:p.cx,cy:p.cy,cr:l,f:ba,s:b});this._connectEvents({element:"spider_plot",index:h,id:"spider_plot_"+S.name,run:S,plot:this,shape:S.group});k.forEach(m.circles,function(a,c){this._connectEvents({element:"spider_circle",index:c,id:"spider_circle_"+S.name+c,run:S,plot:this,
shape:a,parent:ea,tdata:ca[c],cx:Z[c].x,cy:Z[c].y,f:ba,s:b})},this)}}return this},_createSeriesEntry:function(a,c,e,f,g,n,p,q,r){n=this.animate?c:e;var v=a.createPolyline(n).setFill(f).setStroke(g),m=[];for(p=0;p<n.length;p++){var x=n[p],x=a.createCircle({cx:x.x,cy:x.y,r:q}).setFill(f).setStroke(g);m.push(x)}this.animate&&(f=k.map(e,function(a,d){var e=new b.Animation(l.delegate({duration:1E3,easing:r,curve:[c[d].y,a.y]},this.animate)),f=m[d];h.connect(e,"onAnimate",function(a){var c=v.getShape();
c.points[d].y=a;v.setShape(c);c=f.getShape();c.cy=a;f.setShape(c)});return e},this),e=k.map(e,function(a,d){var e=new b.Animation(l.delegate({duration:1E3,easing:r,curve:[c[d].x,a.x]},this.animate)),f=m[d];h.connect(e,"onAnimate",function(a){var c=v.getShape();c.points[d].x=a;v.setShape(c);c=f.getShape();c.cx=a;f.setShape(c)});return e},this),d.combine(f.concat(e)).play());return{group:a,poly:v,circles:m}},plotEvent:function(a){"spider_plot"==a.element&&"onmouseover"==a.type&&!e("ie")&&a.shape.moveToFront()},
tooltipFunc:function(a){return"spider_circle"==a.element?a.tdata.sname+"\x3cbr/\x3e"+a.tdata.key+"\x3cbr/\x3e"+a.tdata.data:null},_getBoundary:function(a){for(var c=a[0].x,b=a[0].x,d=a[0].y,e=a[0].y,f=0;f<a.length;f++)var g=a[f],c=Math.max(g.x,c),d=Math.max(g.y,d),b=Math.min(g.x,b),e=Math.min(g.y,e);return{x:b,y:e,width:c-b,height:d-e}},_drawArrow:function(a,c,b,d){var e=Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2)),f=(b.y-c.y)/e,g=(b.x-c.x)/e;a.createPolyline([c,{x:b.x+e/3*-f,y:b.y+e/3*g},{x:b.x+
e/3*f,y:b.y+e/3*-g}]).setFill(d.color).setStroke(d)},_buildPoints:function(a,c,b,d,e,f,g){for(var n=0;n<c;n++)a.push(this._getCoordinate(b,d,e+2*Math.PI*n/c,g));f&&a.push(this._getCoordinate(b,d,e+2*Math.PI,g))},_getCoordinate:function(a,c,b,d){var f=a.cx+c*Math.cos(b);e("dojo-bidi")&&(this.chart.isRightToLeft()&&d)&&(f=d.width-f);return{x:f,y:a.cy+c*Math.sin(b)}},_getObjectLength:function(a){var c=0;if(l.isObject(a))for(var b in a)c++;return c},_getLabel:function(a){return f.getLabel(a,this.opt.fixed,
this.opt.precision)}})})},"webSceneViewer/widgets/Header/Role":function(){define("require esri/core/declare dojo/_base/lang dojo/_base/array dojo/json esri/core/lang".split(" "),function(l,m,h,k,g,b){return m(null,{declaredClass:"arcgisonline.sharing.dijit.Role",basePath:l.toUrl("arcgisonline/sharing/dijit"),id:null,baseRole:null,name:null,description:null,privileges:[],privilegeObj:null,constructor:function(b){b=b||{};this.id=b.id;this.baseRole=b.role;this.name=b.name;this.description=b.description},
_initPrivilegesObject:function(){this.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,assignToGroups:!1,manageEnterpriseGroups:!1,viewItems:!1,updateItems:!1,deleteItems:!1,reassignItems:!1,manageLicenses:!1},publisher:{publishFeatures:!1,publishTiles:!1,publishScenes:!1},user:{createGroup:!1,joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,shareToOrg:!1,
shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,demographics:!1,elevation:!1}},marketplace:{admin:{manage:!1,purchase:!1,startTrial:!1}}}},_readPrivileges:function(d){b.isDefined(d)&&d instanceof Array&&k.forEach(d,h.hitch(this,function(b){this._readPrivilege(b)}))},_readPrivilege:function(b){this._applyEffectToAction(!0,
b)},_applyEffectToAction:function(b,e){switch(e){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=b;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=b;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=b;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=b;break;case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=b;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=
b;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=b;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=b;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=b;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=b;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=b;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=
b;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=b;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=b;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=b;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=b;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=b;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=
b;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=b;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=b;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=b;break;case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=b;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=b;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=
b;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=b;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=b;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=b;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=b;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=b;break;case "features:user:edit":this.privilegeObj.features.user.edit=
b;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=b;break;case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=b;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=b;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=b;break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=b;break;case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=
b;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=b;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=b;break;case "premium:user:elevation":this.privilegeObj.premium.user.elevation=b;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=b;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=b;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=
b}},_applyToAll:function(b){this.privilegeObj.portal.admin.inviteUsers=b;this.privilegeObj.portal.admin.disableUsers=b;this.privilegeObj.portal.admin.viewUsers=b;this.privilegeObj.portal.admin.updateUsers=b;this.privilegeObj.portal.admin.deleteUsers=b;this.privilegeObj.portal.admin.changeUserRoles=b;this.privilegeObj.portal.admin.viewGroups=b;this.privilegeObj.portal.admin.updateGroups=b;this.privilegeObj.portal.admin.deleteGroups=b;this.privilegeObj.portal.admin.reassignGroups=b;this.privilegeObj.portal.admin.assignToGroups=
b;this.privilegeObj.portal.admin.manageEnterpriseGroups=b;this.privilegeObj.portal.admin.viewItems=b;this.privilegeObj.portal.admin.updateItems=b;this.privilegeObj.portal.admin.deleteItems=b;this.privilegeObj.portal.admin.reassignItems=b;this.privilegeObj.portal.admin.manageLicenses=b;this.privilegeObj.portal.publisher.publishFeatures=b;this.privilegeObj.portal.publisher.publishTiles=b;this.privilegeObj.portal.publisher.publishScenes=b;this.privilegeObj.portal.user.createGroup=b;this.privilegeObj.portal.user.joinGroup=
b;this.privilegeObj.portal.user.joinNonOrgGroup=b;this.privilegeObj.portal.user.createItem=b;this.privilegeObj.portal.user.shareToGroup=b;this.privilegeObj.portal.user.shareToOrg=b;this.privilegeObj.portal.user.shareToPublic=b;this.privilegeObj.portal.user.shareGroupToOrg=b;this.privilegeObj.portal.user.shareGroupToPublic=b;this.privilegeObj.features.user.edit=b;this.privilegeObj.opendata.user.openDataAdmin=b;this.privilegeObj.opendata.user.designateGroup=b;this.privilegeObj.premium.user.geocode=
b;this.privilegeObj.premium.user.networkanalysis=b;this.privilegeObj.premium.user.spatialanalysis=b;this.privilegeObj.premium.user.geoenrichment=b;this.privilegeObj.premium.user.demographics=b;this.privilegeObj.premium.user.elevation=b;this.privilegeObj.marketplace.admin.purchase=b;this.privilegeObj.marketplace.admin.manage=b;this.privilegeObj.marketplace.admin.startTrial=b},_buildPrivilegesArray:function(){var b=[];!0===this.privilegeObj.portal.admin.inviteUsers&&b.push("portal:admin:inviteUsers");
!0===this.privilegeObj.portal.admin.disableUsers&&b.push("portal:admin:disableUsers");!0===this.privilegeObj.portal.admin.viewUsers&&b.push("portal:admin:viewUsers");!0===this.privilegeObj.portal.admin.updateUsers&&b.push("portal:admin:updateUsers");!0===this.privilegeObj.portal.admin.deleteUsers&&b.push("portal:admin:deleteUsers");!0===this.privilegeObj.portal.admin.changeUserRoles&&b.push("portal:admin:changeUserRoles");!0===this.privilegeObj.portal.admin.viewGroups&&b.push("portal:admin:viewGroups");
!0===this.privilegeObj.portal.admin.updateGroups&&b.push("portal:admin:updateGroups");!0===this.privilegeObj.portal.admin.deleteGroups&&b.push("portal:admin:deleteGroups");!0===this.privilegeObj.portal.admin.reassignGroups&&b.push("portal:admin:reassignGroups");!0===this.privilegeObj.portal.admin.assignToGroups&&b.push("portal:admin:assignToGroups");!0===this.privilegeObj.portal.admin.manageEnterpriseGroups&&b.push("portal:admin:manageEnterpriseGroups");!0===this.privilegeObj.portal.admin.viewItems&&
b.push("portal:admin:viewItems");!0===this.privilegeObj.portal.admin.updateItems&&b.push("portal:admin:updateItems");!0===this.privilegeObj.portal.admin.deleteItems&&b.push("portal:admin:deleteItems");!0===this.privilegeObj.portal.admin.reassignItems&&b.push("portal:admin:reassignItems");!0===this.privilegeObj.portal.admin.manageLicenses&&b.push("portal:admin:manageLicenses");!0===this.privilegeObj.portal.publisher.publishFeatures&&b.push("portal:publisher:publishFeatures");!0===this.privilegeObj.portal.publisher.publishTiles&&
b.push("portal:publisher:publishTiles");!0===this.privilegeObj.portal.publisher.publishScenes&&b.push("portal:publisher:publishScenes");!0===this.privilegeObj.portal.user.createGroup&&b.push("portal:user:createGroup");!0===this.privilegeObj.portal.user.joinGroup&&b.push("portal:user:joinGroup");!0===this.privilegeObj.portal.user.joinNonOrgGroup&&b.push("portal:user:joinNonOrgGroup");!0===this.privilegeObj.portal.user.createItem&&b.push("portal:user:createItem");!0===this.privilegeObj.portal.user.shareToGroup&&
b.push("portal:user:shareToGroup");!0===this.privilegeObj.portal.user.shareToOrg&&b.push("portal:user:shareToOrg");!0===this.privilegeObj.portal.user.shareToPublic&&b.push("portal:user:shareToPublic");!0===this.privilegeObj.portal.user.shareGroupToOrg&&b.push("portal:user:shareGroupToOrg");!0===this.privilegeObj.portal.user.shareGroupToPublic&&b.push("portal:user:shareGroupToPublic");!0===this.privilegeObj.features.user.edit&&b.push("features:user:edit");!0===this.privilegeObj.features.user.fullEdit&&
b.push("features:user:fullEdit");!0===this.privilegeObj.opendata.user.openDataAdmin&&b.push("opendata:user:openDataAdmin");!0===this.privilegeObj.opendata.user.designateGroup&&b.push("opendata:user:designateGroup");!0===this.privilegeObj.premium.user.geocode&&b.push("premium:user:geocode");!0===this.privilegeObj.premium.user.networkanalysis&&b.push("premium:user:networkanalysis");!0===this.privilegeObj.premium.user.spatialanalysis&&b.push("premium:user:spatialanalysis");!0===this.privilegeObj.premium.user.geoenrichment&&
b.push("premium:user:geoenrichment");!0===this.privilegeObj.premium.user.demographics&&b.push("premium:user:demographics");!0===this.privilegeObj.premium.user.elevation&&b.push("premium:user:elevation");!0===this.privilegeObj.marketplace.admin.purchase&&b.push("marketplace:admin:purchase");!0===this.privilegeObj.marketplace.admin.manage&&b.push("marketplace:admin:manage");!0===this.privilegeObj.marketplace.admin.startTrial&&b.push("marketplace:admin:startTrial");return b},isUser:function(){return b.isDefined(this.id)&&
("org_user"===this.id||"account_user"===this.id)},isPublisher:function(){return b.isDefined(this.id)&&("org_publisher"===this.id||"account_publisher"===this.id)},isAdmin:function(){return b.isDefined(this.id)&&("org_admin"===this.id||"account_admin"===this.id)},isBasedOnUser:function(){return this.isUser()||b.isDefined(this.baseRole)&&("org_user"===this.baseRole||"account_user"===this.baseRole)},isBasedOnPublisher:function(){return this.isPublisher()||b.isDefined(this.baseRole)&&("org_publisher"===
this.baseRole||"account_publisher"===this.baseRole)},isBasedOnAdmin:function(){return this.isAdmin()||b.isDefined(this.baseRole)&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)},isCustom:function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&b.isDefined(this.id)&&0<this.id.length},canInviteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.inviteUsers},canDisableUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers},
canViewUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers},canUpdateUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateUsers},canDeleteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers},canChangeUserRoles:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles},canViewOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups},canUpdateOrgGroups:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.updateGroups},canDeleteOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups},canReassignOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups},canAssignUsersToOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups},canManageEnterpriseGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups},canViewOrgItems:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.viewItems},canUpdateOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems},canDeleteOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems},canReassignOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems},canManageLicenses:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses},canCreateGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup},
canJoinOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup},canJoinNonOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup},canPublishFeatures:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishFeatures},canPublishTiles:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles},canPublishScenes:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes},
canCreateItem:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem},canShareItemToGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup},canShareItemToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg},canShareItemToPublic:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToPublic},canShareGroupToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg},canShareGroupToPublic:function(){return this.privilegeObj&&
this.privilegeObj.portal.user.shareGroupToPublic},canEditFeatures:function(){return this.privilegeObj&&this.privilegeObj.features.user.edit},canEditFeaturesFullControl:function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit},canManageOpenData:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.openDataAdmin},canDesignateOpenDataGroups:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup},canUseGeocode:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.geocode},canUseNetworkAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis},canUseSpatialAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis},canUseGeoenrichment:function(){return this.privilegeObj&&this.privilegeObj.premium.user.geoenrichment},canUseDemographics:function(){return this.privilegeObj&&this.privilegeObj.premium.user.demographics},canUseElevation:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.elevation},canPurchaseMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase},canManageMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage},canTrialMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.startTrial},setPrivileges:function(d){this.privileges=d;this._initPrivilegesObject();b.isDefined(d)&&this._readPrivileges(d)},stringify:function(){return g.stringify({id:this.id,
name:this.name,description:this.description,privileges:this._buildPrivilegesArray()})},stringifyRole:function(){return g.stringify({id:this.id,name:this.name,description:this.description})},stringifyPrivileges:function(){return g.stringify({privileges:this._buildPrivilegesArray()})},stringifyPretty:function(){return g.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()},null,"  ")}})})},"dojox/charting/plot2d/StackedBars":function(){define(["dojo/_base/declare",
"./Bars","./commonStacked"],function(l,m,h){return l("dojox.charting.plot2d.StackedBars",m,{getSeriesStats:function(){var k=h.collectStats(this.series),g;k.hmin-=0.5;k.hmax+=0.5;g=k.hmin;k.hmin=k.vmin;k.vmin=g;g=k.hmax;k.hmax=k.vmax;k.vmax=g;return k},getValue:function(k,g,b,d){d?k=h.getIndexValue(this.series,b,g):(g=k.x-1,k=h.getValue(this.series,b,k.x),k=[k[0]?k[0].y:null,k[1]?k[1]:null]);return{x:g,y:k[0],py:k[1]}}})})},"webSceneViewer/webScene/LayerTemplates":function(){define("dojo/_base/lang esri/request esri/core/urlUtils dojo/Deferred dojo/promise/all dojo/sniff esri/renderers/Renderer esri/renderers/SimpleRenderer esri/renderers/UniqueValueRenderer esri/symbols/support/jsonUtils".split(" "),
function(l,m,h,k,g,b,d,e,a,c){var f={};l.mixin(f,{symbolFromJSON:function(a){f.adjustProtocolInSymbolRefs(a);(b("ie")||b("trident"))&&f.changeSVGRefsToPNG(a);return c.fromJSON(a)},removeProtocol:function(a){return a=a.replace(/^http:|https:/,"")},adjustProtocol:function(a){return a="https:"===location.protocol?a.replace(/^http:/,"https:"):a.replace(/^https:/,"http:")},removeProtocolFromSymbolRefs:function(a){if(a.symbolLayers)for(var b=0;b<a.symbolLayers.length;b++){var c=a.symbolLayers[b];if(c.resource&&
c.resource.href){var d=c.resource.href;h.fixUrl(d);d=f.removeProtocol(d);c.resource.href=d}}},adjustProtocolInSymbolRefs:function(a){if(a.symbolLayers)for(var b=0;b<a.symbolLayers.length;b++){var c=a.symbolLayers[b];if(c.resource&&c.resource.href){var d=c.resource.href,d=f.adjustProtocol(d);c.resource.href=d}}},changeSVGRefsToPNG:function(a){if(a.symbolLayers)for(var b=0;b<a.symbolLayers.length;b++){var c=a.symbolLayers[b];if(c.resource&&c.resource.href&&-1!==c.resource.href.indexOf(".svg",c.resource.href.length-
4)){var d=c.resource.href,d=d.replace(".svg",".png"),d=d.replace("/resource/","/resource/png/");c.resource.href=d}}},hasContentByReference:function(a){return!a?!1:a.styleUrl||a.styleName?"renderer":a.symbol&&a.symbol.type&&"styleSymbolReference"===a.symbol.type?"symbol":!1},getStyleFromUrl:function(a){var b=new k;m({url:f.adjustProtocol(a),content:{f:"json"},handleAs:"json"}).then(function(a){b.resolve(a)},function(a){b.reject(a)});return b},getStyle:function(a,b){var c=new k;if(!b)return c.reject("no portal to query styles"),
c;var d=b.stylesGroupQuery;if(!d)return c.reject("no stylesGroupQuery in portal.self"),c;b.queryGroups(d,!0).then(function(d){if(!d.results||0===d.results.length)return c.reject("no styles in styleGroup"),c;b.queryGroupItems(d.results[0].id,{q:"typekeywords:"+a},!0).then(function(d){0===d.total?c.reject("style name "+a+" not in style group"):b.getItemData(d.results[0].id).then(function(a){c.resolve(a)})})});return c},getSymbolSet:function(a){var b=new k;if(!a.symbolSetUrl)return b.reject("style does not provide url for symbolSet"),
b;m({url:f.adjustProtocol(a.symbolSetUrl),content:{f:"json"},handleAs:"json"}).then(function(c){(0===c.length||!c[0].name)&&b.reject("invalid syntax or missing data in symbol set");for(var d={defaultSymbol:void 0},e=0;e<c.length;e++){var g=f.symbolFromJSON(c[e]);d[c[e].name]=g;c[e].name===a.defaultItem&&(d.defaultSymbol=g)}d.defaultSymbol||(d.defaultSymbol=d[c[0].name]);b.resolve(d)});return b},getSymbolsIndividually:function(a){for(var b=[],c=0;c<a.items.length;c++)b.push(f.getSymbol(a.items[c].name));
return g(b)},getSymbol:function(a,b){for(var c=new k,d=0;d<a.items.length;d++)if(a.items[d].name===b)return m({url:f.adjustProtocol(a.items[d].webRef),content:{f:"json"},handleAs:"json"}).then(function(a){c.resolve(f.symbolFromJSON(a))},function(a){c.reject(a)}),c;c.reject("symbolName "+b+" not found in style");return c},getSymbolFromUrl:function(a){var b=new k;m({url:f.adjustProtocol(a),content:{f:"json"},handleAs:"json"}).then(function(a){b.resolve(f.symbolFromJSON(a))},function(a){b.reject(a)});
return b},createRenderer:function(a,b){var c,d=f.hasContentByReference(a);"renderer"===d?c=f._createUVRendererFromStyleUrl(a,b):"symbol"===d&&(c=f._createSimpleRendererWithStyleSymbolReference(a,b));return c},_patchInfosIntoRenderer:function(a,b){var c=new d(a);c.sizeInfo&&b.setProportionalSymbolInfo(c.sizeInfo);c.colorInfo&&b.setColorInfo(c.colorInfo);c.visualVariables&&b.setVisualVariables(c.visualVariables);return b},_createSimpleRendererWithStyleSymbolReference:function(a,b){var c=new k,d=a.symbol;
if(!d.name)return c.reject("no name in styleSymbolReference symbol"),c;var g;if(d.styleUrl)g=f.getStyleFromUrl(d.styleUrl);else if(d.styleName)g=f.getStyle(d.styleName,b);else return c.reject("no styleUrl or styleName in layerDefinition "+a),c;g.then(function(b){f.getSymbol(b,d.name).then(function(b){b=new e(b);b=f._patchInfosIntoRenderer(a,b);c.resolve(b)},function(a){c.reject("Can't get symbol. "+a)})},function(a){c.reject(a)});return c},_createUVRendererFromStyleUrl:function(b,c){var d=new k,e;
if(b.styleUrl)e=f.getStyleFromUrl(b.styleUrl);else if(b.styleName)e=f.getStyle(b.styleName,c);else return d.reject("no styleUrl or styleName in layerDefinition "+b),d;e.then(function(c){f.getSymbolSet(c).then(function(c){var e=new a(b.defaultSymbol&&c[b.defaultSymbol.name]?c[b.defaultSymbol.name]:c.defaultSymbol,b.field1),g;for(g in c)c.hasOwnProperty(g)&&e.addValue(g,c[g]);e=f._patchInfosIntoRenderer(b,e);d.resolve(e)},function(a){d.reject(a)})},function(a){d.reject(a)});return d}});return f})},
"dojox/charting/plot2d/Columns":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/functional/reversed dojox/lang/utils dojox/gfx/fx".split(" "),function(l,m,h,k,g,b,d,e,a,c,f){var n=a.lambda("item.purgeGroup()");return h("dojox.charting.plot2d.Columns",[g,b],{defaultParams:{gap:0,animate:null,enableCache:!1},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},filter:{},
styleFunc:null,font:"",fontColor:""},constructor:function(a,b){this.opt=l.clone(l.mixin(this.opt,this.defaultParams));c.updateWithObject(this.opt,b);c.updateWithPattern(this.opt,b,this.optionalParams);this.animate=this.opt.animate;this.renderingOptions={"shape-rendering":"crispEdges"}},getSeriesStats:function(){var a=d.collectSimpleStats(this.series);a.hmin-=0.5;a.hmax+=0.5;return a},createRect:function(a,b,c){var d;this.opt.enableCache&&0<a._rectFreePool.length?(d=a._rectFreePool.pop(),d.setShape(c),
b.add(d)):d=b.createRect(c);this.opt.enableCache&&a._rectUsePool.push(d);return d},render:function(a,b){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,b);this.resetEvents();this.dirty=this.isDirty();var c;this.dirty&&(m.forEach(this.series,n),this._eventSeries={},this.cleanGroup(),c=this.getGroup(),e.forEachRev(this.series,function(a){a.cleanGroup(c)}));var d=this.chart.theme,f=this._hScaler.scaler.getTransformerFromModel(this._hScaler),g=this._vScaler.scaler.getTransformerFromModel(this._vScaler),
h=Math.max(0,this._vScaler.bounds.lower),L=g(h),t=this.events(),A=this.getBarProperties(),s=this.series.length;m.forEach(this.series,function(a){a.hidden&&s--});for(var B=this.series.length-1;0<=B;--B){var y=this.series[B];if(!this.dirty&&!y.dirty)d.skip(),this._reconnectEvents(y.name);else{y.cleanGroup();this.opt.enableCache&&(y._rectFreePool=(y._rectFreePool?y._rectFreePool:[]).concat(y._rectUsePool?y._rectUsePool:[]),y._rectUsePool=[]);var u=d.next("column",[this.opt,y]),E=Array(y.data.length);
if(y.hidden)y.dyn.fill=u.series.fill;else{s--;c=y.group;for(var I=m.some(y.data,function(a){return"number"==typeof a||a&&!a.hasOwnProperty("x")}),z=I?Math.max(0,Math.floor(this._hScaler.bounds.from-1)):0,H=I?Math.min(y.data.length,Math.ceil(this._hScaler.bounds.to)):y.data.length;z<H;++z){var J=y.data[z];if(null!=J){var G=this.getValue(J,z,B,I),F=g(G.y),K=Math.abs(F-L),D,N;this.opt.styleFunc||"number"!=typeof J?(D="number"!=typeof J?[J]:[],this.opt.styleFunc&&D.push(this.opt.styleFunc(J)),D=d.addMixin(u,
"column",D,!0)):D=d.post(u,"column");if(1<=A.width&&0<=K){var w={x:b.l+f(G.x+0.5)+A.gap+A.thickness*s,y:a.height-b.b-(G.y>h?F:L),width:A.width,height:K};D.series.shadow&&(N=l.clone(w),N.x+=D.series.shadow.dx,N.y+=D.series.shadow.dy,N=this.createRect(y,c,N).setFill(D.series.shadow.color).setStroke(D.series.shadow),this.animate&&this._animateColumn(N,a.height-b.b+L,K));var O=this._plotFill(D.series.fill,a,b),O=this._shapeFill(O,w),O=this.createRect(y,c,w).setFill(O).setStroke(D.series.stroke);O.setFilter&&
D.series.filter&&O.setFilter(D.series.filter);y.dyn.fill=O.getFill();y.dyn.stroke=O.getStroke();if(t){var P={element:"column",index:z,run:y,shape:O,shadow:N,cx:G.x+0.5,cy:G.y,x:I?z:y.data[z].x,y:I?y.data[z]:y.data[z].y};this._connectEvents(P);E[z]=P}!isNaN(G.py)&&G.py>h&&(w.height=F-g(G.py));this.createLabel(c,J,w,D);this.animate&&this._animateColumn(O,a.height-b.b-L,K)}}}this._eventSeries[y.name]=E;y.dirty=!1}}}this.dirty=!1;k("dojo-bidi")&&this._checkOrientation(this.group,a,b);return this},getValue:function(a,
b,c,d){d?(c="number"==typeof a?a:a.y,a=b):(c=a.y,a=a.x-1);return{x:a,y:c}},getBarProperties:function(){var a=d.calculateBarSize(this._hScaler.bounds.scale,this.opt);return{gap:a.gap,width:a.size,thickness:0}},_animateColumn:function(a,b,c){0==c&&(c=1);f.animateTransform(l.delegate({shape:a,duration:1200,transform:[{name:"translate",start:[0,b-b/c],end:[0,0]},{name:"scale",start:[1,1/c],end:[1,1]},{name:"original"}]},this.animate)).play()}})})},"dojox/lang/functional/array":function(){define(["dojo/_base/kernel",
"dojo/_base/lang","dojo/_base/array","./lambda"],function(l,m,h,k){var g={};m.mixin(k,{filter:function(b,d,e){"string"==typeof b&&(b=b.split(""));e=e||l.global;d=k.lambda(d);var a=[],c,f,n;if(m.isArray(b)){f=0;for(n=b.length;f<n;++f)c=b[f],d.call(e,c,f,b)&&a.push(c)}else if("function"==typeof b.hasNext&&"function"==typeof b.next)for(f=0;b.hasNext();)c=b.next(),d.call(e,c,f++,b)&&a.push(c);else for(f in b)f in g||(c=b[f],d.call(e,c,f,b)&&a.push(c));return a},forEach:function(b,d,e){"string"==typeof b&&
(b=b.split(""));e=e||l.global;d=k.lambda(d);var a,c;if(m.isArray(b)){a=0;for(c=b.length;a<c;d.call(e,b[a],a,b),++a);}else if("function"==typeof b.hasNext&&"function"==typeof b.next)for(a=0;b.hasNext();d.call(e,b.next(),a++,b));else for(a in b)a in g||d.call(e,b[a],a,b);return e},map:function(b,d,e){"string"==typeof b&&(b=b.split(""));e=e||l.global;d=k.lambda(d);var a,c,f;if(m.isArray(b)){a=Array(c=b.length);for(f=0;f<c;a[f]=d.call(e,b[f],f,b),++f);}else if("function"==typeof b.hasNext&&"function"==
typeof b.next){a=[];for(f=0;b.hasNext();a.push(d.call(e,b.next(),f++,b)));}else for(f in a=[],b)f in g||a.push(d.call(e,b[f],f,b));return a},every:function(b,d,e){"string"==typeof b&&(b=b.split(""));e=e||l.global;d=k.lambda(d);var a,c;if(m.isArray(b)){a=0;for(c=b.length;a<c;++a)if(!d.call(e,b[a],a,b))return!1}else if("function"==typeof b.hasNext&&"function"==typeof b.next)for(a=0;b.hasNext();){if(!d.call(e,b.next(),a++,b))return!1}else for(a in b)if(!(a in g)&&!d.call(e,b[a],a,b))return!1;return!0},
some:function(b,d,e){"string"==typeof b&&(b=b.split(""));e=e||l.global;d=k.lambda(d);var a,c;if(m.isArray(b)){a=0;for(c=b.length;a<c;++a)if(d.call(e,b[a],a,b))return!0}else if("function"==typeof b.hasNext&&"function"==typeof b.next)for(a=0;b.hasNext();){if(d.call(e,b.next(),a++,b))return!0}else for(a in b)if(!(a in g)&&d.call(e,b[a],a,b))return!0;return!1}});return k})},"esri/tasks/GeometryService":function(){define("dojo/_base/array ../core/declare dojo/_base/lang ../request ./Task ../geometry/Extent ../geometry/support/jsonUtils ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon".split(" "),
function(l,m,h,k,g,b,d,e,a,c){m=m(g,{declaredClass:"esri.tasks.GeometryService",_encodeGeometries:function(a){var b=[],c,e=a.length;for(c=0;c<e;c++)b.push(a[c].toJSON());return{geometryType:d.getJsonType(a[0]),geometries:b}},_decodeGeometries:function(a,b,c){var e=d.getGeometryType(b);a=a.geometries;var g=[],k={spatialReference:c.toJSON()},m=h.mixin;l.forEach(a,function(a,b){g[b]=new e(m(a,k))});return g},_toProjectGeometry:function(d){var e=d.spatialReference.toJSON();return d instanceof b?new c({rings:[[[d.xmin,
d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]]],spatialReference:e}):new a({paths:[[].concat(d.points)],spatialReference:e})},_fromProjectedGeometry:function(a,c,d){return"esriGeometryEnvelope"===c?(a=a.rings[0],new b(a[0][0],a[0][1],a[2][0],a[2][1],d)):new e({points:a.paths[0],spatialReference:d.toJSON()})},project:function(a,b){var c=h.mixin({},this.parsedUrl.query,{f:"json"}),e;a.geometries?(b=a.outSR,e=a.geometries[0],c=h.mixin(c,a.toJSON())):(e=a[0],c=h.mixin(c,{outSR:b.wkid||
JSON.stringify(b.toJSON()),inSR:e.spatialReference.wkid||JSON.stringify(e.spatialReference.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}));var g=d.getJsonType(e),l=this._decodeGeometries;return k({url:this.parsedUrl.path+"/project",content:c,callbackParamName:"callback"}).then(function(a){return l(a,g,b)})},simplify:function(a){var b=a[0].spatialReference,c=h.mixin({},this.parsedUrl.query,{f:"json",sr:b.wkid?b.wkid:JSON.stringify(b.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),
e=d.getJsonType(a[0]),g=this._decodeGeometries;return k({url:this.parsedUrl.path+"/simplify",content:c,callbackParamName:"callback"}).then(function(a){return g(a,e,b)})},convexHull:function(a){var b=a[0].spatialReference;a=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(b.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))});return k({url:this.parsedUrl.path+"/convexHull",content:a,callbackParamName:"callback"}).then(function(a){return d.fromJSON(a.geometry).set("spatialReference",
b)})},union:function(a){var b=a[0].spatialReference;a=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(b.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))});return k({url:this.parsedUrl.path+"/union",content:a,callbackParamName:"callback"}).then(function(a){return d.fromJSON(a.geometry).set("spatialReference",b)})},autoComplete:function(a,b){var d=a[0].spatialReference,e=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(d.toJSON()),polygons:JSON.stringify(this._encodeGeometries(a).geometries),
polylines:JSON.stringify(this._encodeGeometries(b).geometries)});return k({url:this.parsedUrl.path+"/autoComplete",content:e,callbackParamName:"callback"}).then(function(a){return(a.geometries||[]).map(function(a){return new c({spatialReference:d,rings:a.rings})})})},reshape:function(a,b){var c=a.spatialReference,e=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(c.toJSON()),target:JSON.stringify({geometryType:d.getJsonType(a),geometry:a.toJSON()}),reshaper:JSON.stringify(b.toJSON())});
return k({url:this.parsedUrl.path+"/reshape",content:e,callbackParamName:"callback"}).then(function(a){return d.fromJSON(a.geometry).set("spatialReference",c)})},cut:function(a,b){var c=a[0].spatialReference,e=l.map(a,function(a){return a.toJSON()}),e=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(c.toJSON()),target:JSON.stringify({geometryType:d.getJsonType(a[0]),geometries:e}),cutter:JSON.stringify(b.toJSON())});return k({url:this.parsedUrl.path+"/cut",content:e,callbackParamName:"callback"}).then(function(a){return{cutIndexes:a.cutIndexes,
geometries:(a.geometries||[]).map(function(a){return d.fromJSON(a).set("spatialReference",c)})}})},intersect:function(a,b){var c=a[0].spatialReference,e=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(c.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a)),geometry:JSON.stringify({geometryType:d.getJsonType(b),geometry:b.toJSON()})});return k({url:this.parsedUrl.path+"/intersect",content:e,callbackParamName:"callback"}).then(function(a){return(a.geometries||[]).map(function(a){return d.fromJSON(a).set("spatialReference",
c)})})},difference:function(a,b){var c=a[0].spatialReference,e=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(c.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a)),geometry:JSON.stringify({geometryType:d.getJsonType(b),geometry:b.toJSON()})});return k({url:this.parsedUrl.path+"/difference",content:e,callbackParamName:"callback"}).then(function(a){return(a.geometries||[]).map(function(a){return d.fromJSON(a).set("spatialReference",c)})})},buffer:function(a){var b=h.mixin({},
this.parsedUrl.query,{f:"json"},a.toJSON()),d=a.outSpatialReference||a.geometries[0].spatialReference;return k({url:this.parsedUrl.path+"/buffer",content:b,callbackParamName:"callback"}).then(function(a){return(a.geometries||[]).map(function(a){return new c({spatialReference:d,rings:a.rings})})})},areasAndLengths:function(a){a=h.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON());return k({url:this.parsedUrl.path+"/areasAndLengths",content:a,callbackParamName:"callback"})},lengths:function(a){a=
h.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON());return k({url:this.parsedUrl.path+"/lengths",content:a,callbackParamName:"callback"})},labelPoints:function(a){var b=l.map(a,function(a){return a.toJSON()}),c=a[0].spatialReference;a=h.mixin({},this.parsedUrl.query,{f:"json",sr:c.wkid?c.wkid:JSON.stringify(c.toJSON()),polygons:JSON.stringify(b)});return k({url:this.parsedUrl.path+"/labelPoints",content:a,callbackParamName:"callback"}).then(function(a){return(a.labelPoints||[]).map(function(a){return d.fromJSON(a).set("spatialReference",
c)})})},relation:function(a){a=h.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON());return k({url:this.parsedUrl.path+"/relation",content:a,callbackParamName:"callback"}).then(this._handleRelationResponse)},trimExtend:function(b){var c=h.mixin({},this.parsedUrl.query,{f:"json"},b.toJSON()),d=b.sr;return k({url:this.parsedUrl.path+"/trimExtend",content:c,callbackParamName:"callback"}).then(function(b){return(b.geometries||[]).map(function(b){return new a({spatialReference:d,paths:b.paths})})})},
densify:function(a){var b=h.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),c=a.geometries[0].spatialReference;return k({url:this.parsedUrl.path+"/densify",content:b,callbackParamName:"callback"}).then(function(a){return(a.geometries||[]).map(function(a){return d.fromJSON(a).set("spatialReference",c)})})},generalize:function(a){var b=h.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),c=a.geometries[0].spatialReference;return k({url:this.parsedUrl.path+"/generalize",content:b,callbackParamName:"callback"}).then(function(a){return(a.geometries||
[]).map(function(a){return d.fromJSON(a).set("spatialReference",c)})})},offset:function(a){var b=h.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),c=a.geometries[0].spatialReference;return k({url:this.parsedUrl.path+"/offset",content:b,callbackParamName:"callback"}).then(function(a){return(a.geometries||[]).map(function(a){return d.fromJSON(a).set("spatialReference",c)})})},distance:function(a){a=h.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON());return k({url:this.parsedUrl.path+"/distance",
content:a,callbackParamName:"callback"}).then(this._handleDistanceResponse)},toGeoCoordinateString:function(a){var b={};h.isObject(a.sr)?b.sr=a.sr.wkid||JSON.stringify(a.sr.toJSON()):b.sr=a.sr;b.coordinates=JSON.stringify(a.coordinates);b.conversionType=a.conversionType||"MGRS";b.conversionMode=a.conversionMode;b.numOfDigits=a.numOfDigits;b.rounding=a.rounding;b.addSpaces=a.addSpaces;a=h.mixin({},this.parsedUrl.query,{f:"json"},b);return k({url:this.parsedUrl.path+"/toGeoCoordinateString",content:a,
callbackParamName:"callback"}).then(this._handleToGeoCoordinateResponse)},fromGeoCoordinateString:function(a){var b={};h.isObject(a.sr)?b.sr=a.sr.wkid||JSON.stringify(a.sr.toJSON()):b.sr=a.sr;b.strings=JSON.stringify(a.strings);b.conversionType=a.conversionType||"MGRS";b.conversionMode=a.conversionMode;a=h.mixin({},this.parsedUrl.query,{f:"json"},b);return k({url:this.parsedUrl.path+"/fromGeoCoordinateString",content:a,callbackParamName:"callback"}).then(this._handleFromGeoCoordinateResponse)},_handleRelationResponse:function(a){return a.relations},
_handleDistanceResponse:function(a){return a&&a.distance},_handleToGeoCoordinateResponse:function(a){return a.strings},_handleFromGeoCoordinateResponse:function(a){return a.coordinates}});h.mixin(m,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,
UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,
UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,
UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",
UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return m})},"dojox/charting/Theme":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/Color ./SimpleTheme dojox/color/_base dojox/color/Palette dojox/gfx/gradutils".split(" "),function(l,m,h,k,g,b){var d=m("dojox.charting.Theme",k,{});l.mixin(d,{defineColors:function(d){d=d||{};var a,c=[],f=d.num||5;if(d.colors){a=d.colors.length;for(var n=0;n<f;n++)c.push(d.colors[n%
a]);return c}return d.hue?(c=d.saturation||100,a=((d.high||90)+(d.low||30))/2,b.generate(g.fromHsv(d.hue,c,a),"monochromatic").colors):d.generator?g.Palette.generate(d.base,d.generator).colors:c},generateGradient:function(b,a,c){b=l.delegate(b);b.colors=[{offset:0,color:a},{offset:1,color:c}];return b},generateHslColor:function(b,a){b=new h(b);var c=b.toHsl(),c=g.fromHsl(c.h,c.s,a);c.a=b.a;return c},generateHslGradient:function(b,a,c,f){b=new h(b);var n=b.toHsl();c=g.fromHsl(n.h,n.s,c);f=g.fromHsl(n.h,
n.s,f);c.a=f.a=b.a;return d.generateGradient(a,c,f)}});d.defaultMarkers=k.defaultMarkers;d.defaultColors=k.defaultColors;d.defaultTheme=k.defaultTheme;return d})},"dojox/charting/themes/common":function(){define(["dojo/_base/lang"],function(l){return l.getObject("dojox.charting.themes",!0)})},"dojox/charting/plot2d/common":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/Color dojox/gfx dojox/lang/functional ../scaler/common".split(" "),function(l,m,h,k,g,b){var d=l.getObject("dojox.charting.plot2d.common",
!0);return l.mixin(d,{doIfLoaded:b.doIfLoaded,makeStroke:function(b){if(!b)return b;if("string"==typeof b||b instanceof h)b={color:b};return k.makeParameters(k.defaultStroke,b)},augmentColor:function(b,a){var c=new h(b),d=new h(a);d.a=c.a;return d},augmentStroke:function(b,a){var c=d.makeStroke(b);c&&(c.color=d.augmentColor(c.color,a));return c},augmentFill:function(b,a){new h(a);return"string"==typeof b||b instanceof h?d.augmentColor(b,a):b},defaultStats:{vmin:Number.POSITIVE_INFINITY,vmax:Number.NEGATIVE_INFINITY,
hmin:Number.POSITIVE_INFINITY,hmax:Number.NEGATIVE_INFINITY},collectSimpleStats:function(b){for(var a=l.delegate(d.defaultStats),c=0;c<b.length;++c)for(var f=b[c],g=0;g<f.data.length;g++)if(null!==f.data[g]){if("number"==typeof f.data[g]){var g=a.vmin,h=a.vmax;m.forEach(f.data,function(b,c){if(null!==b){var d=c+1,e=b;isNaN(e)&&(e=0);a.hmin=Math.min(a.hmin,d);a.hmax=Math.max(a.hmax,d);a.vmin=Math.min(a.vmin,e);a.vmax=Math.max(a.vmax,e)}})}else{var q=a.hmin,p=a.hmax,g=a.vmin,h=a.vmax;(!("xmin"in f)||
!("xmax"in f)||!("ymin"in f)||!("ymax"in f))&&m.forEach(f.data,function(b,c){if(null!==b){var d="x"in b?b.x:c+1,e=b.y;isNaN(d)&&(d=0);isNaN(e)&&(e=0);a.hmin=Math.min(a.hmin,d);a.hmax=Math.max(a.hmax,d);a.vmin=Math.min(a.vmin,e);a.vmax=Math.max(a.vmax,e)}});"xmin"in f&&(a.hmin=Math.min(q,f.xmin));"xmax"in f&&(a.hmax=Math.max(p,f.xmax))}"ymin"in f&&(a.vmin=Math.min(g,f.ymin));"ymax"in f&&(a.vmax=Math.max(h,f.ymax));break}return a},calculateBarSize:function(b,a,c){c||(c=1);var d=a.gap,d=(b-2*d)/c;"minBarSize"in
a&&(d=Math.max(d,a.minBarSize));"maxBarSize"in a&&(d=Math.min(d,a.maxBarSize));d=Math.max(d,1);return{size:d,gap:(b-d*c)/2}},collectStackedStats:function(b){var a=l.clone(d.defaultStats);if(b.length){a.hmin=Math.min(a.hmin,1);a.hmax=g.foldl(b,"seed, run -\x3e Math.max(seed, run.data.length)",a.hmax);for(var c=0;c<a.hmax;++c){var f=b[0].data[c],f=f&&("number"==typeof f?f:f.y);isNaN(f)&&(f=0);a.vmin=Math.min(a.vmin,f);for(var n=1;n<b.length;++n){var h=b[n].data[c],h=h&&("number"==typeof h?h:h.y);isNaN(h)&&
(h=0);f+=h}a.vmax=Math.max(a.vmax,f)}}return a},curve:function(b,a){var c=b.slice(0);"x"==a&&(c[c.length]=c[0]);return m.map(c,function(b,d){if(0==d)return"M"+b.x+","+b.y;if(isNaN(a)){if("X"==a||"x"==a||"S"==a){var e,g=c[d-1],h=c[d],k,l,m,M=1/6;1==d?(e="x"==a?c[c.length-2]:g,M=1/3):e=c[d-2];d==c.length-1?(k="x"==a?c[1]:h,M=1/3):k=c[d+1];l=Math.sqrt((h.x-g.x)*(h.x-g.x)+(h.y-g.y)*(h.y-g.y));m=Math.sqrt((h.x-e.x)*(h.x-e.x)+(h.y-e.y)*(h.y-e.y));var L=Math.sqrt((k.x-g.x)*(k.x-g.x)+(k.y-g.y)*(k.y-g.y)),
t=m*M,M=L*M;t>l/2&&M>l/2?(t=l/2,M=l/2):t>l/2?(t=l/2,M=l/2*L/m):M>l/2&&(M=l/2,t=l/2*m/L);"S"==a&&(e==g&&(t=0),h==k&&(M=0));l=g.x+t*(h.x-e.x)/m;e=g.y+t*(h.y-e.y)/m;m=h.x-M*(k.x-g.x)/L;g=h.y-M*(k.y-g.y)/L}}else return h=b.x-c[d-1].x,"C"+(b.x-(a-1)*(h/a))+","+c[d-1].y+" "+(b.x-h/a)+","+b.y+" "+b.x+","+b.y;return"C"+(l+","+e+" "+m+","+g+" "+h.x+","+h.y)}).join(" ")},getLabel:function(d,a,c){return b.doIfLoaded("dojo/number",function(b){return(a?b.format(d,{places:c}):b.format(d))||""},function(){return a?
d.toFixed(c):d.toString()})}})})},"dojox/charting/plot2d/Bars":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/has ./CartesianBase ./_PlotEvents ./common dojox/gfx/fx dojox/lang/utils dojox/lang/functional dojox/lang/functional/reversed".split(" "),function(l,m,h,k,g,b,d,e,a,c,f){var n=f.lambda("item.purgeGroup()");return h("dojox.charting.plot2d.Bars",[g,b],{defaultParams:{gap:0,animate:null,enableCache:!1},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},
shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:""},constructor:function(b,c){this.opt=l.clone(l.mixin(this.opt,this.defaultParams));a.updateWithObject(this.opt,c);a.updateWithPattern(this.opt,c,this.optionalParams);this.animate=this.opt.animate;this.renderingOptions={"shape-rendering":"crispEdges"}},getSeriesStats:function(){var a=d.collectSimpleStats(this.series),b;a.hmin-=0.5;a.hmax+=0.5;b=a.hmin;a.hmin=a.vmin;a.vmin=b;b=a.hmax;a.hmax=a.vmax;a.vmax=b;return a},createRect:function(a,
b,c){var d;this.opt.enableCache&&0<a._rectFreePool.length?(d=a._rectFreePool.pop(),d.setShape(c),b.add(d)):d=b.createRect(c);this.opt.enableCache&&a._rectUsePool.push(d);return d},createLabel:function(a,b,c,d){this.opt.labels&&"outside"==this.opt.labelStyle?this.renderLabel(a,c.x+c.width+this.opt.labelOffset,c.y+c.height/2,this._getLabel(isNaN(b.y)?b:b.y),d,"start"):this.inherited(arguments)},render:function(a,b){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,b);this.dirty=this.isDirty();
this.resetEvents();var d;this.dirty&&(m.forEach(this.series,n),this._eventSeries={},this.cleanGroup(),d=this.getGroup(),c.forEachRev(this.series,function(a){a.cleanGroup(d)}));var e=this.chart.theme,f=this._hScaler.scaler.getTransformerFromModel(this._hScaler),g=this._vScaler.scaler.getTransformerFromModel(this._vScaler),h=Math.max(0,this._hScaler.bounds.lower),L=f(h),t=this.events(),A=this.getBarProperties(),s=this.series.length;m.forEach(this.series,function(a){a.hidden&&s--});for(var B=s,y=this.series.length-
1;0<=y;--y){var u=this.series[y];if(!this.dirty&&!u.dirty)e.skip(),this._reconnectEvents(u.name);else{u.cleanGroup();this.opt.enableCache&&(u._rectFreePool=(u._rectFreePool?u._rectFreePool:[]).concat(u._rectUsePool?u._rectUsePool:[]),u._rectUsePool=[]);var E=e.next("bar",[this.opt,u]);if(u.hidden)u.dyn.fill=E.series.fill,u.dyn.stroke=E.series.stroke;else{B--;var I=Array(u.data.length);d=u.group;for(var z=m.some(u.data,function(a){return"number"==typeof a||a&&!a.hasOwnProperty("x")}),H=z?Math.max(0,
Math.floor(this._vScaler.bounds.from-1)):0,J=z?Math.min(u.data.length,Math.ceil(this._vScaler.bounds.to)):u.data.length;H<J;++H){var G=u.data[H];if(null!=G){var F=this.getValue(G,H,y,z),K=f(F.y),D=Math.abs(K-L),N,w;this.opt.styleFunc||"number"!=typeof G?(N="number"!=typeof G?[G]:[],this.opt.styleFunc&&N.push(this.opt.styleFunc(G)),N=e.addMixin(E,"bar",N,!0)):N=e.post(E,"bar");if(0<=D&&1<=A.height){K={x:b.l+(F.y<h?K:L),y:a.height-b.b-g(F.x+1.5)+A.gap+A.thickness*(s-B-1),width:D,height:A.height};N.series.shadow&&
(w=l.clone(K),w.x+=N.series.shadow.dx,w.y+=N.series.shadow.dy,w=this.createRect(u,d,w).setFill(N.series.shadow.color).setStroke(N.series.shadow),this.animate&&this._animateBar(w,b.l+L,-D));var O=this._plotFill(N.series.fill,a,b),O=this._shapeFill(O,K),O=this.createRect(u,d,K).setFill(O).setStroke(N.series.stroke);O.setFilter&&N.series.filter&&O.setFilter(N.series.filter);u.dyn.fill=O.getFill();u.dyn.stroke=O.getStroke();if(t){var P={element:"bar",index:H,run:u,shape:O,shadow:w,cx:F.y,cy:F.x+1.5,x:z?
H:u.data[H].x,y:z?u.data[H]:u.data[H].y};this._connectEvents(P);I[H]=P}!isNaN(F.py)&&F.py>h&&(K.x+=f(F.py),K.width-=f(F.py));this.createLabel(d,G,K,N);this.animate&&this._animateBar(O,b.l+L,-D)}}}this._eventSeries[u.name]=I;u.dirty=!1}}}this.dirty=!1;k("dojo-bidi")&&this._checkOrientation(this.group,a,b);return this},getValue:function(a,b,c,d){d?(c="number"==typeof a?a:a.y,a=b):(c=a.y,a=a.x-1);return{y:c,x:a}},getBarProperties:function(){var a=d.calculateBarSize(this._vScaler.bounds.scale,this.opt);
return{gap:a.gap,height:a.size,thickness:0}},_animateBar:function(a,b,c){0==c&&(c=1);e.animateTransform(l.delegate({shape:a,duration:1200,transform:[{name:"translate",start:[b-b/c,0],end:[0,0]},{name:"scale",start:[1/c,1],end:[1,1]},{name:"original"}]},this.animate)).play()}})})},"dojox/charting/plot2d/CartesianBase":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/connect dojo/has ./Base ../scaler/primitive dojox/gfx dojox/gfx/fx dojox/lang/utils".split(" "),function(l,m,h,k,g,b,
d,e,a){return m("dojox.charting.plot2d.CartesianBase",g,{baseParams:{hAxis:"x",vAxis:"y",labels:!1,labelOffset:10,fixed:!0,precision:1,labelStyle:"inside",htmlLabels:!0,omitLabels:!0,labelFunc:null},constructor:function(b,d){this.axes=["hAxis","vAxis"];this.zoom=null;this.zoomQueue=[];this.lastWindow={vscale:1,hscale:1,xoffset:0,yoffset:0};this.hAxis=d&&d.hAxis||"x";this.vAxis=d&&d.vAxis||"y";this.series=[];this.opt=l.clone(this.baseParams);a.updateWithObject(this.opt,d)},clear:function(){this.inherited(arguments);
this._vAxis=this._hAxis=null;return this},cleanGroup:function(a,b){this.inherited(arguments);if(!b&&this.chart._nativeClip){var d=this.chart.offsets,e=this.chart.dim,g=Math.max(0,e.width-d.l-d.r),e=Math.max(0,e.height-d.t-d.b);this.group.setClip({x:d.l,y:d.t,width:g,height:e});this._clippedGroup||(this._clippedGroup=this.group.createGroup())}},purgeGroup:function(){this.inherited(arguments);this._clippedGroup=null},getGroup:function(){return this._clippedGroup||this.group},setAxis:function(a){a&&
(this[a.vertical?"_vAxis":"_hAxis"]=a);return this},toPage:function(a){var b=this._hAxis,d=this._vAxis,e=b.getScaler(),g=d.getScaler(),h=e.scaler.getTransformerFromModel(e),k=g.scaler.getTransformerFromModel(g),l=this.chart.getCoords(),m=this.chart.offsets,M=this.chart.dim,e=function(a){var c={};c.x=h(a[b.name])+l.x+m.l;c.y=l.y+M.height-m.b-k(a[d.name]);return c};return a?e(a):e},toData:function(a){var b=this._hAxis,d=this._vAxis,e=b.getScaler(),g=d.getScaler(),h=e.scaler.getTransformerFromPlot(e),
k=g.scaler.getTransformerFromPlot(g),l=this.chart.getCoords(),m=this.chart.offsets,M=this.chart.dim,e=function(a){var c={};c[b.name]=h(a.x-l.x-m.l);c[d.name]=k(l.y+M.height-a.y-m.b);return c};return a?e(a):e},isDirty:function(){return this.dirty||this._hAxis&&this._hAxis.dirty||this._vAxis&&this._vAxis.dirty},createLabel:function(a,b,e,g){if(this.opt.labels){var h,p=this.opt.labelFunc?this.opt.labelFunc.apply(this,[b,this.opt.fixed,this.opt.precision]):this._getLabel(isNaN(b.y)?b:b.y);if("inside"==
this.opt.labelStyle){var k=d._base._getTextBox(p,{font:g.series.font});b=e.x+e.width/2;h=e.y+e.height/2+k.h/4;if(k.w>e.width||k.h>e.height)return}else b=e.x+e.width/2,h=e.y-this.opt.labelOffset;this.renderLabel(a,b,h,p,g,"inside"==this.opt.labelStyle)}},performZoom:function(a,b){var d=this._vAxis.scale||1,g=this._hAxis.scale||1,k=a.height-b.b,p=this._hScaler.bounds,p=(p.from-p.lower)*p.scale,m=this._vScaler.bounds,m=(m.from-m.lower)*m.scale,x=d/this.lastWindow.vscale,C=g/this.lastWindow.hscale,M=
(this.lastWindow.xoffset-p)/(1==this.lastWindow.hscale?g:this.lastWindow.hscale),L=(m-this.lastWindow.yoffset)/(1==this.lastWindow.vscale?d:this.lastWindow.vscale),t=this.getGroup(),k=e.animateTransform(l.delegate({shape:t,duration:1200,transform:[{name:"translate",start:[0,0],end:[b.l*(1-C),k*(1-x)]},{name:"scale",start:[1,1],end:[C,x]},{name:"original"},{name:"translate",start:[0,0],end:[M,L]}]},this.zoom));l.mixin(this.lastWindow,{vscale:d,hscale:g,xoffset:p,yoffset:m});this.zoomQueue.push(k);
h.connect(k,"onEnd",this,function(){this.zoom=null;this.zoomQueue.shift();0<this.zoomQueue.length&&this.zoomQueue[0].play()});1==this.zoomQueue.length&&this.zoomQueue[0].play();return this},initializeScalers:function(a,d){this._hAxis?(this._hAxis.initialized()||this._hAxis.calculate(d.hmin,d.hmax,a.width),this._hScaler=this._hAxis.getScaler()):this._hScaler=b.buildScaler(d.hmin,d.hmax,a.width);this._vAxis?(this._vAxis.initialized()||this._vAxis.calculate(d.vmin,d.vmax,a.height),this._vScaler=this._vAxis.getScaler()):
this._vScaler=b.buildScaler(d.vmin,d.vmax,a.height);return this}})})},"esri/layers/support/LayerDrawingOptions":function(){define("../../core/declare dojo/_base/lang dojo/_base/array ../../core/lang ../../renderers/support/jsonUtils ./LabelClass".split(" "),function(l,m,h,k,g,b){return l(null,{declaredClass:"esri.layers.support.LayerDrawingOptions",constructor:function(d){if(d&&(m.mixin(this,d),d.renderer&&(this.renderer=g.fromJSON(d.renderer)),d.labelingInfo&&0<d.labelingInfo.length)){this.labelingInfo=
[];var e;h.forEach(d.labelingInfo,function(a){e=new b(a);this.labelingInfo.push(e)},this)}},toJson:function(){try{throw Error("toJson is deprecated, use toJSON instead");}catch(b){console.warn(b.stack)}return this.toJSON()},toJSON:function(){var b={renderer:this.renderer&&this.renderer.toJSON(),transparency:this.transparency,scaleSymbols:this.scaleSymbols,showLabels:this.showLabels};this.labelingInfo&&0<this.labelingInfo.length&&(b.labelingInfo=[],h.forEach(this.labelingInfo,function(e){b.labelingInfo.push(e.toJSON())}));
return k.fixJson(b)}})})},"dojox/charting/plot2d/StackedLines":function(){define(["dojo/_base/declare","./Stacked"],function(l,m){return l("dojox.charting.plot2d.StackedLines",m,{constructor:function(){this.opt.lines=!0}})})},"webSceneViewer/basemapUtils":function(){define("dojo/promise/all dojo/Deferred dojo/_base/lang esri/layers/ArcGISElevationLayer esri/core/watchUtils esri/geometry/SpatialReference webSceneViewer/webScene/WebSceneLayers esri/Basemap esri/core/Collection webSceneViewer/widgets/MessageListWidget/MessageListWidget webSceneViewer/spatialReferenceUtils esri/layers/OpenStreetMapLayer esri/layers/GraphicsLayer esri/views/3d/terrain/TilingScheme esri/geometry/support/webMercatorUtils esri/geometry/support/scaleUtils esri/geometry/Extent ./environmentUtils dojo/i18n!webSceneViewer/nls/viewer".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n,r,q,p,v,x,C,M){function L(a){var b=Error("Invalid basemap");b.errors=a;return b}function t(a){for(var b=[],c=[],e=0;e<a.length;e++){var f=a[e];if(f instanceof n)c.push({layer:f});else if(d.extrapolateTypeFromLayerInstance(f))if(f.url){var g=d.validateServerUrl(f.url);g.hasLayer?b.push({msg:M.messages.addLayerFailed,details:"unsupported url "+f.url}):c.push({layer:f,serviceDetails:g,url:f.url,params:{url:f.url}})}else b.push({msg:M.messages.addLayerFailed,details:"missing url"});
else b.push({msg:M.messages.onlyTiledLayerSupported,details:f.url})}if(0!==b.length)throw L(b);return c}function A(a){function b(){0===c.length?f.resolve(e):f.reject(L(c.filter(function(a){return!!a})))}for(var c=[],e=[],f=new m,g=a.length,h=0;h<a.length;h++){var n=a[h];n.serviceDetails?d.prepareOpLayerFromService(n,1).then(function(a,c){e[a]=c;0===--g&&b()}.bind(this,h),function(a,d){c[a]=d;0===--g&&b()}.bind(this,h)):(e[h]={layerType:d.extrapolateTypeFromLayerInstance(n.layer)},0===--g&&b())}0===
a.length&&b();return f.promise}function s(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];"ArcGISTiledMapServiceLayer"!==d.layerType&&("ArcGISTiledImageServiceLayer"!==d.layerType&&"ArcGISTiledElevationServiceLayer"!==d.layerType&&"OpenStreetMap"!==d.layerType)&&b.push({msg:M.messages.onlyTiledLayerSupported,details:a[c].url})}if(0<b.length)throw L(b);}var B,y={},u={_basemapLayersEqual:function(a,b){return a.length!==b.length?!1:!!a.reduce(function(a,c,d){d=b.getItemAt(d);return a&&d&&d instanceof
c.constructor&&c.url===d.url},!0)},equals:function(a,b){return!b?!1:u._basemapLayersEqual(a.baseLayers,b.baseLayers)&&u._basemapLayersEqual(a.referenceLayers,b.referenceLayers)&&u._basemapLayersEqual(a.elevationLayers,b.elevationLayers)},turnOnElevation:function(a){var b=a.basemap;b.elevationLayers&&0<b.elevationLayers.length||(b?b.elevationLayers=b._elevationLayersCache&&0<b._elevationLayersCache.length?b._elevationLayersCache:[u.DefaultElevationLayer]:a.basemap=new e({elevationLayers:[u.DefaultElevationLayer]}))},
turnOffElevation:function(a){var b=a.basemap;b&&(b._elevationLayersCache=b.get("elevationLayers").getAll(),b.elevationLayers=[],0===b.baseLayers.length&&(a.basemap=null))},_copyBasemapLayers:function(a,b){return b.map(function(b){var c=a.find(function(a){return b instanceof a.constructor&&a.url===b.url});return c?c:b})},fixSSL:function(a,b){function c(a){Array.isArray(a)&&a.forEach(function(a){a.url=d.useSSLIfRequired(a.url,b)})}b||(b=u.portal);c(a.baseMapLayers);c(a.elevationLayers);c(a.referenceLayers)},
fixJSON:function(a,b){var c=h.clone(a);Array.isArray(c.baseMapLayers)&&c.baseMapLayers.forEach(function(a){!a.layerType&&a.type&&(a.layerType=a.type,delete a.type);!a.urlTemplate&&a.templateUrl&&(a.urlTemplate=a.templateUrl)});this.fixSSL(c,b);return c},fromJSON:function(a,b){try{return e.fromJSON(this.fixJSON(a,b))}catch(c){throw Error("");}},fromJSONAndCopySubLayers:function(a,b,c){b=this.fromJSON(b);a&&(b.baseLayers=u._copyBasemapLayers(a.baseLayers,b.baseLayers),b.elevationLayers=c?a.elevationLayers:
u._copyBasemapLayers(a.elevationLayers,b.elevationLayers),b.referenceLayers=u._copyBasemapLayers(a.referenceLayers,b.referenceLayers));return b},_handleBasemapSetError:function(a,d){if(!a.map.isFulfilled()){var e=u.spatialReferenceLocked?a.map.spatialReference:b.WebMercator,f=new r({spatialReference:e,id:"__basemapErrorFallbackLayer__"});if(!p.canProject(f.fullExtent,f.spatialReference)){var h=5E4*v.getUnitValueForSR(f.spatialReference);f.fullExtent=new x({xmin:-h,xmax:h,ymin:-h,ymax:h,spatialReference:f.spatialReference})}a.map.spatialReference=
e;if("planar"===a.globeMode)g.once(a,"fullExtent",function(){a.map.remove(f);setTimeout(function(){a.extent=a.fullExtent},0)});else a.then(function(){a.map.remove(f)});a.map.add(f)}if(d&&d.errors)for(e=0;e<d.errors.length;e++)h=d.errors[e],c.show({message:M.dialogs.unsupportedBasemap,type:c.MessageTypes.ERROR,details:(h.msg||h.message)+(h.details?"\n"+h.details:"")});else d&&c.show({message:M.dialogs.unsupportedBasemap,type:c.MessageTypes.ERROR,details:(d.msg||d.message)+(d.details?"\n"+d.details:
"")})},validateAndSet:function(b,d,e,h){var n=b.map;B&&(B.cancel(y),B=null);if(d&&u.equals(d,n.basemap))e!==b.basemapTransparency&&u.applyTransparency(b,e);else{if(d){var p=new a;p.addItems(d.baseLayers);p.addItems(d.referenceLayers);p.addItems(d.elevationLayers);var k;return k=B=l(p.getAll()).then(t).then(A).then(s).then(function(){if(B===k||void 0===k){B=null;var a=this.getBasemapSR(d),p=!1;if(a&&(!a.equals(b.map.spatialReference)||!this._tilingSchemeEquals(d,b)))if(this._allowBasemapToSwitchSR(h,
b))p=d.baseLayers&&0<d.baseLayers.length&&d.baseLayers.getItemAt(0).fullExtent,this._resetView(b.map,a),f.pingGeometryService(p.center),p=!0;else{c.show({message:M.messages.selectedBasemapMismatchTitle,type:c.MessageTypes.ERROR,details:M.messages.selectedBasemapMismatch});return}0===d.baseLayers.length&&0===d.elevationLayers.length&&(d=null);if(n.basemap=d)this.checkAndSetDefaultElevationAvailability(b,p),(a=u.getFirstLayer(d))&&C.adjustLightForLayer(b,a);g.whenOnce(b,"ready",function(){n.basemap===
d&&u.applyTransparency(b,e)})}}.bind(this),function(a){if(a!==y&&(B===k||void 0===k))B=null,u._handleBasemapSetError(b,a)})}this._handleBasemapSetError(b,null)}},checkAndSetDefaultElevationAvailability:function(a,b){var c=a.map;try{u._checkDefaultElevationCompatibility(a),b&&u.turnOnElevation(c)}catch(d){u.turnOffElevation(c)}},_checkDefaultElevationCompatibility:function(a){var b=a.map.basemap,c=a.spatialReference,d;b?d=(b=b.elevationLayers&&0<b.elevationLayers.length?b.elevationLayers.getItemAt(0):
b._elevationLayersCache&&0<b._elevationLayersCache.length?b._elevationLayersCache[0]:u.DefaultElevationLayer)?b.spatialReference:null:(b=u.DefaultElevationLayer,d=u.DefaultElevationLayer.spatialReference);if(d&&c&&!d.equals(c))throw{msg:M.messages.elevationBasemapTitle,details:M.messages.elevationBasemapSR};a=a.basemapTerrain?a.basemapTerrain.tilingScheme:null;c=b?b.tileInfo:null;if(a&&c&&!a.compatibleWith(c))throw{msg:M.messages.elevationBasemapTitle,details:M.messages.elevationBasemapTS};},getBasemapTS:function(a){return(a=
a.baseLayers&&a.baseLayers.length?a.baseLayers.getItemAt(0):null)?new q(a.tileInfo):null},_allowBasemapToSwitchSR:function(a,b){var c=!b.map.layers.some(function(a){return"__basemapErrorFallbackLayer__"!==a.id&&"SilentContentLayer"!==a.id});return!a&&!u.spatialReferenceLocked&&c},_tilingSchemeEquals:function(a,b){var c=a.baseLayers&&a.baseLayers.items.length?a.baseLayers.items[0]:null;return c?b.basemapTerrain&&b.basemapTerrain.tilingScheme?b.basemapTerrain.tilingScheme.compatibleWith(c.tileInfo):
!0:!0},_resetView:function(a,c){c=c instanceof b?c.clone():b.fromJSON(c);a.basemap&&(a.basemap=null);a.spatialReference=c.clone()},setFromJSON:function(a,b,c,d){var e,f=a.map;try{e=u.fromJSONAndCopySubLayers(f.basemap,b,c)}catch(g){u._handleBasemapSetError(a,g);return}return u.validateAndSet(a,e,b.transparency,d)},isBasemapGlobalCapable:function(a){return 0<a.baseMapLayers.length&&a.baseMapLayers[0].resourceInfo?(a=a.baseMapLayers[0].resourceInfo.spatialReference,a instanceof b||(a=b.fromJSON(a)),
a.isWebMercator()):!0},getJsonBasemapSR:function(a){return 0<a.baseMapLayers.length&&a.baseMapLayers[0].resourceInfo?(a=a.baseMapLayers[0].resourceInfo.spatialReference,a instanceof b||(a=b.fromJSON(a)),a):b.WebMercator},getBasemapSR:function(a){if(a){if(a.baseLayers&&0<a.baseLayers.length&&a.baseLayers.getItemAt(0).spatialReference)return a.baseLayers.getItemAt(0).spatialReference;if(a.elevationLayers&&0<a.elevationLayers.length&&a.elevationLayers.getItemAt(0).spatialReference)return a.elevationLayers.getItemAt(0).spatialReference}return null},
_basemapLayersToJSON:function(a,b,c){a.forEach(function(a){var e={id:a.id},f=d.extrapolateTypeFromLayerInstance(a);"OpenStreetMap"!==f&&(e.url=a.url);null!=f&&(e.layerType=f);c&&(e.isReference=!0);b.push(e)});return b},toJSON:function(a,b){var c;b?(c={},c.visibility=b.visibility,null!=b.id&&(c.id=b.id),null!=b.title&&(c.title=b.title),c.baseMapLayers=[],u._basemapLayersToJSON(b.baseLayers,c.baseMapLayers),u._basemapLayersToJSON(b.referenceLayers,c.baseMapLayers,!0),c.elevationLayers=[],u._basemapLayersToJSON(b.elevationLayers,
c.elevationLayers)):c={id:"empty-basemap",baseMapLayers:[],elevationLayers:[]};void 0!==a.basemapTransparency&&0!==a.basemapTransparency&&(c.transparency=a.basemapTransparency);return c},applyTransparency:function(a,b){void 0!==b&&0!==b?(a.basemapTerrain.opacity=0.99,a.basemapTerrain.wireframe={mode:"shader",wireOpacity:1,surfaceOpacity:0,width:1,subdivision:"constant",subdivisionReduceLevels:2},a.basemapTerrain.frontMostTransparent=!0):(a.basemapTerrain.wireframe=!1,a.basemapTerrain.frontMostTransparent=
!1,a.basemapTerrain.opacity=1);a.basemapTransparency=b},getFirstLayer:function(a){return a.baseLayers&&a.baseLayers.getItemAt(0)||a.elevationLayers&&a.elevationLayers.getItemAt(0)},portal:null,spatialReferenceLocked:!1};u.defaultArcGISWorldElevationService=location.protocol+"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer";u.DefaultElevationLayer=new k({id:"globalElevation",url:u.defaultArcGISWorldElevationService});u.DefaultBasemapJson={baseMapLayers:[{id:"worldTopoBase",
opacity:1,visibility:!0,url:location.protocol+"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}],elevationLayers:[{id:"globalElevation",url:u.defaultArcGISWorldElevationService,layerType:"ArcGISTiledElevationServiceLayer"}],title:"Topographic"};return u})},"webSceneViewer/spatialReferenceUtils":function(){define("dojo/Deferred esri/config esri/geometry/SpatialReference esri/geometry/support/scaleUtils esri/tasks/support/ProjectParameters webSceneViewer/widgets/MessageListWidget/MessageListWidget dojo/i18n!webSceneViewer/nls/viewer".split(" "),
function(l,m,h,k,g,b,d){var e={isGeographicCRS:function(a){return 1E5<k.getUnitValueForSR(a)},projectLayerExtentToSceneSR:function(a,b){m.geometryService&&require(["dojo/on"],function(b){b.once(a,"load",function(){var b=a.fullExtent;if(b){var c=window._webSceneViewerView.map.spatialReference;if(!b.spatialReference.equals(c)){var d=m.geometryService,e=new g;e.geometries=[b];e.outSR=c.clone();d.project(e).then(function(b){b&&0<b.length&&a.set("fullExtent",b[0])})}}})})},getLatitudeOfPoint:function(a){var b=
new l,d=a.latitude;if(d)b.resolve(d);else{var d=m.geometryService,e=new g;e.geometries=[a];e.outSR=h.WGS84;d.project(e).then(function(a){a&&0<a.length?b.resolve(a[0].y):b.reject()},function(){b.reject()})}return b.promise},pingGeometryService:function(a){e.getLatitudeOfPoint(a).otherwise(function(a){b.show({message:d.messages.geometryServiceUnavailableTitle,type:b.MessageTypes.ERROR,details:d.messages.geometryServiceUnavailable})})}};return e})},"dojox/charting/plot2d/StackedColumns":function(){define(["dojo/_base/declare",
"./Columns","./commonStacked"],function(l,m,h){return l("dojox.charting.plot2d.StackedColumns",m,{getSeriesStats:function(){var k=h.collectStats(this.series);k.hmin-=0.5;k.hmax+=0.5;return k},getValue:function(k,g,b,d){d?k=h.getIndexValue(this.series,b,g):(g=k.x-1,k=h.getValue(this.series,b,k.x),k=[k[0]?k[0].y:null,k[1]?k[1]:null]);return{x:g,y:k[0],py:k[1]}}})})},"webSceneViewer/widgets/Crosshair/Crosshair":function(){define("esri/core/declare esri/core/watchUtils esri/core/domUtils esri/views/3d/support/eventUtils dojo/dom-construct dojo/dom-style".split(" "),
function(l,m,h,k,g,b){return l(null,{constructor:function(d){this.node=g.create("div",{className:"crosshair",id:"navCrosshair"},d.container);h.hide(this.node);this.dim=[b.get(this.node,"width"),b.get(this.node,"height")];var e=function(a){this.show([a.x,a.y])}.bind(this),a=function(a){this.hide()}.bind(this),c=new k.Handles;this.navigationWatchHandle=m.init(d,"navigation",function(b){c.remove();b&&c.push(b.zoom.on("begin",e),b.zoom.on("end",a),b.pan.on("begin",a),b.rotate.on("begin",a))});this.handles=
c},destroy:function(){this.navigationWatchHandle.remove();this.handles.remove()},show:function(d){b.set(this.node,"left",d[0]-this.dim[0]/2+"px");b.set(this.node,"top",d[1]-this.dim[1]/2+"px");h.show(this.node)},hide:function(){h.hide(this.node)}})})},"dojox/charting/plot2d/Default":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/functional/reversed dojox/lang/utils dojox/gfx/fx".split(" "),function(l,
m,h,k,g,b,d,e,a,c,f){var n=a.lambda("item.purgeGroup()");return m("dojox.charting.plot2d.Default",[g,b],{defaultParams:{lines:!0,areas:!1,markers:!1,tension:"",animate:!1,enableCache:!1,interpolate:!1},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:"",marker:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerFont:"",markerFontColor:""},constructor:function(a,b){this.opt=l.clone(l.mixin(this.opt,this.defaultParams));c.updateWithObject(this.opt,
b);c.updateWithPattern(this.opt,b,this.optionalParams);this.animate=this.opt.animate},createPath:function(a,b,c){var d;this.opt.enableCache&&0<a._pathFreePool.length?(d=a._pathFreePool.pop(),d.setShape(c),b.add(d)):d=b.createPath(c);this.opt.enableCache&&a._pathUsePool.push(d);return d},buildSegments:function(a,b){for(var c=this.series[a],d=b?Math.max(0,Math.floor(this._hScaler.bounds.from-1)):0,e=b?Math.min(c.data.length,Math.ceil(this._hScaler.bounds.to)):c.data.length,f=null,g=[];d<e;d++)if(null!=
c.data[d]&&(b||null!=c.data[d].y))f||(f=[],g.push({index:d,rseg:f})),f.push(b&&c.data[d].hasOwnProperty("y")?c.data[d].y:c.data[d]);else if(!this.opt.interpolate||b)f=null;return g},render:function(a,b){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,b);this.resetEvents();this.dirty=this.isDirty();var c;this.dirty&&(h.forEach(this.series,n),this._eventSeries={},this.cleanGroup(),this.getGroup().setTransform(null),c=this.getGroup(),e.forEachRev(this.series,function(a){a.cleanGroup(c)}));
for(var g=this.chart.theme,m,C,M=this.events(),L=this.series.length-1;0<=L;--L){var t=this.series[L];if(!this.dirty&&!t.dirty)g.skip(),this._reconnectEvents(t.name);else if(t.cleanGroup(),this.opt.enableCache&&(t._pathFreePool=(t._pathFreePool?t._pathFreePool:[]).concat(t._pathUsePool?t._pathUsePool:[]),t._pathUsePool=[]),t.data.length){var A=g.next(this.opt.areas?"area":"line",[this.opt,t],!0),s,B=this._hScaler.scaler.getTransformerFromModel(this._hScaler),y=this._vScaler.scaler.getTransformerFromModel(this._vScaler),
u=this._eventSeries[t.name]=Array(t.data.length);c=t.group;if(t.hidden)this.opt.lines&&(t.dyn.stroke=A.series.stroke),this.opt.markers&&(t.dyn.markerFill=A.marker.fill,t.dyn.markerStroke=A.marker.stroke,t.dyn.marker=A.symbol),this.opt.areas&&(t.dyn.fill=A.series.fill);else{for(var E=h.some(t.data,function(a){return"number"==typeof a||a&&!a.hasOwnProperty("x")}),I=this.buildSegments(L,E),z=0;z<I.length;z++){var H=I[z];s=E?h.map(H.rseg,function(c,d){return{x:B(d+H.index+1)+b.l,y:a.height-b.b-y(c),data:c}},
this):h.map(H.rseg,function(c){return{x:B(c.x)+b.l,y:a.height-b.b-y(c.y),data:c}},this);if(E&&this.opt.interpolate)for(;z<I.length;)z++,(H=I[z])&&(s=s.concat(h.map(H.rseg,function(c,d){return{x:B(d+H.index+1)+b.l,y:a.height-b.b-y(c),data:c}},this)));var J=this.opt.tension?d.curve(s,this.opt.tension):"";if(this.opt.areas&&1<s.length){var G=this._plotFill(A.series.fill,a,b),F=l.clone(s);this.opt.tension?t.dyn.fill=c.createPath(J+" "+("L"+F[F.length-1].x+","+(a.height-b.b)+" L"+F[0].x+","+(a.height-
b.b)+" L"+F[0].x+","+F[0].y)).setFill(G).getFill():(F.push({x:s[s.length-1].x,y:a.height-b.b}),F.push({x:s[0].x,y:a.height-b.b}),F.push(s[0]),t.dyn.fill=c.createPolyline(F).setFill(G).getFill())}if(this.opt.lines||this.opt.markers)m=A.series.stroke,A.series.outline&&(C=t.dyn.outline=d.makeStroke(A.series.outline),C.width=2*C.width+m.width);this.opt.markers&&(t.dyn.marker=A.symbol);var K=null,D=null,N=null;if(m&&A.series.shadow&&1<s.length){var w=A.series.shadow,G=h.map(s,function(a){return{x:a.x+
w.dx,y:a.y+w.dy}});this.opt.lines&&(t.dyn.shadow=this.opt.tension?c.createPath(d.curve(G,this.opt.tension)).setStroke(w).getStroke():c.createPolyline(G).setStroke(w).getStroke());this.opt.markers&&A.marker.shadow&&(w=A.marker.shadow,N=h.map(G,function(a){return this.createPath(t,c,"M"+a.x+" "+a.y+" "+A.symbol).setStroke(w).setFill(w.color)},this))}if(this.opt.lines&&1<s.length){var O;C&&(t.dyn.outline=this.opt.tension?c.createPath(J).setStroke(C).getStroke():c.createPolyline(s).setStroke(C).getStroke());
t.dyn.stroke=this.opt.tension?(O=c.createPath(J)).setStroke(m).getStroke():(O=c.createPolyline(s)).setStroke(m).getStroke();O.setFilter&&A.series.filter&&O.setFilter(A.series.filter)}J=null;if(this.opt.markers){var P=A,K=Array(s.length),D=Array(s.length);C=null;P.marker.outline&&(C=d.makeStroke(P.marker.outline),C.width=2*C.width+(P.marker.stroke?P.marker.stroke.width:0));h.forEach(s,function(a,b){if(this.opt.styleFunc||"number"!=typeof a.data){var d="number"!=typeof a.data?[a.data]:[];this.opt.styleFunc&&
d.push(this.opt.styleFunc(a.data));P=g.addMixin(A,"marker",d,!0)}else P=g.post(A,"marker");d="M"+a.x+" "+a.y+" "+P.symbol;C&&(D[b]=this.createPath(t,c,d).setStroke(C));K[b]=this.createPath(t,c,d).setStroke(P.marker.stroke).setFill(P.marker.fill)},this);t.dyn.markerFill=P.marker.fill;t.dyn.markerStroke=P.marker.stroke;!J&&this.opt.labels&&(J=K[0].getBoundingBox());M?h.forEach(K,function(a,b){var c={element:"marker",index:b+H.index,run:t,shape:a,outline:D[b]||null,shadow:N&&N[b]||null,cx:s[b].x,cy:s[b].y};
E?(c.x=b+H.index+1,c.y=t.data[b+H.index]):(c.x=H.rseg[b].x,c.y=t.data[b+H.index].y);this._connectEvents(c);u[b+H.index]=c},this):delete this._eventSeries[t.name]}if(this.opt.labels){var V=J?J.width:2,Y=J?J.height:2;h.forEach(s,function(a,b){if(this.opt.styleFunc||"number"!=typeof a.data){var d="number"!=typeof a.data?[a.data]:[];this.opt.styleFunc&&d.push(this.opt.styleFunc(a.data));P=g.addMixin(A,"marker",d,!0)}else P=g.post(A,"marker");this.createLabel(c,H.rseg[b],{x:a.x-V/2,y:a.y-Y/2,width:V,height:Y},
P)},this)}}t.dirty=!1}}else t.dirty=!1,g.skip()}k("dojo-bidi")&&this._checkOrientation(this.group,a,b);this.animate&&(m=this.getGroup(),f.animateTransform(l.delegate({shape:m,duration:1200,transform:[{name:"translate",start:[0,a.height-b.b],end:[0,0]},{name:"scale",start:[1,0],end:[1,1]},{name:"original"}]},this.animate)).play());this.dirty=!1;return this}})})},"dojox/charting/Series":function(){define(["dojo/_base/lang","dojo/_base/declare","./Element"],function(l,m,h){return m("dojox.charting.Series",
h,{constructor:function(h,g,b){l.mixin(this,b);"string"!=typeof this.plot&&(this.plot="default");this.update(g)},clear:function(){this.dyn={}},update:function(h){l.isArray(h)?this.data=h:(this.source=h,this.data=this.source.data,this.source.setSeriesObject&&this.source.setSeriesObject(this));this.dirty=!0;this.clear()}})})},"dojox/charting/plot2d/Base":function(){define("dojo/_base/declare dojo/_base/array dojox/gfx ../Element ./common ../axis2d/common dojo/has".split(" "),function(l,m,h,k,g,b,d){l=
l("dojox.charting.plot2d.Base",k,{constructor:function(b,a){a&&a.tooltipFunc&&(this.tooltipFunc=a.tooltipFunc)},clear:function(){this.series=[];this.dirty=!0;return this},setAxis:function(b){return this},assignAxes:function(b){m.forEach(this.axes,function(a){this[a]&&this.setAxis(b[this[a]])},this)},addSeries:function(b){this.series.push(b);return this},getSeriesStats:function(){return g.collectSimpleStats(this.series)},calculateAxes:function(b){this.initializeScalers(b,this.getSeriesStats());return this},
initializeScalers:function(){return this},isDataDirty:function(){return m.some(this.series,function(b){return b.dirty})},render:function(b,a){return this},renderLabel:function(d,a,c,f,g,k,q){d=b.createText[this.opt.htmlLabels&&"vml"!=h.renderer?"html":"gfx"](this.chart,d,a,c,q?q:"middle",f,g.series.font,g.series.fontColor);k&&(this.opt.htmlLabels&&"vml"!=h.renderer?d.style.pointerEvents="none":d.rawNode&&(d.rawNode.style.pointerEvents="none"));this.opt.htmlLabels&&"vml"!=h.renderer&&this.htmlElements.push(d);
return d},getRequiredColors:function(){return this.series.length},_getLabel:function(b){return g.getLabel(b,this.opt.fixed,this.opt.precision)}});d("dojo-bidi")&&l.extend({_checkOrientation:function(b,a,c){this.chart.applyMirroring(this.group,a,c)}});return l})},"dojox/charting/action2d/Tooltip":function(){define("dijit/Tooltip dojo/_base/lang dojo/_base/declare dojo/_base/window dojo/_base/connect dojo/dom-style ./PlotAction dojox/gfx/matrix dojo/has dojo/has!dojo-bidi?../bidi/action2d/Tooltip dojox/lang/functional dojox/lang/functional/scan dojox/lang/functional/fold".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f){var n=function(a,b){var c=a.run&&a.run.data&&a.run.data[a.index];return c&&"number"!=typeof c&&(c.tooltip||c.text)?c.tooltip||c.text:b.tooltipFunc?b.tooltipFunc(a):a.y},r=Math.PI/4,q=Math.PI/2;b=h(a("dojo-bidi")?"dojox.charting.action2d.NonBidiTooltip":"dojox.charting.action2d.Tooltip",d,{defaultParams:{text:n,mouseOver:!0},optionalParams:{},constructor:function(a,b,c){this.text=c&&c.text?c.text:n;this.mouseOver=c&&void 0!=c.mouseOver?c.mouseOver:!0;this.connect()},
process:function(b){if("onplotreset"===b.type||"onmouseout"===b.type)l.hide(this.aroundRect),this.aroundRect=null,"onplotreset"===b.type&&delete this.angles;else if(b.shape&&!(this.mouseOver&&"onmouseover"!==b.type||!this.mouseOver&&"onclick"!==b.type)){var c={type:"rect"},d=["after-centered","before-centered"];switch(b.element){case "marker":c.x=b.cx;c.y=b.cy;c.w=c.h=1;break;case "circle":c.x=b.cx-b.cr;c.y=b.cy-b.cr;c.w=c.h=2*b.cr;break;case "spider_circle":c.x=b.cx;c.y=b.cy;c.w=c.h=1;break;case "spider_plot":return;
case "column":d=["above-centered","below-centered"];case "bar":c=m.clone(b.shape.getShape());c.w=c.width;c.h=c.height;break;case "candlestick":c.x=b.x;c.y=b.y;c.w=b.width;c.h=b.height;break;default:if(!this.angles){var h="number"==typeof b.run.data[0]?f.map(b.run.data,"x ? Math.max(x, 0) : 0"):f.map(b.run.data,"x ? Math.max(x.y, 0) : 0");this.angles=f.map(f.scanl(h,"+",0),"* 2 * Math.PI / this",f.foldl(h,"+",0))}var h=e._degToRad(b.plot.opt.startAngle),n=(this.angles[b.index]+this.angles[b.index+
1])/2+h;c.x=b.cx+b.cr*Math.cos(n);c.y=b.cy+b.cr*Math.sin(n);c.w=c.h=1;if(h&&(0>n||n>2*Math.PI))n=Math.abs(2*Math.PI-Math.abs(n));n<r||(n<q+r?d=["below-centered","above-centered"]:n<Math.PI+r?d=["before-centered","after-centered"]:n<2*Math.PI-r&&(d=["above-centered","below-centered"]))}a("dojo-bidi")&&this._recheckPosition(b,c,d);h=this.chart.getCoords();c.x+=h.x;c.y+=h.y;c.x=Math.round(c.x);c.y=Math.round(c.y);c.w=Math.ceil(c.w);c.h=Math.ceil(c.h);this.aroundRect=c;(b=this.text(b,this.plot))&&l.show(this._format(b),
this.aroundRect,d);this.mouseOver||(this._handle=g.connect(k.doc,"onclick",this,"onClick"))}},onClick:function(){this.process({type:"onmouseout"})},_recheckPosition:function(a,b,c){},_format:function(a){return a}});return a("dojo-bidi")?h("dojox.charting.action2d.Tooltip",[b,c]):b})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(l,m,h){m.switchTo(h);return m})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),
function(l,m,h,k,g,b,d,e,a,c){var f=l.shape={};f.Shape=h("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(g("gfxRegistry")){var a=f.register(this);this.getUID=function(){return a}}},destroy:function(){g("gfxRegistry")&&f.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},
getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var b=this._getRealMatrix();return[c.multiplyPoint(b,a.x,a.y),c.multiplyPoint(b,a.x+a.width,a.y),c.multiplyPoint(b,a.x+a.width,a.y+a.height),c.multiplyPoint(b,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},
setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=l.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=l.makeParameters(l.defaultLinearGradient,a);break;case "radial":b=l.makeParameters(l.defaultRadialGradient,a);break;case "pattern":b=l.makeParameters(l.defaultPattern,a)}else b=l.normalizeColor(a);this.fillStyle=
b;return this},setStroke:function(b){if(!b)return this.strokeStyle=null,this;if("string"==typeof b||m.isArray(b)||b instanceof a)b={color:b};b=this.strokeStyle=l.makeParameters(l.defaultStroke,b);b.color=l.normalizeColor(b.color);return this},setTransform:function(a){this.matrix=c.clone(a?c.normalize(a):c.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=
this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},
_updateParentMatrix:function(a){this.parentMatrix=a?c.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,b=this.parent;b;)b.matrix&&(a=c.multiply(b.matrix,a)),b=b.parent;return a}});f._eventsProcessing={on:function(a,c){return b(this.getEventSource(),a,f.fixCallback(this,l.fixTarget,c))},connect:function(a,b,c){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,c?m.hitch(b,c):b)},disconnect:function(a){return a.remove()}};f.fixCallback=function(a,
b,c,d){d||(d=c,c=null);if(m.isString(d)){c=c||k.global;if(!c[d])throw['dojox.gfx.shape.fixCallback: scope["',d,'"] is null (scope\x3d"',c,'")'].join("");return function(e){return b(e,a)?c[d].apply(c,arguments||[]):void 0}}return!c?function(e){return b(e,a)?d.apply(c,arguments):void 0}:function(e){return b(e,a)?d.apply(c,arguments||[]):void 0}};m.extend(f.Shape,f._eventsProcessing);f.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},
add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){b||(a.parent=null,a.parentMatrix=null);this.children.splice(c,1);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var a=null;
d.forEach(this.children,function(b){var d=b.getBoundingBox();d&&((b=b.getTransform())&&(d=c.multiplyRectangle(b,d)),a?(a.x=Math.min(a.x,d.x),a.y=Math.min(a.y,d.y),a.endX=Math.max(a.endX,d.x+d.width),a.endY=Math.max(a.endY,d.y+d.height)):a={x:d.x,y:d.y,endX:d.x+d.width,endY:d.y+d.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,1);this.children.push(a);break}return this},
_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,1);this.children.unshift(a);break}return this}};f.Surface=h("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){d.forEach(this._nodes,e.destroy);this._nodes=[];d.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(g("ie"))for(;this._parent.lastChild;)e.destroy(this._parent.lastChild);
else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,c){var d=m.hitch(a,c);if(this.isLoaded)d(this);else b.once(this,"load",function(a){d(a)})}});m.extend(f.Surface,f._eventsProcessing);f.Rect=h("dojox.gfx.shape.Rect",f.Shape,{constructor:function(a){this.shape=l.getDefault("Rect");this.rawNode=a},getBoundingBox:function(){return this.shape}});f.Ellipse=h("dojox.gfx.shape.Ellipse",
f.Shape,{constructor:function(a){this.shape=l.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});f.Circle=h("dojox.gfx.shape.Circle",f.Shape,{constructor:function(a){this.shape=l.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});f.Line=h("dojox.gfx.shape.Line",
f.Shape,{constructor:function(a){this.shape=l.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});f.Polyline=h("dojox.gfx.shape.Polyline",f.Shape,{constructor:function(a){this.shape=l.getDefault("Polyline");this.rawNode=a},setShape:function(a,b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&
this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],d=0;d<b;d+=2)c.push({x:a[d],y:a[d+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],d=c.x,e=c.y,f=c.x,g=c.y,h=1;h<b;++h)c=a[h],d>c.x&&(d=c.x),f<c.x&&(f=c.x),e>c.y&&(e=c.y),g<c.y&&(g=c.y);this.bbox={x:d,y:e,width:f-
d,height:g-e}}return this.bbox}});f.Image=h("dojox.gfx.shape.Image",f.Shape,{constructor:function(a){this.shape=l.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});f.Text=h(f.Shape,{constructor:function(a){this.fontStyle=null;this.shape=l.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?l.splitFontString(a):l.makeParameters(l.defaultFont,
a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=l._base._computeTextBoundingBox(this));return a}});f.Creator={createShape:function(a){switch(a.type){case l.defaultPath.type:return this.createPath(a);case l.defaultRect.type:return this.createRect(a);case l.defaultCircle.type:return this.createCircle(a);case l.defaultEllipse.type:return this.createEllipse(a);case l.defaultLine.type:return this.createLine(a);case l.defaultPolyline.type:return this.createPolyline(a);
case l.defaultImage.type:return this.createImage(a);case l.defaultText.type:return this.createText(a);case l.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(l.Group)},createRect:function(a){return this.createObject(l.Rect,a)},createEllipse:function(a){return this.createObject(l.Ellipse,a)},createCircle:function(a){return this.createObject(l.Circle,a)},createLine:function(a){return this.createObject(l.Line,a)},createPolyline:function(a){return this.createObject(l.Polyline,
a)},createImage:function(a){return this.createObject(l.Image,a)},createText:function(a){return this.createObject(l.Text,a)},createPath:function(a){return this.createObject(l.Path,a)},createTextPath:function(a){return this.createObject(l.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return f})},"dojox/charting/Chart2D":function(){define("dojo/_base/kernel dojo/_base/lang .. ./Chart ./axis2d/Default ./axis2d/Invisible ./plot2d/Default ./plot2d/Lines ./plot2d/Areas ./plot2d/Markers ./plot2d/MarkersOnly ./plot2d/Scatter ./plot2d/Stacked ./plot2d/StackedLines ./plot2d/StackedAreas ./plot2d/Columns ./plot2d/StackedColumns ./plot2d/ClusteredColumns ./plot2d/Bars ./plot2d/StackedBars ./plot2d/ClusteredBars ./plot2d/Grid ./plot2d/Pie ./plot2d/Bubble ./plot2d/Candlesticks ./plot2d/OHLC ./plot2d/Spider".split(" "),
function(l,m,h,k){l.deprecated("dojox.charting.Chart2D","Use dojox.charting.Chart instead and require all other components explicitly","2.0");return m.setObject("dojox.charting.Chart2D",k)})},"dojox/charting/scaler/linear":function(){define(["dojo/_base/lang","./common"],function(l,m){function h(b,e){b=b.toLowerCase();for(var a=e.length-1;0<=a;--a)if(b===e[a])return!0;return!1}var k=l.getObject("dojox.charting.scaler.linear",!0),g=m.getNumericLabel,b=function(b,e,a,c,f,g,m){a=l.delegate(a);c||("major"==
a.fixUpper&&(a.fixUpper="minor"),"major"==a.fixLower&&(a.fixLower="minor"));f||("minor"==a.fixUpper&&(a.fixUpper="micro"),"minor"==a.fixLower&&(a.fixLower="micro"));g||("micro"==a.fixUpper&&(a.fixUpper="none"),"micro"==a.fixLower&&(a.fixLower="none"));var q=h(a.fixLower,["major"])?Math.floor(a.min/c)*c:h(a.fixLower,["minor"])?Math.floor(a.min/f)*f:h(a.fixLower,["micro"])?Math.floor(a.min/g)*g:a.min,p=h(a.fixUpper,["major"])?Math.ceil(a.max/c)*c:h(a.fixUpper,["minor"])?Math.ceil(a.max/f)*f:h(a.fixUpper,
["micro"])?Math.ceil(a.max/g)*g:a.max;a.useMin&&(b=q);a.useMax&&(e=p);var v=!c||a.useMin&&h(a.fixLower,["major"])?b:Math.ceil(b/c)*c,x=!f||a.useMin&&h(a.fixLower,["major","minor"])?b:Math.ceil(b/f)*f,C=!g||a.useMin&&h(a.fixLower,["major","minor","micro"])?b:Math.ceil(b/g)*g,M=!c?0:(a.useMax&&h(a.fixUpper,["major"])?Math.round((e-v)/c):Math.floor((e-v)/c))+1,L=!f?0:(a.useMax&&h(a.fixUpper,["major","minor"])?Math.round((e-x)/f):Math.floor((e-x)/f))+1;a=!g?0:(a.useMax&&h(a.fixUpper,["major","minor",
"micro"])?Math.round((e-C)/g):Math.floor((e-C)/g))+1;var t=f?Math.round(c/f):0,A=g?Math.round(f/g):0,s=c?Math.floor(Math.log(c)/Math.LN10):0,B=f?Math.floor(Math.log(f)/Math.LN10):0,y=m/(e-b);isFinite(y)||(y=1);return{bounds:{lower:q,upper:p,from:b,to:e,scale:y,span:m},major:{tick:c,start:v,count:M,prec:s},minor:{tick:f,start:x,count:L,prec:B},micro:{tick:g,start:C,count:a,prec:0},minorPerMajor:t,microPerMinor:A,scaler:k}};return l.mixin(k,{buildScaler:function(d,e,a,c,f,g){var h={fixUpper:"none",
fixLower:"none",natural:!1};c&&("fixUpper"in c&&(h.fixUpper=String(c.fixUpper)),"fixLower"in c&&(h.fixLower=String(c.fixLower)),"natural"in c&&(h.natural=Boolean(c.natural)));g=!g||3>g?3:g;"min"in c&&(d=c.min);"max"in c&&(e=c.max);c.includeZero&&(0<d&&(d=0),0>e&&(e=0));h.min=d;h.useMin=!0;h.max=e;h.useMax=!0;"from"in c&&(d=c.from,h.useMin=!1);"to"in c&&(e=c.to,h.useMax=!1);if(e<=d)return b(d,e,h,0,0,0,a);f||(f=e-d);f=Math.floor(Math.log(f)/Math.LN10);f=c&&"majorTickStep"in c?c.majorTickStep:Math.pow(10,
f);var k=0,p=0,l;if(c&&"minorTickStep"in c)k=c.minorTickStep;else{do{k=f/10;if(!h.natural||0.9<k)if(l=b(d,e,h,f,k,0,a),l.bounds.scale*l.minor.tick>g)break;k=f/5;if(!h.natural||0.9<k)if(l=b(d,e,h,f,k,0,a),l.bounds.scale*l.minor.tick>g)break;k=f/2;if(!h.natural||0.9<k)if(l=b(d,e,h,f,k,0,a),l.bounds.scale*l.minor.tick>g)break;return b(d,e,h,f,0,0,a)}while(0)}if(c&&"microTickStep"in c)p=c.microTickStep,l=b(d,e,h,f,k,p,a);else{do{p=k/10;if(!h.natural||0.9<p)if(l=b(d,e,h,f,k,p,a),3<l.bounds.scale*l.micro.tick)break;
p=k/5;if(!h.natural||0.9<p)if(l=b(d,e,h,f,k,p,a),3<l.bounds.scale*l.micro.tick)break;p=k/2;if(!h.natural||0.9<p)if(l=b(d,e,h,f,k,p,a),3<l.bounds.scale*l.micro.tick)break;p=0}while(0)}return p?l:b(d,e,h,f,k,0,a)},buildTicks:function(b,e){var a,c,f,h=b.major.start,k=b.minor.start,l=b.micro.start;if(e.microTicks&&b.micro.tick)a=b.micro.tick,c=l;else if(e.minorTicks&&b.minor.tick)a=b.minor.tick,c=k;else if(b.major.tick)a=b.major.tick,c=h;else return null;var p=1/b.bounds.scale;if(b.bounds.to<=b.bounds.from||
isNaN(p)||!isFinite(p)||0>=a||isNaN(a)||!isFinite(a))return null;for(var m=[],x=[],C=[];c<=b.bounds.to+p;)Math.abs(h-c)<a/2?(f={value:h},e.majorLabels&&(f.label=g(h,b.major.prec,e)),m.push(f),h+=b.major.tick,k+=b.minor.tick):Math.abs(k-c)<a/2?(e.minorTicks&&(f={value:k},e.minorLabels&&b.minMinorStep<=b.minor.tick*b.bounds.scale&&(f.label=g(k,b.minor.prec,e)),x.push(f)),k+=b.minor.tick):e.microTicks&&C.push({value:l}),l+=b.micro.tick,c+=a;return{major:m,minor:x,micro:C}},getTransformerFromModel:function(b){var e=
b.bounds.from,a=b.bounds.scale;return function(b){return(b-e)*a}},getTransformerFromPlot:function(b){var e=b.bounds.from,a=b.bounds.scale;return function(b){return b/a+e}}})})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(l,m,h,k,g){var b=null;h.add("vml",function(b,e,a){a.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';b="adj"in a.firstChild;a.innerHTML="";return b});return{load:function(d,e,a){function c(){e(["dojox/gfx/"+
f],function(c){l.renderer=f;b=c;a(c)})}if(b&&"force"!=d)a(b);else{var f=g.forceGfxRenderer;d=!f&&(m.isString(g.gfxRenderer)?g.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var n,r;!f&&d.length;)switch(d.shift()){case "svg":"SVGAngle"in k.global&&(f="svg");break;case "vml":h("vml")&&(f="vml");break;case "silverlight":try{h("ie")?(n=new ActiveXObject("AgControl.AgControl"))&&n.IsVersionSupported("1.0")&&(r=!0):navigator.plugins["Silverlight Plug-In"]&&(r=!0)}catch(q){r=!1}finally{n=null}r&&
(f="silverlight");break;case "canvas":k.global.CanvasRenderingContext2D&&(f="canvas")}"canvas"===f&&!1!==g.canvasEvents&&(f="canvasWithEvents");g.isDebug&&console.log("gfx renderer \x3d "+f);"svg"==f&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(c):c()}}}})},"webSceneViewer/widgets/MessageListWidget/MessageWidget":function(){define("esri/core/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/dom-class dojo/on dojo/_base/fx dojo/text!./templates/MessageWidget.html".split(" "),function(l,
m,h,k,g,b,d){return l([m,h],{declaredClass:"MessageWidget",MessageTypes:{INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error"},templateString:d,message:void 0,details:void 0,type:void 0,timeout:void 0,collapsed:!1,constructor:function(b){},_remove:function(){clearTimeout(this.timer);var d=b.fadeOut({node:this.domNode,duration:500}).play();g.once(d,"End",function(a,b){this.destroy()}.bind(this))},postCreate:function(){if(void 0===this.type||this.type!==this.MessageTypes.INFO&&this.type!==
this.MessageTypes.SUCCESS&&this.type!==this.MessageTypes.WARNING&&this.type!==this.MessageTypes.ERROR)this.type=this.MessageTypes.INFO;void 0===this.collapsed&&(this.collapsed=!1);void 0===this.timeout&&(this.timeout=this.type===this.MessageTypes.ERROR?0:1E4);k.add(this.domNode,this.type);this.MessageShortDesc.innerHTML=this.message;this.MessageShortDesc.title=this.message;this.details&&""!==this.details?this.MessageDetails.innerHTML=this.details:(k.add(this.ExpandIcon,"hide"),k.add(this.MessageDetails,
"hide"));this.collapsed&&k.add(this.domNode,"collapsed");k.add(this.MessageTypeIcon,this.type+"Icon");0<this.timeout&&(this.timer=setTimeout(function(){this._remove()}.bind(this),this.timeout));b.fadeIn({node:this.domNode,duration:500}).play()},_expand:function(b){if(""!==this.details&&(b=b.target?b.target:b.srcElement,-1===b.className.indexOf("closeIcon")))if(-1===b.className.indexOf("MessageWidget")&&(b=b.parentNode),-1!==b.className.indexOf("expand"))k.remove(b,"expand");else for(var a=b.parentNode,
c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];d===b?k.add(d,"expand"):k.remove(d,"expand")}}})})},"dojox/lang/functional":function(){define(["./functional/lambda","./functional/array","./functional/object"],function(l){return l})},"dojox/charting/scaler/common":function(){define(["dojo/_base/lang"],function(l){var m=function(g,b){return Math.abs(g-b)<=1E-6*(Math.abs(g)+Math.abs(b))},h=l.getObject("dojox.charting.scaler.common",!0),k={};return l.mixin(h,{doIfLoaded:function(g,b,d){if(void 0==
k[g])try{k[g]=require(g)}catch(e){k[g]=null}return k[g]?b(k[g]):d()},getNumericLabel:function(g,b,d){var e="";h.doIfLoaded("dojo/number",function(a){e=(d.fixed?a.format(g,{places:0>b?-b:0}):a.format(g))||""},function(){e=d.fixed?g.toFixed(0>b?-b:0):g.toString()});if(d.labelFunc){var a=d.labelFunc(e,g,b);if(a)return a}if(d.labels){for(var a=d.labels,c=0,f=a.length;c<f;){var k=Math.floor((c+f)/2);a[k].value<g?c=k+1:f=k}if(c<a.length&&m(a[c].value,g))return a[c].text;--c;if(0<=c&&c<a.length&&m(a[c].value,
g))return a[c].text;c+=2;if(c<a.length&&m(a[c].value,g))return a[c].text}return e}})})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(l,m,h,k,g){g=h("dojox.gfx.path.Path",g.Shape,{constructor:function(b){this.shape=m.clone(l.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=b;this.segmented=!1},setAbsoluteMode:function(b){this._confirmSegmented();this.absolute="string"==typeof b?"absolute"==
b:b;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var b=this.bbox,d=this._getRealMatrix();this.bbox=null;for(var e=0,a=this.segments.length;e<a;++e)this._updateWithSegment(this.segments[e],d);d=this.bbox;
this.bbox=b;return this.tbbox=d?[{x:d.l,y:d.t},{x:d.r,y:d.t},{x:d.r,y:d.b},{x:d.l,y:d.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(b,d,e){e&&(d=k.multiplyPoint(e,b,d),b=d.x,d=d.y);this.bbox&&"l"in this.bbox?(this.bbox.l>b&&(this.bbox.l=b),this.bbox.r<b&&(this.bbox.r=b),this.bbox.t>d&&(this.bbox.t=d),this.bbox.b<d&&(this.bbox.b=d)):this.bbox={l:b,
b:d,r:b,t:d}},_updateWithSegment:function(b,d){var e=b.args,a=e.length,c;switch(b.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(c=0;c<a;c+=2)this._updateBBox(e[c],e[c+1],d);this.last.x=e[a-2];this.last.y=e[a-1];this.absolute=!0;break;case "H":for(c=0;c<a;++c)this._updateBBox(e[c],this.last.y,d);this.last.x=e[a-1];this.absolute=!0;break;case "V":for(c=0;c<a;++c)this._updateBBox(this.last.x,e[c],d);this.last.y=e[a-1];this.absolute=!0;break;case "m":c=0;"x"in this.last||(this._updateBBox(this.last.x=
e[0],this.last.y=e[1],d),c=2);for(;c<a;c+=2)this._updateBBox(this.last.x+=e[c],this.last.y+=e[c+1],d);this.absolute=!1;break;case "l":case "t":for(c=0;c<a;c+=2)this._updateBBox(this.last.x+=e[c],this.last.y+=e[c+1],d);this.absolute=!1;break;case "h":for(c=0;c<a;++c)this._updateBBox(this.last.x+=e[c],this.last.y,d);this.absolute=!1;break;case "v":for(c=0;c<a;++c)this._updateBBox(this.last.x,this.last.y+=e[c],d);this.absolute=!1;break;case "c":for(c=0;c<a;c+=6)this._updateBBox(this.last.x+e[c],this.last.y+
e[c+1],d),this._updateBBox(this.last.x+e[c+2],this.last.y+e[c+3],d),this._updateBBox(this.last.x+=e[c+4],this.last.y+=e[c+5],d);this.absolute=!1;break;case "s":case "q":for(c=0;c<a;c+=4)this._updateBBox(this.last.x+e[c],this.last.y+e[c+1],d),this._updateBBox(this.last.x+=e[c+2],this.last.y+=e[c+3],d);this.absolute=!1;break;case "A":for(c=0;c<a;c+=7)this._updateBBox(e[c+5],e[c+6],d);this.last.x=e[a-2];this.last.y=e[a-1];this.absolute=!0;break;case "a":for(c=0;c<a;c+=7)this._updateBBox(this.last.x+=
e[c+5],this.last.y+=e[c+6],d);this.absolute=!1}var f=[b.action];for(c=0;c<a;++c)f.push(l.formatNumber(e[c],!0));if("string"==typeof this.shape.path)this.shape.path+=f.join("");else{c=0;for(a=f.length;c<a;++c)this.shape.path.push(f[c])}},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(b,d){this.tbbox=null;var e=this._validSegments[b.toLowerCase()];"number"==typeof e&&(e?d.length>=e&&(e={action:b,args:d.slice(0,d.length-d.length%e)},this.segments.push(e),this._updateWithSegment(e)):
(e={action:b,args:[]},this.segments.push(e),this._updateWithSegment(e)))},_collectArgs:function(b,d){for(var e=0;e<d.length;++e){var a=d[e];"boolean"==typeof a?b.push(a?1:0):"number"==typeof a?b.push(a):a instanceof Array?this._collectArgs(b,a):"x"in a&&"y"in a&&b.push(a.x,a.y)}},moveTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"M":"m",b);return this},lineTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);
this._pushSegment(this.absolute?"L":"l",b);return this},hLineTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"H":"h",b);return this},vLineTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"V":"v",b);return this},curveTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"C":"c",b);return this},smoothCurveTo:function(){this._confirmSegmented();
var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"S":"s",b);return this},qCurveTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"Q":"q",b);return this},qSmoothCurveTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"T":"t",b);return this},arcTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"A":
"a",b);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var b=this.shape.path;this.shape.path=[];this._setPath(b);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(b){b=m.isArray(b)?b:b.match(l.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(b){for(var d="",e=[],a=b.length,c=0;c<a;++c){var f=b[c],g=parseFloat(f);isNaN(g)?(d&&this._pushSegment(d,
e),e=[],d=f):e.push(g)}this._pushSegment(d,e)}},setShape:function(b){this.inherited(arguments,["string"==typeof b?{path:b}:b]);this.segmented=!1;this.segments=[];l.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});h=h("dojox.gfx.path.TextPath",g,{constructor:function(b){"text"in this||(this.text=m.clone(l.defaultTextPath));"fontStyle"in this||(this.fontStyle=m.clone(l.defaultFont))},getText:function(){return this.text},setText:function(b){this.text=l.makeParameters(this.text,
"string"==typeof b?{text:b}:b);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(b){this.fontStyle="string"==typeof b?l.splitFontString(b):l.makeParameters(l.defaultFont,b);this._setFont();return this}});return l.path={Path:g,TextPath:h}})},"dojox/charting/axis2d/common":function(){define(["dojo/_base/lang","dojo/_base/window","dojo/dom-geometry","dojox/gfx","dojo/has"],function(l,m,h,k,g){var b=l.getObject("dojox.charting.axis2d.common",!0),d=function(b){b.marginLeft=
"0px";b.marginTop="0px";b.marginRight="0px";b.marginBottom="0px";b.paddingLeft="0px";b.paddingTop="0px";b.paddingRight="0px";b.paddingBottom="0px";b.borderLeftWidth="0px";b.borderTopWidth="0px";b.borderRightWidth="0px";b.borderBottomWidth="0px"};return l.mixin(b,{createText:{gfx:function(b,a,c,d,g,h,k,l){return a.createText({x:c,y:d,text:h,align:g}).setFont(k).setFill(l)},html:function(b,a,c,f,l,r,q,p,v){a=m.doc.createElement("div");var x=a.style,C;b.getTextDir&&(a.dir=b.getTextDir(r));d(x);x.font=
q;a.innerHTML=String(r).replace(/\s/g,"\x26nbsp;");x.color=p;x.position="absolute";x.left="-10000px";m.body().appendChild(a);var M=k.normalizedLength(k.splitFontString(q).size);v||(a.getBoundingClientRect?(C=a.getBoundingClientRect(),C=C.width||C.right-C.left):C=h.getMarginBox(a).w);"rtl"==a.dir&&(c+=v?v:C);m.body().removeChild(a);x.position="relative";if(v)switch(x.width=v+"px",l){case "middle":x.textAlign="center";x.left=c-v/2+"px";break;case "end":x.textAlign="right";x.left=c-v+"px";break;default:x.left=
c+"px",x.textAlign="left"}else switch(l){case "middle":x.left=Math.floor(c-C/2)+"px";break;case "end":x.left=Math.floor(c-C)+"px";break;default:x.left=Math.floor(c)+"px"}x.top=Math.floor(f-M)+"px";x.whiteSpace="nowrap";v=m.doc.createElement("div");x=v.style;d(x);x.width="0px";x.height="0px";v.appendChild(a);b.node.insertBefore(v,b.node.firstChild);g("dojo-bidi")&&b.htmlElementsRegistry.push([v,c,f,l,r,q,p]);return v}}})})},"dojox/lang/functional/object":function(){define(["dojo/_base/kernel","dojo/_base/lang",
"./lambda"],function(l,m,h){var k={};m.mixin(h,{keys:function(g){var b=[],d;for(d in g)d in k||b.push(d);return b},values:function(g){var b=[],d;for(d in g)d in k||b.push(g[d]);return b},filterIn:function(g,b,d){d=d||l.global;b=h.lambda(b);var e={},a,c;for(c in g)c in k||(a=g[c],b.call(d,a,c,g)&&(e[c]=a));return e},forIn:function(g,b,d){d=d||l.global;b=h.lambda(b);for(var e in g)e in k||b.call(d,g[e],e,g);return d},mapIn:function(g,b,d){d=d||l.global;b=h.lambda(b);var e={},a;for(a in g)a in k||(e[a]=
b.call(d,g[a],a,g));return e}});return h})},"dojox/charting/axis2d/Default":function(){define("dojo/_base/lang dojo/_base/array dojo/sniff dojo/_base/declare dojo/_base/connect dojo/dom-geometry ./Invisible ../scaler/linear ./common dojox/gfx dojox/lang/utils dojox/lang/functional dojo/has!dojo-bidi?../bidi/axis2d/Default".split(" "),function(l,m,h,k,g,b,d,e,a,c,f,n,r){d=k(h("dojo-bidi")?"dojox.charting.axis2d.NonBidiDefault":"dojox.charting.axis2d.Default",d,{defaultParams:{vertical:!1,fixUpper:"none",
fixLower:"none",natural:!1,leftBottom:!0,includeZero:!1,fixed:!0,majorLabels:!0,minorTicks:!0,minorLabels:!0,microTicks:!1,rotation:0,htmlLabels:!0,enableCache:!1,dropLabels:!0,labelSizeChange:!1,position:"leftOrBottom"},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1,labels:[],labelFunc:null,maxLabelSize:0,maxLabelCharCount:0,trailingSymbol:null,stroke:{},majorTick:{},minorTick:{},microTick:{},tick:{},font:"",fontColor:"",title:"",titleGap:0,titleFont:"",titleFontColor:"",
titleOrientation:""},constructor:function(a,b){this.opt=l.clone(this.defaultParams);f.updateWithObject(this.opt,b);f.updateWithPattern(this.opt,b,this.optionalParams);this.opt.enableCache&&(this._textFreePool=[],this._lineFreePool=[],this._textUsePool=[],this._lineUsePool=[]);this._invalidMaxLabelSize=!0;b&&"position"in b||(this.opt.position=this.opt.leftBottom?"leftOrBottom":"rightOrTop");this.renderingOptions={"shape-rendering":"crispEdges"}},setWindow:function(a,b){a!=this.scale&&(this._invalidMaxLabelSize=
!0);return this.inherited(arguments)},_groupLabelWidth:function(a,b,d){if(!a.length)return 0;50<a.length&&(a.length=50);l.isObject(a[0])&&(a=n.map(a,function(a){return a.text}));d&&(a=n.map(a,function(a){return 0==l.trim(a).length?"":a.substring(0,d)+this.trailingSymbol},this));a=a.join("\x3cbr\x3e");return c._base._getTextBox(a,{font:b}).w||0},_getMaxLabelSize:function(a,b,c,d,f,g){if(null==this._maxLabelSize&&6==arguments.length){var h=this.opt;this.scaler.minMinorStep=this._prevMinMinorStep=0;
var k=l.clone(h);delete k.to;delete k.from;var n=e.buildScaler(a,b,c,k,h.to-h.from);n.minMinorStep=0;this._majorStart=n.major.start;h=e.buildTicks(n,h);if(g&&h){var r=n=0,B=function(a){a.label&&this.push(a.label)},y=[];this.opt.majorLabels&&(m.forEach(h.major,B,y),n=this._groupLabelWidth(y,f,k.maxLabelCharCount),k.maxLabelSize&&(n=Math.min(k.maxLabelSize,n)));y=[];this.opt.dropLabels&&this.opt.minorLabels&&(m.forEach(h.minor,B,y),r=this._groupLabelWidth(y,f,k.maxLabelCharCount),k.maxLabelSize&&(r=
Math.min(k.maxLabelSize,r)));this._maxLabelSize={majLabelW:n,minLabelW:r,majLabelH:g,minLabelH:g}}else this._maxLabelSize=null}return this._maxLabelSize},calculate:function(a,b,d){this.inherited(arguments);this.scaler.minMinorStep=this._prevMinMinorStep;if((this._invalidMaxLabelSize||d!=this._oldSpan)&&Infinity!=a&&-Infinity!=b){this._invalidMaxLabelSize=!1;this.opt.labelSizeChange&&(this._maxLabelSize=null);this._oldSpan=d;var f=this.opt,g=this.chart.theme.axis,h=f.rotation%360,k=this.chart.theme.axis.tick.labelGap,
l=f.font||g.majorTick&&g.majorTick.font||g.tick&&g.tick.font,g=l?c.normalizedLength(c.splitFontString(l).size):0,l=this._getMaxLabelSize(a,b,d,h,l,g);"number"!=typeof k&&(k=4);if(l&&f.dropLabels){var f=Math.abs(Math.cos(h*Math.PI/180)),n=Math.abs(Math.sin(h*Math.PI/180));0>h&&(h+=360);switch(h){case 0:case 180:this.vertical?h=g:(h=l.majLabelW,g=l.minLabelW);break;case 90:case 270:this.vertical?(h=l.majLabelW,g=l.minLabelW):h=g;break;default:var h=this.vertical?Math.min(l.majLabelW,g/f):Math.min(l.majLabelW,
g/n),m=Math.sqrt(l.minLabelW*l.minLabelW+g*g),g=Math.min(m,this.vertical?g*f+l.minLabelW*n:l.minLabelW*f+g*n)}this.scaler.minMinorStep=this._prevMinMinorStep=Math.max(h,g)+k;this._skipInterval=this.scaler.minMinorStep<=this.scaler.minor.tick*this.scaler.bounds.scale?0:Math.floor((h+k)/(this.scaler.major.tick*this.scaler.bounds.scale))}else this._skipInterval=0}this.ticks=e.buildTicks(this.scaler,this.opt);return this},getOffsets:function(){var a={l:0,r:0,t:0,b:0};if(!this.scaler)return a;var b=this.opt,
d=this.chart.theme.axis,e=this.chart.theme.axis.tick.labelGap,f=b.titleFont||d.title&&d.title.font,d=0==b.titleGap?0:b.titleGap||d.title&&d.title.gap,g=this.chart.theme.getTick("major",b),h=this.chart.theme.getTick("minor",b),f=f?c.normalizedLength(c.splitFontString(f).size):0,k=b.rotation%360,l=b.position,n="rightOrTop"!==l,m=Math.abs(Math.cos(k*Math.PI/180)),r=Math.abs(Math.sin(k*Math.PI/180));this.trailingSymbol=void 0===b.trailingSymbol||null===b.trailingSymbol?this.trailingSymbol:b.trailingSymbol;
"number"!=typeof e&&(e=4);0>k&&(k+=360);var u=this._getMaxLabelSize();if(u){var E=Math.ceil(Math.max(u.majLabelW,u.minLabelW))+1,I=Math.ceil(Math.max(u.majLabelH,u.minLabelH))+1;if(this.vertical)switch(u=n?"l":"r",k){case 0:case 180:a[u]="center"===l?0:E;a.t=a.b=I/2;break;case 90:case 270:a[u]=I;a.t=a.b=E/2;break;default:45>=k||180<k&&225>=k?(a[u]=I*r/2+E*m,a[n?"t":"b"]=I*m/2+E*r,a[n?"b":"t"]=I*m/2):315<k||180>k&&135<k?(a[u]=I*r/2+E*m,a[n?"b":"t"]=I*m/2+E*r,a[n?"t":"b"]=I*m/2):90>k||180<k&&270>k?
(a[u]=I*r+E*m,a[n?"t":"b"]=I*m+E*r):(a[u]=I*r+E*m,a[n?"b":"t"]=I*m+E*r)}else switch(u=n?"b":"t",k){case 0:case 180:a[u]="center"===l?0:I;a.l=a.r=E/2;break;case 90:case 270:a[u]=E;a.l=a.r=I/2;break;default:45<=k&&90>=k||225<=k&&270>=k?(a[u]=I*m/2+E*r,a[n?"r":"l"]=I*r/2+E*m,a[n?"l":"r"]=I*r/2):90<=k&&135>=k||270<=k&&315>=k?(a[u]=I*m/2+E*r,a[n?"l":"r"]=I*r/2+E*m,a[n?"r":"l"]=I*r/2):45>k||180<k&&225>k?(a[u]=I*m+E*r,a[n?"r":"l"]=I*r+E*m):(a[u]=I*m+E*r,a[n?"l":"r"]=I*r+E*m)}a[u]="center"===l?0:a[u]+(e+
Math.max(0<g.length?g.length:0,0<h.length?h.length:0)+(b.title?f+d:0))}return a},cleanGroup:function(a){this.opt.enableCache&&this.group&&(this._lineFreePool=this._lineFreePool.concat(this._lineUsePool),this._lineUsePool=[],this._textFreePool=this._textFreePool.concat(this._textUsePool),this._textUsePool=[]);this.inherited(arguments)},createText:function(b,c,d,e,f,g,h,k,l){if(!this.opt.enableCache||"html"==b)return a.createText[b](this.chart,c,d,e,f,g,h,k,l);0<this._textFreePool.length?(b=this._textFreePool.pop(),
b.setShape({x:d,y:e,text:g,align:f}),c.add(b)):b=a.createText[b](this.chart,c,d,e,f,g,h,k);this._textUsePool.push(b);return b},createLine:function(a,b){var c;this.opt.enableCache&&0<this._lineFreePool.length?(c=this._lineFreePool.pop(),c.setShape(b),a.add(c)):c=a.createLine(b);this.opt.enableCache&&this._lineUsePool.push(c);return c},render:function(b,d){var f,g,k,l,n,r,A,s,B,y,u,E,I,z,H=this._isRtl();if(!this.dirty||!this.scaler)return this;var J=this.opt;B=this.chart.theme.axis;var G=J.position,
F="rightOrTop"!==G,K=J.rotation%360,D=0,N,w,D=this.chart.theme.axis.tick.labelGap,O=J.font||B.majorTick&&B.majorTick.font||B.tick&&B.tick.font,P=J.titleFont||B.title&&B.title.font,V=J.fontColor||B.majorTick&&B.majorTick.fontColor||B.tick&&B.tick.fontColor||"black",Y=J.titleFontColor||B.title&&B.title.fontColor||"black";n=0==J.titleGap?0:J.titleGap||B.title&&B.title.gap||15;var T=J.titleOrientation||B.title&&B.title.orientation||"axis",R=this.chart.theme.getTick("major",J),W=this.chart.theme.getTick("minor",
J),$=this.chart.theme.getTick("micro",J),aa="stroke"in J?J.stroke:B.stroke,X=O?c.normalizedLength(c.splitFontString(O).size):0;r=Math.abs(Math.cos(K*Math.PI/180));N=Math.abs(Math.sin(K*Math.PI/180));var U=P?c.normalizedLength(c.splitFontString(P).size):0;"number"!=typeof D&&(D=4);0>K&&(K+=360);var Q=this._getMaxLabelSize(),Q=Q&&Q.majLabelW;if(this.vertical){I=b.height-d.b;z=void 0;u=d.t;E=void 0;B=(b.height-d.b+d.t)/2;y=void 0;N=X*N+(Q||0)*r+D+Math.max(0<R.length?R.length:0,0<W.length?W.length:0)+
U+n;A=0;s=-1;g=f=0;n=1;r=0;k=D;l=0;switch(K){case 0:w="end";g=0.4*X;break;case 90:w="middle";f=-X;break;case 180:w="start";g=0.4*-X;break;case 270:w="middle";break;default:45>K?(w="end",g=0.4*X):90>K?(w="end",g=0.4*X):135>K?w="start":225>K?(w="start",g=0.4*-X):270>K?(w="start",f=F?0:0.4*X):315>K?(w="end",f=F?0:0.4*X):(w="end",g=0.4*X)}if(F)z=E="center"===G?b.width/2:d.l,D=T&&"away"==T?90:270,y=d.l-N+(270==D?U:0),n=-1,k=-k;else switch(z=E=b.width-d.r,D=T&&"axis"==T?90:270,y=b.width-d.r+N-(270==D?0:
U),w){case "start":w="end";break;case "end":w="start";break;case "middle":f+=X}}else{z=d.l;I=void 0;E=b.width-d.r;u=void 0;y=(b.width-d.r+d.l)/2;B=void 0;N=X*r+(Q||0)*N+D+Math.max(0<R.length?R.length:0,0<W.length?W.length:0)+U+n;A=H?-1:1;n=g=f=s=0;r=1;k=0;l=D;switch(K){case 0:w="middle";g=X;break;case 90:w="start";f=0.4*-X;break;case 180:w="middle";break;case 270:w="end";f=0.4*X;break;default:45>K?(w="start",g=F?X:0):135>K?(w="start",f=0.4*-X):180>K?(w="start",g=F?0:-X):225>K?(w="end",g=F?0:-X):315>
K?(w="end",g=F?0.4*X:0):(w="end",g=F?X:0)}if(F)I=u="center"===G?b.height/2:b.height-d.b,D=T&&"axis"==T?180:0,B=b.height-d.b+N-(D?U:0);else switch(I=u=d.t,D=T&&"away"==T?180:0,B=d.t-N+(D?0:U),r=-1,l=-l,w){case "start":w="end";break;case "end":w="start";break;case "middle":g-=X}}this.cleanGroup();var S=this.group,G=this.scaler,F=this.ticks,da=e.getTransformerFromModel(this.scaler),ba=(!J.title||!D)&&!K&&this.opt.htmlLabels&&!h("ie")&&!h("opera")?"html":"gfx",Z=n*R.length,ca=r*R.length,ea=this._skipInterval;
S.createLine({x1:z,y1:I,x2:E,y2:u}).setStroke(aa);J.title&&(P=a.createText[ba](this.chart,S,y,B,"middle",J.title,P,Y),"html"==ba?this.htmlElements.push(P):P.setTransform(c.matrix.rotategAt(D,y,B)));if(null==F)return this.dirty=!1,this;var ga=0<F.major.length?(F.major[0].value-this._majorStart)/G.major.tick:0,fa=this.opt.majorLabels;m.forEach(F.major,function(a,b){var d=da(a.value),e=(H?E:z)+A*d,h=I+s*d;b+=ga;this.createLine(S,{x1:e,y1:h,x2:e+Z,y2:h+ca}).setStroke(R);if(a.label&&(!ea||0==(b-(1+ea))%
(1+ea))){var n=J.maxLabelCharCount?this.getTextWithLimitCharCount(a.label,O,J.maxLabelCharCount):{text:a.label,truncated:!1},n=J.maxLabelSize?this.getTextWithLimitLength(n.text,O,J.maxLabelSize,n.truncated):n,d=this.createText(ba,S,e+(0<R.length?Z:0)+k+(K?0:f),h+(0<R.length?ca:0)+l+(K?0:g),w,n.text,O,V);n.truncated&&this.chart.formatTruncatedLabel(d,a.label,ba);n.truncated&&this.labelTooltip(d,this.chart,a.label,n.text,O,ba);"html"==ba?this.htmlElements.push(d):K&&d.setTransform([{dx:f,dy:g},c.matrix.rotategAt(K,
e+(0<R.length?Z:0)+k,h+(0<R.length?ca:0)+l)])}},this);Z=n*W.length;ca=r*W.length;fa=this.opt.minorLabels&&G.minMinorStep<=G.minor.tick*G.bounds.scale;m.forEach(F.minor,function(a){var b=da(a.value),d=(H?E:z)+A*b,e=I+s*b;this.createLine(S,{x1:d,y1:e,x2:d+Z,y2:e+ca}).setStroke(W);if(fa&&a.label){var h=J.maxLabelCharCount?this.getTextWithLimitCharCount(a.label,O,J.maxLabelCharCount):{text:a.label,truncated:!1},h=J.maxLabelSize?this.getTextWithLimitLength(h.text,O,J.maxLabelSize,h.truncated):h,b=this.createText(ba,
S,d+(0<W.length?Z:0)+k+(K?0:f),e+(0<W.length?ca:0)+l+(K?0:g),w,h.text,O,V);h.truncated&&this.chart.formatTruncatedLabel(b,a.label,ba);h.truncated&&this.labelTooltip(b,this.chart,a.label,h.text,O,ba);"html"==ba?this.htmlElements.push(b):K&&b.setTransform([{dx:f,dy:g},c.matrix.rotategAt(K,d+(0<W.length?Z:0)+k,e+(0<W.length?ca:0)+l)])}},this);Z=n*$.length;ca=r*$.length;m.forEach(F.micro,function(a){var b=da(a.value);a=z+A*b;b=I+s*b;this.createLine(S,{x1:a,y1:b,x2:a+Z,y2:b+ca}).setStroke($)},this);this.dirty=
!1;return this},labelTooltip:function(a,d,e,f,h,k){var n=["dijit/Tooltip"],m={type:"rect"},r=["above","below"];f=c._base._getTextBox(f,{font:h}).w||0;h=h?c.normalizedLength(c.splitFontString(h).size):0;"html"==k?(l.mixin(m,b.position(a.firstChild,!0)),m.width=Math.ceil(f),m.height=Math.ceil(h),this._events.push({shape:dojo,handle:g.connect(a.firstChild,"onmouseover",this,function(a){require(n,function(a){a.show(e,m,r)})})}),this._events.push({shape:dojo,handle:g.connect(a.firstChild,"onmouseout",
this,function(a){require(n,function(a){a.hide(m)})})})):(k=a.getShape(),d=d.getCoords(),m=l.mixin(m,{x:k.x-f/2,y:k.y}),m.x+=d.x,m.y+=d.y,m.x=Math.round(m.x),m.y=Math.round(m.y),m.width=Math.ceil(f),m.height=Math.ceil(h),this._events.push({shape:a,handle:a.connect("onmouseenter",this,function(a){require(n,function(a){a.show(e,m,r)})})}),this._events.push({shape:a,handle:a.connect("onmouseleave",this,function(a){require(n,function(a){a.hide(m)})})}))},_isRtl:function(){return!1}});return h("dojo-bidi")?
k("dojox.charting.axis2d.Default",[d,r]):d})},"dojox/charting/plot2d/ClusteredBars":function(){define(["dojo/_base/declare","dojo/_base/array","./Bars","./common"],function(l,m,h,k){return l("dojox.charting.plot2d.ClusteredBars",h,{getBarProperties:function(){var g=this.series.length;m.forEach(this.series,function(b){b.hidden&&g--});var b=k.calculateBarSize(this._vScaler.bounds.scale,this.opt,g);return{gap:b.gap,height:b.size,thickness:b.size}}})})},"webSceneViewer/widgets/Compass/Compass":function(){define(["esri/core/declare",
"dojo/dom-construct","dojo/on","dojo/i18n!../nls/widgets"],function(l,m,h,k){return l(null,{constructor:function(){this._compassContainerDiv=m.create("div",{className:"compassContainer",title:k.compass.compass});this._setPerspectiveStyle(this._compassContainerDiv,500);this._compassDiv=m.create("div",{className:"compass"},this._compassContainerDiv)},addToView:function(g){m.place(this._compassContainerDiv,g.container);h(this._compassDiv,"click",function(){g.animateTo({heading:0})});g.watch("camera",
function(b){var d=Math.min(65/90*b.get("tilt"),65);this._setTransformStyle(this._compassDiv,"rotateX("+d+"deg) rotateY(0) rotateZ("+-b.get("heading")+"deg)")}.bind(this));return this},_setTransformStyle:function(g,b){g.style.transform=b;g.style["-moz-transform"]=b;g.style["-webkit-transform"]=b;g.style["-o-transform"]=b;g.style["-ms-transform"]=b},_setPerspectiveStyle:function(g,b){var d=b+"px";g.style.perspective=d;g.style["-webkit-perspective"]=d;g.style["-moz-perspective"]=d;g.style["-o-perspective"]=
d;g.style["-ms-perspective"]=d}})})},"dojox/charting/SimpleTheme":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/Color dojox/lang/utils dojox/gfx/gradutils".split(" "),function(l,m,h,k,g,b){var d=h("dojox.charting.SimpleTheme",null,{shapeSpaces:{shape:1,shapeX:1,shapeY:1},constructor:function(b){b=b||{};var a=d.defaultTheme;m.forEach("chart plotarea axis grid series marker indicator".split(" "),function(c){this[c]=l.delegate(a[c],b[c])},this);b.seriesThemes&&b.seriesThemes.length?
(this.colors=null,this.seriesThemes=b.seriesThemes.slice(0)):(this.seriesThemes=null,this.colors=(b.colors||d.defaultColors).slice(0));this.markerThemes=null;b.markerThemes&&b.markerThemes.length&&(this.markerThemes=b.markerThemes.slice(0));this.markers=b.markers?l.clone(b.markers):l.delegate(d.defaultMarkers);this.noGradConv=b.noGradConv;this.noRadialConv=b.noRadialConv;b.reverseFills&&this.reverseFills();this._current=0;this._buildMarkerArray()},clone:function(){var b=new this.constructor({chart:this.chart,
plotarea:this.plotarea,axis:this.axis,grid:this.grid,series:this.series,marker:this.marker,colors:this.colors,markers:this.markers,indicator:this.indicator,seriesThemes:this.seriesThemes,markerThemes:this.markerThemes,noGradConv:this.noGradConv,noRadialConv:this.noRadialConv});m.forEach("clone clear next skip addMixin post getTick".split(" "),function(a){this.hasOwnProperty(a)&&(b[a]=this[a])},this);return b},clear:function(){this._current=0},next:function(b,a,c){var d=g.merge,h;if(this.colors){h=
l.delegate(this.series);var d=l.delegate(this.marker),m=new k(this.colors[this._current%this.colors.length]),q;h.stroke&&h.stroke.color?(h.stroke=l.delegate(h.stroke),q=new k(h.stroke.color),h.stroke.color=new k(m),h.stroke.color.a=q.a):h.stroke={color:m};d.stroke&&d.stroke.color?(d.stroke=l.delegate(d.stroke),q=new k(d.stroke.color),d.stroke.color=new k(m),d.stroke.color.a=q.a):d.stroke={color:m};!h.fill||h.fill.type?h.fill=m:(q=new k(h.fill),h.fill=new k(m),h.fill.a=q.a);!d.fill||d.fill.type?d.fill=
m:(q=new k(d.fill),d.fill=new k(m),d.fill.a=q.a)}else h=this.seriesThemes?d(this.series,this.seriesThemes[this._current%this.seriesThemes.length]):this.series,d=this.markerThemes?d(this.marker,this.markerThemes[this._current%this.markerThemes.length]):h;h={series:h,marker:d,symbol:d&&d.symbol||this._markers[this._current%this._markers.length]};++this._current;a&&(h=this.addMixin(h,b,a));c&&(h=this.post(h,b));return h},skip:function(){++this._current},addMixin:function(b,a,c,d){if(l.isArray(c))m.forEach(c,
function(c){b=this.addMixin(b,a,c)},this);else{var h={};"color"in c&&("line"==a||"area"==a?(l.setObject("series.stroke.color",c.color,h),l.setObject("marker.stroke.color",c.color,h)):l.setObject("series.fill",c.color,h));m.forEach("stroke outline shadow fill filter font fontColor labelWiring".split(" "),function(a){var b="marker"+a.charAt(0).toUpperCase()+a.substr(1),d=b in c;a in c&&(l.setObject("series."+a,c[a],h),d||l.setObject("marker."+a,c[a],h));d&&l.setObject("marker."+a,c[b],h)});"marker"in
c&&(h.symbol=c.marker,h.symbol=c.marker);b=g.merge(b,h)}d&&(b=this.post(b,a));return b},post:function(b,a){var c=b.series.fill,d;if(!this.noGradConv&&this.shapeSpaces[c.space]&&"linear"==c.type){if("bar"==a)d={x1:c.y1,y1:c.x1,x2:c.y2,y2:c.x2};else if(!this.noRadialConv&&"shape"==c.space&&("slice"==a||"circle"==a))d={type:"radial",cx:0,cy:0,r:100};if(d)return g.merge(b,{series:{fill:d}})}return b},getTick:function(b,a){var c=this.axis.tick,d=b+"Tick",h=g.merge;c?this.axis[d]&&(c=h(c,this.axis[d])):
c=this.axis[d];a&&(c?a[d]&&(c=h(c,a[d])):c=a[d]);return c},inspectObjects:function(b){m.forEach("chart plotarea axis grid series marker indicator".split(" "),function(a){b(this[a])},this);this.seriesThemes&&m.forEach(this.seriesThemes,b);this.markerThemes&&m.forEach(this.markerThemes,b)},reverseFills:function(){this.inspectObjects(function(d){d&&d.fill&&(d.fill=b.reverse(d.fill))})},addMarker:function(b,a){this.markers[b]=a;this._buildMarkerArray()},setMarkers:function(b){this.markers=b;this._buildMarkerArray()},
_buildMarkerArray:function(){this._markers=[];for(var b in this.markers)this._markers.push(this.markers[b])}});l.mixin(d,{defaultMarkers:{CIRCLE:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",SQUARE:"m-3,-3 l0,6 6,0 0,-6 z",DIAMOND:"m0,-3 l3,3 -3,3 -3,-3 z",CROSS:"m0,-3 l0,6 m-3,-3 l6,0",X:"m-3,-3 l6,6 m0,-6 l-6,6",TRIANGLE:"m-3,3 l3,-6 3,6 z",TRIANGLE_INVERTED:"m-3,-3 l3,6 3,-6 z"},defaultColors:["#54544c","#858e94","#6e767a","#948585","#474747"],defaultTheme:{chart:{stroke:null,fill:"white",pageStyle:null,
titleGap:20,titlePos:"top",titleFont:"normal normal bold 14pt Tahoma",titleFontColor:"#333"},plotarea:{stroke:null,fill:"white"},axis:{stroke:{color:"#333",width:1},tick:{color:"#666",position:"center",font:"normal normal normal 7pt Tahoma",fontColor:"#333",labelGap:4},majorTick:{width:1,length:6},minorTick:{width:0.8,length:3},microTick:{width:0.5,length:1},title:{gap:15,font:"normal normal normal 11pt Tahoma",fontColor:"#333",orientation:"axis"}},series:{stroke:{width:1.5,color:"#333"},outline:{width:0.1,
color:"#ccc"},shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000",labelWiring:{width:1,color:"#ccc"}},marker:{stroke:{width:1.5,color:"#333"},outline:{width:0.1,color:"#ccc"},shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000"},indicator:{lineStroke:{width:1.5,color:"#333"},lineOutline:{width:0.1,color:"#ccc"},lineShadow:null,lineFill:null,stroke:{width:1.5,color:"#333"},outline:{width:0.1,color:"#ccc"},shadow:null,fill:"#ccc",radius:3,font:"normal normal normal 10pt Tahoma",
fontColor:"#000",markerFill:"#ccc",markerSymbol:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",markerStroke:{width:1.5,color:"#333"},markerOutline:{width:0.1,color:"#ccc"},markerShadow:null}}});return d})},"esri/widgets/PopupLegacy/PopupManager":function(){define("require ../../core/declare dojo/_base/array dojo/_base/lang dojo/on dojo/Deferred dojo/promise/all dijit/registry ../../layers/support/layerUtils ../../geometry/Extent ../../tasks/support/Query ../../layers/GroupLayer ../../core/Accessor".split(" "),
function(l,m,h,k,g,b,d,e,a,c,f,n,r){var q;return m(r,{declaredClass:"esri.views.PopupManager",classMetadata:{properties:{map:{dependsOn:["view.map"],readOnly:!0}}},constructor:function(){this._featureLayersCache={}},destroy:function(){this._featureLayersCache={};this.view=null},_clickHandle:null,_featureLayersCache:null,enabled:!1,_enabledSetter:function(a){this._clickHandle&&(a?this._clickHandle.resume():this._clickHandle.pause());return a},_mapGetter:function(){return this.get("view.map")||null},
view:null,_viewSetter:function(a){this._clickHandle&&(this._clickHandle.remove(),this._clickHandle=null);a&&(this._clickHandle=g.pausable(a,"click",this._clickHandler.bind(this)),this.enabled||this._clickHandle.pause());return a},getMapLayer:function(a){var b;if(a&&(b=a.getLayer()))if(a=b.id,this._featureLayersCache[a]){var c=a.lastIndexOf("_");-1<c&&(a=a.substring(0,c),b=this.map.getLayer(a))}return b},_showInfoWindow:function(a,b){var c=this.view.popup,d=a.geometry,d=d&&"point"===d.type?d:b,f=a.getContent();
c.setTitle(a.getTitle());if(f&&k.isString(f.id)){var g=e.byId(f.id);g&&(g.set&&/_PopupRenderer/.test(g.declaredClass))&&g.set("showTitle",!1)}c.setContent(f);c.show(d)},_showPopup:function(a){function d(a){if(null==a)return!1;var b=g.getLayerView(a);return null==b?!1:a.loaded&&!a.disablePopup&&a.popupTemplate&&!b.suspended}var e=this.map,g=this.view,k=g.popup,l=this,m=[];h.forEach(e.layers.getAll(),function(a){a.isInstanceOf(n)?h.forEach(a.layers.getAll(),function(a){d(a)&&(!a.elevationInfo||"onTheGround"===
a.elevationInfo.mode)&&m.push(a)}):d(a)&&(!a.elevationInfo||"onTheGround"===a.elevationInfo.mode)&&m.push(a)});var q=null;if(a.graphic&&(a.graphic.popupTemplate||d(a.graphic.layer)))q=a.graphic;if(m.length||q){var r=[],B=!0,y=!!q;if(!q){var u=l._calculateClickTolerance(m),r=a.mapPoint;if(!r)return;var E=u*(g.basemapTerrain&&g.basemapTerrain.overlayManager.overlayPixelSizeInMapUnits(r)),u=r.offset(-E,-E),r=r.offset(E,E);if(null==u||null==r)return;var I=new c(Math.min(u.x,r.x),Math.min(u.y,r.y),Math.max(u.x,
r.x),Math.max(u.y,r.y),e.spatialReference),z=new f,r=h.map(m,function(c){var d;z.timeExtent=c.useMapTime?e.timeExtent:null;if("esri.layers.ArcGISImageServiceLayer"===c.declaredClass)z.geometry=a.mapPoint,B=!1,d=c.queryVisibleRasters(z,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),d.then(function(){var a=c.getVisibleRasters();y=y||0<a.length;return a});else if("esri.layers.SceneLayer"===c.declaredClass)d=new b,d.resolve();else if(l._featureLayersCache[c.id]||"function"===typeof c.queryFeatures&&
(0===c.currentMode||1===c.currentMode))z.geometry=I,d=c.queryFeatures(z),d.then(function(a){a=a.features;y=y||0<a.length;return a});else{d=new b;var f=[],k=g.getLayerView(c);k&&k._graphicsCollection&&(f=h.filter(k._graphicsCollection.getAll(),function(a){return a&&I.intersects(a.geometry)}));y=y||0<f.length;d.resolve(f)}return d.promise})}q&&(u=new b,r.unshift(u.resolve([q])));!h.some(r,function(a){return!a.isFulfilled()})&&!y?(k.hide(),k.clearFeatures()):(k.setFeatures(r),k.show(a.mapPoint,{closestFirst:B}))}},
_getSubLayerFeatureLayers:function(c,e){var f=e||new b,k=[],m=c.length,n=Math.floor(this.map.extent.getWidth()/this.map.width),r=this.map.getScale(),A=!1,s=this,B=0;a:for(;B<m;B++){var y=c[B],u=y.dynamicLayerInfos||y.layerInfos;if(u){var E=null;if(y._params&&(y._params.layers||y._params.dynamicLayers))E=y.visibleLayers;for(var E=a._getVisibleLayers(u,E),I=a._getLayersForScale(r,u),z=u.length,H=0;H<z;H++){var J=u[H],G=J.id,F=y.popupTemplates[G];if(!J.subLayerIds&&F&&F.popupTemplate&&-1<h.indexOf(E,
G)&&-1<h.indexOf(I,G)){if(!q){A=!0;break a}var K=y.id+"_"+G,D=this._featureLayersCache[K];if(!D||!D.loadError)D||((D=F.layerUrl)||(D=J.source?this._getLayerUrl(y.url,"/dynamicLayer"):this._getLayerUrl(y.url,G)),D=new q(D,{id:K,drawMode:!1,mode:q.MODE_SELECTION,outFields:this._getOutFields(F.popupTemplate),resourceInfo:F.resourceInfo,source:J.source}),this._featureLayersCache[K]=D),D.setDefinitionExpression(y.layerDefinitions&&y.layerDefinitions[G]),D.setGDBVersion(y.gdbVersion),D.popupTemplate=F.popupTemplate,
D.setMaxAllowableOffset(n),D.setUseMapTime(!!y.useMapTime),y.layerDrawingOptions&&(y.layerDrawingOptions[G]&&y.layerDrawingOptions[G].renderer)&&D.setRenderer(y.layerDrawingOptions[G].renderer),k.push(D)}}}}if(A){var N=new b;l(["../layers/FeatureLayer"],function(a){q=a;N.resolve()});N.then(function(){s._getSubLayerFeatureLayers(c,f)})}else{var w=[];h.forEach(k,function(a){if(!a.loaded){var c=new b;g.once(a,"load, error",function(){c.resolve()});w.push(c.promise)}});w.length?d(w).then(function(){k=
h.filter(k,function(a){return!a.loadError&&a.isVisibleAtScale(r)});f.resolve(k)}):(k=h.filter(k,function(a){return a.isVisibleAtScale(r)}),f.resolve(k))}return f.promise},_getLayerUrl:function(a,b){var c=a.indexOf("?");return-1===c?a+"/"+b:a.substring(0,c)+"/"+b+a.substring(c)},_getOutFields:function(a){var b;a.info&&"esri.widgets.PopupTemplate"===a.declaredClass?(b=[],h.forEach(a.info.fieldInfos,function(a){var c=a.fieldName&&a.fieldName.toLowerCase();c&&("shape"!==c&&0!==c.indexOf("relationships/"))&&
b.push(a.fieldName)})):b=["*"];return b},_calculateClickTolerance:function(a){var b=6;h.forEach(a,function(a){if(a=a.renderer)"esri.renderer.SimpleRenderer"===a.declaredClass?((a=a.symbol)&&a.xoffset&&(b=Math.max(b,Math.abs(a.xoffset))),a&&a.yoffset&&(b=Math.max(b,Math.abs(a.yoffset)))):("esri.renderer.UniqueValueRenderer"===a.declaredClass||"esri.renderer.ClassBreaksRenderer"===a.declaredClass)&&h.forEach(a.infos,function(a){(a=a.symbol)&&a.xoffset&&(b=Math.max(b,Math.abs(a.xoffset)));a&&a.yoffset&&
(b=Math.max(b,Math.abs(a.yoffset)))})});return b},_clickHandler:function(a){var b=this.view.popup,c=a.graphic;b&&(this.map.loaded&&this.view.ready)&&(b.clearFeatures&&b.setFeatures?this._showPopup(a):c&&c.getEffectivePopupTemplate()&&this._showInfoWindow(c,a.mapPoint))}})})},"dojox/charting/Element":function(){define(["dojo/_base/array","dojo/dom-construct","dojo/_base/declare","dojox/gfx","dojox/gfx/shape"],function(l,m,h,k,g){return h("dojox.charting.Element",null,{chart:null,group:null,htmlElements:null,
dirty:!0,renderingOptions:null,constructor:function(b,d){this.chart=b;this.group=null;this.htmlElements=[];this.dirty=!0;this.trailingSymbol="...";this._events=[];d&&d.renderingOptions&&(this.renderingOptions=d.renderingOptions)},purgeGroup:function(){this.destroyHtmlElements();if(this.group){this.getGroup().removeShape();var b=this.getGroup().children;if(g.dispose)for(var d=0;d<b.length;++d)g.dispose(b[d],!0);this.getGroup().rawNode&&m.empty(this.getGroup().rawNode);this.getGroup().clear();g.dispose&&
g.dispose(this.getGroup(),!0);this.getGroup()!=this.group&&(this.group.rawNode&&m.empty(this.group.rawNode),this.group.clear(),g.dispose&&g.dispose(this.group,!0));this.group=null}this.dirty=!0;this._events.length&&(l.forEach(this._events,function(b){b.shape.disconnect(b.handle)}),this._events=[]);return this},cleanGroup:function(b){this.destroyHtmlElements();b||(b=this.chart.surface);if(this.group){var d;b=this.getGroup().children;if(g.dispose)for(var e=0;e<b.length;++e)g.dispose(b[e],!0);this.getGroup().rawNode&&
(d=this.getGroup().bgNode,m.empty(this.getGroup().rawNode));this.getGroup().clear();d&&this.getGroup().rawNode.appendChild(d)}else if(this.group=b.createGroup(),this.renderingOptions&&this.group.rawNode&&"http://www.w3.org/2000/svg"==this.group.rawNode.namespaceURI)for(e in this.renderingOptions)this.group.rawNode.setAttribute(e,this.renderingOptions[e]);this.dirty=!0;return this},getGroup:function(){return this.group},destroyHtmlElements:function(){this.htmlElements.length&&(l.forEach(this.htmlElements,
m.destroy),this.htmlElements=[])},destroy:function(){this.purgeGroup()},getTextWidth:function(b,d){return k._base._getTextBox(b,{font:d}).w||0},getTextWithLimitLength:function(b,d,e,a){if(!b||0>=b.length)return{text:"",truncated:a||!1};if(!e||0>=e)return{text:b,truncated:a||!1};var c=b.substring(0,1)+this.trailingSymbol,f=this.getTextWidth(c,d);if(e<=f)return{text:c,truncated:!0};if(this.getTextWidth(b,d)<=e)return{text:b,truncated:a||!1};a=0;for(c=b.length;a<c;){if(2>=c-a){for(;this.getTextWidth(b.substring(0,
a)+this.trailingSymbol,d)>e;)a-=1;return{text:b.substring(0,a)+this.trailingSymbol,truncated:!0}}f=a+Math.round(0.618*(c-a));this.getTextWidth(b.substring(0,f),d)<e?a=f:c=f}},getTextWithLimitCharCount:function(b,d,e,a){return!b||0>=b.length?{text:"",truncated:a||!1}:!e||0>=e||b.length<=e?{text:b,truncated:a||!1}:{text:b.substring(0,e)+this.trailingSymbol,truncated:!0}},_plotFill:function(b,d,e){if(!b||!b.type||!b.space)return b;var a=b.space,c;switch(b.type){case "linear":if("plot"===a||"shapeX"===
a||"shapeY"===a){b=k.makeParameters(k.defaultLinearGradient,b);b.space=a;if("plot"===a||"shapeX"===a)c=d.height-e.t-e.b,b.y1=e.t+c*b.y1/100,b.y2=e.t+c*b.y2/100;if("plot"===a||"shapeY"===a)c=d.width-e.l-e.r,b.x1=e.l+c*b.x1/100,b.x2=e.l+c*b.x2/100}break;case "radial":"plot"===a&&(b=k.makeParameters(k.defaultRadialGradient,b),b.space=a,a=d.width-e.l-e.r,d=d.height-e.t-e.b,b.cx=e.l+a*b.cx/100,b.cy=e.t+d*b.cy/100,b.r=b.r*Math.sqrt(a*a+d*d)/200);break;case "pattern":if("plot"===a||"shapeX"===a||"shapeY"===
a){b=k.makeParameters(k.defaultPattern,b);b.space=a;if("plot"===a||"shapeX"===a)c=d.height-e.t-e.b,b.y=e.t+c*b.y/100,b.height=c*b.height/100;if("plot"===a||"shapeY"===a)c=d.width-e.l-e.r,b.x=e.l+c*b.x/100,b.width=c*b.width/100}}return b},_shapeFill:function(b,d){if(!b||!b.space)return b;var e=b.space,a;switch(b.type){case "linear":if("shape"===e||"shapeX"===e||"shapeY"===e){b=k.makeParameters(k.defaultLinearGradient,b);b.space=e;if("shape"===e||"shapeX"===e)a=d.width,b.x1=d.x+a*b.x1/100,b.x2=d.x+
a*b.x2/100;if("shape"===e||"shapeY"===e)a=d.height,b.y1=d.y+a*b.y1/100,b.y2=d.y+a*b.y2/100}break;case "radial":"shape"===e&&(b=k.makeParameters(k.defaultRadialGradient,b),b.space=e,b.cx=d.x+d.width/2,b.cy=d.y+d.height/2,b.r=b.r*d.width/200);break;case "pattern":if("shape"===e||"shapeX"===e||"shapeY"===e){b=k.makeParameters(k.defaultPattern,b);b.space=e;if("shape"===e||"shapeX"===e)a=d.width,b.x=d.x+a*b.x/100,b.width=a*b.width/100;if("shape"===e||"shapeY"===e)a=d.height,b.y=d.y+a*b.y/100,b.height=
a*b.height/100}}return b},_pseudoRadialFill:function(b,d,e,a,c){if(!b||"radial"!==b.type||"shape"!==b.space)return b;var f=b.space;b=k.makeParameters(k.defaultRadialGradient,b);b.space=f;if(4>arguments.length)return b.cx=d.x,b.cy=d.y,b.r=b.r*e/100,b;f=5>arguments.length?a:(c+a)/2;return{type:"linear",x1:d.x,y1:d.y,x2:d.x+b.r*e*Math.cos(f)/100,y2:d.y+b.r*e*Math.sin(f)/100,colors:b.colors}}})})},"url:webSceneViewer/widgets/Dialog/templates/ConfirmDialog.html":'\x3cdiv class\x3d"dijitDialog confirmDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title" role\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"0"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\r\n    \x3cdiv class\x3d"dijitDialogPaneContentArea"\x3e\r\n      \x3cdiv class\x3d"confirmDialogContentNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"Message"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"dijitDialogPaneActionBar"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" type\x3d"submit" data-dojo-attach-event\x3d"click: _confirmButtonClickHandler" data-dojo-attach-point\x3d"buttonConfirm"\x3e\x3c/button\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" type\x3d"button" data-dojo-attach-event\x3d"click: onCancel" title\x3d"${buttonCancel}" data-dojo-attach-point\x3d"buttonCancel"\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:webSceneViewer/widgets/MessageListWidget/templates/MessageWidget.html":'\x3cdiv class\x3d"MessageWidget"  data-dojo-attach-event\x3d"click:_expand"\x3e\r\n    \x3cdiv class\x3d"" data-dojo-attach-point\x3d"MessageTypeIcon"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"MessageShortDesc" class \x3d "MessageTitle"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"MessageDetails" class \x3d "MessageContent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"closeIcon" data-dojo-attach-event\x3d"click:_remove"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"ExpandIcon" class\x3d"arrowIcon"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:webSceneViewer/widgets/Header/templates/Header.html":'\x3cdiv id\x3d"webmap-header" class\x3d"top-nav clearfix" \x3e\r\n\r\n  \x3cdiv id\x3d"header_map_home" class\x3d"esriFloatLeading gutter-right-1"\x3e\r\n    \x3cdiv id\x3d"home-navigation" class\x3d"dropdown" data-dojo-attach-point\x3d"navDropdown"\x3e\r\n      \x3ca id\x3d"homeTitle" class\x3d"top-nav-link dropdown-btn js-dropdown-toggle" data-dojo-attach-point\x3d"homeTitle"\x3e\x3c/a\x3e\r\n      \x3cdiv class\x3d"dropdown-menu"\x3e\r\n        \x3ca class\x3d"dropdown-link homeHome" href\x3d""\x3e\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link homeFeatures hide" href\x3d""\x3e\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link homePlans hide" href\x3d""\x3e\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link homeGallery" href\x3d""\x3e\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link homeMap" href\x3d""\x3e\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link homeGroups hide" href\x3d""\x3e\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link homeMyContent hide" href\x3d""\x3e\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link homeMyOrg hide" href\x3d""\x3e\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link homeHelp" href\x3d""\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3ch1 id\x3d"webmap-title" class\x3d"avenir-light font-size-1 esriFloatLeading leader-1 text-ellipsis"\x3e\r\n    \x3ca id\x3d"webmap-title-text" target\x3d"_blank"\x3e\x3c/a\x3e\x3cdiv id\x3d"sceneType" class\x3d"sceneType hide"\x3e\x3c/div\x3e\r\n  \x3c/h1\x3e\r\n\r\n  \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n\r\n    \x3cdiv id\x3d"header_map_newMap" class\x3d"esriFloatLeading gutter-right-1"\x3e\r\n      \x3cdiv id\x3d"new-scene-navigation" class\x3d"dropdown esriFloatTrailing" data-dojo-attach-point\x3d"newSceneDropdown"\x3e\r\n        \x3ca id\x3d"webmap-newMap" class\x3d"dropdown-btn top-nav-link" data-dojo-attach-point\x3d"newScene"\x3e\r\n          \x3cspan id\x3d"newMapLabel"\x3e\x3c/span\x3e\r\n        \x3c/a\x3e\r\n        \x3cdiv class\x3d"dropdown-menu dropdown-right"\x3e\r\n          \x3ca class\x3d"dropdown-link" id\x3d"global-scene-link" data-dojo-attach-event\x3d"click:_newGlobalSceneClickHandler" \x3eNew Global Scene!!!\x3c/a\x3e\r\n          \x3ca class\x3d"dropdown-link" id\x3d"local-scene-link" data-dojo-attach-event\x3d"click:_newLocalSceneClickHandler" \x3eNew Local Scene!!!\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"header_map_modifyMap" class\x3d"esriFloatLeading esriTrailingMargin1" style\x3d"display:none;"\x3e\r\n      \x3ca id\x3d"webmap-modifyMap" class\x3d"top-nav-link" \x3e\r\n        \x3cspan id\x3d"modifyMapLabel"\x3e\x3c/span\x3e\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"header_map_presentation" class\x3d"esriFloatLeading esriTrailingMargin1" style\x3d"display:none;"\x3e\r\n      \x3ca id\x3d"webmap-presentation" class\x3d"top-nav-link" \x3e\r\n        \x3cspan id\x3d"presentationLabel"\x3e\x3c/span\x3e\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"header_map_signin" class\x3d"status esriFloatTrailing"\x3e\r\n\r\n       \x3c!-- Log in --\x3e\r\n      \x3cdiv id\x3d"logged-out-navigation" class\x3d"hide esriFloatTrailing esriAlignTrailing"\x3e\r\n        \x3ca id\x3d"login-link" class\x3d"top-nav-link icon-ui-user link-gray" data-dojo-attach-event\x3d"click:_signInLinkClickHandler"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3c!-- User Menu --\x3e\r\n      \x3cdiv id\x3d"logged-in-navigation" class\x3d"dropdown hide esriFloatTrailing" data-dojo-attach-point\x3d"userDropdown"\x3e\r\n        \x3ca class\x3d"top-nav-link dropdown-btn top-nav-username text-ellipsis" data-dojo-attach-point\x3d"userProfile"\x3e\r\n          \x3cimg id\x3d"profileImgSmall" width\x3d"16" height\x3d"16" alt\x3d""\x3e\r\n          \x3cspan id\x3d"username"\x3e\x3c/span\x3e\r\n        \x3c/a\x3e\r\n        \x3cdiv class\x3d"dropdown-menu dropdown-right"\x3e\r\n          \x3ca id\x3d"profileLink" class\x3d"dropdown-link" href\x3d"#"\x3e\r\n            \x3cimg id\x3d"dropdown-image" width\x3d"32" height\x3d"32" class\x3d"gutter-right-half gutter-left-0 left"\x3e\r\n            \x3cdiv id\x3d"logged-in-myProfile" class\x3d"text-ellipsis dropdown-username"\x3e\x3c/div\x3e\r\n          \x3c/a\x3e\r\n          \x3ca class\x3d"dropdown-link dropdown-link-external hide" id\x3d"esri-community-link"  data-dojo-attach-event\x3d"click:_communityLinkClickHandler, contextmenu:_disableEvent"\x3e\x3c/a\x3e\r\n          \x3ca class\x3d"dropdown-link dropdown-link-external hide" id\x3d"my-esri-link" data-dojo-attach-event\x3d"click:_myEsriLinkClickHandler, contextmenu:_disableEvent" \x3e\x3c/a\x3e\r\n          \x3ca class\x3d"dropdown-link dropdown-link-external hide" id\x3d"esri-training-link" data-dojo-attach-event\x3d"click:_trainingLinkClickHandler, contextmenu:_disableEvent" \x3e\x3c/a\x3e\r\n          \x3ca class\x3d"dropdown-link hide" id\x3d"trial-download-link" data-dojo-attach-event\x3d"click:_trialLinkClickHandler, contextmenu:_disableEvent" \x3e\x3c/a\x3e\r\n          \x3ca class\x3d"dropdown-link loggedInHelp" id\x3d"logged-in-help"\x3e\x3c/a\x3e\r\n          \x3ca class\x3d"dropdown-link hide" id\x3d"logged-in-adminhelp" data-dojo-attach-event\x3d"click:_loggedInAdminHelpLinkClickHandler, contextmenu:_disableEvent" class\x3d"loggedInAdminHelp" \x3e\x3c/a\x3e\r\n          \x3ca class\x3d"dropdown-link" id\x3d"logged-in-signOut" data-dojo-attach-event\x3d"click:_signOutLinkClickHandler, contextmenu:_disableEvent" \x3e\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:webSceneViewer/widgets/Header/templates/EmbedHeader.html":'\x3cdiv class\x3d"embedHeader"\x3e\r\n  \x3ca class\x3d"fullScreen" href\x3d"" target\x3d"_blank" data-dojo-attach-point\x3d"FullScreenLink"\x3e\x3c/a\x3e\r\n  \x3cdiv class\x3d"title"\x3e\r\n    \x3ca class\x3d"titleLink" target\x3d"_blank" href\x3d"" data-dojo-attach-point\x3d"WebSceneTitle"\x3e\x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:webSceneViewer/widgets/MessageListWidget/templates/MessageListWidget.html":'\x3cdiv class\x3d"MessageList" data-dojo-attach-point\x3d"MessageList"\x3e\r\n    \x3cdiv class\x3d"MessageListContent" data-dojo-attach-point\x3d"MessageListContentNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"*now":function(l){l(['dojo/i18n!*preload*webSceneViewer/nls/WebSceneViewer*["ar","ca","cs","da","de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])}}});
define("require esri/core/declare dojo/io-query dojo/dom dojo/on dojo/Deferred dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/_base/window dojo/hash dojo/topic esri/kernel esri/config dojo/cookie esri/core/sniff dojo/_base/window esri/Map esri/views/SceneView esri/geometry/Extent esri/geometry/SpatialReference esri/layers/ArcGISElevationLayer esri/views/3d/navigation/EventController esri/Viewpoint esri/core/watchUtils esri/tasks/GeometryService esri/widgets/PopupLegacy esri/widgets/PopupLegacy/PopupManager esri/widgets/Logo esri/widgets/Attribution webSceneViewer/widgets/Compass/Compass webSceneViewer/widgets/MapControls/MapControls webSceneViewer/widgets/Crosshair/Crosshair webSceneViewer/widgets/FPSView/FPSView webSceneViewer/widgets/Dialog/Dialog webSceneViewer/widgets/MessageListWidget/MessageListWidget webSceneViewer/spatialReferenceUtils webSceneViewer/webScene/WebScene webSceneViewer/webScene/Presentation webSceneViewer/basemapUtils webSceneViewer/urlUtils webSceneViewer/PortalExtended webSceneViewer/widgets/Header/Header webSceneViewer/widgets/Header/EmbedHeader webSceneViewer/UIUtils dojo/i18n!webSceneViewer/nls/viewer dojo/i18n!webSceneViewer/editor/nls/editor".split(" "),function(l,
m,h,k,g,b,d,e,a,c,f,n,r,q,p,v,x,C,M,L,t,A,s,B,y,u,E,I,z,H,J,G,F,K,D,N,w,O,P,V,Y,T,R,W,$,aa,X){function U(){return"undefined"!==typeof window.esriGeowConfig}var Q=m(null,{_onHandles:void 0,constructor:function(){this._onHandles=[]},destroy:function(){this._onHandles.forEach(function(a){a.remove()})},init:function(a){q.request.corsEnabledServers.push("elevation3d.arcgis.com","elevation3ddev.arcgis.com","s3-eu-west-1.amazonaws.com","web3d.esri.com","web3d.esri.com:5080","zrh-arcgis-server-1:5080","54.229.240.181:5080",
"54.229.240.181","ec2-54-229-240-181.eu-west-1.compute.amazonaws.com:5080","ec2-54-229-240-181.eu-west-1.compute.amazonaws.com");r.appUrl&&q.request.corsEnabledServers.push(r.appUrl.authority);"function"===typeof r._css&&(r._css=r._css());U()?q.request.proxyUrl=window.esriGeowConfig.proxyServer:q.request.proxyUrl="/proxy.php";q.geometryService=new u("//utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer");Y.cleanUrl();var b=Y.urlParams();b.ui&&"min"===b.ui&&e.add(k.byId("webscene-main"),
"minUI");N.placeAt(k.byId("webscene-map"));this._commonLayout(b);/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent)?(a=new D({title:aa.dialogs.browserFail,content:aa.webglMessages.mobile}),this._addHelpLinkToDialog(a)):(b=this._canvas3DCheck(),b.canDoCanvas3D?this.initMap(a):this._addHelpLinkToDialog(b.dialog))},_globalViewRequired:function(a,b){return b&&"global"===b||!b&&V.isBasemapGlobalCapable(a)},_localViewRequired:function(a,b){return b&&"local"===b||
!b&&!V.isBasemapGlobalCapable(a)},initMap:function(a){var b=Y.urlParams(),c=this._createMapAndView();this.view=c;var d=c.map;this._setupFullScreenControl(c,b);this._setupLogoAndAttribution(c);this._setupMapControls(c,b);this._readAndSetMemoryLimitSetting(c,b);this._loadNavigationModeSetting(c);this._initPortal(b).then(function(e){Q.setAppVersionMetaTag(e);e.access&&"public"!==e.access&&e.signIn();if(e.allSSL&&"https:"!==location.protocol){var f=e.portalUtil.useSSL(location.protocol,document.location.href);
document.location.href!==f&&(document.location.href=f)}this._header.set("portal",e);e.defaultBasemap&&(V.DefaultBasemapJson.baseMapLayers=e.defaultBasemap.baseMapLayers,V.DefaultBasemapJson.title=e.defaultBasemap.title);e.helperServices&&(e.helperServices.defaultElevationLayers&&0<e.helperServices.defaultElevationLayers.length)&&(f=e.helperServices.defaultElevationLayers[0],V.DefaultElevationLayer=new A(f),V.defaultArcGISWorldElevationService=f.url,V.DefaultBasemapJson.elevationLayers[0].url=f.url);
e.helperServices&&e.helperServices.geometry&&(q.geometryService=new u(e.helperServices.geometry.url));if(e.defaultExtent)if(this._globalViewRequired(V.DefaultBasemapJson,b.viewingmode)){var f=L.fromJSON(e.defaultExtent),f=[(f.xmax+f.xmin)/2,(f.ymax+f.ymin)/2],g=new L(0,0,0,0,new t(102100));g.xmin=f[0]-7E8;g.xmax=f[0]+7E8;g.ymin=f[1]-7E8;g.ymax=f[1]+7E8;c.setInitialExtent(g,2)}else c.setInitialExtent(L.fromJSON(e.defaultExtent),2),w.pingGeometryService(L.fromJSON(e.defaultExtent).center);this._initWebScene(b,
c,d,a,e)}.bind(this),function(){Q.setAppVersionMetaTag();this._initWebScene(b,c,d,a)}.bind(this))},_initWebScene:function(a,b,c,d,e){this._getWebScene(a.webscene,a.viewingmode).then(function(f){var g=Q.getAppVersion(e);f.currentAuthoringApp=g.appName;f.currentAuthoringAppVersion=g.appVersion;this._header.set("title",f.portalItemProperties&&f.portalItemProperties.title);f.watch("title",function(a){this._header.set("title",a)}.bind(this));this._header.set("websceneId",a.webscene);this._header.set("viewingMode",
f.viewingMode);f.spatialReference&&this._header.set("sceneSR",f.spatialReference.wkid);c.watch("spatialReference",function(a){this._header.set("sceneSR",a.wkid)}.bind(this));b.watch("globeMode",function(a){this._header.set("viewingMode","spherical"===a?"global":"local");"spherical"===a?(this.view.constraints.collision.enabled=!0,this.view.constraints.tilt.mode="auto"):(this.view.constraints.collision.enabled=!1,this.view.constraints.tilt.max=179.99)}.bind(this));this._setupEditor(a,f,b);this._setupViewer(a,
f,b,d&&d.viewer).then(function(){f.applyToMap(c,b,e,null,a).then(function(){function d(a){var c=f.presentation.slides.getAll(),e=0>a||a>=c.length?null:c[a];e&&y.whenOnce(b,"ready",function(){P.applySlideToView(e,b)})}console.log("webscene loaded");f.emit("load");var g=window.location.hash;""!==g&&d(parseInt(g.substr(1),10)-1);n.subscribe("/dojo/hashchange",function(a){a=window.location.hash;""!==a&&d(parseInt(a.substr(1),10)-1)});g=null;a.viewpoint&&(g=Y.viewpointFromUrlParameter(a.viewpoint));!g&&
(f.initialState&&f.initialState.viewpoint)&&(g=B.fromJSON(f.initialState.viewpoint));g&&this._mapControls.setHomeViewpoint(g);f.watch("initialState",function(a){this._mapControls.setHomeViewpoint(B.fromJSON(a.viewpoint))}.bind(this));a.hasOwnProperty("url")&&O.addLayerToMapByUrl(c,{url:a.url},e,O.spatialReferenceLocked?0:2).then(function(b){console.log("layer added: "+a.url);this.view.map.layers.forEach(function(a){void 0!==a._websceneIndex&&delete a._websceneIndex})}.bind(this),function(b){N.show({message:aa.messages.addLayerFailed,
type:N.MessageTypes.ERROR,details:(b.msg||b.message?b.msg||b.message+"\x3cbr\x3e":"")+(b.customDetails||a.url),collapsed:!1})});e&&a.hasOwnProperty("layers")&&(a.layers&&a.layers.split&&a.layers.split(",")).forEach(function(a){O.addContentByItemId(c,e,a,{},f,O.spatialReferenceLocked?0:2).then(function(){this.view.map.layers.forEach(function(a){void 0!==a._websceneIndex&&delete a._websceneIndex})}.bind(this))}.bind(this))}.bind(this))}.bind(this),function(a){console.warn(a)})}.bind(this),function(){var a=
h.queryToObject(window.location.search.replace(/^\?/,""));delete a.webscene;delete a.url;delete a.layers;a=window.location.origin+window.location.pathname+"?"+decodeURIComponent(h.objectToQuery(a));window.location=a})},_setupFullScreenControl:function(b,d){if($.isFullScreenEnabled()){this._fullScreenContainerDiv=a.create("div",{className:"fullScreenContainer",title:aa.buttons.fullScreen});this._fullScreenDiv=a.create("div",{className:"fullscreen"},this._fullScreenContainerDiv);g(this._fullScreenContainerDiv,
"click",function(){var a=k.byId("webscene-page");$.toggleFullScreen(a)}.bind(this));var f=function(){var b=!document.fullscreenElement&&!document.msFullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement;if(b){if(!d.ui||"min"!==d.ui){var c=this._header.websceneId,f=this._header.title,g=this._header.viewingMode,h=this._header.sceneSR;this._header.destroy();a.create("div",{id:"webmap-header"},k.byId("webscene-header"));this._createFullHeader(f,c,g,h);e.remove(k.byId("webscene-main"),
"minUI");this.editor&&this.editor.isOpen()&&this.editor.show()}this._fullScreenContainerDiv.title=aa.buttons.fullScreen;e.remove(this._fullScreenContainerDiv,"exit");this.viewer.refreshTools()}else{var f=this._header.title,g=this._header.viewingMode,h=this._header.sceneSR;if(!d.ui||"min"!==d.ui)e.add(k.byId("webscene-main"),"minUI"),this._header.destroy(),this._headerEventHandle&&this._headerEventHandle.remove(),c=a.create("div",{},k.byId("webscene-header")),this._header=new W({websceneId:d.webscene,
"class":"fullScreenHeader",portal:this._portal},c),this._header.set("title",f),this._header.set("viewingMode",g),h&&this._header.set("sceneSR",h),e.add(this._header,"fullScreenHeader");this._fullScreenContainerDiv.title=aa.buttons.exitFullScreen;e.add(this._fullScreenContainerDiv,"exit")}this._toggleAutoHideControls(!b,!d.ui||"min"!==d.ui)}.bind(this);g(c.doc,"fullscreenChange",f);g(c.doc,"MSFullscreenChange",f);g(c.doc,"webkitfullscreenchange",f);g(c.doc,"mozfullscreenchange",f);a.place(this._fullScreenContainerDiv,
b.container)}},_setupLogoAndAttribution:function(b){this._logoContainerDiv=a.create("div",{className:"esriLogoContainer"});a.place(this._logoContainerDiv,b.container);(new z).placeAt(this._logoContainerDiv);this._attrContainerDiv=a.create("div",{className:"attrContainer"});a.place(this._attrContainerDiv,b.container);new H({map:b.map,view:b},this._attrContainerDiv)},_createFullHeader:function(a,b,c,d){this._header=new R({},k.byId("webmap-header"));this._headerEventHandle=g(this._header,"before-sign-out",
function(){if(this.editor&&this.editor.unsavedChanges){var a=confirm(X.messages.pendingChangesConfirm);if(this._header.userProceedsToLogout=a)this.editor.unsavedChanges=!1,this._mapControls&&(this._mapControls.removeStyleClass("moved"),this._compass&&e.remove(this._compass._compassContainerDiv,"moved")),this.editor.destroy(),this.editor=void 0}}.bind(this));this._header.startup();this._portal&&this._header.set("portal",this._portal);a&&this._header.set("title",a);b&&this._header.set("websceneId",
b);void 0!==c&&this._header.set("viewingMode",c);d&&this._header.set("sceneSR",d)},_setupMapControls:function(a,b){this._mapControls=new G(a);this._compass=(new J).addToView(a);b.ui&&"min"===b.ui&&this._toggleAutoHideControls(!0);this._onHandles.push(g(this._mapControls,"pan-tumble-change",d.hitch(this,function(a){this.viewer.primaryNavigationChanged(a.tumble)})));new F(a);new K(a)},_toggleAutoHideControls:function(a,b){if(!this._autoHide){var c=k.byId("webscene-page"),d=[k.byId("slideDeckContainer"),
this._mapControls._domNode,this._compass._compassContainerDiv,this._header.domNode.parentNode,this._logoContainerDiv,this._attrContainerDiv];this._fullScreenContainerDiv&&d.push(this._fullScreenContainerDiv);this._autoHide=new $.autoHide(d,c)}a?(this._autoHide.start(),this._autoHide.forceHide()):b&&(this._autoHide.show(),this._autoHide.stop())},_setupViewer:function(a,c,d,e){var f=this._portal,h=new b;if("noView"in a)h.resolve();else{var m=this;l(["webSceneViewer/Viewer","webSceneViewer/widgets/SlideDeck/SlideDeck"],
function(b,l){m.viewer=new b(k.byId("viewerContainer"),d,c,f,a);e&&e(m.viewer);m._onHandles.push(g(m.viewer,"nav-mode-change",function(){m._setNavigationModeSetting(d)}.bind(m)));m._onHandles.push(g(m.viewer,"share-email",function(a){m.editor&&m.editor.goToshareEmail(a.mailUrl)}.bind(m)));m._onHandles.push(d.map.watch("spatialReference",function(a){m.viewer.showHideAllLayerIcons(a.isWebMercator())}.bind(m)));new l({view:d,webScene:c,"class":"horizontalBar"},k.byId("slideDeckContainer"));h.resolve()},
function(){h.resolve()})}return h},_setupEditor:function(a,b,c){function d(){l(["webSceneViewer/editor/WebSceneEditor"],function(d){if(!f.editor){var h=new d(k.byId("editorContainer"));h.set("view",c);h.set("map",c.map);h.set("webScene",b);f._portal&&h.set("portal",f._portal);f.editor=h;f._onHandles.push(g(f.editor,"layer-found",function(a){f.viewer&&f.viewer.addLayerIcon(a)}));f._onHandles.push(g(f.editor,"layer-toggle-popup",function(a){f.viewer&&f.viewer.toggleLayerIconPopup(a)}));f._onHandles.push(g(f.editor,
"layer-found-visible",function(a){f.viewer&&(a.clear?f.viewer.removeAllLayerIcons():f.viewer.toggleLayerIconVisibility(a.category,a.id))}));f._onHandles.push(g(f.editor,"open-change",function(a){f._mapControls&&(a.open?(f._mapControls.removeStyleClass("moved"),f._compass&&e.remove(f._compass._compassContainerDiv,"moved")):(f._mapControls.addStyleClass("moved"),f._compass&&e.add(f._compass._compassContainerDiv,"moved")))}));f._onHandles.push(g(f.editor,"scene-save",function(a){a.saveAsNew&&(f.viewer&&
f.viewer.newSceneSaved(a.webscene),f._header&&f._header.set("websceneId",a.webscene.portalItemProperties.id))}));f._onHandles.push(g(f.editor,"unsaved-change",function(a){f.viewer&&f.viewer.setUnsavedSceneChanges(a.unsavedChanges)}));f._mapControls&&(a.webscene?(f._mapControls.addStyleClass("moved"),f._compass&&e.add(f._compass._compassContainerDiv,"moved")):(f._mapControls.removeStyleClass("moved"),f._compass&&e.remove(f._compass._compassContainerDiv,"moved")));a.webscene||setTimeout(function(){h.show()},
0)}})}if(!this.editor&&!("noEdit"in a||"ui"in a&&"min"===a.ui)){var f=this,h=this._portal;this._editorAvailable(a,b,h)&&setTimeout(d,1E3);h&&g(h,"sign-in",function(b,c){this._editorAvailable(a,c,b)&&setTimeout(d,1E3)}.bind(this,h,b))}},_editorAvailable:function(a,b,c){return c?c.isSignedIn()&&c.userHasEditingPrivileges(b)?!0:!1:!0},_commonLayout:function(a){a.ui&&"min"===a.ui?this._header=new W({websceneId:a.webscene},k.byId("webmap-header")):this._createFullHeader()},_canvas3DCheck:function(){var a=
v("esri-webgl"),b,c;a||(b=aa.dialogs.browserFail,c=new D({title:aa.dialogs.browserCheck,content:b}));return{canDoCanvas3D:a,msg:b,dialog:c}},_createMapAndView:function(){var b=new C,c=new M({ui:{components:[]},container:"webscene-map",map:b});window.map=b;window.view=c;c.popup.destroy();var d=c.popup=new E({view:c,highlight:!1},a.create("div"));d.domNode.style.zIndex=40;d.startup();d._ootb=!0;d.setMap(b);c.popupManager.destroy();c.popupManager=new I({enabled:!0,view:c});return window._webSceneViewerView=
c},_getPortalUrl:function(a){return U()?window.esriGeowConfig.restBaseUrl:a.hasOwnProperty("portal")?a.portal:""},_initPortal:function(a){var c=new b;if(this._portal)setTimeout(function(){c.resolve(this._portal)}.bind(this),0);else if(a=this._getPortalUrl(a)){var d=new T.Portal(a);g(d,"sign-in-error",function(a){console.log("SignIn Error - "+a.msg+" - User was automatically signed out");c.resolve(d)});g(d,"ready",function(){p("esri_auth")?d.isSignedIn()?setTimeout(function(){c.resolve(d)}.bind(this),
0):g(d,"sign-in",function(){c.resolve(d)}):setTimeout(function(){c.resolve(d)}.bind(this),0)});this._portal=d;V.portal=d}else setTimeout(function(){c.reject()}.bind(this),0);return c.promise},_getWebScene:function(a,c){function e(a){a=new D({title:aa.dialogs.webscene,content:a});g(a,"close",function(){f.reject()})}var f=new b;if(a)0===a.indexOf("http")||0===a.indexOf("https")?O.getFromUrl(this._portal,a).then(function(a){f.resolve(a)},e):O.getFromPortalItem(this._portal,a).then(function(a){f.resolve(a)},
e);else{var h=new O(null);f.resolve(h);if(this._portal&&this._portal.defaultBasemap){var k=d.clone(this._portal.defaultBasemap);k.elevationLayers=V.DefaultBasemapJson.elevationLayers;h.basemap=k;this._localViewRequired(V.DefaultBasemapJson,c)&&(h.viewingMode="local",h.spatialReference=V.getJsonBasemapSR(this._portal.defaultBasemap).clone())}else this._localViewRequired(V.DefaultBasemapJson,c)&&(h.viewingMode="local",h.spatialReference=new t(102100))}return f},_readAndSetMemoryLimitSetting:function(a,
b){"gpuMemoryLimit"in b&&(null!=b.gpuMemoryLimit&&0<b.gpuMemoryLimit.length&&!isNaN(Number(b.gpuMemoryLimit)))&&S.getValue("gpuMemoryLimit")!==b.gpuMemoryLimit&&(-1==b.gpuMemoryLimit?S.setValue("gpuMemoryLimit",null):S.setValue("gpuMemoryLimit",b.gpuMemoryLimit)?console.log("New GPU memory limit stored: "+b.gpuMemoryLimit+" MB"):console.error("Can not store values in LocalStorage or Cookies"));var c=S.getValue("gpuMemoryLimit")||b.gpuMemoryLimit;c&&(!isNaN(Number(c))&&0<c)&&a.resourceController.setMaxGpuMemory(Number(c))},
_loadNavigationModeSetting:function(a){if(S.getValue("navigationMode")){var b;b="pro"==S.getValue("navigationMode")?s.PRO_PAN:s.PAN;y.whenOnce(a,"navigationController",function(a){a.setControls(b)})}},_setNavigationModeSetting:function(a){a=a.navigationController.getControls();a===s.PAN||a===s.TUMBLE?S.setValue("navigationMode","default"):S.setValue("navigationMode","pro")},_addHelpLinkToDialog:function(a){var b=Y.urlParams(),c="http://doc.arcgis.com/en/arcgis-online/reference/scene-viewer-requirements.htm",
d="http://doc.arcgis.com/en/arcgis-online/reference/scene-viewer-requirements.htm";a.set("details",'\x3ca class\x3d"link" href\x3d\''+c+"'\x3e"+aa.webglMessages.learnMore+"\x3c/a\x3e");a.execute=function(){window.location.href=d};this._initPortal(b).then(function(b){b&&b.helpBase&&(c=b.helpBase+b.helpMap.m["120000966"]||c,U()&&window.esriGeowConfig.baseUrl&&(d=window.esriGeowConfig.baseUrl),a.set("details",'\x3ca class\x3d"link" href\x3d\''+c+"'\x3e"+aa.webglMessages.learnMore+"\x3c/a\x3e"),a.execute=
function(){window.location.href=d})})}}),S={persistedValuePrefix:"esriWebSceneViewer",supportsLocalStorage:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}},getValue:function(a){a=S.persistedValuePrefix+"_"+a;return S.supportsLocalStorage()?window.localStorage.getItem(a):p(a)},setValue:function(a,b){var c=S.persistedValuePrefix+"_"+a;if(S.supportsLocalStorage())b?window.localStorage.setItem(c,b):window.localStorage.removeItem(c);else if(b){if(p(c,b,{expires:1})!==
b)return!1}else p(c,null,{expires:-1});return!0}};Q.setAppVersionMetaTag=function(b){b=Q.getAppVersion(b).appVersion;b=a.create("meta",{name:"websceneviewer:version",content:b});x.doc.getElementsByTagName("head")[0].insertBefore(b,x.doc.getElementsByTagName("head")[0].firstChild)};Q.getAppVersion=function(a){var b="3.10.0.0";a&&a.isPortal&&(b="10.4.0.0");if(b){a=b.split("_");var c=a[0].split("."),b={major:c[0],minor:c[1],patch:c[2],flag:a[1],appName:"WebSceneViewer",appVersion:b,uiString:"Web Scene Viewer "+
c[0]+"."+c[1]};a="Web Scene Viewer "+b.major+"."+b.minor;b.flag&&(a+=" ("+b.flag+")");b.uiString=a;return b}return{major:void 0,minor:void 0,patch:void 0,flag:void 0,appName:"WebSceneViewer",appVersion:void 0,uiString:"Web Scene Viewer "}};return Q});