// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/widgets/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${css.root}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv aria-labelledby\x3d"${id}_input" data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}" role\x3d"menu"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv aria-labelledby\x3d"${id}_menu_button" data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}" role\x3d"menu"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("require ../core/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/keys dojo/on dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ./Widget ../core/lang ./../PopupTemplate ../geometry/SpatialReference ../Graphic ../core/promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/support/scaleUtils ../tasks/Locator ../tasks/support/Query ../layers/GraphicsLayer ../Color ../styles/basic".split(" "),
function(P,Q,y,E,w,p,u,A,I,r,h,n,q,R,S,T,B,l,U,C,J,V,z,D,W,X,F,Y,K,x,G,L,M,Z,N,$,O,aa){return Q([U,S,T],{declaredClass:"esri.widgets.Search",templateString:R,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(a){this.css={root:"esri-search",searchGroup:"esri-container",visible:"esri-visible",searchInput:"esri-input",searchInputGroup:"esri-input-container",searchBtn:"esri-search-button",searchSubmit:"esri-submit",searchIcon:"esri-icon esri-icon-search",searchButtonText:"esri-icon-font-fallback-text",
searchToggle:"esri-toggle",searchToggleIcon:"esri-icon esri-icon-down-arrow",searchMenu:"esri-menu",searchMenuHeader:"esri-header",searchClear:"esri-clear",searchClearIcon:"esri-icon esri-icon-close esri-close",searchSpinner:"esri-icon esri-icon-loading-indicator esri-rotating",searchSourceName:"esri-source-name",suggestionsMenu:"esri-suggest-menu",sourcesMenu:"esri-source-menu",activeSource:"esri-active",hasValue:"esri-has-value",hasButtonMode:"esri-has-button-mode",hasMultipleSources:"esri-has-multiple-sources",
showSuggestions:"esri-show-suggestions",showSources:"esri-show-sources",showNoResults:"esri-show-no-results",searchLoading:"esri-search-loading",latLonHeader:"esri-lat-long-header",searchMoreResults:"esri-more-results",searchMoreResultsList:"esri-results-list",searchMoreResultsHeader:"esri-more-header",searchMoreResultsItem:"esri-more-item",searchMoreResultsListHeader:"esri-popup-header",searchShowMoreResults:"esri-show-more-results",searchNoResultsMenu:"esri-no-results-menu",searchNoResultsBody:"esri-no-results-body",
searchNoResultsHeader:"esri-no-results-header",searchNoValueIcon:"esri-no-value-icon esri-icon-notice-triangle",searchNoValueText:"esri-no-value-text",searchNoResultsText:"esri-no-results-text",searchExpandContainer:"esri-expand-container",searchAnimateContainer:"esri-animate",searchExpanded:"esri-expanded",searchCollapsed:"esri-collapsed",searchClearFloat:"esri-clearfix"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this.defaultSource={locator:new Z("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),
singleLineFieldName:"SingleLine",outFields:["Addr_type","Match_addr","StAddr","City"],name:q.widgets.Search.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:q.widgets.Search.placeholder,highlightSymbol:(new W(P.toUrl("./Search/images/search-pointer.png"),36,36)).set({xoffset:9,yoffset:18})};this.options={view:null,visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enablePopup:!0,
showPopupOnSelect:!0,enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new K).set("color",new O([181,56,46,0.9])).set("font",new x("14px",x.STYLE_NORMAL,x.VARIANT_NORMAL,x.WEIGHT_BOLD,"Arial")),labelGraphic:null,popupTemplate:new J({title:q.widgets.Search.searchResult,content:'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'}),
searchResults:null,suggestResults:null,selectedResult:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};a=y.mixin({},this.options,a);this.set(a);this._updateActiveSource();this._i18n=q.widgets.Search;this._defaultSR=V.WGS84},activeSource:null,activeSourceIndex:0,addLayersFromMap:!1,allPlaceholder:"Find address or place",autoNavigate:!0,autoSelect:!0,enableButtonMode:!1,enableHighlight:!0,enableLabel:!1,enablePopup:!0,
enableSourcesMenu:!0,enableSearchingAll:!0,defaultSource:"ArcGIS Online Geocoding service",enableSuggestions:!0,enableSuggestionsMenu:!0,expanded:!1,graphicsLayer:null,highlightGraphic:null,labelGraphic:null,labelSymbol:(new K).set("color",new O([181,56,46,0.9])).set("font",new x("14px",x.STYLE_NORMAL,x.VARIANT_NORMAL,x.WEIGHT_BOLD,"Arial")),loaded:null,maxLength:128,maxResults:6,maxSuggestions:6,minCharacters:1,popupTemplate:new J({title:q.widgets.Search.searchResult,content:'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'}),
searchResults:null,selectedResult:null,showPopupOnSelect:!0,sources:[this.defaultSource],suggestResults:null,suggestionDelay:150,value:"",visible:!0,view:null,zoomScale:1E3,startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);var a=[],b=this._getMap();b&&a.push(b);this.view&&a.push(this.view);a.length?D(a).always(function(){this._init()}.bind(this)):this._init()},postCreate:function(){var a=this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(u(this.submitNode,
B,this._searchButton.bind(this)));this.own(u(this.sourcesBtnNode,B,this._toggleSourcesMenu.bind(this)));this.own(u(this.inputNode,B,this._inputClick.bind(this)));this.own(u(this.clearNode,B,this._clearButton.bind(this)));this.own(u(this.formNode,"submit",function(a){a.preventDefault();this._cancelSuggest();this.search()}.bind(this)));this.own(u(this.inputNode,"keyup",function(a){this._inputKey(a)}.bind(this)));this.own(u(this.sourcesBtnNode,"keyup",function(a){this._sourceBtnKey(a)}.bind(this)));
this.own(u(this.suggestionsNode,"li:click, li:keyup",function(c){a._suggestionsEvent(c,this)}));this.own(u(this.sourcesNode,"li:click, li:keyup",function(c){a._sourcesEvent(c,this)}));this.own(u(this.inputNode,"input, paste",function(){this._suggestDelay()}.bind(this)));if(this.view){var b=this.view.popup;b&&(b.domNode&&this.enablePopup)&&(this.own(u(b.domNode,"#"+this._moreResultsId+"_show:click",function(a){this._showMoreResultsClick(a)}.bind(this))),this.own(u(b.domNode,"#"+this._moreResultsId+
"_list li a:click",function(a){this._moreResultsClick(a)}.bind(this))),this.own(u(b.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",function(a){this._switchCoordinatesClick(a)}.bind(this))))}this.value&&this._checkStatus();this._hideMenus();this._visible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);this._updateButtonMode(this.enableButtonMode);this._expanded()},destroy:function(){if(this.graphicsLayer&&this.get("view")){var a=this.view.get("map");
a&&a.remove(this.graphicsLayer)}n.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();r.get(this.inputNode,"value")&&r.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);h.remove(this.containerNode,this.css.hasValue);r.set(this.clearNode,"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},search:function(a){var b=
new w;this._mapLoaded().then(function(){this._searchDeferred(a).then(function(a){var d=a.results;this.set("searchResults",d);0===a.numResults&&(this._noResults(a.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",a);this._selectFirstResult(d,a.activeSourceIndex);b.resolve(d)}.bind(this),function(a){b.reject(a)})}.bind(this));return b.promise},suggest:function(a){var b=new w;this._mapLoaded().then(function(){this._suggestDeferred(a).then(function(a){if(a){var d=a.results;
this.set("suggestResults",d);this._insertSuggestions(d,a.value);this.emit("suggest-results",a);b.resolve(d)}}.bind(this),function(a){b.reject(a)})}.bind(this));return b.promise},select:function(a){var b=this._getDefaultSymbol(a),c=this.labelSymbol,d,e=this.sources,k=this.activeSourceIndex,g=this.enableHighlight,m=this.enableLabel,f=this.autoNavigate,s=this.showPopupOnSelect,t=this.enablePopup,H=this.popupTemplate,h=z.fromJSON(a.feature.toJSON());if(k===this._allIndex){var l=this._getSourceIndexOfResult(a);
null!==l&&(d=e[l],k=l)}else d=e[k];d&&(d.hasOwnProperty("highlightSymbol")&&(b=d.highlightSymbol),d.hasOwnProperty("labelSymbol")&&(c=d.labelSymbol),d.hasOwnProperty("enableHighlight")&&(g=d.enableHighlight),d.hasOwnProperty("enableLabel")&&(m=d.enableLabel),d.hasOwnProperty("autoNavigate")&&(f=d.autoNavigate),d.hasOwnProperty("showPopupOnSelect")&&(s=d.showPopupOnSelect),d.hasOwnProperty("enablePopup")&&(t=d.enablePopup),d.hasOwnProperty("popupTemplate")?H=d.popupTemplate:d.featureLayer&&d.featureLayer.popupTemplate&&
(H=d.featureLayer.popupTemplate));this._hideMenus();this._hideLoading();if(h){var e=this.highlightGraphic,l=this.graphicsLayer,v=this.labelGraphic,n=y.mixin({},h.attributes,{searchTheme:this.css.root,searchResult:this._searchResultHTML(a),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(a)}),p=null;t&&(p=H);v?(v.set("geometry",h.geometry),v.set("attributes",n),v.set("symbol",
c)):(v=new z(h.geometry,c,n),m&&l&&l.add(v));v&&(v.symbol&&"textsymbol"===v.symbol.type)&&v.symbol.set("text",a.name);e?(e.set("geometry",h.geometry),e.set("attributes",n),e.set("popupTemplate",p),e.set("symbol",b)):(e=new z(h.geometry,b,n,p),g&&l&&l.add(e));e&&(e.symbol&&"textsymbol"===e.symbol.type)&&e.symbol.set("text",a.name);var q=null;if(this.view&&this.view.popup&&t&&s){q=this.view.popup;q.setFeatures([e]);var r=this._getPointFromGeometry(e.geometry);r&&q.show(r)}this.view&&(f&&a&&a.hasOwnProperty("extent"))&&
this.view.animateTo(a.extent).then(function(){q&&q.show(r)});this.set("highlightGraphic",e);this.set("labelGraphic",v)}this.set("selectedResult",a);this.emit("select-result",{result:a,source:d,sourceIndex:k})},focus:function(){l.focus(this.inputNode)},blur:function(){l.curNode&&l.curNode.blur()},clearGraphics:function(){var a=this.highlightGraphic,b=this.graphicsLayer,c=this.labelGraphic;a&&b&&b.remove(a);c&&b&&b.remove(c);this.set("labelGraphic",null);this.set("highlightGraphic",null)},_clearButton:function(){this.clear();
l.focus(this.inputNode)},_getMap:function(){var a;this.view&&(a=this.view.get("map"));return a},_init:function(){var a=this.get("graphicsLayer");if(!a&&(a=new $,this.set("graphicsLayer",a),this.get("view"))){var b=this.view.get("map");b&&b.add(a)}this._getMapLayers().then(function(){this.set("loaded",!0);this.emit("load")}.bind(this))},_error:function(a){return Error(this.declaredClass+" "+a)},_searchDeferred:function(a){var b=new w,c=this.value,d=this.activeSourceIndex;a&&a.hasOwnProperty("index")&&
(d=a.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();(a?"string"===typeof a?this._searchQueries({text:a}):"object"===typeof a&&a.hasOwnProperty("magicKey")?this._searchQueries(a):"object"===typeof a&&a.hasOwnProperty("geometry")?this._searchQueries({geometry:a}):"object"===typeof a&&a.hasOwnProperty(this._objectIdIdentifier)?this._searchQueries(a):"object"===typeof a&&"point"===a.type?this._searchQueries({point:a}):a instanceof Array&&2===a.length?this._searchQueries({latlon:a}):
this._searchQueries({text:c}):this._searchQueries({text:c})).always(function(a){a=this._formatResults(a,d,c);b.resolve(a)}.bind(this));return b.promise},_mapLoaded:function(){var a=new w;this.view&&this.view.map?this.view.map.then(function(){a.resolve()}):a.resolve();return a.promise},_suggestDeferred:function(a){var b=new w;this._deferreds.push(b);a||(a=this.value);var c=this.activeSourceIndex;this._suggestQueries({text:a}).always(function(d){var e;if(d)for(var k=0;k<d.length;k++)d[k]&&(e=!0);e?
(d=this._formatResults(d,c,a),b.resolve(d)):b.resolve()}.bind(this));return b.promise},_getDefaultSymbol:function(a){var b,c,d,e,k;if(e=this._getMap())if(e=e.get("basemap"))k=e.id;k||(k="topo");a&&(a.feature&&a.feature.geometry)&&(d=a.feature.geometry.type);if(d){if(a=aa.getSchemes({theme:"default",basemap:k,geometryType:d}))c=a.primaryScheme;if(c){c.color&&c.hasOwnProperty("opacity")&&(c.color.a=c.opacity);b=c;a=c.color;c=c.size;var g;switch(d){case "point":g=new X;g.set("color",a);g.set("size",
null!==c?c:b.size);d=new F;d.set("color",b.outline.color);d.set("width",b.outline.width);g.set("outline",d);break;case "line":g=new F;g.set("color",a);g.set("width",null!==c?c:b.width);break;case "polygon":g=new Y,g.set("color",a),d=new F,d.set("color",b.outline.color),d.set("width",b.outline.width),g.set("outline",d)}b=g}}return b},_selectFirstResult:function(a,b){if(this.autoSelect&&a){var c;b===this._allIndex?c=this._getFirstResult(a):a[b]&&a[b][0]&&(c=a[b][0]);c&&this.select(c)}},_getSourceIndexOfResult:function(a){var b=
this.searchResults;if(b)for(var c in b)if(b[c]&&b[c].length)for(var d=0;d<b[c].length;d++)if(b[c][d]===a)return parseInt(c,10);return null},_getFirstResult:function(a){if(a)for(var b in a)if(a[b]&&a[b][0])return a[b][0];return!1},_onFocus:function(){this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();this.enableButtonMode&&this.loaded&&this.set("expanded",!1);this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var a=new w,b=this._getMap();if(this.addLayersFromMap&&
b){var c=[];(c=b.get("layers").getAll())&&c.length?D(c).always(function(b){for(var c,k=this.sources,g=0;g<b.length;g++)b[g].loaded&&(b[g].type&&"Feature Layer"===b[g].type)&&(k.push({featureLayer:b[g],enableSuggestions:!0}),c=!0);c&&this.set("sources",k);a.resolve()}.bind(this)):a.resolve()}else a.resolve();return a.promise},_switchCoordinatesClick:function(a){a.preventDefault();if(a=r.get(a.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",a),this.search()},_moreResultsClick:function(a){a.preventDefault();
var b=a.target;a=parseInt(r.get(b,"data-source-index"),10);var b=parseInt(r.get(b,"data-index"),10),c=this.searchResults;c&&c[a]&&(a=c[a][b])&&this.select(a)},_showMoreResultsClick:function(a){a.preventDefault();if(a=I.byId(this._moreResultsId)){h.toggle(a,this.css.searchShowMoreResults);var b=I.byId(this._moreResultsId+"_show");b&&(h.contains(a,this.css.searchShowMoreResults)?r.set(b,"textContent",q.widgets.Search.hideMoreResults):r.set(b,"textContent",q.widgets.Search.showMoreResults))}},_getObjectSize:function(a){var b=
0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},_sourcesEvent:function(a,b){var c=r.get(b,"data-index"),d=A("li",this.sourcesNode),e=E.indexOf(d,b);c!==this._allIndex&&(c=parseInt(c,10));"click"===a.type||a.keyCode===p.ENTER?(this.set("activeSourceIndex",c),l.focus(this.inputNode),this._hideSourcesMenu()):a.keyCode===p.UP_ARROW?(a.stopPropagation(),a.preventDefault(),c=e-1,0>c?l.focus(this.sourcesBtnNode):l.focus(d[c])):a.keyCode===p.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),c=e+1,c>=d.length?
l.focus(this.sourcesBtnNode):l.focus(d[c])):a.keyCode===p.ESCAPE&&(this._hideSourcesMenu(),l.focus(this.inputNode))},_suggestionsEvent:function(a,b){var c=r.get(b,"data-source-index"),d=parseInt(r.get(b,"data-index"),10),e=A("li",this.suggestionsNode),k=this.sources,g=E.indexOf(e,b);c!==this._allIndex&&(c=parseInt(c,10));this._clearQueryTimeout();if("click"===a.type||a.keyCode===p.ENTER){var e=this.suggestResults,m;e&&(e[c]&&e[c][d])&&(m=e[c][d]);m&&(m.index=c,k[c].featureLayer&&(m[this._objectIdIdentifier]=
m.feature.attributes[k[c].featureLayer.objectIdField]),this.search(m),l.focus(this.inputNode))}else a.keyCode===p.BACKSPACE||a.keyCode===p.DELETE?l.focus(this.inputNode):a.keyCode===p.UP_ARROW?(a.stopPropagation(),a.preventDefault(),c=g-1,0>c?l.focus(this.inputNode):l.focus(e[c])):a.keyCode===p.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),c=g+1,c>=e.length?l.focus(this.inputNode):l.focus(e[c])):a.keyCode===p.ESCAPE&&(this._hideMenus(),l.focus(this.inputNode))},_getResultName:function(a){var b;
a.hasOwnProperty("name")&&null!==a.name&&(b=a.name.toString());b||(b=q.widgets.Search.untitledResult);return b},_getSuggestionName:function(a){var b;a.hasOwnProperty("name")&&(b=a.name.toString());a=a.text||b;a||(a=q.widgets.Search.untitledResult);return a},_searchResultHTML:function(a){var b="";if(a.feature&&a.feature.attributes&&a.feature.attributes.Addr_type&&"LatLong"===a.feature.attributes.Addr_type){var c=a.name.split(" "),d,e;2===c.length&&(d=c[0],e=c[1]);if(e&&d){if(a=parseFloat(d),e=parseFloat(e),
c=e+", "+a,b+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+q.widgets.Search.lonlat+"\x3c/div\x3e",b+=a+", "+e,b=b+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),a!==e&&!(90<a||-90>a||180<e||-180>e))b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+q.widgets.Search.reverseLonLatHeader+"\x3c/div\x3e",b+='\x3ca data-switch-coordinates\x3d"'+c+'" tabindex\x3d"0" href\x3d"#"\x3e'+c+"\x3c/a\x3e",b+="\x3c/div\x3e"}else b=
a.name}else b=a.name;return b},_moreResultsHTML:function(a){var b="",c="",d=this.searchResults,e=this.sources,k=0;if(d){var c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),c=c+('\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+q.widgets.Search.showMoreResults+"\x3c/a\x3e"),c=c+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsList+'"\x3e'),c=c+('\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e'),g;for(g in d)if(d[g]){var m=d[g].length;if(m){var f=1===m&&d[g][0]===
a;if(1<this._getObjectSize(d)&&!f)var s=this._getSourceName(g),c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+s+"\x3c/div\x3e");if(m&&!f){c+="\x3cul\x3e";s=e[g].maxResults||this.maxResults;for(f=0;f<m&&f<s;++f)if(d[g][f]!==a){var t=this._getResultName(d[g][f]),c=c+('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+f+'" data-source-index\x3d"'+g+'" href\x3d"#"\x3e'+t+"\x3c/a\x3e\x3c/li\x3e");k++}c+="\x3c/ul\x3e"}}}c+="\x3c/div\x3e";c+="\x3c/div\x3e"}k&&(b+=c);return b},_validField:function(a,
b){return a.getField(b)},_validFields:function(a,b){if(a&&b&&b.length){for(var c=0;c<b.length;c++)if(!this._validField(a,b[c]))return!1;return!0}return!1},_getCodedName:function(a,b){if(a&&a.length)for(var c=0,d=a.length;c<d;c++){var e=a[c];if(e.code===b)return e.name}},_getCodedValue:function(a,b,c){if(a&&a.length)for(var d=0,e=a.length;d<e;d++){var k=a[d],g=k.name,m=b;c||(g=g.toLowerCase(),m=m.toLowerCase());if(g===m)return k.code}return!1},_whereClause:function(a,b,c,d){var e=null;if(a){var k=
"";this.reHostedFS.test(b.url)&&this._containsNonLatinCharacter(a)&&(k="N");if(c&&c.length)for(var g=0,m=c.length;g<m;g++){var f="",s=a,f=c[g],t=b.getField(f),h=b.getDomain(f);h&&"codedValue"===h.type&&(s=this._getCodedValue(h.codedValues,s,d));s&&(t=t.type,"esriFieldTypeString"===t||"esriFieldTypeDate"===t?f=d?f+" \x3d "+k+"'"+s+"'":"UPPER("+f+") LIKE "+k+"'%"+s.toUpperCase()+"%'":"esriFieldTypeSmallInteger"===t||"esriFieldTypeInteger"===t||"esriFieldTypeSingle"===t||"esriFieldTypeDouble"===t?(s=
parseFloat(s),f=isNaN(s)?!1:f+" \x3d "+s):f=f+" \x3d "+s,f&&(e=e?e+" or ":"",e+=f))}}return e},_suggest:function(a){a||(a={index:this.activeSourceIndex,text:this.value});var b=new w,c=a.index,d=this.sources[c],e=this.enableSuggestions;d.hasOwnProperty("enableSuggestions")&&(e=d.enableSuggestions);var k=0,g;a.hasOwnProperty("text")&&a.text&&(g=y.trim(a.text),k=a.text.length);a=d.minCharacters||this.minCharacters;if(e&&g&&k>=a&&this._supportsPagination(d)){var m="";d.prefix&&(m+=d.prefix);m+=g;d.suffix&&
(m+=d.suffix);var f=this._defaultSR;if(e=this._getMap())f=e.spatialReference;e={};if(d.locator){d.categories&&(e.categories=d.categories);d.locator.outSpatialReference=f;if(this.view&&(d.localSearchOptions&&d.localSearchOptions.hasOwnProperty("distance")&&d.localSearchOptions.hasOwnProperty("minScale"))&&(k=this._getScale(),!d.localSearchOptions.minScale||k&&k<=parseFloat(d.localSearchOptions.minScale)))e.location=this.view.get("extent").get("center"),e.distance=d.localSearchOptions.distance;e.text=
m;d.useMapExtent&&(this.view&&this.view.extent)&&(e.searchExtent=this.view.extent);d.searchExtent&&(e.searchExtent=d.searchExtent);e.maxSuggestions=d.maxSuggestions||this.maxSuggestions;d.sourceCountry&&(e.countryCode=d.sourceCountry);d.countryCode&&(e.countryCode=d.countryCode);d.locator.suggestLocations(e).then(function(a){b.resolve(a)},function(a){a||(a=this._error("Locator suggestLocations could not be performed."));b.reject(a)}.bind(this))}else d.featureLayer?d.featureLayer.then(function(){var a=
this._getDisplayField(d),e=d.searchFields||[a],g=[];d.suggestionTemplate?(d.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(a,b){g.push(b)}),-1===E.indexOf(g,d.featureLayer.objectIdField)&&g.push(d.featureLayer.objectIdField)):g=[a,d.featureLayer.objectIdField];var a=this._validField(d.featureLayer,a),k=this._validFields(d.featureLayer,g),h=this._validFields(d.featureLayer,e);if(!a||!k||!h)b.reject(this._error("Invalid FeatureLayer field"));else{a=new N;d.hasOwnProperty("suggestQueryParams")&&
y.mixin(a,d.suggestQueryParams);a.outSpatialReference=f;a.returnGeometry=!1;a.num=d.maxSuggestions||this.maxSuggestions;a.outFields=g;d.useMapExtent&&(this.view&&this.view.extent)&&(a.geometry=this.view.extent);d.searchExtent&&(a.geometry=d.searchExtent);var l;if(e=this._whereClause(m,d.featureLayer,e,!1))a.where=e,l=!0;l?d.featureLayer.queryFeatures(a,function(a){var d;(a=a.features)&&(d=this._hydrateResults(a,c,!0));b.resolve(d)}.bind(this),function(a){a||(a=this._error("FeatureLayer queryFeatures errored with suggestions"));
b.reject(a)}.bind(this)):b.resolve()}}.bind(this)):b.reject(this._error("Invalid source"))}else b.resolve();return b.promise},_supportsPagination:function(a){var b;a.locator?b=!0:a.featureLayer&&a.featureLayer.advancedQueryCapabilities&&a.featureLayer.advancedQueryCapabilities.supportsPagination&&(b=!0);return b},_suggestQueries:function(a){var b=this.sources,c=this.activeSourceIndex,d=[],e;if(c===this._allIndex)for(c=0;c<b.length;c++)e=a,e.index=c,e=this._suggest(e),d.push(e);else a.index=c,e=this._suggest(a),
d.push(e);return D(d)},_expanded:function(){this.enableButtonMode&&(this.expanded?(h.add(this.containerNode,this.css.searchExpanded),h.remove(this.containerNode,this.css.searchCollapsed)):(h.remove(this.containerNode,this.css.searchExpanded),h.add(this.containerNode,this.css.searchCollapsed)));this._hideMenus()},_getPointFromGeometry:function(a){var b;if(a)switch(a.type){case "extent":b=a.get("center");break;case "multipoint":b=a.get("extent").get("center");break;case "point":b=a;break;case "polygon":b=
a.get("extent").get("center");break;case "polyline":b=a.get("extent").get("center")}return b},_searchQueries:function(a){a.hasOwnProperty("index")||(a.index=this.activeSourceIndex);var b=[],c;if(a.index===this._allIndex)for(var d=this.sources,e=0;e<d.length;e++)c=a,c.index=e,c=this._search(c),b.push(c);else a=this._search(a),b.push(a);return D(b)},_searchButton:function(){this.enableButtonMode&&!this.expanded?(this.set("expanded",!0),l.focus(this.inputNode)):(this._cancelSuggest(),this.search())},
_search:function(a){a||(a={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});var b,c=new w,d=a.index,e=this.sources[d],k;a.hasOwnProperty("text")&&a.text&&(k=y.trim(a.text));if(e){var g="";e.prefix&&!a.magicKey&&(g+=e.prefix);g+=k;e.suffix&&!a.magicKey&&(g+=e.suffix);var m=this._defaultSR,f=this._getMap();f&&(m=f.spatialReference);if(e.locator)if(a.hasOwnProperty("text")&&k){f={};e.categories&&(f.categories=e.categories);m&&(e.locator.outSpatialReference=
m);if(this.view&&e.localSearchOptions&&e.localSearchOptions.hasOwnProperty("distance")&&e.localSearchOptions.hasOwnProperty("minScale")){var h=this._getScale();if(!e.localSearchOptions.minScale||h&&h<=parseFloat(e.localSearchOptions.minScale))f.location=this.view.get("extent").get("center"),f.distance=e.localSearchOptions.distance}f.address={};f.maxLocations=e.maxResults||this.maxResults;e.useMapExtent&&(this.view&&this.view.extent)&&(f.searchExtent=this.view.extent);e.searchExtent&&(f.searchExtent=
e.searchExtent);e.sourceCountry&&(f.countryCode=e.sourceCountry);e.countryCode&&(f.countryCode=e.countryCode);a.magicKey&&(f.magicKey=a.magicKey);e.singleLineFieldName?f.address[e.singleLineFieldName]=g:f.address["Single Line Input"]=g;e.outFields&&(f.outFields=e.outFields);e.locator.addressToLocations(f).then(function(a){a=this._hydrateResults(a,d,!1);c.resolve(a)}.bind(this),function(a){a||(a=this._error("Locator addressToLocations could not be performed"));c.reject(a)}.bind(this))}else a.geometry?
(b=this._getPointFromGeometry(a.geometry.geometry))?this._reverseGeocodePoint(d,b).then(function(a){c.resolve(a)},function(a){c.reject(a)}):c.reject(this._error("Invalid point to reverse geocode")):a.point?this._reverseGeocodePoint(d,a.point).then(function(a){c.resolve(a)},function(a){c.reject(a)}):a.latlon?(f=new G(a.latlon,this._defaultSR),this._reverseGeocodePoint(d,f).then(function(a){c.resolve(a)},function(a){c.reject(a)})):a.hasOwnProperty("text")&&!k?c.resolve([]):c.reject(this._error("Invalid query type for Locator"));
else e.featureLayer?e.featureLayer.then(function(){var f=this._getDisplayField(e),h=e.searchFields||[f],f=this._validField(e.featureLayer,f),l=this._validFields(e.featureLayer,h);if(!f||!l)c.reject(this._error("Invalid FeatureLayer field"));else{f=new N;e.hasOwnProperty("searchQueryParams")&&y.mixin(f,e.searchQueryParams);if(m&&(f.outSpatialReference=m,l=M.getUnitValueForSR(m)))f.maxAllowableOffset=l;f.returnGeometry=!0;e.outFields&&(f.outFields=e.outFields);var n;a.hasOwnProperty(this._objectIdIdentifier)||
(this._supportsPagination(e)&&(f.num=e.maxResults||this.maxResults),e.useMapExtent&&(this.view&&this.view.extent)&&(f.geometry=this.view.extent),e.searchExtent&&(f.geometry=e.searchExtent),n=e.exactMatch);a.hasOwnProperty("text")&&k?(h=this._whereClause(g,e.featureLayer,h,n))?(f.where=h,h=!0):h=!1:a.hasOwnProperty(this._objectIdIdentifier)?(f.objectIds=[a[this._objectIdIdentifier]],h=!0):a.geometry?(f.geometry=a.geometry,h=!0):a.point?(f.geometry=a.point,h=!0):a.latlon?(b=new G(a.latlon,this._defaultSR),
f.geometry=b,h=!0):(a.hasOwnProperty("text")&&!k?c.resolve([]):c.reject(this._error("Invalid query type for FeatureLayer")),h=!1);h?e.featureLayer.queryFeatures(f,function(a){a=a.features;var b;a&&(b=this._hydrateResults(a,d,!1));c.resolve(b)}.bind(this),function(a){a||(a=this._error("FeatureLayer queryFeatures could not be performed"));c.reject(a)}.bind(this)):c.resolve()}}.bind(this)):c.reject(this._error("Invalid source"))}else c.reject(this._error("Source is undefined"));return c.promise},_clearQueryTimeout:function(){this._queryTimer&&
clearTimeout(this._queryTimer)},_formatResults:function(a,b,c){c={activeSourceIndex:b,value:c,numResults:0,numErrors:0,errors:null,results:null};var d={},e={};if(a)if(b===this._allIndex)for(b=0;b<a.length;b++)a[b]&&(a[b]instanceof Error?(d[b]=a[b],c.numErrors++):(e[b]=a[b],c.numResults+=a[b].length));else a[0]&&(a[0]instanceof Error?(d[b]=a[0],c.numErrors++):(e[b]=a[0],c.numResults+=a[0].length));c.numErrors&&(c.errors=d);c.numResults&&(c.results=e);return c},_reverseGeocodePoint:function(a,b){var c=
new w,d=this.sources[a];if(b&&d){var e=d.locationToAddressDistance||this.locationToAddressDistance;d.locator.outSpatialReference=this._defaultSR;var k=this._getMap();k&&(d.locator.outSpatialReference=k.spatialReference);d.locator.locationToAddress(b,e,function(b){b=this._hydrateResults([b],a,!1);c.resolve(b)}.bind(this),function(a){a||(a=this._error("Locator locationToAddress could not be performed"));c.reject(a)}.bind(this))}else c.reject(this._error("No point or source defined for reverse geocoding"));
return c.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel(this.declaredClass+" cancelling request");this._deferreds=[]},_sourceBtnKey:function(a){if(a){var b=A("li",this.sourcesNode);a.keyCode===p.UP_ARROW?(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),(a=b.length)&&l.focus(b[a-1])):a.keyCode===p.DOWN_ARROW&&(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),b[0]&&l.focus(b[0]))}},
_inputKey:function(a){if(a){var b=A("li",this.suggestionsNode),c=this.suggestResults;if(a.keyCode===p.TAB||a.keyCode===p.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(a.keyCode===p.UP_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),(a=b.length)&&l.focus(b[a-1]);else if(a.keyCode===p.DOWN_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),b[0]&&l.focus(b[0]);else{if(a.ctrlKey||a.metaKey||a.keyCode===
p.copyKey||a.keyCode===p.LEFT_ARROW||a.keyCode===p.RIGHT_ARROW||a.keyCode===p.ENTER)return a;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(function(){this.suggest()}.bind(this),this.suggestionDelay)},_changeValue:function(){this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},
_getSourceName:function(a){var b=this.sources,c=b[a].name;!c&&b[a].featureLayer&&(c=b[a].featureLayer.name);c||(c=q.widgets.Search.untitledSource);return c},_insertSuggestions:function(a,b){if(this.enableSuggestionsMenu&&this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var c,d=this.sources;if(a){c=n.create("div");for(var e in a)if(a[e]&&a[e].length){var k=this._getSourceName(e);1<d.length&&this.activeSourceIndex===this._allIndex&&n.create("div",{className:this.css.searchMenuHeader,
textContent:k},c);for(var k=n.create("ul",{},c),g=d[e].maxSuggestions||this.maxSuggestions,h=0;h<a[e].length&&h<g;++h)for(var f=n.create("li",{"data-index":h,"data-source-index":e,role:"menuitem",tabindex:0},k),l=RegExp("("+b+")","gi"),l=this._getSuggestionName(a[e][h]).replace(l,"|$1|").split("|"),q=l.length,p=0;p<q;p++){var r=l[p];r.toLowerCase()===b.toLowerCase()?n.create("strong",{textContent:r},f):(r=document.createTextNode(r),n.place(r,f))}}}c?(n.place(c,this.suggestionsNode,"only"),this._showSuggestionsMenu()):
(n.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var b,c,d=this.activeSourceIndex,e=n.create("ul");this.enableSearchingAll&&(b="",d===this._allIndex&&(b="active"),n.create("li",{"data-index":this._allIndex,role:"menuitem",className:b,tabIndex:0,textContent:q.widgets.Search.all},e));for(c=0;c<a.length;c++){b="";c===d&&(b=this.css.activeSource);var k=this._getSourceName(c);n.create("li",{"data-index":c,role:"menuitem",
className:b,tabIndex:0,textContent:k},e)}h.add(this.containerNode,this.css.hasMultipleSources);n.place(e,this.sourcesNode,"only")}else h.remove(this.containerNode,this.css.hasMultipleSources),n.empty(this.sourcesNode)},_showLoading:function(){h.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){h.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(h.add(this.containerNode,this.css.hasValue),r.set(this.clearNode,"title",q.widgets.Search.clearButtonTitle)):
this.clear()},_closePopup:function(){this.enablePopup&&(this.view&&this.view.popup)&&this.view.popup.hide()},_noResults:function(a){var b;a&&(b=y.trim(a));var c=n.create("div",{className:this.css.searchNoResultsBody});a&&b?(n.create("div",{className:this.css.searchNoResultsHeader,textContent:q.widgets.Search.noResults},c),n.create("div",{className:this.css.searchNoResultsText,textContent:C.substitute({value:'"'+a+'"'},q.widgets.Search.noResultsFound)},c)):(a=n.create("div",{},c),n.create("span",{"aria-hidden":"true",
className:this.css.searchNoValueIcon},a),n.create("span",{className:this.css.searchNoValueText,textContent:q.widgets.Search.emptyValue},a));n.place(c,this.noResultsMenuNode,"only")},_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){h.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();h.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){h.remove(this.containerNode,
this.css.showSources)},_hideSuggestionsMenu:function(){h.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();h.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();h.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();h.toggle(this.containerNode,this.css.showSources)},
_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var b=0;b<a.length;b++){var c=a[b];if("esriFieldTypeString"===c.type)return c.name}return""},_getDisplayField:function(a){return a.displayField||a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validExtent:function(a){return a&&a.xmin&&"NaN"!==a.xmin&&a.ymin&&"NaN"!==a.ymin&&a.xmax&&"NaN"!==a.xmax&&a.ymax&&"NaN"!==a.ymax?!0:!1},_hydrateResult:function(a,b,c){var d={},e=this._defaultSR,k;b=this.sources[b];var g=
this._getMap();g&&(e=g.spatialReference);if(a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;if(a.hasOwnProperty("geometry"))k=z.fromJSON(a.toJSON()),d.feature=k,(k=d.feature.geometry)&&k.set("spatialReference",e);else if(a.hasOwnProperty("location")){var h=new G(a.location.x,a.location.y,e);k={};a.hasOwnProperty("attributes")&&(k=a.attributes);a.hasOwnProperty("score")&&(k.score=a.score);d.feature=new z(h,null,k,null)}else d.feature=null;if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))d.extent=
new L(a.extent),d.extent.set("spatialReference",e);else if(d.feature&&d.feature.geometry)switch(d.feature.geometry.type){case "extent":d.extent=d.feature.geometry;break;case "multipoint":d.extent=d.feature.geometry.get("extent");break;case "polygon":d.extent=d.feature.geometry.get("extent");break;case "polyline":d.extent=d.feature.geometry.get("extent");break;case "point":g?(e=this.zoomScale,b&&b.zoomScale&&(e=b.zoomScale),this._getScale()>e?d.extent=M.getExtentForScale(this.view,e).centerAt(d.feature.geometry):
d.extent=this.view.get("extent").centerAt(d.feature.geometry)):d.extent=new L({xmin:d.feature.geometry.x-0.25,ymin:d.feature.geometry.y-0.25,xmax:d.feature.geometry.x+0.25,ymax:d.feature.geometry.y+0.25,spatialReference:this._defaultSR})}else d.extent=null;d.name="";b.featureLayer?b.suggestionTemplate&&c?d.name=C.substitute(a.attributes,b.suggestionTemplate):b.searchTemplate?d.name=C.substitute(a.attributes,b.searchTemplate):(c=this._getDisplayField(b),b=b.featureLayer.getDomain(c),c&&(a.hasOwnProperty("attributes")&&
a.attributes.hasOwnProperty(c))&&(a=a.attributes[c],d.name=b&&"codedValue"===b.type?this._getCodedName(b.codedValues,a):a)):a.address&&b.searchTemplate?d.name=C.substitute(a.address,b.searchTemplate):a.hasOwnProperty("name")?d.name=a.name:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.Match_addr?(d.name=a.attributes.Match_addr,a.attributes.Addr_type&&("POI"===a.attributes.Addr_type&&a.attributes.StAddr&&a.attributes.City)&&(d.name+=" - "+a.attributes.StAddr+", "+a.attributes.City)):
a.hasOwnProperty("address")&&"string"===typeof a.address?d.name=a.address:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Address")?d.name=a.address.Address:d.feature&&d.feature.geometry&&(d.name=d.feature.geometry.x+","+d.feature.geometry.y);return d},_getScale:function(){var a;this.view&&(a=this.view.get("scale"));return a},_hydrateResults:function(a,b,c){var d=[],e=0;if(a&&a.length)for(e;e<a.length;e++){var h=this._hydrateResult(a[e],b,c);d.push(h)}return d},
_containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1},_setPlaceholder:function(a){var b="",c=this.sources[a];a===this._allIndex?b=this.allPlaceholder||q.widgets.Search.allPlaceholder:c&&c.placeholder&&(b=c.placeholder);var d=q.widgets.Search.all;c&&(d=this._getSourceName(a));r.set(this.sourceNameNode,"textContent",d);r.set(this.inputNode,"placeholder",b);r.set(this.inputNode,"title",b)},_updateActiveSource:function(){var a=this.sources,b=this.activeSourceIndex,
c;a&&a[b]&&(c=a[b]);c?this.set("activeSource",c):this.set("activeSource",null)},_visible:function(){this.get("visible")?h.add(this.containerNode,this.css.visible):h.remove(this.containerNode,this.css.visible)},_updateButtonMode:function(a){a?(h.toggle(this.containerNode,this.css.searchExpanded,this.expanded),h.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),h.add(this.containerNode,this.css.hasButtonMode)):(h.remove(this.containerNode,this.css.searchExpanded),h.remove(this.containerNode,
this.css.searchCollapsed),h.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(){var a=this.sources;a&&1===a.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&(this._setDefaultActiveSourceIndex(),
this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(a){this._set("sources",a);this._created&&(this._setDefaultActiveSourceIndex(),this._hideMenus(),this._insertSources(a))},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",a);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),this._insertSources(this.sources))},
_setMaxLengthAttr:function(a){this._set("maxLength",a);this._created&&r.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this._set("value",a);this._created&&(r.set(this.inputNode,"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&this._visible()},_setExpandedAttr:function(a){this._set("expanded",a);this._created&&this._expanded()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",a);this._created&&this._updateButtonMode(a)}})});