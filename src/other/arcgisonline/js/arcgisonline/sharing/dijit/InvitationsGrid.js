// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/InvitationsGrid",["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dojo/data/ItemFileReadStore,dojox/grid/DataGrid,dojox/rpc/Service,dojo/rpc/JsonService,dijit/Toolbar,dijit/Tooltip,dojox/layout/ContentPane,arcgisonline/sharing/geow/QueryReadStore,arcgisonline/sharing/util"],function(g,b,h){b.provide("arcgisonline.sharing.dijit.InvitationsGrid");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dojo.data.ItemFileReadStore");b.require("dojox.grid.DataGrid");
b.require("dojox.rpc.Service");b.require("dojo.rpc.JsonService");b.require("dijit.Toolbar");b.require("dijit.Tooltip");b.require("dojox.layout.ContentPane");b.require("arcgisonline.sharing.geow.QueryReadStore");b.require("arcgisonline.sharing.util");b.declare("arcgisonline.sharing.dijit.InvitationsGrid",[g._Widget,g._Templated],{widgetsInTemplate:!0,templateString:' \x3cdiv id\x3d"esriInvitationsGrid" style\x3d"width: 100%; height: 100%; margin:auto;"\x3e\r\n    \x3ctable dojotype\x3d"dojox.grid.DataGrid" jsid\x3d"grid" id\x3d"invitationsNode" rowsperpage\x3d"10"\r\n        delayscroll\x3d"true" class\x3d"esriGrid" style\x3d"height:100%; width:100%;"\x3e\r\n    \x3cthead\x3e\r\n        \x3ctr\x3e        \r\n        \x3cth get\x3d"arcgisonline.sharing.dijit.InvitationsGrid.formatters.groupName" formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"20%" name\x3d"Group Name"\x3e${i18n.groupName}\x3c/th\x3e\r\n        \x3cth get\x3d"arcgisonline.sharing.dijit.InvitationsGrid.formatters.sender" formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"20%" name\x3d"Sender"\x3e${i18n.sender}\x3c/th\x3e\r\n        \x3cth get\x3d"arcgisonline.sharing.dijit.InvitationsGrid.formatters.received" formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"25%" name\x3d"Received"\x3e${i18n.received}\x3c/th\x3e\r\n        \x3cth get\x3d"arcgisonline.sharing.dijit.InvitationsGrid.formatters.yourResponse" formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"60%" name\x3d"Your Response"\x3e${i18n.yourResponse}\x3c/th\x3e\r\n        \x3c/tr\x3e\r\n    \x3c/thead\x3e\r\n    \x3c/table\x3e\r\n \x3c/div\x3e   \r\n',
i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").invitationsGrid)},postCreate:function(){this._applyGridPatches()},_applyGridPatches:function(){var e=grid.adaptWidth;grid.adaptWidth=function(){for(var a=this.views.views,c=0,d;d=a[c];c++){b.style(d.headerNode,"display","block");var f=d.adaptWidth;d.adaptWidth=function(){this.flexCells&&null==
this.headerContentNode.firstChild||f.apply(this,arguments)}}e.apply(this,arguments);for(c=0;d=a[c];c++)b.style(d.headerNode,"display","none")}},loadGrid:function(e){for(var a=0,c=!1;!c;)g.byId("tooltip_"+a)?g.byId("tooltip_"+a).destroy():c=!0,a++;e={identifier:"id",label:"groupTitle",items:e};grid.noDataMessage="\x3cspan style\x3d'font-size:1.2em;color:#7a7979;'\x3e"+this.i18n.noGroupInvites+"\x3c/span\x3e";e=new b.data.ItemFileReadStore({data:e});grid.setStore(e)}});arcgisonline.sharing.dijit.InvitationsGrid.formatters=
{i18n:null,groupName:function(b,a){return!a?this.defaultValue:'\x3cspan id\x3d"group_title_'+b+'" onMouseOver\x3d"JavaScript:arcgisonline.sharing.dijit.InvitationsGrid.formatters.showTooltip('+b+');"\x3e'+a.groupTitle+"\x3c/span\x3e"},showTooltip:function(e){if(!g.byId("tooltip_"+e)&&b.byId("group_title_"+e)){var a=grid.getItem(e),c=null;null!=a.groupDescription&&(1==a.groupDescription.length&&null!=a.groupDescription[0]&&0<a.groupDescription[0].length?c=a.groupDescription[0]:1<a.groupDescription.length&&
(c=a.groupDescription));var d=null;null!=a.groupThumbnail&&(1==a.groupThumbnail.length&&null!=a.groupThumbnail[0]&&0<a.groupThumbnail[0].length?d=a.groupThumbnail[0]:1<a.groupThumbnail.length&&(d=a.groupThumbnail));if(null!=c||null!=d){var f='\x3cspan class\x3d"esriItemTitle" style\x3d"line-height:20px;"\x3e'+a.groupTitle+"\x3c/span\x3e";null!=d&&(f=-1<d.indexOf("http://")?f+("\x3cbr/\x3e\x3cbr/\x3e\x3cimg src\x3d'"+d+'\' width\x3d"65" height\x3d"65" /\x3e'):f+("\x3cbr/\x3e\x3cbr/\x3e\x3cimg src\x3d'"+
esriGeowConfig.restBaseUrl+"community/groups/"+a.groupId+"/info/"+d+'\' width\x3d"65" height\x3d"65" /\x3e'));null!=c&&(c=arcgisonline.sharing.util.removeHTMLTags(c),f=150<c.length?f+("\x3cbr/\x3e\x3cbr/\x3e"+c.substring(0,150)+" ..."):f+("\x3cbr/\x3e\x3cbr/\x3e"+c));(new g.Tooltip({label:f+"\x3cbr/\x3e\x26nbsp;",connectId:["group_title_"+e],id:"tooltip_"+e})).open(b.byId("group_title_"+e))}}},sender:function(b,a){return!a?this.defaultValue:a.fromUserFullname},received:function(e,a){if(!a)return this.defaultValue;
var c=new Date(parseFloat(a.received));return b.date.locale.format(c,{selector:"date",formatLength:"long"})},yourResponse:function(e,a){this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").invitationsGrid);if(!a)return this.defaultValue;var c=a.asUser&&a.asUser[0]?a.asUser[0]:null,d="";c?(d='\x3cdiv class\x3d"list-links"\x3e\x3cspan class\x3d"approveApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.acceptInvitationByUser(\''+
a.groupId+"','"+c+"')\"\x3e"+this.i18n.joinThisGroup+"\x3c/a\x3e",d+=' \x3cspan class\x3d"declineApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.declineInvitationByUser(\''+a.groupId+"','"+c+"')\"'\x3e"+this.i18n.decline+"\x3c/a\x3e\x3c/div\x3e"):(d='\x3cdiv class\x3d"list-links"\x3e\x3cspan class\x3d"approveApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.acceptInvitation(\''+a.groupId+"')\"\x3e"+this.i18n.joinThisGroup+
"\x3c/a\x3e",d+=' \x3cspan class\x3d"declineApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.declineInvitation(\''+a.groupId+"')\"'\x3e"+this.i18n.decline+"\x3c/a\x3e\x3c/div\x3e");return d}}});