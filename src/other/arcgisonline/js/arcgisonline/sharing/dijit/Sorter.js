// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/Sorter",["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/util,arcgisonline/sharing/_Search,dijit/_Widget,dijit/_Templated"],function(f,b,g){b.provide("arcgisonline.sharing.dijit.Sorter");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing._Search");b.require("dijit._Widget");b.require("dijit._Templated");b.declare("arcgisonline.sharing.dijit.Sorter",[f._Widget,arcgisonline.sharing._Search],{_util:arcgisonline.sharing.util,_container:null,
fields:[],restrict:null,sortField:null,sortOrder:null,constructor:function(){},postCreate:function(){var a=this._getSearchParams();if(-1<location.href.indexOf("search.html")){var c=this._readSearchCookie();a.sortField&&(c.sortField=a.sortField);a.sortOrder&&(c.sortOrder=a.sortOrder);a.resetSort&&-1<location.href.indexOf("search.html")&&(c={});this.sortField=c.sortField;this.sortOrder=c.sortOrder;this._setSearchCookie(c)}else a.sortField&&(this.sortField=a.sortField),a.sortOrder&&(this.sortOrder=a.sortOrder);
b.addClass(this.domNode,"esriSorter")},startup:function(){},_setFieldsAttr:function(a){a&&a.length&&(this.fields=a,this._redraw())},_redraw:function(){b.empty(this.domNode);if(null!==this.fields){var a=b.create,c=a("span",{"class":"esriItemLinks"},this.domNode,"only");b.forEach(this.fields,function(e){var d=a("a",{"class":"itemField",innerHTML:e.label,href:this._getSortUrl(e)},c);(null===e.name&&(!this.sortField||null===this.sortField)||this.sortField===e.name)&&b.addClass(d,"selected");null!==this.sortField&&
this.sortField===e.name&&(d=a("span",{"class":"dijitInline esriArrows"},d),e.reverse?"asc"===this.sortOrder&&b.addClass(d,"arrowUp"):(null===this.sortOrder||"asc"===this.sortOrder)&&b.addClass(d,"arrowUp"))},this)}},_getSortUrl:function(a){var c={sortField:null,sortOrder:null,start:null};void 0!==this.restrict&&null!==this.restrict&&(c.restrict=this.restrict);a.name&&null!==a.name?(c.sortField=a.name,delete c.resetSort,c.sortOrder=this.sortField===a.name?null===this.sortOrder||"asc"===this.sortOrder?
"desc":"asc":a.reverse?"desc":"asc"):null===a.name&&-1<location.href.indexOf("search.html")&&(c.resetSort=!0);return this.getSearchUrl(c,{useCurrentPageLocation:!0})},_readSearchCookie:function(){return this._util.getCookie("esri_search")||{}},_setSearchCookie:function(a){b.cookie("esri_search",b.json.stringify(a),{path:"/"})},sort:function(a,c){var b={sortField:null,sortOrder:null,start:null},d=this._readSearchCookie();void 0!==this.restrict&&null!==this.restrict&&(b.restrict=this.restrict);a&&null!==
a&&(b.sortField=a,b.sortOrder=c||"desc",d.sortField=b.sortField,d.sortOrder=b.sortOrder,this._setSearchCookie(d));window.location=this.getSearchUrl(b)},setRestrict:function(a){this.restrict=a;this._redraw()}})});