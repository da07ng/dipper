// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
require({cache:{"url:arcgisonline/sharing/dijit/dialog/templates/BatchAssignToGroupsDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${baseClass} batch-assign-group-dialog" data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" title\x3d"${i18n.assignMembership}"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/layout/StackContainer" data-dojo-attach-point\x3d"_stackContainer"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"_stackSelectUsers" class\x3d"select-users-stack"\x3e\r\n        \x3cdiv class\x3d"stepHeader"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading stepSprite step1"\x3e\x26nbsp;\x3c/div\x3e\x26nbsp;\x26nbsp;\r\n          \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n            \x3cdiv class\x3d"stepMessage" data-dojo-attach-point\x3d"_step1Message"\x3e\x3cstrong\x3e${i18n.step1}\x3c/strong\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"_userSelectContainer"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_userSelector" data-dojo-type\x3d"arcgisonline/sharing/dijit/OrgUserSelector"\r\n            data-dojo-props\x3d"enableListActions: true"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr\x3e\r\n\r\n        \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n          \x3cbutton class\x3d"calcite blue small" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n            data-dojo-attach-point\x3d"_selectUsersNext"\x3e${i18n.next}\x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite transparent small" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n            data-dojo-attach-point\x3d"_selectUsersClose"\x3e${i18n.cancel}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr class\x3d"clearBreak"\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"_stackSelectGroups" class\x3d"select-groups-stack"\x3e\r\n        \x3cdiv class\x3d"stepHeader"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading stepSprite step2"\x3e\x26nbsp;\x3c/div\x3e\x26nbsp;\x26nbsp;\r\n          \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n            \x3cdiv class\x3d"stepMessage" data-dojo-attach-point\x3d"_step2Message"\x3e\x3cstrong\x3e${i18n.step2}\x3c/strong\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"_groupSelectContainer"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_groupSelector" data-dojo-type\x3d"arcgisonline/sharing/dijit/GroupSelector"\r\n            data-dojo-props\x3d"enableListActions: true, excludeEnterpriseGroups: true"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr\x3e\r\n\r\n        \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n          \x3cbutton class\x3d"calcite default small hoverWhite" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n                  data-dojo-attach-point\x3d"_selectGroupsBack"\x3e${i18n.back}\x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite blue small" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n                  data-dojo-attach-point\x3d"_selectGroupsNext"\x3e${i18n.next}\x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite transparent small" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n                  data-dojo-attach-point\x3d"_selectGroupsClose"\x3e${i18n.cancel}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr class\x3d"clearBreak"\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"_stackSummary" class\x3d"summary-stack"\x3e\r\n        \x3cdiv class\x3d"stepHeader"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading stepSprite step3"\x3e\x26nbsp;\x3c/div\x3e\x26nbsp;\x26nbsp;\r\n          \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n            \x3cdiv class\x3d"stepMessage" data-dojo-attach-point\x3d"_step3Message"\x3e\x3cstrong\x3e${i18n.step3}\x3c/strong\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"marginTop1" data-dojo-attach-point\x3d"_summaryContainer"\x3e\r\n          \x3ctable class\x3d"marginTop1" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"column270"\x3e\r\n                \x3cdiv class\x3d"listLabel"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_userListLabel"\x3e${i18n.selectedUsers}\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"listContainer" data-dojo-type\x3d"dijit/layout/BorderContainer"\r\n                     data-dojo-props\x3d"gutters:false,splitters:false,design:\'headline\'"\x3e\r\n                  \x3cdiv class\x3d"listInnerContainer"\r\n                       data-dojo-type\x3d"dijit/layout/ContentPane"\r\n                       data-dojo-props\x3d"region:\'middle\',splitter:false"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_selectedUsersPane"\x3e\r\n                      \x3c!-- selected user list is populated here --\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd class\x3d"column10"\x3e\x3c/td\x3e\r\n              \x3ctd class\x3d"column270"\x3e\r\n                \x3cdiv class\x3d"listLabel"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_selectedUserListLabel"\x3e${i18n.selectedGroups}\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"listContainer" data-dojo-type\x3d"dijit/layout/BorderContainer"\r\n                     data-dojo-props\x3d"gutters:false,splitters:false,design:\'headline\'"\x3e\r\n                  \x3cdiv class\x3d"listInnerContainer"\r\n                       data-dojo-type\x3d"dijit/layout/ContentPane"\r\n                       data-dojo-props\x3d"region:\'middle\',splitter:false"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_selectedGroupsPane"\x3e\r\n                      \x3c!-- selected group list is populated here --\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3cbr\x3e\r\n        \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n          \x3cbutton class\x3d"calcite default small hoverWhite" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n                  data-dojo-attach-point\x3d"_summaryBack"\x3e${i18n.back}\x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite green small" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n                  data-dojo-attach-point\x3d"_summaryAssign"\x3e${i18n.assign}\x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite transparent small" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n                  data-dojo-attach-point\x3d"_summaryClose"\x3e${i18n.cancel}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr style\x3d"clear:both;"\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"_stackResultSummary" class\x3d"result-summary-stack"\x3e\r\n        \x3cdiv class\x3d"stepHeader"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading stepSprite step4"\x3e\x26nbsp;\x3c/div\x3e\x26nbsp;\x26nbsp;\r\n          \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n            \x3cdiv class\x3d"stepMessage" data-dojo-attach-point\x3d"_step4Message"\x3e\x3cstrong\x3e${i18n.assignmentComplete}\x3c/strong\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"resultSummary"\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"_resultMessage"\x3e\x3c/label\x3e\r\n          \x3cdiv class\x3d"marginTop1"\x3e\x3clabel\x3e${i18n.continueAssignment}\x3c/label\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr\x3e\r\n        \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n          \x3cbutton class\x3d"calcite blue small" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n                  data-dojo-attach-point\x3d"_resultAssign"\x3e${i18n.assignMore}\x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite default small hoverWhite" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\r\n                  data-dojo-attach-point\x3d"_resultClose"\x3e${i18n.done}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr style\x3d"clear:both;"\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("arcgisonline/sharing/dijit/dialog/BatchAssignToGroupsDlg","require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/sniff dojo/on dijit/a11yclick dojo/mouse dojo/promise/all dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog dijit/layout/BorderContainer dijit/layout/StackContainer dijit/layout/ContentPane dijit/form/Button dijit/Tooltip esri/lang arcgisonline/sharing/util arcgisonline/sharing/dijit/OrgUserSelector arcgisonline/sharing/dijit/GroupSelector dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/BatchAssignToGroupsDlg.html".split(" "),
function(r,s,d,k,h,g,A,m,n,e,p,t,u,v,w,B,C,D,E,F,f,x,y,G,H,q,z){var l=s("arcgisonline.sharing.dijit.dialog.BatchAssignToGroupsDlg",[u,v,w],{declaredClass:"arcgisonline.sharing.dijit.dialog.BatchAssignToGroupsDlg",baseClass:"esriBatchAssignToGroups",basePath:r.toUrl("arcgisonline/sharing/dijit/dialog"),templateString:z,widgetsInTemplate:!0,constructor:function(a){a&&(a.initialUserSearch&&this._set("initialUserSearch",a.initialUserSearch),a.initialGroupSearch&&this._set("initialGroupSearch",a.initialGroupSearch))},
postMixInProperties:function(){this.inherited(arguments);this.i18n=d.mixin({},q.common);d.mixin(this.i18n,q.batchAssignToGroupsDlg)},postCreate:function(){this.inherited(arguments);this._setupConnections()},startup:function(){this.inherited(arguments)},_setupConnections:function(){var a=d.hitch(this,this.hide);this.own(e(this._selectUsersNext,d.hitch(this,this._selectGroupsClick)),e(this._selectUsersClose,a),e(this._selectGroupsBack,d.hitch(this,this._backToSelectUsersClick)),e(this._selectGroupsNext,
d.hitch(this,this._summaryClick)),e(this._selectGroupsClose,a),e(this._summaryBack,d.hitch(this,this._backToSelectGroupsClick)),e(this._summaryAssign,d.hitch(this,this._assignClick)),e(this._summaryClose,a),e(this._resultAssign,d.hitch(this,this._assignMoreClick)),e(this._resultClose,a),this._userSelector.on("selection-change",d.hitch(this,this._selectUsersChange)),this._groupSelector.on("selection-change",d.hitch(this,this._selectGroupsChange)))},_goToSelectUsers:function(){var a=this._get("initialUserSearch");
this._stackContainer.selectChild(this._stackSelectUsers);this._userSelector.focusSearch();a&&(this._userSelector._searchBox.set("value",a),this._userSelector._toggleClearSearchButton(),this._userSelector._searchClick())},_goToSelectGroups:function(){var a=this._get("initialGroupSearch");this._stackContainer.selectChild(this._stackSelectGroups);this._groupSelector.focusSearch();a&&(this._groupSelector._searchBox.set("value",a),this._groupSelector._toggleClearSearchButton(),this._groupSelector._searchClick())},
_goToSummary:function(){this._stackContainer.selectChild(this._stackSummary)},_goToResultSummary:function(){this._assigningMembership(!1);this._stackContainer.selectChild(this._stackResultSummary)},_selectUsersChange:function(a){a&&a.selectedUsers&&(this._set("selectedUsers",a.selectedUsers),this._refreshSelectedUsers())},_selectGroupsChange:function(a){a&&a.selectedGroups&&(this._set("selectedGroups",a.selectedGroups),this._refreshSelectedGroups())},_selectGroupsClick:function(a){a&&a.preventDefault();
var b=this;0===(b._get("selectedUsers")||[]).length?(a='\x3cspan style\x3d"color:red;"\x3e'+b.i18n.mustSelectUsers+"\x3c/span\x3e",f.show(a,b._selectUsersNext.domNode),n.once(b._selectUsersNext.domNode,p.leave,function(){f.hide(b._selectUsersNext.domNode)})):b._goToSelectGroups()},_backToSelectUsersClick:function(a){a&&a.preventDefault();this._goToSelectUsers()},_summaryClick:function(a){a&&a.preventDefault();var b=this;0===(b._get("selectedGroups")||[]).length?(a='\x3cspan style\x3d"color:red;"\x3e'+
b.i18n.mustSelectGroups+"\x3c/span\x3e",f.show(a,b._selectGroupsNext.domNode),n.once(b._selectGroupsNext.domNode,p.leave,function(){f.hide(b._selectGroupsNext.domNode)})):this._goToSummary()},_backToSelectGroupsClick:function(a){a&&a.preventDefault();this._goToSelectGroups()},_assigningMembership:function(a){this._summaryAssign.set("disabled",a);this._summaryAssign.set("label",a?this.i18n.assigning:this.i18n.assign)},_assignClick:function(a){a&&a.preventDefault();var b=this;a=b._get("selectedUsers")||
[];var c=b._get("selectedGroups")||[],d=b._getUsernameList(a).join(",");a=b._getGroupIDList(c);var e=esriGeowConfig.restBaseUrl+"community/groups/${groupId}/addUsers",g=[],f;b._assigningMembership(!0);k.forEach(a,function(a){g.push(y.request({url:x.substitute({groupId:a},e),content:{users:d}},{usePost:!0}))});t(g).then(function(a){f=b._createResultSummary(a,c);h.set(b._resultMessage,"innerHTML",f);b._goToResultSummary()},function(a){console.log("error assigning members to groups",a);f=b._createErrorSummary(a);
h.set(b._resultMessage,"innerHTML",f);b._goToResultSummary()})},_assignMoreClick:function(a){a&&a.preventDefault();this.clear()},_createResultSummary:function(a,b){return this.i18n.assignmentSuccessful},_createErrorSummary:function(a){return this.i18n.assignmentError},_getUsernameList:function(a){var b=[];k.forEach(a,function(a){a&&a.username&&b.push(a.username)});return b},_getGroupIDList:function(a){var b=[];k.forEach(a,function(a){a&&a.id&&b.push(a.id)});return b},_refreshSelectedUsers:function(){h.set(this._selectedUsersPane,
"innerHTML","");var a=this._get("selectedUsers")||[],b,c;if(a)for(b=0;b<a.length;b++)c=a[b],g.create("span",{id:"selected-user-"+b,innerHTML:c.altName||c.fullName,"data-fullName":c.fullName,"data-username":c.username},this._selectedUsersPane),g.create("br",null,this._selectedUsersPane)},_refreshSelectedGroups:function(){h.set(this._selectedGroupsPane,"innerHTML","");var a=this._get("selectedGroups")||[],b,c;if(a)for(b=0;b<a.length;b++)c=a[b],g.create("span",{id:"selected-group-"+b,innerHTML:c.altTitle||
c.title,"data-id":c.id,"data-title":c.title,"data-owner":c.owner},this._selectedGroupsPane),g.create("br",null,this._selectedGroupsPane)},clear:function(){this._userSelector.reset();this._userSelector._initialize();this._groupSelector.reset();this._set("selectedUsers",[]);this._set("selectedGroups",[]);this._refreshSelectedUsers();this._refreshSelectedGroups();this._assigningMembership(!1);h.set(this._resultMessage,"innerHTML","");this._goToSelectUsers()},show:function(){this.clear();this._dialog.show()},
hide:function(){this._dialog.hide();(9>m("ie")||5>m("trident"))&&this._goToSelectUsers()}});l.prototype.statics={_instance:null,getInstance:function(){null==this._instance&&(this._instance=new l);return this._instance}};return l});