// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
define("dojo/_base/array dojo/_base/lang dojo/Deferred dojo/dom dojo/dom-construct dojo/dom-class ../core/Accessor ../core/declare ../core/Evented ../core/HandleRegistry ../core/Promise ../core/watchUtils ./CSSTraits ./DOMContainer ./LayerViewsOwner ./LayerViewFactory ./FlatLayerViewsCollection ./BasemapView ./PopupManager ./ui/DefaultUI ../widgets/Popup".split(" "),function(h,k,e,f,d,g,l,m,n,p,q,r,s,t,u,v,w,x,y,z,A){var B=["logo","attribution","zoom","compass"];return m([l,q,t,n,u,s],{declaredClass:"esri.views.View",
classMetadata:{properties:{ready:{readOnly:!0},factory:{},basemapView:{},ui:{type:z}},computed:{ready:["map.loaded","surface","size"],stationary:["animation","interacting"]}},constructor:function(a){this._viewInitializePromise=new e;this.addResolvingPromise(this._viewInitializePromise.promise);this.factory=new v(this);this.basemapView=new x({view:this});this.layerViewsFlat=new w({view:this});this._handles=new p},getDefaults:function(){return k.mixin(this.inherited(arguments),{padding:{left:0,top:0,
right:0,bottom:0},ui:{components:B}})},initialize:function(){var a=new e;this.addResolvingPromise(a.promise);this._viewInitializePromise.promise.then(function(){var b=this.watch("ready",function(){b.remove();b=null;a.resolve();a=null});this.notifyChange("ready")}.bind(this))},destroy:function(){this.basemapView.destroy();this.factory.destroy();this.ui.destroy();this._handles.destroy();this.container=this.map=null;this.emit("destroy")},_handles:null,activeTool:"navigation",animation:null,basemapView:null,
container:null,_containerSetter:function(a,b){a=f.byId(a);if(b===a)return b;b&&(g.remove(b,"esri-view"),this.popupManager.destroy(),this.popupManager=null,this.popup.destroy(),this.popup=null,d.destroy(this.root),this.root=null);a?(g.add(a,"esri-view"),this.root=d.create("div",{className:"esri-view-root"},a,"first"),this.surface=d.create("div",{className:"esri-view-surface"},this.root),f.setSelectable(this.surface,!1),this.width=a.style.width,this.height=a.style.height,"auto"===this.width&&(a.style.width=
""),"auto"===this.height&&(a.style.height=""),(this.popup=new A({view:this,highlight:!1},d.create("div"))).startup(),this.popupManager=new y({enabled:!0,view:this})):this.surface=null;return a},interacting:!1,_interactingSetter:function(a){this.surface&&this.surface.setAttribute("data-interacting",a);return a},map:null,padding:null,popup:null,_readyGetter:function(){var a=this.size;return this._viewInitializePromise.isResolved()&&!0===this.get("map.loaded")&&null!=this.surface&&0<a[0]&&0<a[1]},stationary:!0,
_stationaryGetter:function(){return!this.animation&&!this.interacting},surface:null,type:null,_uiSetter:function(a,b){if(a===b)return b;this._handles.remove("ui");b&&b.destroy();a&&(a.view=this,this._handles.add([r.init(this,"container",function(){a.container=a?d.create("div",null,this.root):null})],"ui"));return a},updating:!1,getLayerView:function(a){var b=this._getContainers(this),c;h.some(b,function(b){c=b.layerViews.find(function(b){return b.layer===a});return!!c});return c},addHandler:function(a){this.gestureManager&&
this.gestureManager.addHandler(a);return this},removeHandler:function(a){this.gestureManager&&this.gestureManager.removeHandler(a);return this},pageToContent:function(a,b,c){var d=this.padding;c=this.pageToContainer(a,b,c);d&&(c[0]-=d.left,c[1]-=d.top);return c},_getContainers:function(a){var b=[a];a.layerViews.forEach(function(a){a&&a.layerViews&&(b=b.concat(this._getContainers(a)))},this);return b}})});