// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/SingleInteractiveFilter",["dijit","dojo","dojox"],function(d,a,k){a.provide("arcgisonline.sharing.dijit.SingleInteractiveFilter");a.declare("arcgisonline.sharing.dijit.SingleInteractiveFilter",[d._Widget,d._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"singleInteractiveFilter" id\x3d"${id}.singleInteractiveFilter"\x3e\r\n  \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"singleInteractiveFilterDiv"\x3e\r\n            \x3ctable\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd nowrap\x3e\r\n                    \x3cspan class\x3d"promptText" dojoAttachPoint\x3d"promptText"\x3e\x3c/span\x3e\r\n                  \x3c/td\x3e\x3ctd width\x3d"10"\x3e\r\n                    \x26nbsp;\r\n                  \x3c/td\x3e\x3ctd width\x3d"100%"\x3e\r\n                    \x3cspan id\x3d"${id}.attributeValueContainer" class\x3d"attributeValueContainer"\x3e\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr id\x3d"${id}.attributeValueOptions" style\x3d"display:none;"\x3e\r\n                  \x3ctd colspan\x3d"2"\x3e\r\n                    \x26nbsp;\r\n                  \x3c/td\x3e\x3ctd\x3e\r\n                    \x3cdiv class\x3d"attributeValueOptions"\x3e\r\n                      \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                        \x3ctbody\x3e\r\n                          \x3ctr\x3e\r\n                            \x3ctd nowrap\x3d"nowrap"\x3e\r\n                              \x3cinput id\x3d"${id}.radioValue" class\x3d"radioValue attributeValueRadio" checked\x3d"checked" name\x3d"${id}.inputOption" dojotype\x3d"dijit.form.RadioButton" title\x3d"${i18n.valueTooltip}"/\x3e\r\n                              \x3clabel class\x3d"labels" title\x3d"${i18n.valueTooltip}"\x3e${i18n.value}\x3c/label\x3e\r\n                            \x3c/td\x3e\x3ctd width\x3d"10"\x3e\r\n                              \x26nbsp;\r\n                            \x3c/td\x3e \x3ctd id\x3d"${id}.radioUniqueColumn" nowrap\x3d"nowrap" class\x3d"esriLeadingPadding05"\x3e\r\n                              \x3cinput id\x3d"${id}.radioUnique" class\x3d"radioUnique attributeValueRadio" name\x3d"${id}.inputOption" dojotype\x3d"dijit.form.RadioButton" title\x3d"${i18n.uniqueValueTooltip}"/\x3e\r\n                              \x3clabel class\x3d"labels" title\x3d"${i18n.uniqueValueTooltip}"\x3e${i18n.uniqueValues}\x3c/label\x3e\r\n                            \x3c/td\x3e\x3ctd width\x3d"100%"\x3e\r\n                              \x26nbsp;\r\n                            \x3c/td\x3e\r\n                          \x3c/tr\x3e\r\n                        \x3c/tbody\x3e\r\n                      \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"singleInteractiveFilterDiv"\x3e\r\n            \x3cspan dojoAttachPoint\x3d"hintText" class\x3d"hintText"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
valueHandlers:[],postMixInProperties:function(){this.inherited(arguments);this.i18n=a.i18n.getLocalization("arcgisonline","arcgisonline").common;this.i18n=a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline","arcgisonline").FilterDlg)},postCreate:function(){this.inherited(arguments);a.connect(d.byId(this.id+".radioValue"),"onClick",this,"showValueInput");a.connect(d.byId(this.id+".radioUnique"),"onClick",this,"showUniqueList")},constructor:function(a,d){this.id=a.id||"";this.owner=a.owner;this.parameterId=
a.parameterId;this.part=a.part},destroy:function(){this.clearAttributeValueDijits();this.inherited(arguments)},toJson:function(){return{valueObj:this.getValue()}},getAttrValContNode:function(){return a.byId(this.id+".attributeValueContainer")},getValue:function(){return{}},showAttrValOptNode:function(){a.style(a.byId(this.id+".attributeValueOptions"),"display","")},hideAttrValOptNode:function(){a.style(a.byId(this.id+".attributeValueOptions"),"display","none")},createValueString:function(b,f){var c=
this.getAttrValContNode();this.clearAttributeValueDijits();a.empty(c);if(b){var c=new d.form.FilteringSelect({id:this.id+".value","class":"attributeValue",maxHeight:150,sortByLabel:!0},a.create("div",{},c)),e=this.buildCodedValuesStore(b);c.set("store",e);for(e=0;e<b.length;e++)if(f==b[e].code){c.set("value",e);break}for(var g=a.create("span",{innerHTML:"",style:"position:absolute; top: -1000px; left: -1000px"},document.body),h=160,e=0;e<b.length;e++)g.innerHTML=b[e].name,h=Math.max(h,a.coords(g).w);
a.style(a.byId("widget_"+this.id+".value"),"width",h+"px");document.body.removeChild(g);this.hideAttrValOptNode()}else c=new d.form.TextBox({id:this.id+".value","class":"attributeValue",required:!0,placeHolder:"",value:f},a.create("div",{},c)),this.showAttrValOptNode();this.valueHandlers.push(a.connect(c,"onChange",this,"onValueChange"));this.getValue=function(){var a=d.byId(this.id+".value"),c=!0;b?a.item?a=a.item.code[0]:(a="",c=!1):(a=a.get("value"),c=a.length);return{value:a,isValid:c,parameterId:this.parameterId,
shortType:"string"}}},createValueDate:function(b){var f=this.getAttrValContNode();this.clearAttributeValueDijits();a.empty(f);b=new d.form.DateTextBox({id:this.id+".value","class":"attributeValue",trim:!0,required:!0,placeHolder:"",value:b},a.create("div",{},f));this.hideAttrValOptNode();this.valueHandlers.push(a.connect(b,"onChange",this,"onValueChange"));this.getValue=function(){var a=d.byId(this.id+".value").get("value");return{value:a,isValid:esri.isDefined(a),parameterId:this.parameterId,shortType:"date"}}},
createValueNumber:function(b,f){var c=this.getAttrValContNode();this.clearAttributeValueDijits();a.empty(c);if(b){var c=new d.form.FilteringSelect({id:this.id+".value","class":"attributeValue",maxHeight:150,sortByLabel:!0},a.create("div",{},c)),e=this.buildCodedValuesStore(b);c.set("store",e);for(e=0;e<b.length;e++)if(f==b[e].code){c.set("value",e);break}for(var g=a.create("span",{innerHTML:"",style:"position:absolute; top: -1000px; left: -1000px"},document.body),h=160,e=0;e<b.length;e++)g.innerHTML=
b[e].name,h=Math.max(h,a.coords(g).w);a.style(a.byId("widget_"+this.id+".value"),"width",h+"px");document.body.removeChild(g);this.hideAttrValOptNode()}else c=new d.form.NumberTextBox({id:this.id+".value","class":"attributeValue",required:!0,placeHolder:"",value:f,constraints:{pattern:"#####0.##########"}},a.create("div",{},c)),this.showAttrValOptNode();this.valueHandlers.push(a.connect(c,"onChange",this,"onValueChange"));this.getValue=function(){var a=d.byId(this.id+".value"),c=!0;b?a.item?a=a.item.code[0]:
(a="",c=!1):(a=a.get("value"),c=esri.isDefined(a)&&!isNaN(a));return{value:a,isValid:c,parameterId:this.parameterId,shortType:"number"}}},createValueOID:function(b){var f=this.getAttrValContNode();this.clearAttributeValueDijits();a.empty(f);b=new d.form.NumberTextBox({id:this.id+".value","class":"attributeValue",required:!0,placeHolder:"",value:b,constraints:{pattern:"#####0"}},a.create("div",{},f));this.showAttrValOptNode();this.valueHandlers.push(a.connect(b,"onChange",this,"onValueChange"));this.getValue=
function(){var a=d.byId(this.id+".value").get("value"),b=esri.isDefined(a)&&!isNaN(a);return{value:a,isValid:b,parameterId:this.parameterId,shortType:"oid"}}},createValueBetweenDate:function(b,f){var c=this.getAttrValContNode();this.clearAttributeValueDijits();a.empty(c);var e=new d.form.DateTextBox({id:this.id+".value1","class":"attributeValue1",trim:!0,required:!0,placeHolder:"",value:b},a.create("div",{},c));a.create("span",{innerHTML:this.i18n.andBetweenValues,"class":"attributeBetweenValues"},
c);c=new d.form.DateTextBox({id:this.id+".value2","class":"attributeValue2",trim:!0,required:!0,placeHolder:"",value:f},a.create("div",{},c));this.hideAttrValOptNode();this.valueHandlers.push(a.connect(e,"onChange",this,"onValueChange"));this.valueHandlers.push(a.connect(c,"onChange",this,"onValueChange"));this.getValue=function(){var a=d.byId(this.id+".value1").get("value"),b=d.byId(this.id+".value2").get("value");return{value1:a,value2:b,isValid:esri.isDefined(a)&&esri.isDefined(b)&&a.getTime()<=
b.getTime(),parameterId:this.parameterId,shortType:"date"}}},createValueBetweenNumber:function(b,f){var c=this.getAttrValContNode();this.clearAttributeValueDijits();a.empty(c);var e=new d.form.NumberTextBox({id:this.id+".value1","class":"attributeValue1",required:!0,placeHolder:"",value:b,constraints:{pattern:"#####0.##########"}},a.create("div",{},c));a.create("span",{innerHTML:this.i18n.andBetweenValues,"class":"attributeBetweenValues"},c);c=new d.form.NumberTextBox({id:this.id+".value2","class":"attributeValue2",
required:!0,placeHolder:"",value:f,constraints:{pattern:"#####0.##########"}},a.create("div",{},c));this.hideAttrValOptNode();this.valueHandlers.push(a.connect(e,"onChange",this,"onValueChange"));this.valueHandlers.push(a.connect(c,"onChange",this,"onValueChange"));this.getValue=function(){var a=d.byId(this.id+".value1").get("value"),b=d.byId(this.id+".value2").get("value");return{value1:a,value2:b,isValid:esri.isDefined(a)&&esri.isDefined(b)&&!isNaN(a)&&!isNaN(b)&&a<=b,parameterId:this.parameterId,
shortType:"number"}}},createValueBetweenOID:function(b,f){var c=this.getAttrValContNode();this.clearAttributeValueDijits();a.empty(c);var e=new d.form.NumberTextBox({id:this.id+".value1","class":"attributeValue1",required:!0,placeHolder:"",value:b,constraints:{pattern:"#####0"}},a.create("div",{},c));a.create("span",{innerHTML:this.i18n.andBetweenValues,"class":"attributeBetweenValues"},c);c=new d.form.NumberTextBox({id:this.id+".value2","class":"attributeValue2",required:!0,placeHolder:"",value:f,
constraints:{pattern:"#####0"}},a.create("div",{},c));this.hideAttrValOptNode();this.valueHandlers.push(a.connect(e,"onChange",this,"onValueChange"));this.valueHandlers.push(a.connect(c,"onChange",this,"onValueChange"));this.getValue=function(){var a=d.byId(this.id+".value1").get("value"),b=d.byId(this.id+".value2").get("value");return{value1:a,value2:b,isValid:esri.isDefined(a)&&esri.isDefined(b)&&!isNaN(a)&&!isNaN(b)&&a<=b,parameterId:this.parameterId,shortType:"oid"}}},createValueUnique:function(b){var f=
this.getAttrValContNode();this.clearAttributeValueDijits();a.empty(f);var c=new d.form.FilteringSelect({id:this.id+".valueUnique","class":"attributeValue",maxHeight:150,store:b},a.create("div",{},f));c.set("value",0);a.forEach(b._arrayOfAllItems,function(a){a.name.toString()==this.part.interactiveObj.value&&c.set("value",a.id.toString())},this);this.valueHandlers.push(a.connect(c,"onChange",this,"onValueChange"));this.getValue=function(){var a=d.byId(this.id+".valueUnique");return{value:a.store.getValue(a.item,
"value"),isValid:!0,parameterId:this.parameterId,shortType:this.part.fieldObj.shortType}}},setValue:function(a){d.byId(this.id+".value")&&d.byId(this.id+".value").set("value","date"==this.part.fieldObj.shortType?new Date(a):a)},setValue1:function(a){d.byId(this.id+".value1")&&d.byId(this.id+".value1").set("value","date"==this.part.fieldObj.shortType?new Date(a):a)},setValue2:function(a){d.byId(this.id+".value2")&&d.byId(this.id+".value2").set("value","date"==this.part.fieldObj.shortType?new Date(a):
a)},setPrompt:function(a){this.promptText.innerHTML=a},setHint:function(a){this.hintText.innerHTML=a},buildCodedValuesStore:function(b){b=a.map(b,function(a,b){return{name:a.name,code:a.code,id:b}});return new a.data.ItemFileWriteStore({data:{label:"name",identifier:"id",items:b}})},enableInteractiveCheck:function(){},onValueChange:function(b){d.byId(this.id+".value")?this.part.interactiveObj.value=d.byId(this.id+".value").get("value"):a.byId(this.id+".value")&&(this.part.interactiveObj.value=a.byId(this.id+
".value").value);d.byId(this.id+".value1")?this.part.interactiveObj.value1=d.byId(this.id+".value1").get("value"):a.byId(this.id+".value1")&&(this.part.interactiveObj.value1=a.byId(this.id+".value1").value);d.byId(this.id+".value2")?this.part.interactiveObj.value2=d.byId(this.id+".value2").get("value"):a.byId(this.id+".value2")&&(this.part.interactiveObj.value2=a.byId(this.id+".value2").value);a.publish("onInteractiveExprChange",this)},showValueInput:function(a){this.owner.showValueInput(d.byNode(a.target),
this,null)},showUniqueList:function(a){this.owner.showUniqueList(d.byNode(a.target),this,null)},onChangeOperator:function(a,d,c){this.owner.onChangeOperator(a,d,c)},clearAttributeValueDijits:function(){d.byId(this.id+".value")?d.byId(this.id+".value").destroy():a.byId(this.id+".value")&&this.getAttrValContNode().removeChild(a.byId(this.id+".value"));a.byId(this.id+".value1")?d.byId(this.id+".value1").destroy():a.byId(this.id+".value1")&&this.getAttrValContNode().removeChild(a.byId(this.id+".value1"));
a.byId(this.id+".value2")?d.byId(this.id+".value2").destroy():a.byId(this.id+".value2")&&this.getAttrValContNode().removeChild(a.byId(this.id+".value2"));d.byId(this.id+".valueUnique")?d.byId(this.id+".valueUnique").destroy():a.byId(this.id+".valueUnique")&&this.getAttrValContNode().removeChild(a.byId(this.id+".value"));a.forEach(this.valueHandlers,a.hitch(this,function(b){a.disconnect(b)}));this.valueHandlers=[]}})});