// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/dialog/SymbolDlg",["dijit","dojo","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/SymbolOptions"],function(c,a,g){a.provide("arcgisonline.sharing.dijit.dialog.SymbolDlg");a.require("dijit.Dialog");a.require("dijit._Widget");a.require("dijit._Templated");a.require("arcgisonline.sharing.dijit.SymbolOptions");a.declare("arcgisonline.sharing.dijit.dialog.SymbolDlg",[c._Widget,c._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"symbol-dialog" title\x3d"${i18n.symbolDlgTitle}" execute\x3d""\x3e\r\n\t  \x3cdiv id\x3d"symbol-dialog-symboloptions" dojotype\x3d"arcgisonline.sharing.dijit.SymbolOptions" dojoAttachPoint\x3d"symbolOptions"\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cbutton dojoAttachPoint\x3d"cancelButton" dojoAttachEvent\x3d"onClick:onCancelClick" class\x3d"jevent cancel esriFloatTrailing" dojoType\x3d"dijit.form.Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n      \x3cbutton id\x3d"symbol-dialog-apply" dojoAttachPoint\x3d"applyButton" dojoAttachEvent\x3d"onClick:onApplyClick" class\x3d"jevent cancel esriFloatTrailing" dojoType\x3d"dijit.form.Button"\x3e${i18n.apply}\x3c/button\x3e\r\n  \t  \x3cbutton id\x3d"symbol-dialog-done" dojoAttachEvent\x3d"onClick:onDoneClick" class\x3d"jevent primary esriFloatTrailing" dojoType\x3d"dijit.form.Button"\x3e${i18n.done}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both;"\x3e\r\n    \x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
i18n:null,applyHandler:null,okHandler:null,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.SymbolDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=a.clone(a.i18n.getLocalization("arcgisonline","arcgisonline").common);a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline","arcgisonline").symbolDlg)},show:function(a,b){this.cancelButton.set("disabled",!1);var e=a.getLayer();if(a.symbol)this.symbolOptions.symbol=
esri.symbol.fromJson(a.symbol.toJson());else{var d=e.renderer.getSymbol(a);this.symbolOptions.symbol=esri.symbol.fromJson(d.toJson())}for(d=0;d<e.types.length;d++)if(e.types[d].id==a.attributes.TYPEID&&e.types[d].templates&&0<e.types[d].templates.length){this.symbolOptions.template=e.types[d].templates[0];break}b?(this.symbolOptions.endSize=b.endSize,this.symbolOptions.showEndSize=0<b.endSize?!0:!1,this.symbolOptions.showNoBgColor=b.showNoBgColor,this.applyHandler=b.applyHandler,this.okHandler=b.okHandler):
(this.symbolOptions.endSize=0,this.symbolOptions.showEndSize=!1,this.symbolOptions.showNoBgColor=!1,this.okHandler=this.applyHandler=null);this.symbolOptions.init(b?b.noPreDefSymbols:null);c.byId("symbol-dialog").show()},showSymbol:function(f,b){this.cancelButton.set("disabled",!1);this.symbolOptions.symbol=esri.symbol.fromJson(f.toJson());this.symbolOptions.symbol.color||(this.symbolOptions.symbol.color=new a.Color([255,255,255,0]));b?(this.symbolOptions.endSize=b.endSize,this.symbolOptions.showEndSize=
0<b.endSize?!0:!1,this.symbolOptions.showNoBgColor=b.showNoBgColor,this.applyHandler=b.applyHandler,this.okHandler=b.okHandler):(this.symbolOptions.endSize=0,this.symbolOptions.showEndSize=!1,this.symbolOptions.showNoBgColor=!1,this.okHandler=this.applyHandler=null);this.symbolOptions.init(b?b.noPreDefSymbols:null);c.byId("symbol-dialog").show()},hide:function(){this.symbolOptions.hide();c.byId("symbol-dialog").hide()},onDoneClick:function(c){"picturemarkersymbol"===this.symbolOptions.symbol.type&&
8>this.symbolOptions.symbol.url.length||setTimeout(a.hitch(this,function(){var b=0;this.symbolOptions.urlChangesNotApplied&&(b=6E3);setTimeout(a.hitch(this,function(){if(this.okHandler){var b=this.symbolOptions.symbol.toJson();if("esriPMS"==this.symbolOptions.symbol.type&&(0==b.url.length||"http://"==b.url))this.symbolOptions.symbol=this.getMarkerJson();this.okHandler(esri.symbol.fromJson(this.symbolOptions.symbol.toJson()))}else this.symbolOptions.showEndSize?a.publish("onSymbolChange",[esri.symbol.fromJson(this.symbolOptions.symbol.toJson()),
this.symbolOptions.endSize]):a.publish("onSymbolChange",[esri.symbol.fromJson(this.symbolOptions.symbol.toJson())]),setTimeout(a.hitch(this,function(){a.publish("applyRendererEdits",[])}),500);this.hide()}),b)}),100)},onApplyClick:function(c){"picturemarkersymbol"===this.symbolOptions.symbol.type&&8>this.symbolOptions.symbol.url.length||setTimeout(a.hitch(this,function(){var b=0;this.symbolOptions.urlChangesNotApplied&&(b=6E3);setTimeout(a.hitch(this,function(){if(this.applyHandler){var b=this.symbolOptions.symbol.toJson();
if(("esriPMS"==this.symbolOptions.symbol.type||"picturemarkersymbol"==this.symbolOptions.symbol.type)&&(0==b.url.length||"http://"==b.url))this.symbolOptions.symbol=this.getMarkerJson();this.applyHandler(esri.symbol.fromJson(this.symbolOptions.symbol.toJson()));this.cancelButton.set("disabled",!0)}else this.symbolOptions.showEndSize?a.publish("onSymbolChange",[esri.symbol.fromJson(this.symbolOptions.symbol.toJson()),this.symbolOptions.endSize]):a.publish("onSymbolChange",[esri.symbol.fromJson(this.symbolOptions.symbol.toJson())]),
setTimeout(a.hitch(this,function(){a.publish("applyRendererEdits",[]);this.cancelButton.set("disabled",!0)}),500)}),b)}),100)},onCancelClick:function(c){a.publish("onSymbolChangeCancel",[]);this.hide()}})});