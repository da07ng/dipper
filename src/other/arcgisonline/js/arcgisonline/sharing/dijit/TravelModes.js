// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
require({cache:{"url:arcgisonline/sharing/dijit/templates/TravelModes.html":'\x3cdiv class\x3d"${baseClass} widgetContent travelModesWidgetHiddenByDefault"\x3e\r\n    \x3cdiv\x3e\r\n        \x3ctable style\x3d"width:100%"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"_header" id\x3d"travel-mode-header"\x3e${i18n.headerAdd}\x3c/span\x3e\r\n            \x3ca id\x3d"travel-modes-helpLink" target\x3d"_blank"\x3e\x3cspan id\x3d"travel-modes-helpLink"\x3e\x26nbsp;\x3c/span\x3e\x3c/a\x3e\r\n        \x3c/td\x3e\x3ctd style\x3d"text-align: right;"\x3e\r\n            \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_saveTravelMode" class\x3d"calcite blue small"\x3e${i18n.saveTravelMode}\x3c/button\x3e\r\n            \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_discardChanges" class\x3d"calcite transparent small"\x3e${i18n.discardChanges}\x3c/button\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr/\x3e\x3cbr/\x3e\r\n    \x3cdiv\x3e\r\n        \x3clabel for\x3d"travel-mode-name"\x3e${i18n.nameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"travel-mode-name" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n             data-dojo-props\x3d"maxLength:50, placeHolder:\'${i18n.namePlaceholder}\', required:true"\r\n             data-dojo-attach-event\x3d"onChange:_nameChange"\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr/\x3e\x3cbr/\x3e\r\n        \x3clabel for\x3d"travel-mode-description"\x3e${i18n.descriptionLabel}\x3c/label\x3e\r\n        \x3cbr/\x3e\r\n        \x3ctextarea id\x3d"travel-mode-description" data-dojo-type\x3d"dijit/form/Textarea"\r\n            data-dojo-props\x3d"placeholder:\'${i18n.descriptionPlaceholder}\', maxLength:1024"\r\n            data-dojo-attach-event\x3d"onKeyUp:_descChange"\x3e\x3c/textarea\x3e\r\n        \x3cdiv class\x3d"example"\x3e\x3cspan data-dojo-attach-point\x3d"_descRevLength"\x3e\x3c/span\x3e${i18n.descriptionCharCount}\x3c/div\x3e\r\n        \x3cbr/\x3e\r\n        \x3clabel for\x3d"travel-mode-type"\x3e${i18n.type}\x3c/label\x3e\r\n        \x3cdiv id\x3d"travel-mode-type"\r\n             data-dojo-type\x3d"arcgisonline/sharing/dijit/ComboBox"\r\n             data-dojo-attach-event\x3d"onChange:_typeChange"\r\n             class\x3d"gallerySelect" style\x3d"display:inline-block;"\x3e\x3c/div\x3e\r\n        \x3cdiv id\x3d"travel-mode-type-icon" class\x3d"tmTypeIcon tmTypeOther"\x3e\x3c/div\x3e\r\n        \x3cbr/\x3e\x3cbr/\x3e\r\n        \x3clabel for\x3d"travel-mode-impedance"\x3e${i18n.impedance}\x3c/label\x3e\r\n        \x3cdiv id\x3d"travel-mode-impedance"\r\n             data-dojo-type\x3d"arcgisonline/sharing/dijit/ComboBox"\r\n             class\x3d"gallerySelect" style\x3d"display:inline-block;"\r\n             data-dojo-attach-event\x3d"onChange:_impedanceChange"\x3e\x3c/div\x3e\r\n        \x3cbr/\x3e\x3cbr/\x3e\r\n        \x3clabel for\x3d"travel-mode-timeImpedance"\x3e${i18n.timeImpedance}\x3c/label\x3e\r\n        \x3cdiv id\x3d"travel-mode-timeImpedance"\r\n             data-dojo-type\x3d"arcgisonline/sharing/dijit/ComboBox"\r\n            class\x3d"gallerySelect" style\x3d"display:inline-block;"\r\n            data-dojo-attach-event\x3d"onChange:_timeDistanceAttrChange"\x3e\x3c/div\x3e\r\n        \x3cbr/\x3e\x3cbr/\x3e\r\n        \x3clabel for\x3d"travel-mode-distanceImpedance"\x3e${i18n.distanceImpedance}\x3c/label\x3e\r\n        \x3cdiv id\x3d"travel-mode-distanceImpedance"\r\n             data-dojo-type\x3d"arcgisonline/sharing/dijit/ComboBox"\r\n            class\x3d"gallerySelect" style\x3d"display:inline-block;"\r\n            data-dojo-attach-event\x3d"onChange:_timeDistanceAttrChange"\x3e\x3c/div\x3e\r\n        \x3cbr/\x3e\x3cbr/\x3e\r\n        \x3clabel for\x3d"travel-mode-uturn"\x3e${i18n.uTurnPolicy}\x3c/label\x3e\r\n        \x3cdiv id\x3d"travel-mode-uturn"\r\n             data-dojo-type\x3d"arcgisonline/sharing/dijit/ComboBox"\r\n             data-dojo-attach-event\x3d"onChange:_uTurnChange"\r\n            class\x3d"gallerySelect" style\x3d"display:inline-block;"\x3e\x3c/div\x3e\r\n        \x3cbr/\x3e\x3cbr/\x3e\r\n        \x3clabel for\x3d"travel-mode-simplification"\x3e${i18n.simplification}\x3c/label\x3e\r\n        \x3cdiv id\x3d"travel-mode-simplification" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n             data-dojo-attach-event\x3d"onChange:_simplificationChange"\r\n             data-dojo-props\x3d"required:true, maxLength:10, placeHolder:\'${i18n.simplificationPlaceholder}\'"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"travel-mode-simplification-units"\r\n             data-dojo-type\x3d"arcgisonline/sharing/dijit/ComboBox"\r\n             data-dojo-attach-event\x3d"onChange:_simplificationChange"\r\n             class\x3d"gallerySelect" style\x3d"display:inline-block;"\x3e\x3c/div\x3e\r\n        \x3cbr/\x3e\x3cbr/\x3e\r\n        \x3cdiv id\x3d"travel-mode-hierarchy" data-dojo-type\x3d"dijit/form/CheckBox"\r\n             data-dojo-attach-event\x3d"onChange:_hierarchyChange"\r\n             class\x3d"vertAlignTextTop"\x3e\x3c/div\x3e\r\n        \x3clabel for\x3d"travel-mode-hierarchy"\x3e${i18n.useHierarchy}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr/\x3e\x3cbr/\x3e\r\n    \x3clabel\x3e${i18n.attributesAndParameters}\x3c/label\x3e\r\n    \x3cbr/\x3e\x3cbr/\x3e\r\n    \x3cdiv id\x3d"travel-mode-attributes-container"\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\r\n        \x3ctable style\x3d"width:100%" id\x3d"footer"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"text-align: right;"\x3e\r\n            \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_saveTravelMode" class\x3d"calcite blue small"\x3e${i18n.saveTravelMode}\x3c/button\x3e\r\n            \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_discardChanges" class\x3d"calcite transparent small"\x3e${i18n.discardChanges}\x3c/button\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("arcgisonline/sharing/dijit/TravelModes","require dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/dom dojo/dom-class dojo/dom-construct dojo/i18n dojo/on dojo/number dojo/store/Memory arcgisonline/sharing/util arcgisonline/sharing/dijit/dialog/GeneralDlg arcgisonline/sharing/dijit/dialog/ChoiceDlg arcgisonline/sharing/dijit/Grid arcgisonline/sharing/geow/TravelModes arcgisonline/sharing/geow/Account dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry dijit/form/ValidationTextBox dijit/form/CheckBox dijit/form/Select dojo/text!arcgisonline/sharing/dijit/templates/TravelModes.html".split(" "),
function(t,p,m,u,v,n,w,I,J,h,l,x,y,z,A,B,q,r,C,D,E,K,F,G,s,H){return u([C,D,E],{declaredClass:"arcgisonline.sharing.dijit.TravelModes",basePath:t.toUrl("arcgisonline/sharing/dijit"),templateString:H,baseClass:"esriAGOTravelModes",_travelMode:null,_rowsPerPage:50,_modified:!1,_deferred:null,_namesToAvoid:[],_defaultId:null,_drivingCarId:"FEgifRtFndKNcJMJ",_helpTopicId:"120001031",postMixInProperties:function(){this.inherited(arguments);this.i18n={};m.mixin(this.i18n,dojo.i18n.getLocalization("arcgisonline",
"arcgisonline").common);m.mixin(this.i18n,dojo.i18n.getLocalization("arcgisonline","arcgisonline").travelModes)},postCreate:function(){this.inherited(arguments);this._errorDlg=y.prototype.statics.getInstance();this._confirmDlg=z.prototype.statics.getInstance();this._api=new B},startup:function(){this.inherited(arguments);this._initUI();return this._api.getTravelModes()},refresh:function(){this._grid&&this._grid._started&&(this._grid._grid.resize(),this._grid._grid.refresh())},reset:function(){this._travelMode=
null;this._namesToAvoid=[];this._deferred&&!this._deferred.isFulfilled()&&this._deferred.resolve(this._api._travelModes);this._deferred=new r;var c=this._agolNAServiceDescription=m.clone(this._origAgolNAServiceDescription),b=dijit.byId("travel-mode-name");b.setValue("");b.focus();dijit.byId("travel-mode-description").setValue("");this._descChange();var b=new l({data:[{id:"AUTOMOBILE",name:this.i18n.tmType.auto},{id:"TRUCK",name:this.i18n.tmType.truck},{id:"WALK",name:this.i18n.tmType.walk},{id:"OTHER",
name:this.i18n.tmType.other}]}),a=dijit.byId("travel-mode-type");a.store=b;a.set("item",a.store.query({id:"AUTOMOBILE"})[0]);for(var a=new l({data:[]}),f=new l({data:[]}),d=new l({data:[]}),b=0;b<c.networkDataset.networkAttributes.length;b++){var e=c.networkDataset.networkAttributes[b];"esriNAUTCost"===e.usageType&&"TimeAt1KPH"!==e.name&&(a.put(dojo.mixin({id:e.name},e)),"esriNAUCentimeters"===e.units||"esriNAUDecimalDegrees"===e.units||"esriNAUDecimeters"===e.units||"esriNAUFeet"===e.units||"esriNAUInches"===
e.units||"esriNAUKilometers"===e.units||"esriNAUMeters"===e.units||"esriNAUMiles"===e.units||"esriNAUMillimeters"===e.units||"esriNAUNauticalMiles"===e.units||"esriNAUYards"===e.units?d.put(dojo.mixin({id:e.name},e)):("esriNAUDays"===e.units||"esriNAUHours"===e.units||"esriNAUMinutes"===e.units||"esriNAUSeconds"===e.units)&&f.put(dojo.mixin({id:e.name},e)))}b=dijit.byId("travel-mode-timeImpedance");b.store=f;b.set("item",null);f=dijit.byId("travel-mode-distanceImpedance");f.store=d;f.set("item",null);
b=dijit.byId("travel-mode-impedance");b.store=a;b.set("item",b.store.query({id:c.impedance})[0]);this._impedanceChange();if(!f.getValue()){d=q.getSelf().units;a=f.store.query({});for(b=0;b<a.length;b++)if("metric"===d&&("esriNAUKilometers"===a[b].units||"esriNAUMeters"===a[b].units||"esriNAUCentimeters"===a[b].units||"esriNAUDecimeters"===a[b].units||"esriNAUMillimeters"===a[b].units)||"english"===d&&("esriNAUMiles"===a[b].units||"esriNAUInches"===a[b].units||"esriNAUFeet"===a[b].units||"esriNAUYards"===
a[b].units||"esriNAUNauticalMiles"===a[b].units)){f.set("item",a[b]);break}}b=dijit.byId("travel-mode-uturn");b.store=new l({data:[{id:"esriNFSBAllowBacktrack",name:this.i18n.uTurn.esriNFSBAllowBacktrack},{id:"esriNFSBAtDeadEndsAndIntersections",name:this.i18n.uTurn.esriNFSBAtDeadEndsAndIntersections},{id:"esriNFSBAtDeadEndsOnly",name:this.i18n.uTurn.esriNFSBAtDeadEndsOnly},{id:"esriNFSBNoBacktrack",name:this.i18n.uTurn.esriNFSBNoBacktrack}]});b.set("item",b.store.query({id:"esriNFSBAtDeadEndsAndIntersections"})[0]);
dijit.byId("travel-mode-simplification").set("value","10");b=dijit.byId("travel-mode-simplification-units");b.store=new l({data:[{id:"esriCentimeters",name:this.i18n.geomSimplificationUnits.esriCentimeters},{id:"esriDecimalDegrees",name:this.i18n.geomSimplificationUnits.esriDecimalDegrees},{id:"esriDecimeters",name:this.i18n.geomSimplificationUnits.esriDecimeters},{id:"esriFeet",name:this.i18n.geomSimplificationUnits.esriFeet},{id:"esriInches",name:this.i18n.geomSimplificationUnits.esriInches},{id:"esriKilometers",
name:this.i18n.geomSimplificationUnits.esriKilometers},{id:"esriMeters",name:this.i18n.geomSimplificationUnits.esriMeters},{id:"esriMiles",name:this.i18n.geomSimplificationUnits.esriMiles},{id:"esriMillimeters",name:this.i18n.geomSimplificationUnits.esriMillimeters},{id:"esriNauticalMiles",name:this.i18n.geomSimplificationUnits.esriNauticalMiles},{id:"esriPoints",name:this.i18n.geomSimplificationUnits.esriPoints},{id:"esriYards",name:this.i18n.geomSimplificationUnits.esriYards}]});b.set("item",b.store.query({id:"esriMeters"})[0]);
dijit.byId("travel-mode-hierarchy").set("checked",!0);this._grid&&this._grid.destroy();this._grid=new A({id:"apGrid",region:"center",columns:this._createGridColumns(),noDataMessage:"",showLoadingMessage:!0,showHeader:!0,rowsPerPage:this._rowsPerPage,pagingLinks:!0,selectionMode:"none",store:new dojo.store.Memory({identifier:"id",label:"name",data:[]}),queryOptions:{sort:[{attribute:"apply",descending:!0},{attribute:"name"}]}},w.create("div",null,v.byId("travel-mode-attributes-container")));this._grid.startup();
for(b=0;b<c.networkDataset.networkAttributes.length;b++)if(a=c.networkDataset.networkAttributes[b],"esriNAUTRestriction"===a.usageType){d=c.attributeParameterValues;f=[];for(e=0;e<d.length;e++)a.name===d[e].attributeName&&(d[e].restrictionUsage=a.restrictionUsageParameterName===d[e].parameterName,f.push(d[e]));this._grid.store.put({id:a.name,name:a.name,apply:-1<p.indexOf(c.restrictions,a.name),params:f})}this._grid.refresh();setTimeout(m.hitch(this,function(){this._modified=!1}),500)},hide:function(){this.domNode.style.display=
"none"},show:function(c,b){this.domNode.style.display="inline";this._loadTravelMode(c);b&&(this._namesToAvoid=b);this._header.innerHTML=c&&c.id?this.i18n.headerModify:this.i18n.headerAdd;return this._deferred.promise},deleteTravelMode:function(c){this.reset();return this._api.deleteTravelMode(c.id)},resetTravelModes:function(){this.reset();return this._api.reset()},getDefaultTravelModeId:function(){var c=new r;this._defaultId?c.resolve(this._defaultId):this._api.getTravelModes().then(m.hitch(this,
function(b){var a=q.getSelf().helperServices.closestFacility.defaultTravelMode;a||(b[this._drivingCarId]?c.resolve(this._drivingCarId):c.resolve(Object.keys(b)[0]));this._defaultId=a;c.resolve(a)}),function(){c.resolve(null)});return c.promise},_initUI:function(){var c=this;q.getSelf(function(a){x.request({url:a.helperServices.closestFacility.url,content:{f:"json"}}).then(function(a){c._origAgolNAServiceDescription=a;c.reset()},function(a){console.error(a);c._origAgolNAServiceDescription={networkDataset:{networkAttributes:[]},
attributeParameterValues:[],restrictions:[]}})});if(esriGeowConfig){var b=esriGeowConfig.self.helpMap.m[this._helpTopicId],b=esriGeowConfig.self.helpBase+(esri.isDefined(b)?b:"");dojo.attr(dojo.byId("travel-modes-helpLink"),"href",b)}b=dijit.byId("travel-mode-simplification");b.set("constraints",{type:"number"});b.set("validator",this._paramValidator)},_createGridColumns:function(){var c=this;return{name:{label:this.i18n.attrNameCol,sortable:!0,formatter:dojo.hitch(this,function(b){return'\x3cspan class\x3d"esriContentTypeName attributeName"\x3e'+
b+"\x3c/span\x3e"})},apply:{label:this.i18n.applyCol,sortable:!0,renderCell:dojo.hitch(this,function(b,a,f){f=dojo.create("div");a=new G({checked:a,onChange:function(a){c._modified=!0;b.apply=a;for(var e in b._uiItems)b._uiItems.hasOwnProperty(e)&&b._uiItems[e].set("disabled",!a)}},f);a.startup();return a.domNode})},params:{label:this.i18n.paramsCol,sortable:!1,renderCell:dojo.hitch(this,function(b,a,f){f=dojo.create("table",{style:"width:100%"});b._uiItems={};for(var d=0;d<a.length;d++){var e=dojo.create("tr",
null,f);dojo.create("td",{innerHTML:a[d].parameterName+(")"===a[d].parameterName[a[d].parameterName.length-1]?"\x26#x200E;":"")+":",className:"parameterName"},e);e=dojo.create("td",null,e);a[d].isValid=!0;a[d].type=a[d].parameterType;if(!a[d].type)if(a[d].type=typeof a[d].value,"string"===a[d].type&&a[d].value){var g=h.parse(a[d].value,{locale:"root"});isNaN(g)?(g=h.parse(a[d].value,{locale:"en"}),isNaN(g)?"true"===a[d].value.toLowerCase()?(a[d].type="boolean",a[d].value=!0):"false"===a[d].value.toLowerCase()&&
(a[d].type="boolean",a[d].value=!1):(a[d].type="number",a[d].value=g)):(a[d].type="number",a[d].value=g)}else if("object"===a[d].type||"function"===a[d].type||"undefined"===a[d].type||"number"===a[d].type&&isNaN(a[d].value))a[d].type="string",a[d].value="";a[d].restrictionUsage?(g=String(a[d].value).toUpperCase(),e=new s({options:[{label:this.i18n.softRestrictions.prohibited,value:"PROHIBITED",selected:"PROHIBITED"===g},{label:this.i18n.softRestrictions.avoidHigh,value:"AVOID_HIGH",selected:"AVOID_HIGH"===
g},{label:this.i18n.softRestrictions.avoidMedium,value:"AVOID_MEDIUM",selected:"AVOID_MEDIUM"===g},{label:this.i18n.softRestrictions.avoidLow,value:"AVOID_LOW",selected:"AVOID_LOW"===g},{label:this.i18n.softRestrictions.preferLow,value:"PREFER_LOW",selected:"PREFER_LOW"===g},{label:this.i18n.softRestrictions.preferMedium,value:"PREFER_MEDIUM",selected:"PREFER_MEDIUM"===g},{label:this.i18n.softRestrictions.preferHigh,value:"PREFER_HIGH",selected:"PREFER_HIGH"===g}],data:a[d],onChange:function(a){c._modified=
!0;this.data.value=a},disabled:!b.apply,className:"dijitButtonText apvSoftRestrictionSelect"},dojo.create("div",null,e)),e.startup()):"boolean"===a[d].type?(e=new s({options:[{label:this.i18n.trueValue,value:"true",selected:a[d].value},{label:this.i18n.falseValue,value:"false",selected:!a[d].value}],data:a[d],onChange:function(a){c._modified=!0;this.data.value="true"===a},disabled:!b.apply,className:"dijitButtonText apvSoftRestrictionSelect"},dojo.create("div",null,e)),e.startup()):e=new F({value:"number"===
a[d].type||"integer"===a[d].type||"float"===a[d].type||"date"===a[d].type?h.format(a[d].value,{locale:"root"}):a[d].value,data:a[d],constraints:{type:a[d].type},validator:this._paramValidator,onChange:function(a){c._modified=!0;this.data.value="number"===this.data.type||"integer"===this.data.type||"float"===this.data.type||"date"===this.data.type?h.parse(a,{locale:"root"}):a;this.data.isValid=this.isValid()},disabled:!b.apply,"class":"dijitButtonText apvParameterValue"},dojo.create("div",null,e));
b._uiItems[a[d].parameterName]=e}return f})}}},_paramValidator:function(c,b){var a=!0;if("number"===b.type||"float"===b.type)a=""!==c&&void 0!==c&&null!==h.format(h.parse(c,{locale:"root"}),{locale:"root"});else if("integer"===b.type||"date"===b.type)""!==c&&void 0!==c?(a=h.parse(c,{locale:"root"}),a=a===Math.floor(a)):a=!1;return a},_loadTravelMode:function(c){this.reset();if(c){this._travelMode=c;dijit.byId("travel-mode-name").set("value",c.name);dijit.byId("travel-mode-description").set("value",
c.description);this._descChange();var b=dijit.byId("travel-mode-type"),a=b.store.query({id:c.type});a.length&&b.set("item",a[0]);b=dijit.byId("travel-mode-impedance");a=b.store.query({id:c.impedanceAttributeName});a.length&&(b.set("item",a[0]),b=dijit.byId("travel-mode-timeImpedance"),a=b.store.query({id:c.timeAttributeName}),a.length&&b.set("item",a[0]),b=dijit.byId("travel-mode-distanceImpedance"),a=b.store.query({id:c.distanceAttributeName}),a.length&&b.set("item",a[0]));this._timeDistanceAttrChange();
b=dijit.byId("travel-mode-uturn");b.set("item",b.store.query({id:c.uturnAtJunctions})[0]);dijit.byId("travel-mode-simplification").set("value",h.format(h.parse(c.simplificationTolerance?c.simplificationTolerance:0,{locale:"en"}),{locale:"root"}));b=dijit.byId("travel-mode-simplification-units");b.set("item",b.store.query({id:c.simplificationToleranceUnits})[0]);dijit.byId("travel-mode-hierarchy").set("value",c.useHierarchy);a=[c.impedanceAttributeName,c.timeAttributeName,c.distanceAttributeName].concat(c.restrictionAttributeNames);
for(b=0;b<this._grid.store.data.length;b++)this._grid.store.data[b].apply=!1;for(b=0;b<a.length;b++)if(a[b]){var f=this._grid.store.query({id:a[b]});if(f.length){f=f[0];f.apply=!0;for(var d=0;d<c.attributeParameterValues.length;d++)if(c.attributeParameterValues[d].attributeName===a[b])for(var e=0;e<f.params.length;e++)if(c.attributeParameterValues[d].parameterName===f.params[e].parameterName){f.params[e].value=c.attributeParameterValues[d].value;break}}}this._grid._grid.refresh()}},_saveTravelMode:function(){this._travelMode||
(this._travelMode={});var c=this._travelMode,b,a=null,f=null,d=this.i18n.valueRequiredTitle,e=this.i18n.valueRequiredTitle;c.attributeParameterValues=[];c.restrictionAttributeNames=[];for(b=0;b<this._grid.store.data.length;b++){var g=this._grid.store.data[b];if(g.apply){for(var k=0;k<g.params.length;k++)if(g.params[k].isValid)c.attributeParameterValues.push({attributeName:g.params[k].attributeName,parameterName:g.params[k].parameterName,value:g.params[k].value});else{a=g._uiItems[g.params[k].parameterName];
d=this.i18n.valueRequiredAPV+' "'+g.params[k].parameterName+'"';break}(!g.params.length||!g.params[0].costAttribute)&&-1===p.indexOf(c.restrictionAttributeNames,g.name)&&c.restrictionAttributeNames.push(g.name);if(a)break}}c.useHierarchy=dijit.byId("travel-mode-hierarchy").get("checked");b=dijit.byId("travel-mode-simplification");b.isValid()||(a=b,d=this.i18n.valueRequiredSimplification);c.simplificationTolerance=h.parse(b.get("value"),{locale:"root"});c.simplificationToleranceUnits=dijit.byId("travel-mode-simplification-units").get("item").id;
c.uturnAtJunctions=dijit.byId("travel-mode-uturn").get("item").id;c.distanceAttributeName=dijit.byId("travel-mode-distanceImpedance").get("value");c.distanceAttributeName||(a=dijit.byId("travel-mode-distanceImpedance"),d=this.i18n.valueRequiredDistanceAttribute);c.timeAttributeName=dijit.byId("travel-mode-timeImpedance").get("value");c.timeAttributeName||(a=dijit.byId("travel-mode-timeImpedance"),d=this.i18n.valueRequiredTimeAttribute);c.impedanceAttributeName=dijit.byId("travel-mode-impedance").get("value");
c.impedanceAttributeName||(a=dijit.byId("travel-mode-impedance"),d=this.i18n.valueRequiredImpedance);c.type=dijit.byId("travel-mode-type").get("item").id;c.description=dijit.byId("travel-mode-description").get("value");g=dijit.byId("travel-mode-name");g.setValue(g.getValue().trim());g.isValid()||(a=g,d=this.i18n.valueRequiredName);c.name=g.getValue();for(b=0;b<this._namesToAvoid.length;b++)if(this._namesToAvoid[b].toUpperCase()===c.name.toUpperCase()){a=g;d=this.i18n.nameAlreadyExists;e=this.i18n.error;
break}if(a)this._travelMode=null,a.focus(),this._errorDlg.show({title:e,message:d});else{if(!c.id){c.id="";for(b=0;16>b;b++){for(a=0;!a||91<=a&&96>=a;)a=Math.round(57*Math.random())+65;c.id+=String.fromCharCode(a)}}this._modified=!1;this.hide();this._api.uploadTravelMode(c.id,c).always(this._deferred.resolve);f=this._travelMode}return f},_discardChanges:function(){var c=this,b=function(){c.reset();c.hide()};this._modified?this._confirmDlg.show({title:this.i18n.travelMode,message:this.i18n.discardQuestion,
choiceOneTitle:this.i18n.discardAnswer,choiceOneHandler:b}):b()},_nameChange:function(){this._modified=!0},_descChange:function(){this._modified=!0;var c=dijit.byId("travel-mode-description");this._descRevLength.innerHTML=Math.max(0,c.maxLength-c.getValue().length-(c.getValue().match(/\n/g)||[]).length)},_typeChange:function(){this._modified=!0;var c=dojo.byId("travel-mode-type").value,b=dojo.byId("travel-mode-type-icon");n.remove(b,"tmTypeOtherDistance tmTypeOtherTime tmTypeDrivingDistance tmTypeDrivingTime tmTypeTruckingDistance tmTypeTruckingTime tmTypeWalkingDistance tmTypeWalkingTime".split(" "));
var c=dijit.byId("travel-mode-type").store.query({name:c})[0].id,a=dijit.byId("travel-mode-impedance").value,f=dijit.byId("travel-mode-timeImpedance").value,a=a===f;"AUTOMOBILE"===c?n.add(b,a?"tmTypeDrivingTime":"tmTypeDrivingDistance"):"TRUCK"===c?n.add(b,a?"tmTypeTruckingTime":"tmTypeTruckingDistance"):"WALK"===c?n.add(b,a?"tmTypeWalkingTime":"tmTypeWalkingDistance"):n.add(b,a?"tmTypeOtherTime":"tmTypeOtherDistance")},_impedanceChange:function(){this._modified=!0;var c=dijit.byId("travel-mode-impedance").value,
b=dijit.byId("travel-mode-timeImpedance"),a=dijit.byId("travel-mode-distanceImpedance"),f=b.store.query({id:c}),c=a.store.query({id:c});b.set("disabled",!1);a.set("disabled",!1);f.length?(b.set("item",f[0]),b.set("disabled",!0)):c.length&&(a.set("item",c[0]),a.set("disabled",!0));this._typeChange()},_timeDistanceAttrChange:function(){this._modified=!0;var c=dijit.byId("travel-mode-timeImpedance").value,b=dijit.byId("travel-mode-distanceImpedance").value,a=this._agolNAServiceDescription;p.forEach(a.networkDataset.networkAttributes,
function(f){if("esriNAUTCost"===f.usageType&&f.parameterNames.length)if(f.name===c||f.name===b){for(var d=a.attributeParameterValues,e=[],g=0;g<d.length;g++)f.name===d[g].attributeName&&(d[g].restrictionUsage=f.restrictionUsageParameterName===d[g].parameterName,d[g].costAttribute=!0,e.push(d[g]));this._grid.store.put({id:f.name,name:f.name,apply:!0,params:e})}else this._grid.store.remove(f.name)},this);this._grid._grid.refresh()},_uTurnChange:function(){this._modified=!0},_simplificationChange:function(){this._modified=
!0},_hierarchyChange:function(){this._modified=!0}})});