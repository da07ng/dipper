// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/map/dijit/renderer/_SimpleMixin","dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/Deferred esri/lang esri/symbols/jsonUtils esri/styles/basic esri/renderers/SimpleRenderer".split(" "),function(h,c,k,l,e,m,n,f,g){return{buildSimpleRenderer:function(){var a=new e;if(this.isFeatColl||this.isCSV||this.isSL||this.hasDynamic)this.buildSimpleRendererGo(null,a);else if("esri.renderer.UniqueValueRenderer"===this.renderer.declaredClass)if(this.isOwnerOfHostedFS){var b=
this.layer.getEditCapabilities();!this.layer.isEditable()||!b.canCreate&&(b.canUpdate||b.canDelete)||this.mapLayer.featureTemplatesChanged?this.buildSimpleRendererGo(!0,a):arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer)?this.buildSimpleRendererGo(!0,a):arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({title:this.i18n.warning,message:this.i18n.featureTypesAndTemplatesWarning,choiceOneTitle:this.i18n.yesLabel,choiceOneHandler:c.hitch(this,function(){this.buildSimpleRendererGo(!0,
a)}),choiceTwoTitle:this.i18n.noLabel,choiceTwoHandler:c.hitch(this,function(){a.reject()})})}else this.buildSimpleRendererGo(null,a);else this.buildSimpleRendererGo(null,a);return a},buildSimpleRendererGo:function(a,b){arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);this.hasDynamic=arcgisonline.map.main.hasDynamicLayers(this.mapLayer);a&&(arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer),this.mapLayer.featureTemplatesChanged=!0);this.scheme||(this.scheme=f.getSchemes({theme:"default",
basemap:this.getBasemapType(),geometryType:this.geometryType}).primaryScheme);this.symbol=this.applySchemeToSymbol(this.symbol,this.scheme);var d=new g(this.symbol);this.renderer.rotationInfo&&d.setRotationInfo(this.renderer.rotationInfo);delete this.authoringInfo;this.hasDynamic?b.resolve(d):this.getSuggestedOutline().then(c.hitch(this,function(a,c){this.replaceVisualVariable("sizeInfo","outline",c.widthInfo,a);b.resolve(a)},d),c.hitch(this,function(a,c){var d=this.getVisualVariablesExceptTypes([{type:"sizeInfo",
target:"outline"},{type:"sizeInfo"},{type:"colorInfo"}],a.visualVariables);a.setVisualVariables(d);b.resolve(a)},d))},applySimpleRenderer:function(a){var b=this.getRendererStyle((this.fLayer||this.layer).renderer);this.setRenderer(a);!this.hasDynamic&&("simple"!==b&&this.scheme&&esri.isDefined(this.scheme.opacity))&&(this.layer.setOpacity(this.scheme.opacity),this.transparencySlider&&this.transparencySlider.set("value",1-this.scheme.opacity));(arcgisonline.map.featColl.isFeatureCollection(this.mapLayer)||
this.isCSV)&&arcgisonline.map.main.markMapAsChanged("onRendererChange");this.isOwnerOfHostedFS&&!this.layer.templates.length&&arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);this.updateLegendPopup()}}});