// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
define("../../core/JSONSupport ../../core/lang ../../Graphic ../../geometry/SpatialReference ../../geometry/support/graphicsUtils ../../geometry/support/jsonUtils ../../symbols/support/jsonUtils".split(" "),function(u,v,w,t,x,y,z){return u.createSubclass({declaredClass:"esri.tasks.FeatureSet",classMetadata:{reader:{exclude:["transform"]}},displayFieldName:null,exceededTransferLimit:null,features:[],_featuresReader:function(a,b){var l=t.fromJSON(b.spatialReference),h;h=a.map(function(a){var b=w.fromJSON(a);
a=a.geometry&&a.geometry.spatialReference;b.geometry&&!a&&(b.geometry.spatialReference=l);return b});b.transform&&this._hydrate(b.transform,b.geometryType,h);return h},fieldAliases:null,geometryType:null,spatialReference:null,_spatialReferenceReader:function(a){return t.fromJSON(a)},toJSON:function(a){var b={hasZ:this.hasZ,hasM:this.hasM};this.displayFieldName&&(b.displayFieldName=this.displayFieldName);this.fields&&(b.fields=this.fields);this.spatialReference?b.spatialReference=this.spatialReference.toJSON():
this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJSON());this.features[0]&&(this.features[0].geometry&&(b.geometryType=y.getJsonType(this.features[0].geometry)),b.features=x._encodeGraphics(this.features,a));b.exceededTransferLimit=this.exceededTransferLimit;b.transform=this.transform;return v.fixJson(b)},quantize:function(a){var b=a.translate[0],l=a.translate[1],h=a.scale[0],r=a.scale[1],m=this.features,q=function(a,p,b){var n,c,g,e,f,
d,k=[];n=0;for(c=a.length;n<c;n++)if(g=a[n],0<n){if(d=p(g[0]),g=b(g[1]),d!==e||g!==f)k.push([d-e,g-f]),e=d,f=g}else e=p(g[0]),f=b(g[1]),k.push([e,f]);return 0<k.length?k:null},s=function(a,p,b){if("esriGeometryPoint"===a)return function(a){a.x=p(a.x);a.y=b(a.y);return a};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){var c,d,e,f,k;e=a.rings||a.paths;k=[];c=0;for(d=e.length;c<d;c++)f=e[c],(f=q(f,p,b))&&k.push(f);return 0<k.length?(a.rings?a.rings=k:a.paths=k,a):null};if("esriGeometryMultipoint"===
a)return function(a){var c;c=q(a.points,p,b);return 0<c.length?(a.points=c,a):null};if("esriGeometryEnvelope"===a)return function(a){return a}}(this.geometryType,function(a){return Math.round((a-b)/h)},function(a){return Math.round((l-a)/r)}),d,k;d=0;for(k=m.length;d<k;d++)s(m[d].geometry)||(m.splice(d,1),d--,k--);this.transform=a;return this},_hydrate:function(a,b,l){if(a){var h=a.translate[0],r=a.translate[1],m=a.scale[0],q=a.scale[1],s=function(a,b,l){if("esriGeometryPoint"===a)return function(a){a.x=
b(a.x);a.y=l(a.y)};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){a=a.rings||a.paths;var d,n,c,g,e,f,h,m;d=0;for(n=a.length;d<n;d++){e=a[d];c=0;for(g=e.length;c<g;c++)f=e[c],0<c?(h+=f[0],m+=f[1]):(h=f[0],m=f[1]),f[0]=b(h),f[1]=l(m)}};if("esriGeometryEnvelope"===a)return function(a){a.xmin=b(a.xmin);a.ymin=l(a.ymin);a.xmax=b(a.xmax);a.ymax=l(a.ymax)};if("esriGeometryMultipoint"===a)return function(a){a=a.points;var d,h,c,g,e;d=0;for(h=a.length;d<h;d++)c=a[d],0<d?(g+=c[0],
e+=c[1]):(g=c[0],e=c[1]),c[0]=b(g),c[1]=l(e)}}(b,function(a){return a*m+h},function(a){return r-a*q});a=0;for(b=l.length;a<b;a++)l[a].geometry&&s(l[a].geometry)}}})});