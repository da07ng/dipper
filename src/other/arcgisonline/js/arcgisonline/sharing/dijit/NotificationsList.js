// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/sharing/dijit/NotificationsList",["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dojox/rpc/Service,dojo/rpc/JsonService,dijit/Toolbar,arcgisonline/sharing/util"],function(h,a,k){a.provide("arcgisonline.sharing.dijit.NotificationsList");a.require("dijit._Widget");a.require("dijit._Templated");a.require("dojox.rpc.Service");a.require("dojo.rpc.JsonService");a.require("dijit.Toolbar");a.require("arcgisonline.sharing.util");a.declare("arcgisonline.sharing.dijit.NotificationsList",
[h._Widget],{i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=a.i18n.getLocalization("arcgisonline","arcgisonline").common;a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline","arcgisonline").notificationsList)},loadList:function(){var c=function(b,c){a.publish("onNotificationCount",[b.notifications.length]);var g=this.notificationsToTable(b.notifications);a.byId("notificationsList").innerHTML=g},b=arcgisonline.sharing.util.getUser();null!=b&&arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+
"community/users/"+b.email+"/notifications",a.hitch(this,c))},updateList:function(){this.loadList()},notificationsToTable:function(c){var b='\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" width\x3d"100%" class\x3d"notifications-table"\x3e';a.forEach(c,function(c,h){var g=c.type,e=a.date.locale.format(new Date(c.received),{selector:"date",format:"short"}),f=c.data.groupTitle,d="";switch(g){case "group_join":d=a.string.substitute(this.i18n.joinGroupByDate,{groupTitle:f,dateStr:e});break;
case "group_application_accepted":d=a.string.substitute(this.i18n.joinGroupAccepted,{groupTitle:f,dateStr:e});break;case "group_application_declined":d=a.string.substitute(this.i18n.declineGroupRequest,{groupTitle:f,dateStr:e});break;case "user_invite":d=a.string.substitute(this.i18n.inviteGroupRequest,{groupTitle:f,dateStr:e})+"\x3cBR/\x3e"+this.i18n.viewInvitation;break;case "user_invitation_accepted":d=a.string.substitute(this.i18n.acceptedInvite,{groupTitle:f,dateStr:e});break;case "user_invitation_declined":d=
a.string.substitute(this.i18n.declinedInvite,{groupTitle:f,dateStr:e});break;default:d=a.string.substitute(this.i18n.defaultMsg,{type:g,groupTitle:f,dateStr:e})}b+='\x3ctr\x3e\x3ctd width\x3d"90%"\x3e'+d+"\x3c/td\x3e";b+='\x3ctd width\x3d"10%"\x3e';b+="\x3cA href\x3d\"JavaScript:arcgisonline.sharing.geow.Community.deleteNotifictation('"+c.id+'\')" alt\x3d"'+this.i18n.deleteLabel+'" title\x3d"'+this.i18n.deleteLabel+'"\x3e\x3cdiv class\x3d"deleteNotificationIcon"\x3e\x3c/div\x3e\x3c/A\x3e';b+="\x3c/td\x3e\x3c/tr\x3e"},
this);0==c.length&&(b+='\x3ctr\x3e\x3ctd align\x3d"center" style\x3d"border:none;"\x3e'+this.i18n.noNotificationsMsg+"\x3c/td\x3e\x3c/tr\x3e");return b+="\x3c/table\x3e"}})});