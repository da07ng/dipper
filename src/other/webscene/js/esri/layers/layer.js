// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
define("require ../core/declare dojo/Deferred ../core/Accessor ../core/Promise ../core/Evented ../core/urlUtils ../kernel ../request ../geometry/SpatialReference ../geometry/Extent".split(" "),function(h,k,d,l,m,n,e,f,p,c,g){var q=0,r="multiply screen overlay darken lighten color-dodge color-burn hard-light soft-light difference exclusion hue saturation color luminosity".split(" ");return k([l,m,n],{declaredClass:"esri.layers.mixins.Layer",classMetadata:{properties:{hasAttributionData:{readOnly:!0,
dependsOn:["attributionDataUrl"]},parsedUrl:{readOnly:!0,dependsOn:["url"]},credential:{readOnly:!0,dependsOn:["loaded","parsedUrl"]},visible:{}},computed:{token:["credential.token"]}},constructor:function(){this.id=Date.now().toString(16)+"-layer-"+q++;this.then(function(a){this.loaded=!0;this.emit("load")}.bind(this),function(a){this.loaded=!1;this.emit("load-error",a);this.emit("error",a)}.bind(this))},attributionDataUrl:null,blendMode:"normal",_blendModeSetter:function(a){return-1<r.indexOf(a)?
a:"normal"},credential:null,_credentialGetter:function(){var a=this.loaded&&this.parsedUrl&&f.id&&f.id.findCredential(this.parsedUrl.path)||null;a&&a.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));return a},fullExtent:new g(-180,-90,180,90,c.WGS84),hasAttributionData:null,_hasAttributionDataGetter:function(){return!!this.attributionDataUrl},initialExtent:new g(-180,-90,180,90,c.WGS84),listMode:"show",loaded:!1,minScale:0,_minScaleSetter:function(a){return a||0},maxScale:0,_maxScaleSetter:function(a){return a||
0},opacity:1,_opacitySetter:function(a){return 0>a?0:1<a?1:a},_parsedUrlGetter:function(){return this.url?e.urlToObject(this.url):null},refreshInterval:0,showAttribution:!0,showLegend:!0,spatialReference:c.WGS84,_userToken:null,_tokenGetter:function(){var a=this._userToken=this._userToken||this.get("parsedUrl.query.token"),b=this.get("credential.token");return a||b||null},_tokenSetter:function(a){this._userToken=a},visible:!0,url:null,_urlSetter:function(a){return e.normalize(a)},load:function(){},
createLayerView:function(a){var b=new d,c=this.viewModulePaths[a.type];c?h([c],function(c){(new c({layer:this,view:a})).then(function(a){b.resolve(a)}.bind(this),function(a){b.reject(a)})}.bind(this)):b.reject(Error('No LayerView module available for layer "'+this.declaredClass+'" and view type: "'+a.type+'"'));return b.promise},destroyLayerView:function(a,b){this.emit("layer-view-destroy",{layerView:b});b.destroy()},getAttributionData:function(){var a=this.attributionDataUrl;this.hasAttributionData&&
a?a=p({url:a,content:{f:"json"},handleAs:"json"}):(a=new d,a.reject(Error("Layer does not have attribution data")),a=a.promise);return a},refresh:function(){this.emit("refresh")}})});