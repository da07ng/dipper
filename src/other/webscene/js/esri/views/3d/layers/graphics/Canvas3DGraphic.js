// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0beta2/esri/copyright.txt for details.
//>>built
define(["../../../../core/declare","./ElevationInfo","../../webgl-engine/Stage"],function(l,e,d){var h=l(null,{constructor:function(a,c,b,d,m,f,e,k){this.canvas3DSymbol=a;this.uniqueMaterials=d;this.uniqueGeometries=b;this.uniqueTextures=m;this.stageObject=c;this.elevationAligner=f;this.elevationInfo=new g(e);this.stageLayer=this.stage=null;this._shown=!1;this._visibilityFlags={};this.visibilityMode=null!=k?k:h.VisibilityModes.HIDE_FACERANGE},initialize:function(a,c){this.stageLayer=a;this.stage=
c;var b;if(this.uniqueMaterials)for(b=0;b<this.uniqueMaterials.length;b++)c.add(d.ModelContentType.MATERIAL,this.uniqueMaterials[b]);if(this.uniqueGeometries)for(b=0;b<this.uniqueGeometries.length;b++)c.add(d.ModelContentType.GEOMETRY,this.uniqueGeometries[b]);if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)c.add(d.ModelContentType.TEXTURE,this.uniqueTextures[b]);c.add(d.ModelContentType.OBJECT,this.stageObject)},isDraped:function(){return!1},areVisibilityFlagsSet:function(a,c){for(var b=
!0,d=Object.keys(this._visibilityFlags),e=0;e<d.length;e++){var f=d[e];if(f!==c){if(f===a)return this._visibilityFlags[f];b=b&&this._visibilityFlags[f]}}return b},setVisibilityFlag:function(a,c){this._visibilityFlags[a]=c;return this._calcAndSetVisibility()},_calcAndSetVisibility:function(){if(null!=this.stage){var a=this.areVisibilityFlagsSet();return this._shown!=a?((this._shown=a)?this.stageLayer.hasObject(this.stageObject)?this.stageObject.unhideAllFaceRange():this.stageLayer.addObject(this.stageObject):
this.visibilityMode===h.VisibilityModes.HIDE_FACERANGE?this.stageObject.hideAllFaceRanges():this.stageLayer.removeObject(this.stageObject),!0):!1}},destroy:function(){if(this.stageLayer){var a,c=this.stage;if(this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)c.remove(d.ModelContentType.MATERIAL,this.uniqueMaterials[a].getId());if(this.uniqueGeometries)for(a=0;a<this.uniqueGeometries.length;a++)c.remove(d.ModelContentType.GEOMETRY,this.uniqueGeometries[a].getId());if(this.uniqueTextures)for(a=
0;a<this.uniqueTextures.length;a++)c.remove(d.ModelContentType.TEXTURE,this.uniqueTextures[a].getId())}c.remove(d.ModelContentType.OBJECT,this.stageObject.getId());this.stageLayer.hasObject(this.stageObject)&&this.stageLayer.removeObject(this.stageObject);this._shown=!1;this.stage=this.stageLayer=null},mustAlignToTerrain:function(){return this.elevationInfo.mode!==e.MODES.ABSOLUTE_HEIGHT},alignWithElevation:function(a,c,b){this.elevationAligner&&this.elevationAligner(this,a,c,b)},setDrawOrder:function(){},
getBSRadius:function(){return this.stageObject.getBSRadiusApproxScaled()},getCenterObjectSpace:function(){return this.stageObject.getCenter(!0)},getBoundingBoxObjectSpace:function(){return this.stageObject.getBBMin(!0).concat(this.stageObject.getBBMax(!0))},getScreenSize:function(){throw Error("Not implemented for this symbol layer/graphic type");}});h.VisibilityModes={REMOVE_OBJECT:0,HIDE_FACERANGE:1};var g=function(a){e.call(this,a);this.centerPointInElevationSR=null};g.prototype=new e;g.prototype.constructor=
g;return h});