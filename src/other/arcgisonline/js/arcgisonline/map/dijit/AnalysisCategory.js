// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.
//>>built
define("arcgisonline/map/dijit/AnalysisCategory",["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/layout/ContentPane,esri/dijit/analysis/Analysis"],function(c,a,e){a.provide("arcgisonline.map.dijit.AnalysisCategory");a.require("dijit._Widget");a.require("dijit._Templated");a.require("dijit.layout.ContentPane");a.require("esri.dijit.analysis.Analysis");a.declare("arcgisonline.map.dijit.AnalysisCategory",[c._Widget,c._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv dojoType\x3d"dijit.layout.BorderContainer" region\x3d"top"\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"analysisContentHeader" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" class\x3d"panel panel_left"\x3e\r\n    \x3ctable class\x3d"esriFormTable" \x3e \r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3cdiv class\x3d"iconPerformAnalysis32"\x3e\x3c/div\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\x3cdiv dojoAttachPoint\x3d"analysisContentTitle" class\x3d"panelSubHeader analysisTitle" style\x3d"padding:0.5em;"\x3e${i18n.performAnalysis}\x3c/div\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"esriFloatTrailing" style\x3d"padding:0;"\x3e\r\n            \x3ca href\x3d"#" dojoAttachPoint\x3d"_closeBtn" dojoAttachEvent\x3d"onclick:_onClose" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse close_icon"\x3e\r\n            \x3cimg src\x3d"images/close.gif" border\x3d"0"/\x3e\x3c/A\x3e\r\n          \x3c/div\x3e                \r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"analysisContentPane"   dojoType\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-x:hidden;overflow-y:auto;position:relative;" class\x3d"scrollPane"\x3e\r\n     \x3cdiv dojoAttachPoint\x3d"aggregateCtr" style\x3d"width:100%"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n   \x3cdiv dojoAttachPoint\x3d"analysisContentFooter" id\x3d"analysisContentFooter" dojoType\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px;"\x3e \r\n      \x3cdiv class\x3d"footer" id\x3d"analysisSiteFooter" dojoAttachPoint\x3d"analysisSiteFooter" dojotype\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\x3c/div\x3e\r\n   \x3c/div\x3e\r\n\x3c/div\x3e',
i18n:null,analysisTool:null,featureLayers:null,analysisLayer:null,constructor:function(b,a){null!=b&&(b.featureLayers&&(this.featureLayers=b.featurelayers),b.containerNode&&(this.container=b.containerNode),b.analysisLayer&&(this.analysisLayer=b.analysisLayer),b.selectedCategory&&(this.selectedCategory=b.selectedCategory),b.analysisType&&(this.analysisType=b.analysisType),this._pbConnects=[])},postMixInProperties:function(){this.inherited(arguments);this.i18n={};a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline",
"arcgisonline").common);a.mixin(this.i18n,a.i18n.getLocalization("arcgisonline","arcgisonline").tocPanel)},postCreate:function(){this.inherited(arguments);this.container.addChild(c.byId(this.id))},startup:function(){this.inherited(arguments);this.analysisTool=new esri.dijit.analysis.Analysis({},this.aggregateCtr);this.analysisTool.startup();this.selectedCategory&&this.analysisTool.set("selectedCategory",this.selectedCategory);arcgisonline.map.dijit.toc.analysis.canPerformDriveAnalysis()||this.analysisTool.hide("CreateDriveTimeAreasTool");
arcgisonline.map.dijit.toc.analysis.canPerformPlanRoutesAnalysis()||this.analysisTool.hide("PlanRoutesTool");arcgisonline.map.dijit.toc.analysis.canPerformODAnalysis()||this.analysisTool.hide("ConnectOriginsToDestinationsTool");arcgisonline.map.dijit.toc.analysis.canPerformGeoEnrichment()||this.analysisTool.hide("EnrichLocationsCategory");arcgisonline.map.dijit.toc.analysis.canPerformElevationAnalysis()||this.analysisTool.hide("CreateViewshedTool");arcgisonline.map.dijit.toc.analysis.canPerformHydroAnalysis()||
(this.analysisTool.hide("TraceDownstreamTool"),this.analysisTool.hide("CreateWatershedsTool"));this.analysisTool.disable("ExtractDataTool",0===this.featureLayers.length&&!this.analysisLayer);this.analysisTool.disable("MergeLayersTool",2>this.featureLayers.length&&!this.analysisLayer);this._loadConnections();this.adjustHeight()},destroy:function(){this.inherited(arguments);a.forEach(this._pbConnects,a.disconnect);delete this._pbConnects},clear:function(){a.query(".esriAnalyisHelpWindow").forEach(function(b){c.popup.close(c.byNode(b))})},
_loadConnections:function(){this._connect(c.byId("leftContentPanel"),"resize",a.hitch(this,this.adjustHeight));this._connect(this.analysisTool,"onToolSelect",a.hitch(this,this._handleToolSelect))},_connect:function(b,d,c){this._pbConnects.push(a.connect(b,d,c))},_onClose:function(b){b.preventDefault();this.analysisContentPane.scrollTop=0;arcgisonline.map.leftPanel.openLeftTOCPanel()},adjustHeight:function(b){if(!("undefined"==typeof leftPanel||"analysisStack"!=leftPanel.visibleStack)){b=a.coords(a.byId("leftPanelDiv")).h;
var d=a.coords(this.analysisContentHeader.domNode).h,c=a.coords(a.byId("analysisSiteFooter_links")).h+10;a.style(a.byId("analysisContentFooter"),"height",c+"px");a.style(this.analysisContentPane.domNode,"height",b-(d+c)+"px")}},_handleToolSelect:function(b){var a={};a.featureLayers=this.featureLayers;b.helpTopic=b.helpTopic.replace("Tool","");b.helpTopic=b.helpTopic.replace("-","");a.toolName=b.helpTopic;a.analysisLayer=this.analysisLayer;this.analysisType&&(a.analysisType=this.analysisType);arcgisonline.map.leftPanel.openAnalysisToolPanel(a)}})});